var M0=Object.defineProperty;var E0=(r,t,e)=>t in r?M0(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var F=(r,t,e)=>E0(r,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=e(n);fetch(n.href,i)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function nh(r){const t=Object.create(null);for(const e of r.split(","))t[e]=1;return e=>e in t}const Et={},Ir=[],xs=()=>{},A0=()=>!1,Wa=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&(r.charCodeAt(2)>122||r.charCodeAt(2)<97),rh=r=>r.startsWith("onUpdate:"),ye=Object.assign,ih=(r,t)=>{const e=r.indexOf(t);e>-1&&r.splice(e,1)},P0=Object.prototype.hasOwnProperty,wt=(r,t)=>P0.call(r,t),lt=Array.isArray,Br=r=>po(r)==="[object Map]",Ua=r=>po(r)==="[object Set]",hu=r=>po(r)==="[object Date]",dt=r=>typeof r=="function",qt=r=>typeof r=="string",$s=r=>typeof r=="symbol",Dt=r=>r!==null&&typeof r=="object",fd=r=>(Dt(r)||dt(r))&&dt(r.then)&&dt(r.catch),dd=Object.prototype.toString,po=r=>dd.call(r),F0=r=>po(r).slice(8,-1),gd=r=>po(r)==="[object Object]",oh=r=>qt(r)&&r!=="NaN"&&r[0]!=="-"&&""+parseInt(r,10)===r,Ai=nh(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ga=r=>{const t=Object.create(null);return e=>t[e]||(t[e]=r(e))},D0=/-(\w)/g,ps=Ga(r=>r.replace(D0,(t,e)=>e?e.toUpperCase():"")),R0=/\B([A-Z])/g,xr=Ga(r=>r.replace(R0,"-$1").toLowerCase()),$a=Ga(r=>r.charAt(0).toUpperCase()+r.slice(1)),Sl=Ga(r=>r?`on${$a(r)}`:""),cn=(r,t)=>!Object.is(r,t),Zo=(r,...t)=>{for(let e=0;e<r.length;e++)r[e](...t)},pd=(r,t,e,s=!1)=>{Object.defineProperty(r,t,{configurable:!0,enumerable:!1,writable:s,value:e})},ca=r=>{const t=parseFloat(r);return isNaN(t)?r:t};let uu;const qa=()=>uu||(uu=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function hs(r){if(lt(r)){const t={};for(let e=0;e<r.length;e++){const s=r[e],n=qt(s)?B0(s):hs(s);if(n)for(const i in n)t[i]=n[i]}return t}else if(qt(r)||Dt(r))return r}const L0=/;(?![^(]*\))/g,j0=/:([^]+)/,I0=/\/\*[^]*?\*\//g;function B0(r){const t={};return r.replace(I0,"").split(L0).forEach(e=>{if(e){const s=e.split(j0);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function $e(r){let t="";if(qt(r))t=r;else if(lt(r))for(let e=0;e<r.length;e++){const s=$e(r[e]);s&&(t+=s+" ")}else if(Dt(r))for(const e in r)r[e]&&(t+=e+" ");return t.trim()}const N0="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",H0=nh(N0);function md(r){return!!r||r===""}function Y0(r,t){if(r.length!==t.length)return!1;let e=!0;for(let s=0;e&&s<r.length;s++)e=Ka(r[s],t[s]);return e}function Ka(r,t){if(r===t)return!0;let e=hu(r),s=hu(t);if(e||s)return e&&s?r.getTime()===t.getTime():!1;if(e=$s(r),s=$s(t),e||s)return r===t;if(e=lt(r),s=lt(t),e||s)return e&&s?Y0(r,t):!1;if(e=Dt(r),s=Dt(t),e||s){if(!e||!s)return!1;const n=Object.keys(r).length,i=Object.keys(t).length;if(n!==i)return!1;for(const o in r){const a=r.hasOwnProperty(o),l=t.hasOwnProperty(o);if(a&&!l||!a&&l||!Ka(r[o],t[o]))return!1}}return String(r)===String(t)}function z0(r,t){return r.findIndex(e=>Ka(e,t))}const vd=r=>!!(r&&r.__v_isRef===!0),Cs=r=>qt(r)?r:r==null?"":lt(r)||Dt(r)&&(r.toString===dd||!dt(r.toString))?vd(r)?Cs(r.value):JSON.stringify(r,_d,2):String(r),_d=(r,t)=>vd(t)?_d(r,t.value):Br(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[s,n],i)=>(e[Tl(s,i)+" =>"]=n,e),{})}:Ua(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>Tl(e))}:$s(t)?Tl(t):Dt(t)&&!lt(t)&&!gd(t)?String(t):t,Tl=(r,t="")=>{var e;return $s(r)?`Symbol(${(e=r.description)!=null?e:t})`:r};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ue;class X0{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Ue,!t&&Ue&&(this.index=(Ue.scopes||(Ue.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].pause();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].resume();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].resume()}}run(t){if(this._active){const e=Ue;try{return Ue=this,t()}finally{Ue=e}}}on(){Ue=this}off(){Ue=this.parent}stop(t){if(this._active){this._active=!1;let e,s;for(e=0,s=this.effects.length;e<s;e++)this.effects[e].stop();for(this.effects.length=0,e=0,s=this.cleanups.length;e<s;e++)this.cleanups[e]();if(this.cleanups.length=0,this.scopes){for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.parent=void 0}}}function V0(){return Ue}let Ft;const Ol=new WeakSet;class yd{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Ue&&Ue.active&&Ue.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Ol.has(this)&&(Ol.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||xd(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,fu(this),Cd(this);const t=Ft,e=ws;Ft=this,ws=!0;try{return this.fn()}finally{wd(this),Ft=t,ws=e,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)ch(t);this.deps=this.depsTail=void 0,fu(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Ol.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){lc(this)&&this.run()}get dirty(){return lc(this)}}let bd=0,Pi,Fi;function xd(r,t=!1){if(r.flags|=8,t){r.next=Fi,Fi=r;return}r.next=Pi,Pi=r}function ah(){bd++}function lh(){if(--bd>0)return;if(Fi){let t=Fi;for(Fi=void 0;t;){const e=t.next;t.next=void 0,t.flags&=-9,t=e}}let r;for(;Pi;){let t=Pi;for(Pi=void 0;t;){const e=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(s){r||(r=s)}t=e}}if(r)throw r}function Cd(r){for(let t=r.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function wd(r){let t,e=r.depsTail,s=e;for(;s;){const n=s.prevDep;s.version===-1?(s===e&&(e=n),ch(s),W0(s)):t=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=n}r.deps=t,r.depsTail=e}function lc(r){for(let t=r.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Sd(t.dep.computed)||t.dep.version!==t.version))return!0;return!!r._dirty}function Sd(r){if(r.flags&4&&!(r.flags&16)||(r.flags&=-17,r.globalVersion===qi))return;r.globalVersion=qi;const t=r.dep;if(r.flags|=2,t.version>0&&!r.isSSR&&r.deps&&!lc(r)){r.flags&=-3;return}const e=Ft,s=ws;Ft=r,ws=!0;try{Cd(r);const n=r.fn(r._value);(t.version===0||cn(n,r._value))&&(r._value=n,t.version++)}catch(n){throw t.version++,n}finally{Ft=e,ws=s,wd(r),r.flags&=-3}}function ch(r,t=!1){const{dep:e,prevSub:s,nextSub:n}=r;if(s&&(s.nextSub=n,r.prevSub=void 0),n&&(n.prevSub=s,r.nextSub=void 0),e.subs===r&&(e.subs=s,!s&&e.computed)){e.computed.flags&=-5;for(let i=e.computed.deps;i;i=i.nextDep)ch(i,!0)}!t&&!--e.sc&&e.map&&e.map.delete(e.key)}function W0(r){const{prevDep:t,nextDep:e}=r;t&&(t.nextDep=e,r.prevDep=void 0),e&&(e.prevDep=t,r.nextDep=void 0)}let ws=!0;const Td=[];function zn(){Td.push(ws),ws=!1}function Xn(){const r=Td.pop();ws=r===void 0?!0:r}function fu(r){const{cleanup:t}=r;if(r.cleanup=void 0,t){const e=Ft;Ft=void 0;try{t()}finally{Ft=e}}}let qi=0;class U0{constructor(t,e){this.sub=t,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class hh{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!Ft||!ws||Ft===this.computed)return;let e=this.activeLink;if(e===void 0||e.sub!==Ft)e=this.activeLink=new U0(Ft,this),Ft.deps?(e.prevDep=Ft.depsTail,Ft.depsTail.nextDep=e,Ft.depsTail=e):Ft.deps=Ft.depsTail=e,Od(e);else if(e.version===-1&&(e.version=this.version,e.nextDep)){const s=e.nextDep;s.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=s),e.prevDep=Ft.depsTail,e.nextDep=void 0,Ft.depsTail.nextDep=e,Ft.depsTail=e,Ft.deps===e&&(Ft.deps=s)}return e}trigger(t){this.version++,qi++,this.notify(t)}notify(t){ah();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{lh()}}}function Od(r){if(r.dep.sc++,r.sub.flags&4){const t=r.dep.computed;if(t&&!r.dep.subs){t.flags|=20;for(let s=t.deps;s;s=s.nextDep)Od(s)}const e=r.dep.subs;e!==r&&(r.prevSub=e,e&&(e.nextSub=r)),r.dep.subs=r}}const cc=new WeakMap,ar=Symbol(""),hc=Symbol(""),Ki=Symbol("");function fe(r,t,e){if(ws&&Ft){let s=cc.get(r);s||cc.set(r,s=new Map);let n=s.get(e);n||(s.set(e,n=new hh),n.map=s,n.key=e),n.track()}}function on(r,t,e,s,n,i){const o=cc.get(r);if(!o){qi++;return}const a=l=>{l&&l.trigger()};if(ah(),t==="clear")o.forEach(a);else{const l=lt(r),c=l&&oh(e);if(l&&e==="length"){const h=Number(s);o.forEach((u,f)=>{(f==="length"||f===Ki||!$s(f)&&f>=h)&&a(u)})}else switch((e!==void 0||o.has(void 0))&&a(o.get(e)),c&&a(o.get(Ki)),t){case"add":l?c&&a(o.get("length")):(a(o.get(ar)),Br(r)&&a(o.get(hc)));break;case"delete":l||(a(o.get(ar)),Br(r)&&a(o.get(hc)));break;case"set":Br(r)&&a(o.get(ar));break}}lh()}function Or(r){const t=Ct(r);return t===r?t:(fe(t,"iterate",Ki),fs(r)?t:t.map(de))}function Ja(r){return fe(r=Ct(r),"iterate",Ki),r}const G0={__proto__:null,[Symbol.iterator](){return kl(this,Symbol.iterator,de)},concat(...r){return Or(this).concat(...r.map(t=>lt(t)?Or(t):t))},entries(){return kl(this,"entries",r=>(r[1]=de(r[1]),r))},every(r,t){return Zs(this,"every",r,t,void 0,arguments)},filter(r,t){return Zs(this,"filter",r,t,e=>e.map(de),arguments)},find(r,t){return Zs(this,"find",r,t,de,arguments)},findIndex(r,t){return Zs(this,"findIndex",r,t,void 0,arguments)},findLast(r,t){return Zs(this,"findLast",r,t,de,arguments)},findLastIndex(r,t){return Zs(this,"findLastIndex",r,t,void 0,arguments)},forEach(r,t){return Zs(this,"forEach",r,t,void 0,arguments)},includes(...r){return Ml(this,"includes",r)},indexOf(...r){return Ml(this,"indexOf",r)},join(r){return Or(this).join(r)},lastIndexOf(...r){return Ml(this,"lastIndexOf",r)},map(r,t){return Zs(this,"map",r,t,void 0,arguments)},pop(){return _i(this,"pop")},push(...r){return _i(this,"push",r)},reduce(r,...t){return du(this,"reduce",r,t)},reduceRight(r,...t){return du(this,"reduceRight",r,t)},shift(){return _i(this,"shift")},some(r,t){return Zs(this,"some",r,t,void 0,arguments)},splice(...r){return _i(this,"splice",r)},toReversed(){return Or(this).toReversed()},toSorted(r){return Or(this).toSorted(r)},toSpliced(...r){return Or(this).toSpliced(...r)},unshift(...r){return _i(this,"unshift",r)},values(){return kl(this,"values",de)}};function kl(r,t,e){const s=Ja(r),n=s[t]();return s!==r&&!fs(r)&&(n._next=n.next,n.next=()=>{const i=n._next();return i.value&&(i.value=e(i.value)),i}),n}const $0=Array.prototype;function Zs(r,t,e,s,n,i){const o=Ja(r),a=o!==r&&!fs(r),l=o[t];if(l!==$0[t]){const u=l.apply(r,i);return a?de(u):u}let c=e;o!==r&&(a?c=function(u,f){return e.call(this,de(u),f,r)}:e.length>2&&(c=function(u,f){return e.call(this,u,f,r)}));const h=l.call(o,c,s);return a&&n?n(h):h}function du(r,t,e,s){const n=Ja(r);let i=e;return n!==r&&(fs(r)?e.length>3&&(i=function(o,a,l){return e.call(this,o,a,l,r)}):i=function(o,a,l){return e.call(this,o,de(a),l,r)}),n[t](i,...s)}function Ml(r,t,e){const s=Ct(r);fe(s,"iterate",Ki);const n=s[t](...e);return(n===-1||n===!1)&&dh(e[0])?(e[0]=Ct(e[0]),s[t](...e)):n}function _i(r,t,e=[]){zn(),ah();const s=Ct(r)[t].apply(r,e);return lh(),Xn(),s}const q0=nh("__proto__,__v_isRef,__isVue"),kd=new Set(Object.getOwnPropertyNames(Symbol).filter(r=>r!=="arguments"&&r!=="caller").map(r=>Symbol[r]).filter($s));function K0(r){$s(r)||(r=String(r));const t=Ct(this);return fe(t,"has",r),t.hasOwnProperty(r)}class Md{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,s){if(e==="__v_skip")return t.__v_skip;const n=this._isReadonly,i=this._isShallow;if(e==="__v_isReactive")return!n;if(e==="__v_isReadonly")return n;if(e==="__v_isShallow")return i;if(e==="__v_raw")return s===(n?i?ov:Fd:i?Pd:Ad).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(s)?t:void 0;const o=lt(t);if(!n){let l;if(o&&(l=G0[e]))return l;if(e==="hasOwnProperty")return K0}const a=Reflect.get(t,e,ve(t)?t:s);return($s(e)?kd.has(e):q0(e))||(n||fe(t,"get",e),i)?a:ve(a)?o&&oh(e)?a:a.value:Dt(a)?n?Rd(a):Za(a):a}}class Ed extends Md{constructor(t=!1){super(!1,t)}set(t,e,s,n){let i=t[e];if(!this._isShallow){const l=gr(i);if(!fs(s)&&!gr(s)&&(i=Ct(i),s=Ct(s)),!lt(t)&&ve(i)&&!ve(s))return l?!1:(i.value=s,!0)}const o=lt(t)&&oh(e)?Number(e)<t.length:wt(t,e),a=Reflect.set(t,e,s,ve(t)?t:n);return t===Ct(n)&&(o?cn(s,i)&&on(t,"set",e,s):on(t,"add",e,s)),a}deleteProperty(t,e){const s=wt(t,e);t[e];const n=Reflect.deleteProperty(t,e);return n&&s&&on(t,"delete",e,void 0),n}has(t,e){const s=Reflect.has(t,e);return(!$s(e)||!kd.has(e))&&fe(t,"has",e),s}ownKeys(t){return fe(t,"iterate",lt(t)?"length":ar),Reflect.ownKeys(t)}}class J0 extends Md{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const Z0=new Ed,Q0=new J0,tv=new Ed(!0);const uc=r=>r,wo=r=>Reflect.getPrototypeOf(r);function ev(r,t,e){return function(...s){const n=this.__v_raw,i=Ct(n),o=Br(i),a=r==="entries"||r===Symbol.iterator&&o,l=r==="keys"&&o,c=n[r](...s),h=e?uc:t?fc:de;return!t&&fe(i,"iterate",l?hc:ar),{next(){const{value:u,done:f}=c.next();return f?{value:u,done:f}:{value:a?[h(u[0]),h(u[1])]:h(u),done:f}},[Symbol.iterator](){return this}}}}function So(r){return function(...t){return r==="delete"?!1:r==="clear"?void 0:this}}function sv(r,t){const e={get(n){const i=this.__v_raw,o=Ct(i),a=Ct(n);r||(cn(n,a)&&fe(o,"get",n),fe(o,"get",a));const{has:l}=wo(o),c=t?uc:r?fc:de;if(l.call(o,n))return c(i.get(n));if(l.call(o,a))return c(i.get(a));i!==o&&i.get(n)},get size(){const n=this.__v_raw;return!r&&fe(Ct(n),"iterate",ar),Reflect.get(n,"size",n)},has(n){const i=this.__v_raw,o=Ct(i),a=Ct(n);return r||(cn(n,a)&&fe(o,"has",n),fe(o,"has",a)),n===a?i.has(n):i.has(n)||i.has(a)},forEach(n,i){const o=this,a=o.__v_raw,l=Ct(a),c=t?uc:r?fc:de;return!r&&fe(l,"iterate",ar),a.forEach((h,u)=>n.call(i,c(h),c(u),o))}};return ye(e,r?{add:So("add"),set:So("set"),delete:So("delete"),clear:So("clear")}:{add(n){!t&&!fs(n)&&!gr(n)&&(n=Ct(n));const i=Ct(this);return wo(i).has.call(i,n)||(i.add(n),on(i,"add",n,n)),this},set(n,i){!t&&!fs(i)&&!gr(i)&&(i=Ct(i));const o=Ct(this),{has:a,get:l}=wo(o);let c=a.call(o,n);c||(n=Ct(n),c=a.call(o,n));const h=l.call(o,n);return o.set(n,i),c?cn(i,h)&&on(o,"set",n,i):on(o,"add",n,i),this},delete(n){const i=Ct(this),{has:o,get:a}=wo(i);let l=o.call(i,n);l||(n=Ct(n),l=o.call(i,n)),a&&a.call(i,n);const c=i.delete(n);return l&&on(i,"delete",n,void 0),c},clear(){const n=Ct(this),i=n.size!==0,o=n.clear();return i&&on(n,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(n=>{e[n]=ev(n,r,t)}),e}function uh(r,t){const e=sv(r,t);return(s,n,i)=>n==="__v_isReactive"?!r:n==="__v_isReadonly"?r:n==="__v_raw"?s:Reflect.get(wt(e,n)&&n in s?e:s,n,i)}const nv={get:uh(!1,!1)},rv={get:uh(!1,!0)},iv={get:uh(!0,!1)};const Ad=new WeakMap,Pd=new WeakMap,Fd=new WeakMap,ov=new WeakMap;function av(r){switch(r){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function lv(r){return r.__v_skip||!Object.isExtensible(r)?0:av(F0(r))}function Za(r){return gr(r)?r:fh(r,!1,Z0,nv,Ad)}function Dd(r){return fh(r,!1,tv,rv,Pd)}function Rd(r){return fh(r,!0,Q0,iv,Fd)}function fh(r,t,e,s,n){if(!Dt(r)||r.__v_raw&&!(t&&r.__v_isReactive))return r;const i=n.get(r);if(i)return i;const o=lv(r);if(o===0)return r;const a=new Proxy(r,o===2?s:e);return n.set(r,a),a}function Nr(r){return gr(r)?Nr(r.__v_raw):!!(r&&r.__v_isReactive)}function gr(r){return!!(r&&r.__v_isReadonly)}function fs(r){return!!(r&&r.__v_isShallow)}function dh(r){return r?!!r.__v_raw:!1}function Ct(r){const t=r&&r.__v_raw;return t?Ct(t):r}function Ld(r){return!wt(r,"__v_skip")&&Object.isExtensible(r)&&pd(r,"__v_skip",!0),r}const de=r=>Dt(r)?Za(r):r,fc=r=>Dt(r)?Rd(r):r;function ve(r){return r?r.__v_isRef===!0:!1}function nt(r){return jd(r,!1)}function gh(r){return jd(r,!0)}function jd(r,t){return ve(r)?r:new cv(r,t)}class cv{constructor(t,e){this.dep=new hh,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=e?t:Ct(t),this._value=e?t:de(t),this.__v_isShallow=e}get value(){return this.dep.track(),this._value}set value(t){const e=this._rawValue,s=this.__v_isShallow||fs(t)||gr(t);t=s?t:Ct(t),cn(t,e)&&(this._rawValue=t,this._value=s?t:de(t),this.dep.trigger())}}function Ze(r){return ve(r)?r.value:r}const hv={get:(r,t,e)=>t==="__v_raw"?r:Ze(Reflect.get(r,t,e)),set:(r,t,e,s)=>{const n=r[t];return ve(n)&&!ve(e)?(n.value=e,!0):Reflect.set(r,t,e,s)}};function Id(r){return Nr(r)?r:new Proxy(r,hv)}class uv{constructor(t,e,s){this.fn=t,this.setter=e,this._value=void 0,this.dep=new hh(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=qi-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&Ft!==this)return xd(this,!0),!0}get value(){const t=this.dep.track();return Sd(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function fv(r,t,e=!1){let s,n;return dt(r)?s=r:(s=r.get,n=r.set),new uv(s,n,e)}const To={},ha=new WeakMap;let Zn;function dv(r,t=!1,e=Zn){if(e){let s=ha.get(e);s||ha.set(e,s=[]),s.push(r)}}function gv(r,t,e=Et){const{immediate:s,deep:n,once:i,scheduler:o,augmentJob:a,call:l}=e,c=b=>n?b:fs(b)||n===!1||n===0?an(b,1):an(b);let h,u,f,d,p=!1,g=!1;if(ve(r)?(u=()=>r.value,p=fs(r)):Nr(r)?(u=()=>c(r),p=!0):lt(r)?(g=!0,p=r.some(b=>Nr(b)||fs(b)),u=()=>r.map(b=>{if(ve(b))return b.value;if(Nr(b))return c(b);if(dt(b))return l?l(b,2):b()})):dt(r)?t?u=l?()=>l(r,2):r:u=()=>{if(f){zn();try{f()}finally{Xn()}}const b=Zn;Zn=h;try{return l?l(r,3,[d]):r(d)}finally{Zn=b}}:u=xs,t&&n){const b=u,w=n===!0?1/0:n;u=()=>an(b(),w)}const m=V0(),v=()=>{h.stop(),m&&m.active&&ih(m.effects,h)};if(i&&t){const b=t;t=(...w)=>{b(...w),v()}}let _=g?new Array(r.length).fill(To):To;const y=b=>{if(!(!(h.flags&1)||!h.dirty&&!b))if(t){const w=h.run();if(n||p||(g?w.some((A,O)=>cn(A,_[O])):cn(w,_))){f&&f();const A=Zn;Zn=h;try{const O=[w,_===To?void 0:g&&_[0]===To?[]:_,d];l?l(t,3,O):t(...O),_=w}finally{Zn=A}}}else h.run()};return a&&a(y),h=new yd(u),h.scheduler=o?()=>o(y,!1):y,d=b=>dv(b,!1,h),f=h.onStop=()=>{const b=ha.get(h);if(b){if(l)l(b,4);else for(const w of b)w();ha.delete(h)}},t?s?y(!0):_=h.run():o?o(y.bind(null,!0),!0):h.run(),v.pause=h.pause.bind(h),v.resume=h.resume.bind(h),v.stop=v,v}function an(r,t=1/0,e){if(t<=0||!Dt(r)||r.__v_skip||(e=e||new Set,e.has(r)))return r;if(e.add(r),t--,ve(r))an(r.value,t,e);else if(lt(r))for(let s=0;s<r.length;s++)an(r[s],t,e);else if(Ua(r)||Br(r))r.forEach(s=>{an(s,t,e)});else if(gd(r)){for(const s in r)an(r[s],t,e);for(const s of Object.getOwnPropertySymbols(r))Object.prototype.propertyIsEnumerable.call(r,s)&&an(r[s],t,e)}return r}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function mo(r,t,e,s){try{return s?r(...s):r()}catch(n){Qa(n,t,e)}}function qs(r,t,e,s){if(dt(r)){const n=mo(r,t,e,s);return n&&fd(n)&&n.catch(i=>{Qa(i,t,e)}),n}if(lt(r)){const n=[];for(let i=0;i<r.length;i++)n.push(qs(r[i],t,e,s));return n}}function Qa(r,t,e,s=!0){const n=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=t&&t.appContext.config||Et;if(t){let a=t.parent;const l=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${e}`;for(;a;){const h=a.ec;if(h){for(let u=0;u<h.length;u++)if(h[u](r,l,c)===!1)return}a=a.parent}if(i){zn(),mo(i,null,10,[r,l,c]),Xn();return}}pv(r,e,n,s,o)}function pv(r,t,e,s=!0,n=!1){if(n)throw r;console.error(r)}const Se=[];let Ds=-1;const Hr=[];let Cn=null,Ar=0;const Bd=Promise.resolve();let ua=null;function pr(r){const t=ua||Bd;return r?t.then(this?r.bind(this):r):t}function mv(r){let t=Ds+1,e=Se.length;for(;t<e;){const s=t+e>>>1,n=Se[s],i=Ji(n);i<r||i===r&&n.flags&2?t=s+1:e=s}return t}function ph(r){if(!(r.flags&1)){const t=Ji(r),e=Se[Se.length-1];!e||!(r.flags&2)&&t>=Ji(e)?Se.push(r):Se.splice(mv(t),0,r),r.flags|=1,Nd()}}function Nd(){ua||(ua=Bd.then(zd))}function Hd(r){lt(r)?Hr.push(...r):Cn&&r.id===-1?Cn.splice(Ar+1,0,r):r.flags&1||(Hr.push(r),r.flags|=1),Nd()}function gu(r,t,e=Ds+1){for(;e<Se.length;e++){const s=Se[e];if(s&&s.flags&2){if(r&&s.id!==r.uid)continue;Se.splice(e,1),e--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function Yd(r){if(Hr.length){const t=[...new Set(Hr)].sort((e,s)=>Ji(e)-Ji(s));if(Hr.length=0,Cn){Cn.push(...t);return}for(Cn=t,Ar=0;Ar<Cn.length;Ar++){const e=Cn[Ar];e.flags&4&&(e.flags&=-2),e.flags&8||e(),e.flags&=-2}Cn=null,Ar=0}}const Ji=r=>r.id==null?r.flags&2?-1:1/0:r.id;function zd(r){try{for(Ds=0;Ds<Se.length;Ds++){const t=Se[Ds];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),mo(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Ds<Se.length;Ds++){const t=Se[Ds];t&&(t.flags&=-2)}Ds=-1,Se.length=0,Yd(),ua=null,(Se.length||Hr.length)&&zd()}}let Fe=null,Xd=null;function fa(r){const t=Fe;return Fe=r,Xd=r&&r.type.__scopeId||null,t}function mh(r,t=Fe,e){if(!t||r._n)return r;const s=(...n)=>{s._d&&Su(-1);const i=fa(t);let o;try{o=r(...n)}finally{fa(i),s._d&&Su(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function mr(r,t){if(Fe===null)return r;const e=nl(Fe),s=r.dirs||(r.dirs=[]);for(let n=0;n<t.length;n++){let[i,o,a,l=Et]=t[n];i&&(dt(i)&&(i={mounted:i,updated:i}),i.deep&&an(o),s.push({dir:i,instance:e,value:o,oldValue:void 0,arg:a,modifiers:l}))}return r}function $n(r,t,e,s){const n=r.dirs,i=t&&t.dirs;for(let o=0;o<n.length;o++){const a=n[o];i&&(a.oldValue=i[o].value);let l=a.dir[s];l&&(zn(),qs(l,e,8,[r.el,a,r,t]),Xn())}}const vv=Symbol("_vte"),_v=r=>r.__isTeleport;function vh(r,t){r.shapeFlag&6&&r.component?(r.transition=t,vh(r.component.subTree,t)):r.shapeFlag&128?(r.ssContent.transition=t.clone(r.ssContent),r.ssFallback.transition=t.clone(r.ssFallback)):r.transition=t}/*! #__NO_SIDE_EFFECTS__ */function Ye(r,t){return dt(r)?ye({name:r.name},t,{setup:r}):r}function Vd(r){r.ids=[r.ids[0]+r.ids[2]+++"-",0,0]}function da(r,t,e,s,n=!1){if(lt(r)){r.forEach((p,g)=>da(p,t&&(lt(t)?t[g]:t),e,s,n));return}if(Di(s)&&!n){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&da(r,t,e,s.component.subTree);return}const i=s.shapeFlag&4?nl(s.component):s.el,o=n?null:i,{i:a,r:l}=r,c=t&&t.r,h=a.refs===Et?a.refs={}:a.refs,u=a.setupState,f=Ct(u),d=u===Et?()=>!1:p=>wt(f,p);if(c!=null&&c!==l&&(qt(c)?(h[c]=null,d(c)&&(u[c]=null)):ve(c)&&(c.value=null)),dt(l))mo(l,a,12,[o,h]);else{const p=qt(l),g=ve(l);if(p||g){const m=()=>{if(r.f){const v=p?d(l)?u[l]:h[l]:l.value;n?lt(v)&&ih(v,i):lt(v)?v.includes(i)||v.push(i):p?(h[l]=[i],d(l)&&(u[l]=h[l])):(l.value=[i],r.k&&(h[r.k]=l.value))}else p?(h[l]=o,d(l)&&(u[l]=o)):g&&(l.value=o,r.k&&(h[r.k]=o))};o?(m.id=-1,We(m,e)):m()}}}qa().requestIdleCallback;qa().cancelIdleCallback;const Di=r=>!!r.type.__asyncLoader,Wd=r=>r.type.__isKeepAlive;function yv(r,t){Ud(r,"a",t)}function bv(r,t){Ud(r,"da",t)}function Ud(r,t,e=oe){const s=r.__wdc||(r.__wdc=()=>{let n=e;for(;n;){if(n.isDeactivated)return;n=n.parent}return r()});if(tl(t,s,e),e){let n=e.parent;for(;n&&n.parent;)Wd(n.parent.vnode)&&xv(s,t,e,n),n=n.parent}}function xv(r,t,e,s){const n=tl(t,r,s,!0);mn(()=>{ih(s[t],n)},e)}function tl(r,t,e=oe,s=!1){if(e){const n=e[r]||(e[r]=[]),i=t.__weh||(t.__weh=(...o)=>{zn();const a=vo(e),l=qs(t,e,r,o);return a(),Xn(),l});return s?n.unshift(i):n.push(i),i}}const pn=r=>(t,e=oe)=>{(!Zi||r==="sp")&&tl(r,(...s)=>t(...s),e)},Cv=pn("bm"),es=pn("m"),Gd=pn("bu"),wv=pn("u"),Sv=pn("bum"),mn=pn("um"),Tv=pn("sp"),Ov=pn("rtg"),kv=pn("rtc");function Mv(r,t=oe){tl("ec",r,t)}const $d="components";function qd(r,t){return Zd($d,r,!0,t)||r}const Kd=Symbol.for("v-ndc");function Jd(r){return qt(r)?Zd($d,r,!1)||r:r||Kd}function Zd(r,t,e=!0,s=!1){const n=Fe||oe;if(n){const i=n.type;{const a=p_(i,!1);if(a&&(a===t||a===ps(t)||a===$a(ps(t))))return i}const o=pu(n[r]||i[r],t)||pu(n.appContext[r],t);return!o&&s?i:o}}function pu(r,t){return r&&(r[t]||r[ps(t)]||r[$a(ps(t))])}function Qe(r,t,e,s){let n;const i=e&&e[s],o=lt(r);if(o||qt(r)){const a=o&&Nr(r);let l=!1;a&&(l=!fs(r),r=Ja(r)),n=new Array(r.length);for(let c=0,h=r.length;c<h;c++)n[c]=t(l?de(r[c]):r[c],c,void 0,i&&i[c])}else if(typeof r=="number"){n=new Array(r);for(let a=0;a<r;a++)n[a]=t(a+1,a,void 0,i&&i[a])}else if(Dt(r))if(r[Symbol.iterator])n=Array.from(r,(a,l)=>t(a,l,void 0,i&&i[l]));else{const a=Object.keys(r);n=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const h=a[l];n[l]=t(r[h],h,l,i&&i[l])}}else n=[];return e&&(e[s]=n),n}const dc=r=>r?yg(r)?nl(r):dc(r.parent):null,Ri=ye(Object.create(null),{$:r=>r,$el:r=>r.vnode.el,$data:r=>r.data,$props:r=>r.props,$attrs:r=>r.attrs,$slots:r=>r.slots,$refs:r=>r.refs,$parent:r=>dc(r.parent),$root:r=>dc(r.root),$host:r=>r.ce,$emit:r=>r.emit,$options:r=>tg(r),$forceUpdate:r=>r.f||(r.f=()=>{ph(r.update)}),$nextTick:r=>r.n||(r.n=pr.bind(r.proxy)),$watch:r=>qv.bind(r)}),El=(r,t)=>r!==Et&&!r.__isScriptSetup&&wt(r,t),Ev={get({_:r},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:s,data:n,props:i,accessCache:o,type:a,appContext:l}=r;let c;if(t[0]!=="$"){const d=o[t];if(d!==void 0)switch(d){case 1:return s[t];case 2:return n[t];case 4:return e[t];case 3:return i[t]}else{if(El(s,t))return o[t]=1,s[t];if(n!==Et&&wt(n,t))return o[t]=2,n[t];if((c=r.propsOptions[0])&&wt(c,t))return o[t]=3,i[t];if(e!==Et&&wt(e,t))return o[t]=4,e[t];gc&&(o[t]=0)}}const h=Ri[t];let u,f;if(h)return t==="$attrs"&&fe(r.attrs,"get",""),h(r);if((u=a.__cssModules)&&(u=u[t]))return u;if(e!==Et&&wt(e,t))return o[t]=4,e[t];if(f=l.config.globalProperties,wt(f,t))return f[t]},set({_:r},t,e){const{data:s,setupState:n,ctx:i}=r;return El(n,t)?(n[t]=e,!0):s!==Et&&wt(s,t)?(s[t]=e,!0):wt(r.props,t)||t[0]==="$"&&t.slice(1)in r?!1:(i[t]=e,!0)},has({_:{data:r,setupState:t,accessCache:e,ctx:s,appContext:n,propsOptions:i}},o){let a;return!!e[o]||r!==Et&&wt(r,o)||El(t,o)||(a=i[0])&&wt(a,o)||wt(s,o)||wt(Ri,o)||wt(n.config.globalProperties,o)},defineProperty(r,t,e){return e.get!=null?r._.accessCache[t]=0:wt(e,"value")&&this.set(r,t,e.value,null),Reflect.defineProperty(r,t,e)}};function mu(r){return lt(r)?r.reduce((t,e)=>(t[e]=null,t),{}):r}let gc=!0;function Av(r){const t=tg(r),e=r.proxy,s=r.ctx;gc=!1,t.beforeCreate&&vu(t.beforeCreate,r,"bc");const{data:n,computed:i,methods:o,watch:a,provide:l,inject:c,created:h,beforeMount:u,mounted:f,beforeUpdate:d,updated:p,activated:g,deactivated:m,beforeDestroy:v,beforeUnmount:_,destroyed:y,unmounted:b,render:w,renderTracked:A,renderTriggered:O,errorCaptured:E,serverPrefetch:D,expose:Y,inheritAttrs:K,components:st,directives:G,filters:rt}=t;if(c&&Pv(c,s,null),o)for(const J in o){const V=o[J];dt(V)&&(s[J]=V.bind(e))}if(n){const J=n.call(e,e);Dt(J)&&(r.data=Za(J))}if(gc=!0,i)for(const J in i){const V=i[J],pt=dt(V)?V.bind(e,e):dt(V.get)?V.get.bind(e,e):xs,Tt=!dt(V)&&dt(V.set)?V.set.bind(e):xs,At=te({get:pt,set:Tt});Object.defineProperty(s,J,{enumerable:!0,configurable:!0,get:()=>At.value,set:B=>At.value=B})}if(a)for(const J in a)Qd(a[J],s,e,J);if(l){const J=dt(l)?l.call(e):l;Reflect.ownKeys(J).forEach(V=>{Qo(V,J[V])})}h&&vu(h,r,"c");function et(J,V){lt(V)?V.forEach(pt=>J(pt.bind(e))):V&&J(V.bind(e))}if(et(Cv,u),et(es,f),et(Gd,d),et(wv,p),et(yv,g),et(bv,m),et(Mv,E),et(kv,A),et(Ov,O),et(Sv,_),et(mn,b),et(Tv,D),lt(Y))if(Y.length){const J=r.exposed||(r.exposed={});Y.forEach(V=>{Object.defineProperty(J,V,{get:()=>e[V],set:pt=>e[V]=pt})})}else r.exposed||(r.exposed={});w&&r.render===xs&&(r.render=w),K!=null&&(r.inheritAttrs=K),st&&(r.components=st),G&&(r.directives=G),D&&Vd(r)}function Pv(r,t,e=xs){lt(r)&&(r=pc(r));for(const s in r){const n=r[s];let i;Dt(n)?"default"in n?i=Xs(n.from||s,n.default,!0):i=Xs(n.from||s):i=Xs(n),ve(i)?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):t[s]=i}}function vu(r,t,e){qs(lt(r)?r.map(s=>s.bind(t.proxy)):r.bind(t.proxy),t,e)}function Qd(r,t,e,s){let n=s.includes(".")?gg(e,s):()=>e[s];if(qt(r)){const i=t[r];dt(i)&&ds(n,i)}else if(dt(r))ds(n,r.bind(e));else if(Dt(r))if(lt(r))r.forEach(i=>Qd(i,t,e,s));else{const i=dt(r.handler)?r.handler.bind(e):t[r.handler];dt(i)&&ds(n,i,r)}}function tg(r){const t=r.type,{mixins:e,extends:s}=t,{mixins:n,optionsCache:i,config:{optionMergeStrategies:o}}=r.appContext,a=i.get(t);let l;return a?l=a:!n.length&&!e&&!s?l=t:(l={},n.length&&n.forEach(c=>ga(l,c,o,!0)),ga(l,t,o)),Dt(t)&&i.set(t,l),l}function ga(r,t,e,s=!1){const{mixins:n,extends:i}=t;i&&ga(r,i,e,!0),n&&n.forEach(o=>ga(r,o,e,!0));for(const o in t)if(!(s&&o==="expose")){const a=Fv[o]||e&&e[o];r[o]=a?a(r[o],t[o]):t[o]}return r}const Fv={data:_u,props:yu,emits:yu,methods:Si,computed:Si,beforeCreate:be,created:be,beforeMount:be,mounted:be,beforeUpdate:be,updated:be,beforeDestroy:be,beforeUnmount:be,destroyed:be,unmounted:be,activated:be,deactivated:be,errorCaptured:be,serverPrefetch:be,components:Si,directives:Si,watch:Rv,provide:_u,inject:Dv};function _u(r,t){return t?r?function(){return ye(dt(r)?r.call(this,this):r,dt(t)?t.call(this,this):t)}:t:r}function Dv(r,t){return Si(pc(r),pc(t))}function pc(r){if(lt(r)){const t={};for(let e=0;e<r.length;e++)t[r[e]]=r[e];return t}return r}function be(r,t){return r?[...new Set([].concat(r,t))]:t}function Si(r,t){return r?ye(Object.create(null),r,t):t}function yu(r,t){return r?lt(r)&&lt(t)?[...new Set([...r,...t])]:ye(Object.create(null),mu(r),mu(t??{})):t}function Rv(r,t){if(!r)return t;if(!t)return r;const e=ye(Object.create(null),r);for(const s in t)e[s]=be(r[s],t[s]);return e}function eg(){return{app:null,config:{isNativeTag:A0,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Lv=0;function jv(r,t){return function(s,n=null){dt(s)||(s=ye({},s)),n!=null&&!Dt(n)&&(n=null);const i=eg(),o=new WeakSet,a=[];let l=!1;const c=i.app={_uid:Lv++,_component:s,_props:n,_container:null,_context:i,_instance:null,version:__,get config(){return i.config},set config(h){},use(h,...u){return o.has(h)||(h&&dt(h.install)?(o.add(h),h.install(c,...u)):dt(h)&&(o.add(h),h(c,...u))),c},mixin(h){return i.mixins.includes(h)||i.mixins.push(h),c},component(h,u){return u?(i.components[h]=u,c):i.components[h]},directive(h,u){return u?(i.directives[h]=u,c):i.directives[h]},mount(h,u,f){if(!l){const d=c._ceVNode||ae(s,n);return d.appContext=i,f===!0?f="svg":f===!1&&(f=void 0),r(d,h,f),l=!0,c._container=h,h.__vue_app__=c,nl(d.component)}},onUnmount(h){a.push(h)},unmount(){l&&(qs(a,c._instance,16),r(null,c._container),delete c._container.__vue_app__)},provide(h,u){return i.provides[h]=u,c},runWithContext(h){const u=Yr;Yr=c;try{return h()}finally{Yr=u}}};return c}}let Yr=null;function Qo(r,t){if(oe){let e=oe.provides;const s=oe.parent&&oe.parent.provides;s===e&&(e=oe.provides=Object.create(s)),e[r]=t}}function Xs(r,t,e=!1){const s=oe||Fe;if(s||Yr){const n=Yr?Yr._context.provides:s?s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(n&&r in n)return n[r];if(arguments.length>1)return e&&dt(t)?t.call(s&&s.proxy):t}}const sg={},ng=()=>Object.create(sg),rg=r=>Object.getPrototypeOf(r)===sg;function Iv(r,t,e,s=!1){const n={},i=ng();r.propsDefaults=Object.create(null),ig(r,t,n,i);for(const o in r.propsOptions[0])o in n||(n[o]=void 0);e?r.props=s?n:Dd(n):r.type.props?r.props=n:r.props=i,r.attrs=i}function Bv(r,t,e,s){const{props:n,attrs:i,vnode:{patchFlag:o}}=r,a=Ct(n),[l]=r.propsOptions;let c=!1;if((s||o>0)&&!(o&16)){if(o&8){const h=r.vnode.dynamicProps;for(let u=0;u<h.length;u++){let f=h[u];if(el(r.emitsOptions,f))continue;const d=t[f];if(l)if(wt(i,f))d!==i[f]&&(i[f]=d,c=!0);else{const p=ps(f);n[p]=mc(l,a,p,d,r,!1)}else d!==i[f]&&(i[f]=d,c=!0)}}}else{ig(r,t,n,i)&&(c=!0);let h;for(const u in a)(!t||!wt(t,u)&&((h=xr(u))===u||!wt(t,h)))&&(l?e&&(e[u]!==void 0||e[h]!==void 0)&&(n[u]=mc(l,a,u,void 0,r,!0)):delete n[u]);if(i!==a)for(const u in i)(!t||!wt(t,u))&&(delete i[u],c=!0)}c&&on(r.attrs,"set","")}function ig(r,t,e,s){const[n,i]=r.propsOptions;let o=!1,a;if(t)for(let l in t){if(Ai(l))continue;const c=t[l];let h;n&&wt(n,h=ps(l))?!i||!i.includes(h)?e[h]=c:(a||(a={}))[h]=c:el(r.emitsOptions,l)||(!(l in s)||c!==s[l])&&(s[l]=c,o=!0)}if(i){const l=Ct(e),c=a||Et;for(let h=0;h<i.length;h++){const u=i[h];e[u]=mc(n,l,u,c[u],r,!wt(c,u))}}return o}function mc(r,t,e,s,n,i){const o=r[e];if(o!=null){const a=wt(o,"default");if(a&&s===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&dt(l)){const{propsDefaults:c}=n;if(e in c)s=c[e];else{const h=vo(n);s=c[e]=l.call(null,t),h()}}else s=l;n.ce&&n.ce._setProp(e,s)}o[0]&&(i&&!a?s=!1:o[1]&&(s===""||s===xr(e))&&(s=!0))}return s}const Nv=new WeakMap;function og(r,t,e=!1){const s=e?Nv:t.propsCache,n=s.get(r);if(n)return n;const i=r.props,o={},a=[];let l=!1;if(!dt(r)){const h=u=>{l=!0;const[f,d]=og(u,t,!0);ye(o,f),d&&a.push(...d)};!e&&t.mixins.length&&t.mixins.forEach(h),r.extends&&h(r.extends),r.mixins&&r.mixins.forEach(h)}if(!i&&!l)return Dt(r)&&s.set(r,Ir),Ir;if(lt(i))for(let h=0;h<i.length;h++){const u=ps(i[h]);bu(u)&&(o[u]=Et)}else if(i)for(const h in i){const u=ps(h);if(bu(u)){const f=i[h],d=o[u]=lt(f)||dt(f)?{type:f}:ye({},f),p=d.type;let g=!1,m=!0;if(lt(p))for(let v=0;v<p.length;++v){const _=p[v],y=dt(_)&&_.name;if(y==="Boolean"){g=!0;break}else y==="String"&&(m=!1)}else g=dt(p)&&p.name==="Boolean";d[0]=g,d[1]=m,(g||wt(d,"default"))&&a.push(u)}}const c=[o,a];return Dt(r)&&s.set(r,c),c}function bu(r){return r[0]!=="$"&&!Ai(r)}const ag=r=>r[0]==="_"||r==="$stable",_h=r=>lt(r)?r.map(Ls):[Ls(r)],Hv=(r,t,e)=>{if(t._n)return t;const s=mh((...n)=>_h(t(...n)),e);return s._c=!1,s},lg=(r,t,e)=>{const s=r._ctx;for(const n in r){if(ag(n))continue;const i=r[n];if(dt(i))t[n]=Hv(n,i,s);else if(i!=null){const o=_h(i);t[n]=()=>o}}},cg=(r,t)=>{const e=_h(t);r.slots.default=()=>e},hg=(r,t,e)=>{for(const s in t)(e||s!=="_")&&(r[s]=t[s])},Yv=(r,t,e)=>{const s=r.slots=ng();if(r.vnode.shapeFlag&32){const n=t._;n?(hg(s,t,e),e&&pd(s,"_",n,!0)):lg(t,s)}else t&&cg(r,t)},zv=(r,t,e)=>{const{vnode:s,slots:n}=r;let i=!0,o=Et;if(s.shapeFlag&32){const a=t._;a?e&&a===1?i=!1:hg(n,t,e):(i=!t.$stable,lg(t,n)),o=t}else t&&(cg(r,t),o={default:1});if(i)for(const a in n)!ag(a)&&o[a]==null&&delete n[a]},We=s_;function Xv(r){return Vv(r)}function Vv(r,t){const e=qa();e.__VUE__=!0;const{insert:s,remove:n,patchProp:i,createElement:o,createText:a,createComment:l,setText:c,setElementText:h,parentNode:u,nextSibling:f,setScopeId:d=xs,insertStaticContent:p}=r,g=(x,C,k,L=null,I=null,j=null,$=void 0,U=null,X=!!C.dynamicChildren)=>{if(x===C)return;x&&!yi(x,C)&&(L=R(x),B(x,I,j,!0),x=null),C.patchFlag===-2&&(X=!1,C.dynamicChildren=null);const{type:H,ref:at,shapeFlag:tt}=C;switch(H){case sl:m(x,C,k,L);break;case vr:v(x,C,k,L);break;case ta:x==null&&_(C,k,L,$);break;case Ht:st(x,C,k,L,I,j,$,U,X);break;default:tt&1?w(x,C,k,L,I,j,$,U,X):tt&6?G(x,C,k,L,I,j,$,U,X):(tt&64||tt&128)&&H.process(x,C,k,L,I,j,$,U,X,Q)}at!=null&&I&&da(at,x&&x.ref,j,C||x,!C)},m=(x,C,k,L)=>{if(x==null)s(C.el=a(C.children),k,L);else{const I=C.el=x.el;C.children!==x.children&&c(I,C.children)}},v=(x,C,k,L)=>{x==null?s(C.el=l(C.children||""),k,L):C.el=x.el},_=(x,C,k,L)=>{[x.el,x.anchor]=p(x.children,C,k,L,x.el,x.anchor)},y=({el:x,anchor:C},k,L)=>{let I;for(;x&&x!==C;)I=f(x),s(x,k,L),x=I;s(C,k,L)},b=({el:x,anchor:C})=>{let k;for(;x&&x!==C;)k=f(x),n(x),x=k;n(C)},w=(x,C,k,L,I,j,$,U,X)=>{C.type==="svg"?$="svg":C.type==="math"&&($="mathml"),x==null?A(C,k,L,I,j,$,U,X):D(x,C,I,j,$,U,X)},A=(x,C,k,L,I,j,$,U)=>{let X,H;const{props:at,shapeFlag:tt,transition:it,dirs:ht}=x;if(X=x.el=o(x.type,j,at&&at.is,at),tt&8?h(X,x.children):tt&16&&E(x.children,X,null,L,I,Al(x,j),$,U),ht&&$n(x,null,L,"created"),O(X,x,x.scopeId,$,L),at){for(const Pt in at)Pt!=="value"&&!Ai(Pt)&&i(X,Pt,null,at[Pt],j,L);"value"in at&&i(X,"value",null,at.value,j),(H=at.onVnodeBeforeMount)&&Fs(H,L,x)}ht&&$n(x,null,L,"beforeMount");const vt=Wv(I,it);vt&&it.beforeEnter(X),s(X,C,k),((H=at&&at.onVnodeMounted)||vt||ht)&&We(()=>{H&&Fs(H,L,x),vt&&it.enter(X),ht&&$n(x,null,L,"mounted")},I)},O=(x,C,k,L,I)=>{if(k&&d(x,k),L)for(let j=0;j<L.length;j++)d(x,L[j]);if(I){let j=I.subTree;if(C===j||mg(j.type)&&(j.ssContent===C||j.ssFallback===C)){const $=I.vnode;O(x,$,$.scopeId,$.slotScopeIds,I.parent)}}},E=(x,C,k,L,I,j,$,U,X=0)=>{for(let H=X;H<x.length;H++){const at=x[H]=U?wn(x[H]):Ls(x[H]);g(null,at,C,k,L,I,j,$,U)}},D=(x,C,k,L,I,j,$)=>{const U=C.el=x.el;let{patchFlag:X,dynamicChildren:H,dirs:at}=C;X|=x.patchFlag&16;const tt=x.props||Et,it=C.props||Et;let ht;if(k&&qn(k,!1),(ht=it.onVnodeBeforeUpdate)&&Fs(ht,k,C,x),at&&$n(C,x,k,"beforeUpdate"),k&&qn(k,!0),(tt.innerHTML&&it.innerHTML==null||tt.textContent&&it.textContent==null)&&h(U,""),H?Y(x.dynamicChildren,H,U,k,L,Al(C,I),j):$||V(x,C,U,null,k,L,Al(C,I),j,!1),X>0){if(X&16)K(U,tt,it,k,I);else if(X&2&&tt.class!==it.class&&i(U,"class",null,it.class,I),X&4&&i(U,"style",tt.style,it.style,I),X&8){const vt=C.dynamicProps;for(let Pt=0;Pt<vt.length;Pt++){const Ot=vt[Pt],ze=tt[Ot],Pe=it[Ot];(Pe!==ze||Ot==="value")&&i(U,Ot,ze,Pe,I,k)}}X&1&&x.children!==C.children&&h(U,C.children)}else!$&&H==null&&K(U,tt,it,k,I);((ht=it.onVnodeUpdated)||at)&&We(()=>{ht&&Fs(ht,k,C,x),at&&$n(C,x,k,"updated")},L)},Y=(x,C,k,L,I,j,$)=>{for(let U=0;U<C.length;U++){const X=x[U],H=C[U],at=X.el&&(X.type===Ht||!yi(X,H)||X.shapeFlag&70)?u(X.el):k;g(X,H,at,null,L,I,j,$,!0)}},K=(x,C,k,L,I)=>{if(C!==k){if(C!==Et)for(const j in C)!Ai(j)&&!(j in k)&&i(x,j,C[j],null,I,L);for(const j in k){if(Ai(j))continue;const $=k[j],U=C[j];$!==U&&j!=="value"&&i(x,j,U,$,I,L)}"value"in k&&i(x,"value",C.value,k.value,I)}},st=(x,C,k,L,I,j,$,U,X)=>{const H=C.el=x?x.el:a(""),at=C.anchor=x?x.anchor:a("");let{patchFlag:tt,dynamicChildren:it,slotScopeIds:ht}=C;ht&&(U=U?U.concat(ht):ht),x==null?(s(H,k,L),s(at,k,L),E(C.children||[],k,at,I,j,$,U,X)):tt>0&&tt&64&&it&&x.dynamicChildren?(Y(x.dynamicChildren,it,k,I,j,$,U),(C.key!=null||I&&C===I.subTree)&&ug(x,C,!0)):V(x,C,k,at,I,j,$,U,X)},G=(x,C,k,L,I,j,$,U,X)=>{C.slotScopeIds=U,x==null?C.shapeFlag&512?I.ctx.activate(C,k,L,$,X):rt(C,k,L,I,j,$,X):ct(x,C,X)},rt=(x,C,k,L,I,j,$)=>{const U=x.component=c_(x,L,I);if(Wd(x)&&(U.ctx.renderer=Q),u_(U,!1,$),U.asyncDep){if(I&&I.registerDep(U,et,$),!x.el){const X=U.subTree=ae(vr);v(null,X,C,k)}}else et(U,x,C,k,I,j,$)},ct=(x,C,k)=>{const L=C.component=x.component;if(t_(x,C,k))if(L.asyncDep&&!L.asyncResolved){J(L,C,k);return}else L.next=C,L.update();else C.el=x.el,L.vnode=C},et=(x,C,k,L,I,j,$)=>{const U=()=>{if(x.isMounted){let{next:tt,bu:it,u:ht,parent:vt,vnode:Pt}=x;{const As=fg(x);if(As){tt&&(tt.el=Pt.el,J(x,tt,$)),As.asyncDep.then(()=>{x.isUnmounted||U()});return}}let Ot=tt,ze;qn(x,!1),tt?(tt.el=Pt.el,J(x,tt,$)):tt=Pt,it&&Zo(it),(ze=tt.props&&tt.props.onVnodeBeforeUpdate)&&Fs(ze,vt,tt,Pt),qn(x,!0);const Pe=Cu(x),Es=x.subTree;x.subTree=Pe,g(Es,Pe,u(Es.el),R(Es),x,I,j),tt.el=Pe.el,Ot===null&&e_(x,Pe.el),ht&&We(ht,I),(ze=tt.props&&tt.props.onVnodeUpdated)&&We(()=>Fs(ze,vt,tt,Pt),I)}else{let tt;const{el:it,props:ht}=C,{bm:vt,m:Pt,parent:Ot,root:ze,type:Pe}=x,Es=Di(C);qn(x,!1),vt&&Zo(vt),!Es&&(tt=ht&&ht.onVnodeBeforeMount)&&Fs(tt,Ot,C),qn(x,!0);{ze.ce&&ze.ce._injectChildStyle(Pe);const As=x.subTree=Cu(x);g(null,As,k,L,x,I,j),C.el=As.el}if(Pt&&We(Pt,I),!Es&&(tt=ht&&ht.onVnodeMounted)){const As=C;We(()=>Fs(tt,Ot,As),I)}(C.shapeFlag&256||Ot&&Di(Ot.vnode)&&Ot.vnode.shapeFlag&256)&&x.a&&We(x.a,I),x.isMounted=!0,C=k=L=null}};x.scope.on();const X=x.effect=new yd(U);x.scope.off();const H=x.update=X.run.bind(X),at=x.job=X.runIfDirty.bind(X);at.i=x,at.id=x.uid,X.scheduler=()=>ph(at),qn(x,!0),H()},J=(x,C,k)=>{C.component=x;const L=x.vnode.props;x.vnode=C,x.next=null,Bv(x,C.props,L,k),zv(x,C.children,k),zn(),gu(x),Xn()},V=(x,C,k,L,I,j,$,U,X=!1)=>{const H=x&&x.children,at=x?x.shapeFlag:0,tt=C.children,{patchFlag:it,shapeFlag:ht}=C;if(it>0){if(it&128){Tt(H,tt,k,L,I,j,$,U,X);return}else if(it&256){pt(H,tt,k,L,I,j,$,U,X);return}}ht&8?(at&16&&Rt(H,I,j),tt!==H&&h(k,tt)):at&16?ht&16?Tt(H,tt,k,L,I,j,$,U,X):Rt(H,I,j,!0):(at&8&&h(k,""),ht&16&&E(tt,k,L,I,j,$,U,X))},pt=(x,C,k,L,I,j,$,U,X)=>{x=x||Ir,C=C||Ir;const H=x.length,at=C.length,tt=Math.min(H,at);let it;for(it=0;it<tt;it++){const ht=C[it]=X?wn(C[it]):Ls(C[it]);g(x[it],ht,k,null,I,j,$,U,X)}H>at?Rt(x,I,j,!0,!1,tt):E(C,k,L,I,j,$,U,X,tt)},Tt=(x,C,k,L,I,j,$,U,X)=>{let H=0;const at=C.length;let tt=x.length-1,it=at-1;for(;H<=tt&&H<=it;){const ht=x[H],vt=C[H]=X?wn(C[H]):Ls(C[H]);if(yi(ht,vt))g(ht,vt,k,null,I,j,$,U,X);else break;H++}for(;H<=tt&&H<=it;){const ht=x[tt],vt=C[it]=X?wn(C[it]):Ls(C[it]);if(yi(ht,vt))g(ht,vt,k,null,I,j,$,U,X);else break;tt--,it--}if(H>tt){if(H<=it){const ht=it+1,vt=ht<at?C[ht].el:L;for(;H<=it;)g(null,C[H]=X?wn(C[H]):Ls(C[H]),k,vt,I,j,$,U,X),H++}}else if(H>it)for(;H<=tt;)B(x[H],I,j,!0),H++;else{const ht=H,vt=H,Pt=new Map;for(H=vt;H<=it;H++){const Xe=C[H]=X?wn(C[H]):Ls(C[H]);Xe.key!=null&&Pt.set(Xe.key,H)}let Ot,ze=0;const Pe=it-vt+1;let Es=!1,As=0;const vi=new Array(Pe);for(H=0;H<Pe;H++)vi[H]=0;for(H=ht;H<=tt;H++){const Xe=x[H];if(ze>=Pe){B(Xe,I,j,!0);continue}let Ps;if(Xe.key!=null)Ps=Pt.get(Xe.key);else for(Ot=vt;Ot<=it;Ot++)if(vi[Ot-vt]===0&&yi(Xe,C[Ot])){Ps=Ot;break}Ps===void 0?B(Xe,I,j,!0):(vi[Ps-vt]=H+1,Ps>=As?As=Ps:Es=!0,g(Xe,C[Ps],k,null,I,j,$,U,X),ze++)}const lu=Es?Uv(vi):Ir;for(Ot=lu.length-1,H=Pe-1;H>=0;H--){const Xe=vt+H,Ps=C[Xe],cu=Xe+1<at?C[Xe+1].el:L;vi[H]===0?g(null,Ps,k,cu,I,j,$,U,X):Es&&(Ot<0||H!==lu[Ot]?At(Ps,k,cu,2):Ot--)}}},At=(x,C,k,L,I=null)=>{const{el:j,type:$,transition:U,children:X,shapeFlag:H}=x;if(H&6){At(x.component.subTree,C,k,L);return}if(H&128){x.suspense.move(C,k,L);return}if(H&64){$.move(x,C,k,Q);return}if($===Ht){s(j,C,k);for(let tt=0;tt<X.length;tt++)At(X[tt],C,k,L);s(x.anchor,C,k);return}if($===ta){y(x,C,k);return}if(L!==2&&H&1&&U)if(L===0)U.beforeEnter(j),s(j,C,k),We(()=>U.enter(j),I);else{const{leave:tt,delayLeave:it,afterLeave:ht}=U,vt=()=>s(j,C,k),Pt=()=>{tt(j,()=>{vt(),ht&&ht()})};it?it(j,vt,Pt):Pt()}else s(j,C,k)},B=(x,C,k,L=!1,I=!1)=>{const{type:j,props:$,ref:U,children:X,dynamicChildren:H,shapeFlag:at,patchFlag:tt,dirs:it,cacheIndex:ht}=x;if(tt===-2&&(I=!1),U!=null&&da(U,null,k,x,!0),ht!=null&&(C.renderCache[ht]=void 0),at&256){C.ctx.deactivate(x);return}const vt=at&1&&it,Pt=!Di(x);let Ot;if(Pt&&(Ot=$&&$.onVnodeBeforeUnmount)&&Fs(Ot,C,x),at&6)Xt(x.component,k,L);else{if(at&128){x.suspense.unmount(k,L);return}vt&&$n(x,null,C,"beforeUnmount"),at&64?x.type.remove(x,C,k,Q,L):H&&!H.hasOnce&&(j!==Ht||tt>0&&tt&64)?Rt(H,C,k,!1,!0):(j===Ht&&tt&384||!I&&at&16)&&Rt(X,C,k),L&&N(x)}(Pt&&(Ot=$&&$.onVnodeUnmounted)||vt)&&We(()=>{Ot&&Fs(Ot,C,x),vt&&$n(x,null,C,"unmounted")},k)},N=x=>{const{type:C,el:k,anchor:L,transition:I}=x;if(C===Ht){W(k,L);return}if(C===ta){b(x);return}const j=()=>{n(k),I&&!I.persisted&&I.afterLeave&&I.afterLeave()};if(x.shapeFlag&1&&I&&!I.persisted){const{leave:$,delayLeave:U}=I,X=()=>$(k,j);U?U(x.el,j,X):X()}else j()},W=(x,C)=>{let k;for(;x!==C;)k=f(x),n(x),x=k;n(C)},Xt=(x,C,k)=>{const{bum:L,scope:I,job:j,subTree:$,um:U,m:X,a:H}=x;xu(X),xu(H),L&&Zo(L),I.stop(),j&&(j.flags|=8,B($,x,C,k)),U&&We(U,C),We(()=>{x.isUnmounted=!0},C),C&&C.pendingBranch&&!C.isUnmounted&&x.asyncDep&&!x.asyncResolved&&x.suspenseId===C.pendingId&&(C.deps--,C.deps===0&&C.resolve())},Rt=(x,C,k,L=!1,I=!1,j=0)=>{for(let $=j;$<x.length;$++)B(x[$],C,k,L,I)},R=x=>{if(x.shapeFlag&6)return R(x.component.subTree);if(x.shapeFlag&128)return x.suspense.next();const C=f(x.anchor||x.el),k=C&&C[vv];return k?f(k):C};let Z=!1;const z=(x,C,k)=>{x==null?C._vnode&&B(C._vnode,null,null,!0):g(C._vnode||null,x,C,null,null,null,k),C._vnode=x,Z||(Z=!0,gu(),Yd(),Z=!1)},Q={p:g,um:B,m:At,r:N,mt:rt,mc:E,pc:V,pbc:Y,n:R,o:r};return{render:z,hydrate:void 0,createApp:jv(z)}}function Al({type:r,props:t},e){return e==="svg"&&r==="foreignObject"||e==="mathml"&&r==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function qn({effect:r,job:t},e){e?(r.flags|=32,t.flags|=4):(r.flags&=-33,t.flags&=-5)}function Wv(r,t){return(!r||r&&!r.pendingBranch)&&t&&!t.persisted}function ug(r,t,e=!1){const s=r.children,n=t.children;if(lt(s)&&lt(n))for(let i=0;i<s.length;i++){const o=s[i];let a=n[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=n[i]=wn(n[i]),a.el=o.el),!e&&a.patchFlag!==-2&&ug(o,a)),a.type===sl&&(a.el=o.el)}}function Uv(r){const t=r.slice(),e=[0];let s,n,i,o,a;const l=r.length;for(s=0;s<l;s++){const c=r[s];if(c!==0){if(n=e[e.length-1],r[n]<c){t[s]=n,e.push(s);continue}for(i=0,o=e.length-1;i<o;)a=i+o>>1,r[e[a]]<c?i=a+1:o=a;c<r[e[i]]&&(i>0&&(t[s]=e[i-1]),e[i]=s)}}for(i=e.length,o=e[i-1];i-- >0;)e[i]=o,o=t[o];return e}function fg(r){const t=r.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:fg(t)}function xu(r){if(r)for(let t=0;t<r.length;t++)r[t].flags|=8}const Gv=Symbol.for("v-scx"),$v=()=>Xs(Gv);function ds(r,t,e){return dg(r,t,e)}function dg(r,t,e=Et){const{immediate:s,deep:n,flush:i,once:o}=e,a=ye({},e),l=t&&s||!t&&i!=="post";let c;if(Zi){if(i==="sync"){const d=$v();c=d.__watcherHandles||(d.__watcherHandles=[])}else if(!l){const d=()=>{};return d.stop=xs,d.resume=xs,d.pause=xs,d}}const h=oe;a.call=(d,p,g)=>qs(d,h,p,g);let u=!1;i==="post"?a.scheduler=d=>{We(d,h&&h.suspense)}:i!=="sync"&&(u=!0,a.scheduler=(d,p)=>{p?d():ph(d)}),a.augmentJob=d=>{t&&(d.flags|=4),u&&(d.flags|=2,h&&(d.id=h.uid,d.i=h))};const f=gv(r,t,a);return Zi&&(c?c.push(f):l&&f()),f}function qv(r,t,e){const s=this.proxy,n=qt(r)?r.includes(".")?gg(s,r):()=>s[r]:r.bind(s,s);let i;dt(t)?i=t:(i=t.handler,e=t);const o=vo(this),a=dg(n,i.bind(s),e);return o(),a}function gg(r,t){const e=t.split(".");return()=>{let s=r;for(let n=0;n<e.length&&s;n++)s=s[e[n]];return s}}const Kv=(r,t)=>t==="modelValue"||t==="model-value"?r.modelModifiers:r[`${t}Modifiers`]||r[`${ps(t)}Modifiers`]||r[`${xr(t)}Modifiers`];function Jv(r,t,...e){if(r.isUnmounted)return;const s=r.vnode.props||Et;let n=e;const i=t.startsWith("update:"),o=i&&Kv(s,t.slice(7));o&&(o.trim&&(n=e.map(h=>qt(h)?h.trim():h)),o.number&&(n=e.map(ca)));let a,l=s[a=Sl(t)]||s[a=Sl(ps(t))];!l&&i&&(l=s[a=Sl(xr(t))]),l&&qs(l,r,6,n);const c=s[a+"Once"];if(c){if(!r.emitted)r.emitted={};else if(r.emitted[a])return;r.emitted[a]=!0,qs(c,r,6,n)}}function pg(r,t,e=!1){const s=t.emitsCache,n=s.get(r);if(n!==void 0)return n;const i=r.emits;let o={},a=!1;if(!dt(r)){const l=c=>{const h=pg(c,t,!0);h&&(a=!0,ye(o,h))};!e&&t.mixins.length&&t.mixins.forEach(l),r.extends&&l(r.extends),r.mixins&&r.mixins.forEach(l)}return!i&&!a?(Dt(r)&&s.set(r,null),null):(lt(i)?i.forEach(l=>o[l]=null):ye(o,i),Dt(r)&&s.set(r,o),o)}function el(r,t){return!r||!Wa(t)?!1:(t=t.slice(2).replace(/Once$/,""),wt(r,t[0].toLowerCase()+t.slice(1))||wt(r,xr(t))||wt(r,t))}function Cu(r){const{type:t,vnode:e,proxy:s,withProxy:n,propsOptions:[i],slots:o,attrs:a,emit:l,render:c,renderCache:h,props:u,data:f,setupState:d,ctx:p,inheritAttrs:g}=r,m=fa(r);let v,_;try{if(e.shapeFlag&4){const b=n||s,w=b;v=Ls(c.call(w,b,h,u,d,f,p)),_=a}else{const b=t;v=Ls(b.length>1?b(u,{attrs:a,slots:o,emit:l}):b(u,null)),_=t.props?a:Zv(a)}}catch(b){Li.length=0,Qa(b,r,1),v=ae(vr)}let y=v;if(_&&g!==!1){const b=Object.keys(_),{shapeFlag:w}=y;b.length&&w&7&&(i&&b.some(rh)&&(_=Qv(_,i)),y=Jr(y,_,!1,!0))}return e.dirs&&(y=Jr(y,null,!1,!0),y.dirs=y.dirs?y.dirs.concat(e.dirs):e.dirs),e.transition&&vh(y,e.transition),v=y,fa(m),v}const Zv=r=>{let t;for(const e in r)(e==="class"||e==="style"||Wa(e))&&((t||(t={}))[e]=r[e]);return t},Qv=(r,t)=>{const e={};for(const s in r)(!rh(s)||!(s.slice(9)in t))&&(e[s]=r[s]);return e};function t_(r,t,e){const{props:s,children:n,component:i}=r,{props:o,children:a,patchFlag:l}=t,c=i.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&l>=0){if(l&1024)return!0;if(l&16)return s?wu(s,o,c):!!o;if(l&8){const h=t.dynamicProps;for(let u=0;u<h.length;u++){const f=h[u];if(o[f]!==s[f]&&!el(c,f))return!0}}}else return(n||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?wu(s,o,c):!0:!!o;return!1}function wu(r,t,e){const s=Object.keys(t);if(s.length!==Object.keys(r).length)return!0;for(let n=0;n<s.length;n++){const i=s[n];if(t[i]!==r[i]&&!el(e,i))return!0}return!1}function e_({vnode:r,parent:t},e){for(;t;){const s=t.subTree;if(s.suspense&&s.suspense.activeBranch===r&&(s.el=r.el),s===r)(r=t.vnode).el=e,t=t.parent;else break}}const mg=r=>r.__isSuspense;function s_(r,t){t&&t.pendingBranch?lt(r)?t.effects.push(...r):t.effects.push(r):Hd(r)}const Ht=Symbol.for("v-fgt"),sl=Symbol.for("v-txt"),vr=Symbol.for("v-cmt"),ta=Symbol.for("v-stc"),Li=[];let ke=null;function ot(r=!1){Li.push(ke=r?null:[])}function n_(){Li.pop(),ke=Li[Li.length-1]||null}let Kr=1;function Su(r,t=!1){Kr+=r,r<0&&ke&&t&&(ke.hasOnce=!0)}function vg(r){return r.dynamicChildren=Kr>0?ke||Ir:null,n_(),Kr>0&&ke&&ke.push(r),r}function ut(r,t,e,s,n,i){return vg(P(r,t,e,s,n,i,!0))}function hn(r,t,e,s,n){return vg(ae(r,t,e,s,n,!0))}function pa(r){return r?r.__v_isVNode===!0:!1}function yi(r,t){return r.type===t.type&&r.key===t.key}const _g=({key:r})=>r??null,ea=({ref:r,ref_key:t,ref_for:e})=>(typeof r=="number"&&(r=""+r),r!=null?qt(r)||ve(r)||dt(r)?{i:Fe,r,k:t,f:!!e}:r:null);function P(r,t=null,e=null,s=0,n=null,i=r===Ht?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:r,props:t,key:t&&_g(t),ref:t&&ea(t),scopeId:Xd,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:s,dynamicProps:n,dynamicChildren:null,appContext:null,ctx:Fe};return a?(yh(l,e),i&128&&r.normalize(l)):e&&(l.shapeFlag|=qt(e)?8:16),Kr>0&&!o&&ke&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&ke.push(l),l}const ae=r_;function r_(r,t=null,e=null,s=0,n=null,i=!1){if((!r||r===Kd)&&(r=vr),pa(r)){const a=Jr(r,t,!0);return e&&yh(a,e),Kr>0&&!i&&ke&&(a.shapeFlag&6?ke[ke.indexOf(r)]=a:ke.push(a)),a.patchFlag=-2,a}if(m_(r)&&(r=r.__vccOpts),t){t=i_(t);let{class:a,style:l}=t;a&&!qt(a)&&(t.class=$e(a)),Dt(l)&&(dh(l)&&!lt(l)&&(l=ye({},l)),t.style=hs(l))}const o=qt(r)?1:mg(r)?128:_v(r)?64:Dt(r)?4:dt(r)?2:0;return P(r,t,e,s,n,o,i,!0)}function i_(r){return r?dh(r)||rg(r)?ye({},r):r:null}function Jr(r,t,e=!1,s=!1){const{props:n,ref:i,patchFlag:o,children:a,transition:l}=r,c=t?o_(n||{},t):n,h={__v_isVNode:!0,__v_skip:!0,type:r.type,props:c,key:c&&_g(c),ref:t&&t.ref?e&&i?lt(i)?i.concat(ea(t)):[i,ea(t)]:ea(t):i,scopeId:r.scopeId,slotScopeIds:r.slotScopeIds,children:a,target:r.target,targetStart:r.targetStart,targetAnchor:r.targetAnchor,staticCount:r.staticCount,shapeFlag:r.shapeFlag,patchFlag:t&&r.type!==Ht?o===-1?16:o|16:o,dynamicProps:r.dynamicProps,dynamicChildren:r.dynamicChildren,appContext:r.appContext,dirs:r.dirs,transition:l,component:r.component,suspense:r.suspense,ssContent:r.ssContent&&Jr(r.ssContent),ssFallback:r.ssFallback&&Jr(r.ssFallback),el:r.el,anchor:r.anchor,ctx:r.ctx,ce:r.ce};return l&&s&&vh(h,l.clone(h)),h}function vc(r=" ",t=0){return ae(sl,null,r,t)}function pe(r="",t=!1){return t?(ot(),hn(vr,null,r)):ae(vr,null,r)}function Ls(r){return r==null||typeof r=="boolean"?ae(vr):lt(r)?ae(Ht,null,r.slice()):pa(r)?wn(r):ae(sl,null,String(r))}function wn(r){return r.el===null&&r.patchFlag!==-1||r.memo?r:Jr(r)}function yh(r,t){let e=0;const{shapeFlag:s}=r;if(t==null)t=null;else if(lt(t))e=16;else if(typeof t=="object")if(s&65){const n=t.default;n&&(n._c&&(n._d=!1),yh(r,n()),n._c&&(n._d=!0));return}else{e=32;const n=t._;!n&&!rg(t)?t._ctx=Fe:n===3&&Fe&&(Fe.slots._===1?t._=1:(t._=2,r.patchFlag|=1024))}else dt(t)?(t={default:t,_ctx:Fe},e=32):(t=String(t),s&64?(e=16,t=[vc(t)]):e=8);r.children=t,r.shapeFlag|=e}function o_(...r){const t={};for(let e=0;e<r.length;e++){const s=r[e];for(const n in s)if(n==="class")t.class!==s.class&&(t.class=$e([t.class,s.class]));else if(n==="style")t.style=hs([t.style,s.style]);else if(Wa(n)){const i=t[n],o=s[n];o&&i!==o&&!(lt(i)&&i.includes(o))&&(t[n]=i?[].concat(i,o):o)}else n!==""&&(t[n]=s[n])}return t}function Fs(r,t,e,s=null){qs(r,t,7,[e,s])}const a_=eg();let l_=0;function c_(r,t,e){const s=r.type,n=(t?t.appContext:r.appContext)||a_,i={uid:l_++,vnode:r,type:s,parent:t,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new X0(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(n.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:og(s,n),emitsOptions:pg(s,n),emit:null,emitted:null,propsDefaults:Et,inheritAttrs:s.inheritAttrs,ctx:Et,data:Et,props:Et,attrs:Et,slots:Et,refs:Et,setupState:Et,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=Jv.bind(null,i),r.ce&&r.ce(i),i}let oe=null;const h_=()=>oe||Fe;let ma,_c;{const r=qa(),t=(e,s)=>{let n;return(n=r[e])||(n=r[e]=[]),n.push(s),i=>{n.length>1?n.forEach(o=>o(i)):n[0](i)}};ma=t("__VUE_INSTANCE_SETTERS__",e=>oe=e),_c=t("__VUE_SSR_SETTERS__",e=>Zi=e)}const vo=r=>{const t=oe;return ma(r),r.scope.on(),()=>{r.scope.off(),ma(t)}},Tu=()=>{oe&&oe.scope.off(),ma(null)};function yg(r){return r.vnode.shapeFlag&4}let Zi=!1;function u_(r,t=!1,e=!1){t&&_c(t);const{props:s,children:n}=r.vnode,i=yg(r);Iv(r,s,i,t),Yv(r,n,e);const o=i?f_(r,t):void 0;return t&&_c(!1),o}function f_(r,t){const e=r.type;r.accessCache=Object.create(null),r.proxy=new Proxy(r.ctx,Ev);const{setup:s}=e;if(s){zn();const n=r.setupContext=s.length>1?g_(r):null,i=vo(r),o=mo(s,r,0,[r.props,n]),a=fd(o);if(Xn(),i(),(a||r.sp)&&!Di(r)&&Vd(r),a){if(o.then(Tu,Tu),t)return o.then(l=>{Ou(r,l)}).catch(l=>{Qa(l,r,0)});r.asyncDep=o}else Ou(r,o)}else bg(r)}function Ou(r,t,e){dt(t)?r.type.__ssrInlineRender?r.ssrRender=t:r.render=t:Dt(t)&&(r.setupState=Id(t)),bg(r)}function bg(r,t,e){const s=r.type;r.render||(r.render=s.render||xs);{const n=vo(r);zn();try{Av(r)}finally{Xn(),n()}}}const d_={get(r,t){return fe(r,"get",""),r[t]}};function g_(r){const t=e=>{r.exposed=e||{}};return{attrs:new Proxy(r.attrs,d_),slots:r.slots,emit:r.emit,expose:t}}function nl(r){return r.exposed?r.exposeProxy||(r.exposeProxy=new Proxy(Id(Ld(r.exposed)),{get(t,e){if(e in t)return t[e];if(e in Ri)return Ri[e](r)},has(t,e){return e in t||e in Ri}})):r.proxy}function p_(r,t=!0){return dt(r)?r.displayName||r.name:r.name||t&&r.__name}function m_(r){return dt(r)&&"__vccOpts"in r}const te=(r,t)=>fv(r,t,Zi);function xg(r,t,e){const s=arguments.length;return s===2?Dt(t)&&!lt(t)?pa(t)?ae(r,null,[t]):ae(r,t):ae(r,null,t):(s>3?e=Array.prototype.slice.call(arguments,2):s===3&&pa(e)&&(e=[e]),ae(r,t,e))}function v_(r,t){const e=r.memo;if(e.length!=t.length)return!1;for(let s=0;s<e.length;s++)if(cn(e[s],t[s]))return!1;return Kr>0&&ke&&ke.push(r),!0}const __="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let yc;const ku=typeof window<"u"&&window.trustedTypes;if(ku)try{yc=ku.createPolicy("vue",{createHTML:r=>r})}catch{}const Cg=yc?r=>yc.createHTML(r):r=>r,y_="http://www.w3.org/2000/svg",b_="http://www.w3.org/1998/Math/MathML",en=typeof document<"u"?document:null,Mu=en&&en.createElement("template"),x_={insert:(r,t,e)=>{t.insertBefore(r,e||null)},remove:r=>{const t=r.parentNode;t&&t.removeChild(r)},createElement:(r,t,e,s)=>{const n=t==="svg"?en.createElementNS(y_,r):t==="mathml"?en.createElementNS(b_,r):e?en.createElement(r,{is:e}):en.createElement(r);return r==="select"&&s&&s.multiple!=null&&n.setAttribute("multiple",s.multiple),n},createText:r=>en.createTextNode(r),createComment:r=>en.createComment(r),setText:(r,t)=>{r.nodeValue=t},setElementText:(r,t)=>{r.textContent=t},parentNode:r=>r.parentNode,nextSibling:r=>r.nextSibling,querySelector:r=>en.querySelector(r),setScopeId(r,t){r.setAttribute(t,"")},insertStaticContent(r,t,e,s,n,i){const o=e?e.previousSibling:t.lastChild;if(n&&(n===i||n.nextSibling))for(;t.insertBefore(n.cloneNode(!0),e),!(n===i||!(n=n.nextSibling)););else{Mu.innerHTML=Cg(s==="svg"?`<svg>${r}</svg>`:s==="mathml"?`<math>${r}</math>`:r);const a=Mu.content;if(s==="svg"||s==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}t.insertBefore(a,e)}return[o?o.nextSibling:t.firstChild,e?e.previousSibling:t.lastChild]}},C_=Symbol("_vtc");function w_(r,t,e){const s=r[C_];s&&(t=(t?[t,...s]:[...s]).join(" ")),t==null?r.removeAttribute("class"):e?r.setAttribute("class",t):r.className=t}const va=Symbol("_vod"),wg=Symbol("_vsh"),Eu={beforeMount(r,{value:t},{transition:e}){r[va]=r.style.display==="none"?"":r.style.display,e&&t?e.beforeEnter(r):bi(r,t)},mounted(r,{value:t},{transition:e}){e&&t&&e.enter(r)},updated(r,{value:t,oldValue:e},{transition:s}){!t!=!e&&(s?t?(s.beforeEnter(r),bi(r,!0),s.enter(r)):s.leave(r,()=>{bi(r,!1)}):bi(r,t))},beforeUnmount(r,{value:t}){bi(r,t)}};function bi(r,t){r.style.display=t?r[va]:"none",r[wg]=!t}const Sg=Symbol("");function S_(r){const t=h_();if(!t)return;const e=t.ut=(n=r(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(i=>_a(i,n))},s=()=>{const n=r(t.proxy);t.ce?_a(t.ce,n):bc(t.subTree,n),e(n)};Gd(()=>{Hd(s)}),es(()=>{ds(s,xs,{flush:"post"});const n=new MutationObserver(s);n.observe(t.subTree.el.parentNode,{childList:!0}),mn(()=>n.disconnect())})}function bc(r,t){if(r.shapeFlag&128){const e=r.suspense;r=e.activeBranch,e.pendingBranch&&!e.isHydrating&&e.effects.push(()=>{bc(e.activeBranch,t)})}for(;r.component;)r=r.component.subTree;if(r.shapeFlag&1&&r.el)_a(r.el,t);else if(r.type===Ht)r.children.forEach(e=>bc(e,t));else if(r.type===ta){let{el:e,anchor:s}=r;for(;e&&(_a(e,t),e!==s);)e=e.nextSibling}}function _a(r,t){if(r.nodeType===1){const e=r.style;let s="";for(const n in t)e.setProperty(`--${n}`,t[n]),s+=`--${n}: ${t[n]};`;e[Sg]=s}}const T_=/(^|;)\s*display\s*:/;function O_(r,t,e){const s=r.style,n=qt(e);let i=!1;if(e&&!n){if(t)if(qt(t))for(const o of t.split(";")){const a=o.slice(0,o.indexOf(":")).trim();e[a]==null&&sa(s,a,"")}else for(const o in t)e[o]==null&&sa(s,o,"");for(const o in e)o==="display"&&(i=!0),sa(s,o,e[o])}else if(n){if(t!==e){const o=s[Sg];o&&(e+=";"+o),s.cssText=e,i=T_.test(e)}}else t&&r.removeAttribute("style");va in r&&(r[va]=i?s.display:"",r[wg]&&(s.display="none"))}const Au=/\s*!important$/;function sa(r,t,e){if(lt(e))e.forEach(s=>sa(r,t,s));else if(e==null&&(e=""),t.startsWith("--"))r.setProperty(t,e);else{const s=k_(r,t);Au.test(e)?r.setProperty(xr(s),e.replace(Au,""),"important"):r[s]=e}}const Pu=["Webkit","Moz","ms"],Pl={};function k_(r,t){const e=Pl[t];if(e)return e;let s=ps(t);if(s!=="filter"&&s in r)return Pl[t]=s;s=$a(s);for(let n=0;n<Pu.length;n++){const i=Pu[n]+s;if(i in r)return Pl[t]=i}return t}const Fu="http://www.w3.org/1999/xlink";function Du(r,t,e,s,n,i=H0(t)){s&&t.startsWith("xlink:")?e==null?r.removeAttributeNS(Fu,t.slice(6,t.length)):r.setAttributeNS(Fu,t,e):e==null||i&&!md(e)?r.removeAttribute(t):r.setAttribute(t,i?"":$s(e)?String(e):e)}function Ru(r,t,e,s,n){if(t==="innerHTML"||t==="textContent"){e!=null&&(r[t]=t==="innerHTML"?Cg(e):e);return}const i=r.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?r.getAttribute("value")||"":r.value,l=e==null?r.type==="checkbox"?"on":"":String(e);(a!==l||!("_value"in r))&&(r.value=l),e==null&&r.removeAttribute(t),r._value=e;return}let o=!1;if(e===""||e==null){const a=typeof r[t];a==="boolean"?e=md(e):e==null&&a==="string"?(e="",o=!0):a==="number"&&(e=0,o=!0)}try{r[t]=e}catch{}o&&r.removeAttribute(n||t)}function tr(r,t,e,s){r.addEventListener(t,e,s)}function M_(r,t,e,s){r.removeEventListener(t,e,s)}const Lu=Symbol("_vei");function E_(r,t,e,s,n=null){const i=r[Lu]||(r[Lu]={}),o=i[t];if(s&&o)o.value=s;else{const[a,l]=A_(t);if(s){const c=i[t]=D_(s,n);tr(r,a,c,l)}else o&&(M_(r,a,o,l),i[t]=void 0)}}const ju=/(?:Once|Passive|Capture)$/;function A_(r){let t;if(ju.test(r)){t={};let s;for(;s=r.match(ju);)r=r.slice(0,r.length-s[0].length),t[s[0].toLowerCase()]=!0}return[r[2]===":"?r.slice(3):xr(r.slice(2)),t]}let Fl=0;const P_=Promise.resolve(),F_=()=>Fl||(P_.then(()=>Fl=0),Fl=Date.now());function D_(r,t){const e=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=e.attached)return;qs(R_(s,e.value),t,5,[s])};return e.value=r,e.attached=F_(),e}function R_(r,t){if(lt(t)){const e=r.stopImmediatePropagation;return r.stopImmediatePropagation=()=>{e.call(r),r._stopped=!0},t.map(s=>n=>!n._stopped&&s&&s(n))}else return t}const Iu=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&r.charCodeAt(2)>96&&r.charCodeAt(2)<123,L_=(r,t,e,s,n,i)=>{const o=n==="svg";t==="class"?w_(r,s,o):t==="style"?O_(r,e,s):Wa(t)?rh(t)||E_(r,t,e,s,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):j_(r,t,s,o))?(Ru(r,t,s),!r.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Du(r,t,s,o,i,t!=="value")):r._isVueCE&&(/[A-Z]/.test(t)||!qt(s))?Ru(r,ps(t),s,i,t):(t==="true-value"?r._trueValue=s:t==="false-value"&&(r._falseValue=s),Du(r,t,s,o))};function j_(r,t,e,s){if(s)return!!(t==="innerHTML"||t==="textContent"||t in r&&Iu(t)&&dt(e));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&r.tagName==="INPUT"||t==="type"&&r.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const n=r.tagName;if(n==="IMG"||n==="VIDEO"||n==="CANVAS"||n==="SOURCE")return!1}return Iu(t)&&qt(e)?!1:t in r}const ya=r=>{const t=r.props["onUpdate:modelValue"]||!1;return lt(t)?e=>Zo(t,e):t};function I_(r){r.target.composing=!0}function Bu(r){const t=r.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const zr=Symbol("_assign"),xc={created(r,{modifiers:{lazy:t,trim:e,number:s}},n){r[zr]=ya(n);const i=s||n.props&&n.props.type==="number";tr(r,t?"change":"input",o=>{if(o.target.composing)return;let a=r.value;e&&(a=a.trim()),i&&(a=ca(a)),r[zr](a)}),e&&tr(r,"change",()=>{r.value=r.value.trim()}),t||(tr(r,"compositionstart",I_),tr(r,"compositionend",Bu),tr(r,"change",Bu))},mounted(r,{value:t}){r.value=t??""},beforeUpdate(r,{value:t,oldValue:e,modifiers:{lazy:s,trim:n,number:i}},o){if(r[zr]=ya(o),r.composing)return;const a=(i||r.type==="number")&&!/^0\d/.test(r.value)?ca(r.value):r.value,l=t??"";a!==l&&(document.activeElement===r&&r.type!=="range"&&(s&&t===e||n&&r.value.trim()===l)||(r.value=l))}},Nu={deep:!0,created(r,{value:t,modifiers:{number:e}},s){const n=Ua(t);tr(r,"change",()=>{const i=Array.prototype.filter.call(r.options,o=>o.selected).map(o=>e?ca(ba(o)):ba(o));r[zr](r.multiple?n?new Set(i):i:i[0]),r._assigning=!0,pr(()=>{r._assigning=!1})}),r[zr]=ya(s)},mounted(r,{value:t}){Hu(r,t)},beforeUpdate(r,t,e){r[zr]=ya(e)},updated(r,{value:t}){r._assigning||Hu(r,t)}};function Hu(r,t){const e=r.multiple,s=lt(t);if(!(e&&!s&&!Ua(t))){for(let n=0,i=r.options.length;n<i;n++){const o=r.options[n],a=ba(o);if(e)if(s){const l=typeof a;l==="string"||l==="number"?o.selected=t.some(c=>String(c)===String(a)):o.selected=z0(t,a)>-1}else o.selected=t.has(a);else if(Ka(ba(o),t)){r.selectedIndex!==n&&(r.selectedIndex=n);return}}!e&&r.selectedIndex!==-1&&(r.selectedIndex=-1)}}function ba(r){return"_value"in r?r._value:r.value}const B_=ye({patchProp:L_},x_);let Yu;function N_(){return Yu||(Yu=Xv(B_))}const H_=(...r)=>{const t=N_().createApp(...r),{mount:e}=t;return t.mount=s=>{const n=z_(s);if(!n)return;const i=t._component;!dt(i)&&!i.render&&!i.template&&(i.template=n.innerHTML),n.nodeType===1&&(n.textContent="");const o=e(n,!1,Y_(n));return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),o},t};function Y_(r){if(r instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&r instanceof MathMLElement)return"mathml"}function z_(r){return qt(r)?document.querySelector(r):r}const ft={CONTROL_PANEL:{OPEN:"open-control-panel",SHOW_TEXT_SETTING_TOOLBAR:"control-panel:show-text-toolbar",HIDE_TEXT_SETTING_TOOLBAR:"control-panel:hide-text-setting-toolbar"},PANEL_TYPE:{BACKGROUND_IMAGE:"background-image",BACKGROUND_COLOR:"background-color",INSERT_IMAGE:"insert-image"},CANVAS:{CANVAS_UPDATE:"canvas:update",BACKGROUND_COLOR_CHANGE:"canvas:background-color-change",BACKGROUND_IMAGE_CHANGE:"canvas:background-image-change"},FRAME:{FRAME_ADDED:"frame:added",FRAME_REMOVED:"frame:removed",FRAME_UPDATED:"frame:updated",FRAMES_REORDERED:"frames:reordered",FRAMES_CLEARED:"frames:cleared"}};class X_{constructor(){F(this,"events");this.events=new Map}on(t,e){this.events.has(t)||this.events.set(t,[]),this.events.get(t).push(e)}off(t,e){if(this.events.has(t))if(e){const s=this.events.get(t),n=s.indexOf(e);n!==-1&&s.splice(n,1),s.length===0&&this.events.delete(t)}else this.events.delete(t)}emit(t,e){this.events.has(t)&&this.events.get(t).forEach(s=>{s(e)})}}const yt=new X_,V_=Ye({__name:"App",setup(r){return(t,e)=>{const s=qd("router-view");return ot(),hn(s,null,{default:mh(({Component:n,route:i})=>[(ot(),hn(Jd(n)))]),_:1})}}}),vs=(r,t)=>{const e=r.__vccOpts||r;for(const[s,n]of t)e[s]=n;return e},W_=vs(V_,[["__scopeId","data-v-9330136f"]]);/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const Pr=typeof document<"u";function Tg(r){return typeof r=="object"||"displayName"in r||"props"in r||"__vccOpts"in r}function U_(r){return r.__esModule||r[Symbol.toStringTag]==="Module"||r.default&&Tg(r.default)}const xt=Object.assign;function Dl(r,t){const e={};for(const s in t){const n=t[s];e[s]=Ts(n)?n.map(r):r(n)}return e}const ji=()=>{},Ts=Array.isArray,Og=/#/g,G_=/&/g,$_=/\//g,q_=/=/g,K_=/\?/g,kg=/\+/g,J_=/%5B/g,Z_=/%5D/g,Mg=/%5E/g,Q_=/%60/g,Eg=/%7B/g,ty=/%7C/g,Ag=/%7D/g,ey=/%20/g;function bh(r){return encodeURI(""+r).replace(ty,"|").replace(J_,"[").replace(Z_,"]")}function sy(r){return bh(r).replace(Eg,"{").replace(Ag,"}").replace(Mg,"^")}function Cc(r){return bh(r).replace(kg,"%2B").replace(ey,"+").replace(Og,"%23").replace(G_,"%26").replace(Q_,"`").replace(Eg,"{").replace(Ag,"}").replace(Mg,"^")}function ny(r){return Cc(r).replace(q_,"%3D")}function ry(r){return bh(r).replace(Og,"%23").replace(K_,"%3F")}function iy(r){return r==null?"":ry(r).replace($_,"%2F")}function Qi(r){try{return decodeURIComponent(""+r)}catch{}return""+r}const oy=/\/$/,ay=r=>r.replace(oy,"");function Rl(r,t,e="/"){let s,n={},i="",o="";const a=t.indexOf("#");let l=t.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(s=t.slice(0,l),i=t.slice(l+1,a>-1?a:t.length),n=r(i)),a>-1&&(s=s||t.slice(0,a),o=t.slice(a,t.length)),s=uy(s??t,e),{fullPath:s+(i&&"?")+i+o,path:s,query:n,hash:Qi(o)}}function ly(r,t){const e=t.query?r(t.query):"";return t.path+(e&&"?")+e+(t.hash||"")}function zu(r,t){return!t||!r.toLowerCase().startsWith(t.toLowerCase())?r:r.slice(t.length)||"/"}function cy(r,t,e){const s=t.matched.length-1,n=e.matched.length-1;return s>-1&&s===n&&Zr(t.matched[s],e.matched[n])&&Pg(t.params,e.params)&&r(t.query)===r(e.query)&&t.hash===e.hash}function Zr(r,t){return(r.aliasOf||r)===(t.aliasOf||t)}function Pg(r,t){if(Object.keys(r).length!==Object.keys(t).length)return!1;for(const e in r)if(!hy(r[e],t[e]))return!1;return!0}function hy(r,t){return Ts(r)?Xu(r,t):Ts(t)?Xu(t,r):r===t}function Xu(r,t){return Ts(t)?r.length===t.length&&r.every((e,s)=>e===t[s]):r.length===1&&r[0]===t}function uy(r,t){if(r.startsWith("/"))return r;if(!r)return t;const e=t.split("/"),s=r.split("/"),n=s[s.length-1];(n===".."||n===".")&&s.push("");let i=e.length-1,o,a;for(o=0;o<s.length;o++)if(a=s[o],a!==".")if(a==="..")i>1&&i--;else break;return e.slice(0,i).join("/")+"/"+s.slice(o).join("/")}const yn={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var to;(function(r){r.pop="pop",r.push="push"})(to||(to={}));var Ii;(function(r){r.back="back",r.forward="forward",r.unknown=""})(Ii||(Ii={}));function fy(r){if(!r)if(Pr){const t=document.querySelector("base");r=t&&t.getAttribute("href")||"/",r=r.replace(/^\w+:\/\/[^\/]+/,"")}else r="/";return r[0]!=="/"&&r[0]!=="#"&&(r="/"+r),ay(r)}const dy=/^[^#]+#/;function gy(r,t){return r.replace(dy,"#")+t}function py(r,t){const e=document.documentElement.getBoundingClientRect(),s=r.getBoundingClientRect();return{behavior:t.behavior,left:s.left-e.left-(t.left||0),top:s.top-e.top-(t.top||0)}}const rl=()=>({left:window.scrollX,top:window.scrollY});function my(r){let t;if("el"in r){const e=r.el,s=typeof e=="string"&&e.startsWith("#"),n=typeof e=="string"?s?document.getElementById(e.slice(1)):document.querySelector(e):e;if(!n)return;t=py(n,r)}else t=r;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function Vu(r,t){return(history.state?history.state.position-t:-1)+r}const wc=new Map;function vy(r,t){wc.set(r,t)}function _y(r){const t=wc.get(r);return wc.delete(r),t}let yy=()=>location.protocol+"//"+location.host;function Fg(r,t){const{pathname:e,search:s,hash:n}=t,i=r.indexOf("#");if(i>-1){let a=n.includes(r.slice(i))?r.slice(i).length:1,l=n.slice(a);return l[0]!=="/"&&(l="/"+l),zu(l,"")}return zu(e,r)+s+n}function by(r,t,e,s){let n=[],i=[],o=null;const a=({state:f})=>{const d=Fg(r,location),p=e.value,g=t.value;let m=0;if(f){if(e.value=d,t.value=f,o&&o===p){o=null;return}m=g?f.position-g.position:0}else s(d);n.forEach(v=>{v(e.value,p,{delta:m,type:to.pop,direction:m?m>0?Ii.forward:Ii.back:Ii.unknown})})};function l(){o=e.value}function c(f){n.push(f);const d=()=>{const p=n.indexOf(f);p>-1&&n.splice(p,1)};return i.push(d),d}function h(){const{history:f}=window;f.state&&f.replaceState(xt({},f.state,{scroll:rl()}),"")}function u(){for(const f of i)f();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",h)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",h,{passive:!0}),{pauseListeners:l,listen:c,destroy:u}}function Wu(r,t,e,s=!1,n=!1){return{back:r,current:t,forward:e,replaced:s,position:window.history.length,scroll:n?rl():null}}function xy(r){const{history:t,location:e}=window,s={value:Fg(r,e)},n={value:t.state};n.value||i(s.value,{back:null,current:s.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(l,c,h){const u=r.indexOf("#"),f=u>-1?(e.host&&document.querySelector("base")?r:r.slice(u))+l:yy()+r+l;try{t[h?"replaceState":"pushState"](c,"",f),n.value=c}catch(d){console.error(d),e[h?"replace":"assign"](f)}}function o(l,c){const h=xt({},t.state,Wu(n.value.back,l,n.value.forward,!0),c,{position:n.value.position});i(l,h,!0),s.value=l}function a(l,c){const h=xt({},n.value,t.state,{forward:l,scroll:rl()});i(h.current,h,!0);const u=xt({},Wu(s.value,l,null),{position:h.position+1},c);i(l,u,!1),s.value=l}return{location:s,state:n,push:a,replace:o}}function Cy(r){r=fy(r);const t=xy(r),e=by(r,t.state,t.location,t.replace);function s(i,o=!0){o||e.pauseListeners(),history.go(i)}const n=xt({location:"",base:r,go:s,createHref:gy.bind(null,r)},t,e);return Object.defineProperty(n,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(n,"state",{enumerable:!0,get:()=>t.state.value}),n}function wy(r){return r=location.host?r||location.pathname+location.search:"",r.includes("#")||(r+="#"),Cy(r)}function Sy(r){return typeof r=="string"||r&&typeof r=="object"}function Dg(r){return typeof r=="string"||typeof r=="symbol"}const Rg=Symbol("");var Uu;(function(r){r[r.aborted=4]="aborted",r[r.cancelled=8]="cancelled",r[r.duplicated=16]="duplicated"})(Uu||(Uu={}));function Qr(r,t){return xt(new Error,{type:r,[Rg]:!0},t)}function Qs(r,t){return r instanceof Error&&Rg in r&&(t==null||!!(r.type&t))}const Gu="[^/]+?",Ty={sensitive:!1,strict:!1,start:!0,end:!0},Oy=/[.+*?^${}()[\]/\\]/g;function ky(r,t){const e=xt({},Ty,t),s=[];let n=e.start?"^":"";const i=[];for(const c of r){const h=c.length?[]:[90];e.strict&&!c.length&&(n+="/");for(let u=0;u<c.length;u++){const f=c[u];let d=40+(e.sensitive?.25:0);if(f.type===0)u||(n+="/"),n+=f.value.replace(Oy,"\\$&"),d+=40;else if(f.type===1){const{value:p,repeatable:g,optional:m,regexp:v}=f;i.push({name:p,repeatable:g,optional:m});const _=v||Gu;if(_!==Gu){d+=10;try{new RegExp(`(${_})`)}catch(b){throw new Error(`Invalid custom RegExp for param "${p}" (${_}): `+b.message)}}let y=g?`((?:${_})(?:/(?:${_}))*)`:`(${_})`;u||(y=m&&c.length<2?`(?:/${y})`:"/"+y),m&&(y+="?"),n+=y,d+=20,m&&(d+=-8),g&&(d+=-20),_===".*"&&(d+=-50)}h.push(d)}s.push(h)}if(e.strict&&e.end){const c=s.length-1;s[c][s[c].length-1]+=.7000000000000001}e.strict||(n+="/?"),e.end?n+="$":e.strict&&!n.endsWith("/")&&(n+="(?:/|$)");const o=new RegExp(n,e.sensitive?"":"i");function a(c){const h=c.match(o),u={};if(!h)return null;for(let f=1;f<h.length;f++){const d=h[f]||"",p=i[f-1];u[p.name]=d&&p.repeatable?d.split("/"):d}return u}function l(c){let h="",u=!1;for(const f of r){(!u||!h.endsWith("/"))&&(h+="/"),u=!1;for(const d of f)if(d.type===0)h+=d.value;else if(d.type===1){const{value:p,repeatable:g,optional:m}=d,v=p in c?c[p]:"";if(Ts(v)&&!g)throw new Error(`Provided param "${p}" is an array but it is not repeatable (* or + modifiers)`);const _=Ts(v)?v.join("/"):v;if(!_)if(m)f.length<2&&(h.endsWith("/")?h=h.slice(0,-1):u=!0);else throw new Error(`Missing required param "${p}"`);h+=_}}return h||"/"}return{re:o,score:s,keys:i,parse:a,stringify:l}}function My(r,t){let e=0;for(;e<r.length&&e<t.length;){const s=t[e]-r[e];if(s)return s;e++}return r.length<t.length?r.length===1&&r[0]===80?-1:1:r.length>t.length?t.length===1&&t[0]===80?1:-1:0}function Lg(r,t){let e=0;const s=r.score,n=t.score;for(;e<s.length&&e<n.length;){const i=My(s[e],n[e]);if(i)return i;e++}if(Math.abs(n.length-s.length)===1){if($u(s))return 1;if($u(n))return-1}return n.length-s.length}function $u(r){const t=r[r.length-1];return r.length>0&&t[t.length-1]<0}const Ey={type:0,value:""},Ay=/[a-zA-Z0-9_]/;function Py(r){if(!r)return[[]];if(r==="/")return[[Ey]];if(!r.startsWith("/"))throw new Error(`Invalid path "${r}"`);function t(d){throw new Error(`ERR (${e})/"${c}": ${d}`)}let e=0,s=e;const n=[];let i;function o(){i&&n.push(i),i=[]}let a=0,l,c="",h="";function u(){c&&(e===0?i.push({type:0,value:c}):e===1||e===2||e===3?(i.length>1&&(l==="*"||l==="+")&&t(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:h,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):t("Invalid state to consume buffer"),c="")}function f(){c+=l}for(;a<r.length;){if(l=r[a++],l==="\\"&&e!==2){s=e,e=4;continue}switch(e){case 0:l==="/"?(c&&u(),o()):l===":"?(u(),e=1):f();break;case 4:f(),e=s;break;case 1:l==="("?e=2:Ay.test(l)?f():(u(),e=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?h[h.length-1]=="\\"?h=h.slice(0,-1)+l:e=3:h+=l;break;case 3:u(),e=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,h="";break;default:t("Unknown state");break}}return e===2&&t(`Unfinished custom RegExp for param "${c}"`),u(),o(),n}function Fy(r,t,e){const s=ky(Py(r.path),e),n=xt(s,{record:r,parent:t,children:[],alias:[]});return t&&!n.record.aliasOf==!t.record.aliasOf&&t.children.push(n),n}function Dy(r,t){const e=[],s=new Map;t=Zu({strict:!1,end:!0,sensitive:!1},t);function n(u){return s.get(u)}function i(u,f,d){const p=!d,g=Ku(u);g.aliasOf=d&&d.record;const m=Zu(t,u),v=[g];if("alias"in u){const b=typeof u.alias=="string"?[u.alias]:u.alias;for(const w of b)v.push(Ku(xt({},g,{components:d?d.record.components:g.components,path:w,aliasOf:d?d.record:g})))}let _,y;for(const b of v){const{path:w}=b;if(f&&w[0]!=="/"){const A=f.record.path,O=A[A.length-1]==="/"?"":"/";b.path=f.record.path+(w&&O+w)}if(_=Fy(b,f,m),d?d.alias.push(_):(y=y||_,y!==_&&y.alias.push(_),p&&u.name&&!Ju(_)&&o(u.name)),jg(_)&&l(_),g.children){const A=g.children;for(let O=0;O<A.length;O++)i(A[O],_,d&&d.children[O])}d=d||_}return y?()=>{o(y)}:ji}function o(u){if(Dg(u)){const f=s.get(u);f&&(s.delete(u),e.splice(e.indexOf(f),1),f.children.forEach(o),f.alias.forEach(o))}else{const f=e.indexOf(u);f>-1&&(e.splice(f,1),u.record.name&&s.delete(u.record.name),u.children.forEach(o),u.alias.forEach(o))}}function a(){return e}function l(u){const f=jy(u,e);e.splice(f,0,u),u.record.name&&!Ju(u)&&s.set(u.record.name,u)}function c(u,f){let d,p={},g,m;if("name"in u&&u.name){if(d=s.get(u.name),!d)throw Qr(1,{location:u});m=d.record.name,p=xt(qu(f.params,d.keys.filter(y=>!y.optional).concat(d.parent?d.parent.keys.filter(y=>y.optional):[]).map(y=>y.name)),u.params&&qu(u.params,d.keys.map(y=>y.name))),g=d.stringify(p)}else if(u.path!=null)g=u.path,d=e.find(y=>y.re.test(g)),d&&(p=d.parse(g),m=d.record.name);else{if(d=f.name?s.get(f.name):e.find(y=>y.re.test(f.path)),!d)throw Qr(1,{location:u,currentLocation:f});m=d.record.name,p=xt({},f.params,u.params),g=d.stringify(p)}const v=[];let _=d;for(;_;)v.unshift(_.record),_=_.parent;return{name:m,path:g,params:p,matched:v,meta:Ly(v)}}r.forEach(u=>i(u));function h(){e.length=0,s.clear()}return{addRoute:i,resolve:c,removeRoute:o,clearRoutes:h,getRoutes:a,getRecordMatcher:n}}function qu(r,t){const e={};for(const s of t)s in r&&(e[s]=r[s]);return e}function Ku(r){const t={path:r.path,redirect:r.redirect,name:r.name,meta:r.meta||{},aliasOf:r.aliasOf,beforeEnter:r.beforeEnter,props:Ry(r),children:r.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in r?r.components||null:r.component&&{default:r.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function Ry(r){const t={},e=r.props||!1;if("component"in r)t.default=e;else for(const s in r.components)t[s]=typeof e=="object"?e[s]:e;return t}function Ju(r){for(;r;){if(r.record.aliasOf)return!0;r=r.parent}return!1}function Ly(r){return r.reduce((t,e)=>xt(t,e.meta),{})}function Zu(r,t){const e={};for(const s in r)e[s]=s in t?t[s]:r[s];return e}function jy(r,t){let e=0,s=t.length;for(;e!==s;){const i=e+s>>1;Lg(r,t[i])<0?s=i:e=i+1}const n=Iy(r);return n&&(s=t.lastIndexOf(n,s-1)),s}function Iy(r){let t=r;for(;t=t.parent;)if(jg(t)&&Lg(r,t)===0)return t}function jg({record:r}){return!!(r.name||r.components&&Object.keys(r.components).length||r.redirect)}function By(r){const t={};if(r===""||r==="?")return t;const s=(r[0]==="?"?r.slice(1):r).split("&");for(let n=0;n<s.length;++n){const i=s[n].replace(kg," "),o=i.indexOf("="),a=Qi(o<0?i:i.slice(0,o)),l=o<0?null:Qi(i.slice(o+1));if(a in t){let c=t[a];Ts(c)||(c=t[a]=[c]),c.push(l)}else t[a]=l}return t}function Qu(r){let t="";for(let e in r){const s=r[e];if(e=ny(e),s==null){s!==void 0&&(t+=(t.length?"&":"")+e);continue}(Ts(s)?s.map(i=>i&&Cc(i)):[s&&Cc(s)]).forEach(i=>{i!==void 0&&(t+=(t.length?"&":"")+e,i!=null&&(t+="="+i))})}return t}function Ny(r){const t={};for(const e in r){const s=r[e];s!==void 0&&(t[e]=Ts(s)?s.map(n=>n==null?null:""+n):s==null?s:""+s)}return t}const Hy=Symbol(""),tf=Symbol(""),il=Symbol(""),Ig=Symbol(""),Sc=Symbol("");function xi(){let r=[];function t(s){return r.push(s),()=>{const n=r.indexOf(s);n>-1&&r.splice(n,1)}}function e(){r=[]}return{add:t,list:()=>r.slice(),reset:e}}function Sn(r,t,e,s,n,i=o=>o()){const o=s&&(s.enterCallbacks[n]=s.enterCallbacks[n]||[]);return()=>new Promise((a,l)=>{const c=f=>{f===!1?l(Qr(4,{from:e,to:t})):f instanceof Error?l(f):Sy(f)?l(Qr(2,{from:t,to:f})):(o&&s.enterCallbacks[n]===o&&typeof f=="function"&&o.push(f),a())},h=i(()=>r.call(s&&s.instances[n],t,e,c));let u=Promise.resolve(h);r.length<3&&(u=u.then(c)),u.catch(f=>l(f))})}function Ll(r,t,e,s,n=i=>i()){const i=[];for(const o of r)for(const a in o.components){let l=o.components[a];if(!(t!=="beforeRouteEnter"&&!o.instances[a]))if(Tg(l)){const h=(l.__vccOpts||l)[t];h&&i.push(Sn(h,e,s,o,a,n))}else{let c=l();i.push(()=>c.then(h=>{if(!h)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const u=U_(h)?h.default:h;o.mods[a]=h,o.components[a]=u;const d=(u.__vccOpts||u)[t];return d&&Sn(d,e,s,o,a,n)()}))}}return i}function ef(r){const t=Xs(il),e=Xs(Ig),s=te(()=>{const l=Ze(r.to);return t.resolve(l)}),n=te(()=>{const{matched:l}=s.value,{length:c}=l,h=l[c-1],u=e.matched;if(!h||!u.length)return-1;const f=u.findIndex(Zr.bind(null,h));if(f>-1)return f;const d=sf(l[c-2]);return c>1&&sf(h)===d&&u[u.length-1].path!==d?u.findIndex(Zr.bind(null,l[c-2])):f}),i=te(()=>n.value>-1&&Wy(e.params,s.value.params)),o=te(()=>n.value>-1&&n.value===e.matched.length-1&&Pg(e.params,s.value.params));function a(l={}){if(Vy(l)){const c=t[Ze(r.replace)?"replace":"push"](Ze(r.to)).catch(ji);return r.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:s,href:te(()=>s.value.href),isActive:i,isExactActive:o,navigate:a}}function Yy(r){return r.length===1?r[0]:r}const zy=Ye({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:ef,setup(r,{slots:t}){const e=Za(ef(r)),{options:s}=Xs(il),n=te(()=>({[nf(r.activeClass,s.linkActiveClass,"router-link-active")]:e.isActive,[nf(r.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:e.isExactActive}));return()=>{const i=t.default&&Yy(t.default(e));return r.custom?i:xg("a",{"aria-current":e.isExactActive?r.ariaCurrentValue:null,href:e.href,onClick:e.navigate,class:n.value},i)}}}),Xy=zy;function Vy(r){if(!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)&&!r.defaultPrevented&&!(r.button!==void 0&&r.button!==0)){if(r.currentTarget&&r.currentTarget.getAttribute){const t=r.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return r.preventDefault&&r.preventDefault(),!0}}function Wy(r,t){for(const e in t){const s=t[e],n=r[e];if(typeof s=="string"){if(s!==n)return!1}else if(!Ts(n)||n.length!==s.length||s.some((i,o)=>i!==n[o]))return!1}return!0}function sf(r){return r?r.aliasOf?r.aliasOf.path:r.path:""}const nf=(r,t,e)=>r??t??e,Uy=Ye({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(r,{attrs:t,slots:e}){const s=Xs(Sc),n=te(()=>r.route||s.value),i=Xs(tf,0),o=te(()=>{let c=Ze(i);const{matched:h}=n.value;let u;for(;(u=h[c])&&!u.components;)c++;return c}),a=te(()=>n.value.matched[o.value]);Qo(tf,te(()=>o.value+1)),Qo(Hy,a),Qo(Sc,n);const l=nt();return ds(()=>[l.value,a.value,r.name],([c,h,u],[f,d,p])=>{h&&(h.instances[u]=c,d&&d!==h&&c&&c===f&&(h.leaveGuards.size||(h.leaveGuards=d.leaveGuards),h.updateGuards.size||(h.updateGuards=d.updateGuards))),c&&h&&(!d||!Zr(h,d)||!f)&&(h.enterCallbacks[u]||[]).forEach(g=>g(c))},{flush:"post"}),()=>{const c=n.value,h=r.name,u=a.value,f=u&&u.components[h];if(!f)return rf(e.default,{Component:f,route:c});const d=u.props[h],p=d?d===!0?c.params:typeof d=="function"?d(c):d:null,m=xg(f,xt({},p,t,{onVnodeUnmounted:v=>{v.component.isUnmounted&&(u.instances[h]=null)},ref:l}));return rf(e.default,{Component:m,route:c})||m}}});function rf(r,t){if(!r)return null;const e=r(t);return e.length===1?e[0]:e}const Gy=Uy;function $y(r){const t=Dy(r.routes,r),e=r.parseQuery||By,s=r.stringifyQuery||Qu,n=r.history,i=xi(),o=xi(),a=xi(),l=gh(yn);let c=yn;Pr&&r.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const h=Dl.bind(null,R=>""+R),u=Dl.bind(null,iy),f=Dl.bind(null,Qi);function d(R,Z){let z,Q;return Dg(R)?(z=t.getRecordMatcher(R),Q=Z):Q=R,t.addRoute(Q,z)}function p(R){const Z=t.getRecordMatcher(R);Z&&t.removeRoute(Z)}function g(){return t.getRoutes().map(R=>R.record)}function m(R){return!!t.getRecordMatcher(R)}function v(R,Z){if(Z=xt({},Z||l.value),typeof R=="string"){const k=Rl(e,R,Z.path),L=t.resolve({path:k.path},Z),I=n.createHref(k.fullPath);return xt(k,L,{params:f(L.params),hash:Qi(k.hash),redirectedFrom:void 0,href:I})}let z;if(R.path!=null)z=xt({},R,{path:Rl(e,R.path,Z.path).path});else{const k=xt({},R.params);for(const L in k)k[L]==null&&delete k[L];z=xt({},R,{params:u(k)}),Z.params=u(Z.params)}const Q=t.resolve(z,Z),bt=R.hash||"";Q.params=h(f(Q.params));const x=ly(s,xt({},R,{hash:sy(bt),path:Q.path})),C=n.createHref(x);return xt({fullPath:x,hash:bt,query:s===Qu?Ny(R.query):R.query||{}},Q,{redirectedFrom:void 0,href:C})}function _(R){return typeof R=="string"?Rl(e,R,l.value.path):xt({},R)}function y(R,Z){if(c!==R)return Qr(8,{from:Z,to:R})}function b(R){return O(R)}function w(R){return b(xt(_(R),{replace:!0}))}function A(R){const Z=R.matched[R.matched.length-1];if(Z&&Z.redirect){const{redirect:z}=Z;let Q=typeof z=="function"?z(R):z;return typeof Q=="string"&&(Q=Q.includes("?")||Q.includes("#")?Q=_(Q):{path:Q},Q.params={}),xt({query:R.query,hash:R.hash,params:Q.path!=null?{}:R.params},Q)}}function O(R,Z){const z=c=v(R),Q=l.value,bt=R.state,x=R.force,C=R.replace===!0,k=A(z);if(k)return O(xt(_(k),{state:typeof k=="object"?xt({},bt,k.state):bt,force:x,replace:C}),Z||z);const L=z;L.redirectedFrom=Z;let I;return!x&&cy(s,Q,z)&&(I=Qr(16,{to:L,from:Q}),At(Q,Q,!0,!1)),(I?Promise.resolve(I):Y(L,Q)).catch(j=>Qs(j)?Qs(j,2)?j:Tt(j):V(j,L,Q)).then(j=>{if(j){if(Qs(j,2))return O(xt({replace:C},_(j.to),{state:typeof j.to=="object"?xt({},bt,j.to.state):bt,force:x}),Z||L)}else j=st(L,Q,!0,C,bt);return K(L,Q,j),j})}function E(R,Z){const z=y(R,Z);return z?Promise.reject(z):Promise.resolve()}function D(R){const Z=W.values().next().value;return Z&&typeof Z.runWithContext=="function"?Z.runWithContext(R):R()}function Y(R,Z){let z;const[Q,bt,x]=qy(R,Z);z=Ll(Q.reverse(),"beforeRouteLeave",R,Z);for(const k of Q)k.leaveGuards.forEach(L=>{z.push(Sn(L,R,Z))});const C=E.bind(null,R,Z);return z.push(C),Rt(z).then(()=>{z=[];for(const k of i.list())z.push(Sn(k,R,Z));return z.push(C),Rt(z)}).then(()=>{z=Ll(bt,"beforeRouteUpdate",R,Z);for(const k of bt)k.updateGuards.forEach(L=>{z.push(Sn(L,R,Z))});return z.push(C),Rt(z)}).then(()=>{z=[];for(const k of x)if(k.beforeEnter)if(Ts(k.beforeEnter))for(const L of k.beforeEnter)z.push(Sn(L,R,Z));else z.push(Sn(k.beforeEnter,R,Z));return z.push(C),Rt(z)}).then(()=>(R.matched.forEach(k=>k.enterCallbacks={}),z=Ll(x,"beforeRouteEnter",R,Z,D),z.push(C),Rt(z))).then(()=>{z=[];for(const k of o.list())z.push(Sn(k,R,Z));return z.push(C),Rt(z)}).catch(k=>Qs(k,8)?k:Promise.reject(k))}function K(R,Z,z){a.list().forEach(Q=>D(()=>Q(R,Z,z)))}function st(R,Z,z,Q,bt){const x=y(R,Z);if(x)return x;const C=Z===yn,k=Pr?history.state:{};z&&(Q||C?n.replace(R.fullPath,xt({scroll:C&&k&&k.scroll},bt)):n.push(R.fullPath,bt)),l.value=R,At(R,Z,z,C),Tt()}let G;function rt(){G||(G=n.listen((R,Z,z)=>{if(!Xt.listening)return;const Q=v(R),bt=A(Q);if(bt){O(xt(bt,{replace:!0,force:!0}),Q).catch(ji);return}c=Q;const x=l.value;Pr&&vy(Vu(x.fullPath,z.delta),rl()),Y(Q,x).catch(C=>Qs(C,12)?C:Qs(C,2)?(O(xt(_(C.to),{force:!0}),Q).then(k=>{Qs(k,20)&&!z.delta&&z.type===to.pop&&n.go(-1,!1)}).catch(ji),Promise.reject()):(z.delta&&n.go(-z.delta,!1),V(C,Q,x))).then(C=>{C=C||st(Q,x,!1),C&&(z.delta&&!Qs(C,8)?n.go(-z.delta,!1):z.type===to.pop&&Qs(C,20)&&n.go(-1,!1)),K(Q,x,C)}).catch(ji)}))}let ct=xi(),et=xi(),J;function V(R,Z,z){Tt(R);const Q=et.list();return Q.length?Q.forEach(bt=>bt(R,Z,z)):console.error(R),Promise.reject(R)}function pt(){return J&&l.value!==yn?Promise.resolve():new Promise((R,Z)=>{ct.add([R,Z])})}function Tt(R){return J||(J=!R,rt(),ct.list().forEach(([Z,z])=>R?z(R):Z()),ct.reset()),R}function At(R,Z,z,Q){const{scrollBehavior:bt}=r;if(!Pr||!bt)return Promise.resolve();const x=!z&&_y(Vu(R.fullPath,0))||(Q||!z)&&history.state&&history.state.scroll||null;return pr().then(()=>bt(R,Z,x)).then(C=>C&&my(C)).catch(C=>V(C,R,Z))}const B=R=>n.go(R);let N;const W=new Set,Xt={currentRoute:l,listening:!0,addRoute:d,removeRoute:p,clearRoutes:t.clearRoutes,hasRoute:m,getRoutes:g,resolve:v,options:r,push:b,replace:w,go:B,back:()=>B(-1),forward:()=>B(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:et.add,isReady:pt,install(R){const Z=this;R.component("RouterLink",Xy),R.component("RouterView",Gy),R.config.globalProperties.$router=Z,Object.defineProperty(R.config.globalProperties,"$route",{enumerable:!0,get:()=>Ze(l)}),Pr&&!N&&l.value===yn&&(N=!0,b(n.location).catch(bt=>{}));const z={};for(const bt in yn)Object.defineProperty(z,bt,{get:()=>l.value[bt],enumerable:!0});R.provide(il,Z),R.provide(Ig,Dd(z)),R.provide(Sc,l);const Q=R.unmount;W.add(R),R.unmount=function(){W.delete(R),W.size<1&&(c=yn,G&&G(),G=null,l.value=yn,N=!1,J=!1),Q()}}};function Rt(R){return R.reduce((Z,z)=>Z.then(()=>D(z)),Promise.resolve())}return Xt}function qy(r,t){const e=[],s=[],n=[],i=Math.max(t.matched.length,r.matched.length);for(let o=0;o<i;o++){const a=t.matched[o];a&&(r.matched.find(c=>Zr(c,a))?s.push(a):e.push(a));const l=r.matched[o];l&&(t.matched.find(c=>Zr(c,l))||n.push(l))}return[e,s,n]}function Ky(){return Xs(il)}const Jy={class:"toolbar"},Zy={class:"toolbar-center"},Qy=["onClick"],tb=["onClick"],eb={class:"toolbar-right"},sb={class:"frame-selector-container"},nb=["onClick"],rb=Ye({__name:"Toolbar",props:{canvasManager:{}},setup(r){const t=r,e=nt(null),s=nt(null),n=nt(!1),i=nt(!1),o=nt([]),a=()=>{var _;(_=t.canvasManager)==null||_.getModeManager().enterPresentMode()},l=()=>{t.canvasManager&&t.canvasManager.exportCanvasToJSON()},c=()=>{var _;(_=s.value)==null||_.click()},h=_=>{const y=_.target;if(y.files&&y.files[0]){const b=y.files[0],w=new FileReader;w.onload=A=>{var E;const O=(E=A.target)==null?void 0:E.result;O&&t.canvasManager&&t.canvasManager.importCanvasFromJSON(O),y.value=""},w.readAsText(b)}},u=()=>{window.open("/test-page","_blank")},f=()=>{if(!t.canvasManager)return;const _=t.canvasManager.getPageFrame(),y=t.canvasManager.getAllFrames(),b=[];_&&b.push(_),y&&y.length&&b.push(...y),o.value=b},d=_=>{t.canvasManager&&(t.canvasManager.navigateToFrame(_),i.value=!1)};ds(()=>t.canvasManager,_=>{_&&f()},{immediate:!0}),es(()=>{t.canvasManager&&f()});const p=[{name:"正方形",type:"square",options:{width:100,height:100,fill:"#fff"}},{name:"矩形",type:"rect",options:{width:150,height:100,fill:"#fff"}},{name:"三角形",type:"triangle",options:{width:100,height:100,fill:"#fff"}},{name:"圆形",type:"circle",options:{radius:50,fill:"#fff"}},{name:"直线",type:"line",options:{width:100,stroke:"#fff",strokeWidth:2}},{name:"箭头",type:"arrow",options:{width:100,stroke:"#fff",strokeWidth:2}}],g=(_,y)=>{var b,w,A;console.log("addShape",(b=t.canvasManager)==null?void 0:b.getControlsManager()),(A=(w=t.canvasManager)==null?void 0:w.getControlsManager())==null||A.addShape(_,y),n.value=!1},m=_=>{var b,w;const y=_.target;if(y.files&&y.files[0]){const A=y.files[0],O=URL.createObjectURL(A);(w=(b=t.canvasManager)==null?void 0:b.getControlsManager())==null||w.addImage(O),y.value=""}},v=nt([{id:2,name:"文本",action:()=>{var _,y;(y=(_=t.canvasManager)==null?void 0:_.getControlsManager())==null||y.addText()}},{id:3,name:"媒体",action:()=>{var _;yt.emit(ft.CONTROL_PANEL.OPEN,{type:ft.PANEL_TYPE.INSERT_IMAGE,canvas:(_=t.canvasManager)==null?void 0:_.getMainCanvas(),canvasManager:t.canvasManager,target:null,position:null})}},{id:4,name:"形状",action:()=>{n.value=!n.value}},{id:1,name:"动画",action:()=>console.log("select")}]);return(_,y)=>(ot(),ut("div",Jy,[y[2]||(y[2]=P("div",{class:"toolbar-left"},[P("div",{class:"logo"},"Next Slides")],-1)),P("div",Zy,[(ot(!0),ut(Ht,null,Qe(v.value,b=>(ot(),ut("div",{class:"tool-item",key:b.id},[P("button",{class:"tool-btn",onClick:b.action},Cs(b.name),9,Qy),b.id===4?mr((ot(),ut("div",{key:0,class:"shape-dropdown",onMouseleave:y[0]||(y[0]=w=>n.value=!1)},[(ot(),ut(Ht,null,Qe(p,w=>P("div",{key:w.type,class:"shape-item",onClick:A=>g(w.type,w.options)},Cs(w.name),9,tb)),64))],544)),[[Eu,n.value]]):pe("",!0)]))),128)),P("input",{type:"file",ref_key:"fileInput",ref:e,accept:".jpg,.jpeg,.png",style:{display:"none"},onChange:m},null,544)]),P("div",eb,[P("button",{class:"test-page-btn",onClick:u},"测试页面"),P("div",sb,[mr(P("div",{class:"frame-dropdown",onMouseleave:y[1]||(y[1]=b=>i.value=!1)},[(ot(!0),ut(Ht,null,Qe(o.value,(b,w)=>(ot(),ut("div",{key:b.id,class:"frame-item",onClick:A=>d(b)},Cs(w===0?"概览":`页面 ${w}`),9,nb))),128))],544),[[Eu,i.value]])]),P("button",{class:"save-btn",onClick:l},"导出"),P("button",{class:"import-btn",onClick:c},"导入"),P("button",{class:"preview-btn",onClick:a},"预览"),P("input",{type:"file",ref_key:"jsonFileInput",ref:s,accept:".json",style:{display:"none"},onChange:h},null,544)])]))}}),ib=vs(rb,[["__scopeId","data-v-23379791"]]);function T(r,t,e){return(t=function(s){var n=function(i,o){if(typeof i!="object"||!i)return i;var a=i[Symbol.toPrimitive];if(a!==void 0){var l=a.call(i,o);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(i)}(s,"string");return typeof n=="symbol"?n:n+""}(t))in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function of(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),e.push.apply(e,s)}return e}function S(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?of(Object(e),!0).forEach(function(s){T(r,s,e[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):of(Object(e)).forEach(function(s){Object.defineProperty(r,s,Object.getOwnPropertyDescriptor(e,s))})}return r}function It(r,t){if(r==null)return{};var e,s,n=function(o,a){if(o==null)return{};var l={};for(var c in o)if({}.hasOwnProperty.call(o,c)){if(a.indexOf(c)>=0)continue;l[c]=o[c]}return l}(r,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);for(s=0;s<i.length;s++)e=i[s],t.indexOf(e)>=0||{}.propertyIsEnumerable.call(r,e)&&(n[e]=r[e])}return n}function Vn(r,t){return t||(t=r.slice(0)),Object.freeze(Object.defineProperties(r,{raw:{value:Object.freeze(t)}}))}class af{constructor(){T(this,"browserShadowBlurConstant",1),T(this,"DPI",96),T(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),T(this,"perfLimitSizeTotal",2097152),T(this,"maxCacheSideLimit",4096),T(this,"minCacheSideLimit",256),T(this,"disableStyleCopyPaste",!1),T(this,"enableGLFiltering",!0),T(this,"textureSize",4096),T(this,"forceGLPutImageData",!1),T(this,"cachesBoundsOfCurve",!1),T(this,"fontPaths",{}),T(this,"NUM_FRACTION_DIGITS",4)}}const _t=new class extends af{constructor(r){super(),this.configure(r)}configure(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,r)}addFonts(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=S(S({},this.fontPaths),r)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(r=>{delete this.fontPaths[r]})}clearFonts(){this.fontPaths={}}restoreDefaults(r){const t=new af,e=(r==null?void 0:r.reduce((s,n)=>(s[n]=t[n],s),{}))||t;this.configure(e)}},jn=function(r){for(var t=arguments.length,e=new Array(t>1?t-1:0),s=1;s<t;s++)e[s-1]=arguments[s];return console[r]("fabric",...e)};class Ns extends Error{constructor(t,e){super("fabric: ".concat(t),e)}}class Bg extends Ns{constructor(t){super("".concat(t," 'options.signal' is in 'aborted' state"))}}class ob{}class ab extends ob{testPrecision(t,e){const s="precision ".concat(e,` float;
void main(){}`),n=t.createShader(t.FRAGMENT_SHADER);return!!n&&(t.shaderSource(n,s),t.compileShader(n),!!t.getShaderParameter(n,t.COMPILE_STATUS))}queryWebGL(t){const e=t.getContext("webgl");e&&(this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(s=>this.testPrecision(e,s)),e.getExtension("WEBGL_lose_context").loseContext(),jn("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(t){return!!this.maxTextureSize&&this.maxTextureSize>=t}}const lb={};let lf;const Ks=()=>lf||(lf={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new ab,dispose(){},copyPasteData:lb}),ui=()=>Ks().document,ol=()=>Ks().window,Ng=()=>{var r;return Math.max((r=_t.devicePixelRatio)!==null&&r!==void 0?r:ol().devicePixelRatio,1)},Bi=new class{constructor(){T(this,"charWidthsCache",{}),T(this,"boundsOfCurveCache",{})}getFontCache(r){let{fontFamily:t,fontStyle:e,fontWeight:s}=r;t=t.toLowerCase(),this.charWidthsCache[t]||(this.charWidthsCache[t]={});const n=this.charWidthsCache[t],i="".concat(e.toLowerCase(),"_").concat((s+"").toLowerCase());return n[i]||(n[i]={}),n[i]}clearFontCache(r){(r=(r||"").toLowerCase())?this.charWidthsCache[r]&&delete this.charWidthsCache[r]:this.charWidthsCache={}}limitDimsByArea(r){const{perfLimitSizeTotal:t}=_t,e=Math.sqrt(t*r);return[Math.floor(e),Math.floor(t/e)]}},Tc="6.6.1";function lr(){}const In=Math.PI/2,fn=2*Math.PI,xh=Math.PI/180,Ee=Object.freeze([1,0,0,1,0,0]),Ch=16,bn=.4477152502,gt="center",St="left",De="top",Oc="bottom",$t="right",Re="none",wh=/\r?\n/,Hg="moving",al="scaling",Yg="rotating",Sh="rotate",zg="skewing",eo="resizing",Xg="modifyPoly",cb="modifyPath",xa="changed",ll="scale",Ae="scaleX",ss="scaleY",fi="skewX",di="skewY",ee="fill",Le="stroke",Ca="modified",kr="json",jl="svg",q=new class{constructor(){this[kr]=new Map,this[jl]=new Map}has(r){return this[kr].has(r)}getClass(r){const t=this[kr].get(r);if(!t)throw new Ns("No class registered for ".concat(r));return t}setClass(r,t){t?this[kr].set(t,r):(this[kr].set(r.type,r),this[kr].set(r.type.toLowerCase(),r))}getSVGClass(r){return this[jl].get(r)}setSVGClass(r,t){this[jl].set(t??r.type.toLowerCase(),r)}},wa=new class extends Array{remove(r){const t=this.indexOf(r);t>-1&&this.splice(t,1)}cancelAll(){const r=this.splice(0);return r.forEach(t=>t.abort()),r}cancelByCanvas(r){if(!r)return[];const t=this.filter(e=>{var s;return e.target===r||typeof e.target=="object"&&((s=e.target)===null||s===void 0?void 0:s.canvas)===r});return t.forEach(e=>e.abort()),t}cancelByTarget(r){if(!r)return[];const t=this.filter(e=>e.target===r);return t.forEach(e=>e.abort()),t}};class hb{constructor(){T(this,"__eventListeners",{})}on(t,e){if(this.__eventListeners||(this.__eventListeners={}),typeof t=="object")return Object.entries(t).forEach(s=>{let[n,i]=s;this.on(n,i)}),()=>this.off(t);if(e){const s=t;return this.__eventListeners[s]||(this.__eventListeners[s]=[]),this.__eventListeners[s].push(e),()=>this.off(s,e)}return()=>!1}once(t,e){if(typeof t=="object"){const s=[];return Object.entries(t).forEach(n=>{let[i,o]=n;s.push(this.once(i,o))}),()=>s.forEach(n=>n())}if(e){const s=this.on(t,function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];e.call(this,...i),s()});return s}return()=>!1}_removeEventListener(t,e){if(this.__eventListeners[t])if(e){const s=this.__eventListeners[t],n=s.indexOf(e);n>-1&&s.splice(n,1)}else this.__eventListeners[t]=[]}off(t,e){if(this.__eventListeners)if(t===void 0)for(const s in this.__eventListeners)this._removeEventListener(s);else typeof t=="object"?Object.entries(t).forEach(s=>{let[n,i]=s;this._removeEventListener(n,i)}):this._removeEventListener(t,e)}fire(t,e){var s;if(!this.__eventListeners)return;const n=(s=this.__eventListeners[t])===null||s===void 0?void 0:s.concat();if(n)for(let i=0;i<n.length;i++)n[i].call(this,e||{})}}const er=(r,t)=>{const e=r.indexOf(t);return e!==-1&&r.splice(e,1),r},Os=r=>{if(r===0)return 1;switch(Math.abs(r)/In){case 1:case 3:return 0;case 2:return-1}return Math.cos(r)},ks=r=>{if(r===0)return 0;const t=r/In,e=Math.sign(r);switch(t){case 1:return e;case 2:return 0;case 3:return-e}return Math.sin(r)};class M{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof t=="object"?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e)}add(t){return new M(this.x+t.x,this.y+t.y)}addEquals(t){return this.x+=t.x,this.y+=t.y,this}scalarAdd(t){return new M(this.x+t,this.y+t)}scalarAddEquals(t){return this.x+=t,this.y+=t,this}subtract(t){return new M(this.x-t.x,this.y-t.y)}subtractEquals(t){return this.x-=t.x,this.y-=t.y,this}scalarSubtract(t){return new M(this.x-t,this.y-t)}scalarSubtractEquals(t){return this.x-=t,this.y-=t,this}multiply(t){return new M(this.x*t.x,this.y*t.y)}scalarMultiply(t){return new M(this.x*t,this.y*t)}scalarMultiplyEquals(t){return this.x*=t,this.y*=t,this}divide(t){return new M(this.x/t.x,this.y/t.y)}scalarDivide(t){return new M(this.x/t,this.y/t)}scalarDivideEquals(t){return this.x/=t,this.y/=t,this}eq(t){return this.x===t.x&&this.y===t.y}lt(t){return this.x<t.x&&this.y<t.y}lte(t){return this.x<=t.x&&this.y<=t.y}gt(t){return this.x>t.x&&this.y>t.y}gte(t){return this.x>=t.x&&this.y>=t.y}lerp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return e=Math.max(Math.min(1,e),0),new M(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)}distanceFrom(t){const e=this.x-t.x,s=this.y-t.y;return Math.sqrt(e*e+s*s)}midPointFrom(t){return this.lerp(t)}min(t){return new M(Math.min(this.x,t.x),Math.min(this.y,t.y))}max(t){return new M(Math.max(this.x,t.x),Math.max(this.y,t.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(t,e){return this.x=t,this.y=e,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setFromPoint(t){return this.x=t.x,this.y=t.y,this}swap(t){const e=this.x,s=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=s}clone(){return new M(this.x,this.y)}rotate(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Th;const s=ks(t),n=Os(t),i=this.subtract(e);return new M(i.x*n-i.y*s,i.x*s+i.y*n).add(e)}transform(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new M(t[0]*this.x+t[2]*this.y+(e?0:t[4]),t[1]*this.x+t[3]*this.y+(e?0:t[5]))}}const Th=new M(0,0),na=r=>!!r&&Array.isArray(r._objects);function Vg(r){class t extends r{constructor(){super(...arguments),T(this,"_objects",[])}_onObjectAdded(s){}_onObjectRemoved(s){}_onStackOrderChanged(s){}add(){for(var s=arguments.length,n=new Array(s),i=0;i<s;i++)n[i]=arguments[i];const o=this._objects.push(...n);return n.forEach(a=>this._onObjectAdded(a)),o}insertAt(s){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return this._objects.splice(s,0,...i),i.forEach(a=>this._onObjectAdded(a)),this._objects.length}remove(){const s=this._objects,n=[];for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return o.forEach(l=>{const c=s.indexOf(l);c!==-1&&(s.splice(c,1),n.push(l),this._onObjectRemoved(l))}),n}forEachObject(s){this.getObjects().forEach((n,i,o)=>s(n,i,o))}getObjects(){for(var s=arguments.length,n=new Array(s),i=0;i<s;i++)n[i]=arguments[i];return n.length===0?[...this._objects]:this._objects.filter(o=>o.isType(...n))}item(s){return this._objects[s]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(s,n){return!!this._objects.includes(s)||!!n&&this._objects.some(i=>i instanceof t&&i.contains(s,!0))}complexity(){return this._objects.reduce((s,n)=>s+=n.complexity?n.complexity():0,0)}sendObjectToBack(s){return!(!s||s===this._objects[0])&&(er(this._objects,s),this._objects.unshift(s),this._onStackOrderChanged(s),!0)}bringObjectToFront(s){return!(!s||s===this._objects[this._objects.length-1])&&(er(this._objects,s),this._objects.push(s),this._onStackOrderChanged(s),!0)}sendObjectBackwards(s,n){if(!s)return!1;const i=this._objects.indexOf(s);if(i!==0){const o=this.findNewLowerIndex(s,i,n);return er(this._objects,s),this._objects.splice(o,0,s),this._onStackOrderChanged(s),!0}return!1}bringObjectForward(s,n){if(!s)return!1;const i=this._objects.indexOf(s);if(i!==this._objects.length-1){const o=this.findNewUpperIndex(s,i,n);return er(this._objects,s),this._objects.splice(o,0,s),this._onStackOrderChanged(s),!0}return!1}moveObjectTo(s,n){return s!==this._objects[n]&&(er(this._objects,s),this._objects.splice(n,0,s),this._onStackOrderChanged(s),!0)}findNewLowerIndex(s,n,i){let o;if(i){o=n;for(let a=n-1;a>=0;--a)if(s.isOverlapping(this._objects[a])){o=a;break}}else o=n-1;return o}findNewUpperIndex(s,n,i){let o;if(i){o=n;for(let a=n+1;a<this._objects.length;++a)if(s.isOverlapping(this._objects[a])){o=a;break}}else o=n+1;return o}collectObjects(s){let{left:n,top:i,width:o,height:a}=s,{includeIntersecting:l=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const c=[],h=new M(n,i),u=h.add(new M(o,a));for(let f=this._objects.length-1;f>=0;f--){const d=this._objects[f];d.selectable&&d.visible&&(l&&d.intersectsWithRect(h,u)||d.isContainedWithinRect(h,u)||l&&d.containsPoint(h)||l&&d.containsPoint(u))&&c.push(d)}return c}}return t}class Wg extends hb{_setOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const e in t)this.set(e,t[e])}_setObject(t){for(const e in t)this._set(e,t[e])}set(t,e){return typeof t=="object"?this._setObject(t):this._set(t,e),this}_set(t,e){this[t]=e}toggle(t){const e=this.get(t);return typeof e=="boolean"&&this.set(t,!e),this}get(t){return this[t]}}function Ni(r){return ol().requestAnimationFrame(r)}function Ug(r){return ol().cancelAnimationFrame(r)}let ub=0;const Bn=()=>ub++,ms=()=>{const r=ui().createElement("canvas");if(!r||r.getContext===void 0)throw new Ns("Failed to create `canvas` element");return r},Gg=()=>ui().createElement("img"),Ms=r=>{const t=ms();return t.width=r.width,t.height=r.height,t},Oh=(r,t,e)=>r.toDataURL("image/".concat(t),e),kh=(r,t,e)=>new Promise((s,n)=>{r.toBlob(s,"image/".concat(t),e)}),Vt=r=>r*xh,Nn=r=>r/xh,$g=r=>r.every((t,e)=>t===Ee[e]),ue=(r,t,e)=>new M(r).transform(t,e),Ke=r=>{const t=1/(r[0]*r[3]-r[1]*r[2]),e=[t*r[3],-t*r[1],-t*r[2],t*r[0],0,0],{x:s,y:n}=new M(r[4],r[5]).transform(e,!0);return e[4]=-s,e[5]=-n,e},Wt=(r,t,e)=>[r[0]*t[0]+r[2]*t[1],r[1]*t[0]+r[3]*t[1],r[0]*t[2]+r[2]*t[3],r[1]*t[2]+r[3]*t[3],e?0:r[0]*t[4]+r[2]*t[5]+r[4],e?0:r[1]*t[4]+r[3]*t[5]+r[5]],cl=(r,t)=>r.reduceRight((e,s)=>s&&e?Wt(s,e,t):s||e,void 0)||Ee.concat(),qg=r=>{let[t,e]=r;return Math.atan2(e,t)},ti=r=>{const t=qg(r),e=Math.pow(r[0],2)+Math.pow(r[1],2),s=Math.sqrt(e),n=(r[0]*r[3]-r[2]*r[1])/s,i=Math.atan2(r[0]*r[2]+r[1]*r[3],e);return{angle:Nn(t),scaleX:s,scaleY:n,skewX:Nn(i),skewY:0,translateX:r[4]||0,translateY:r[5]||0}},gi=function(r){return[1,0,0,1,r,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function pi(){let{angle:r=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:t=0,y:e=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=Vt(r),n=Os(s),i=ks(s);return[n,i,-i,n,t?t-(n*t-i*e):0,e?e-(i*t+n*e):0]}const hl=function(r){return[r,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,0,0]},Kg=r=>Math.tan(Vt(r)),Mh=r=>[1,0,Kg(r),1,0,0],Eh=r=>[1,Kg(r),0,1,0,0],_o=r=>{let{scaleX:t=1,scaleY:e=1,flipX:s=!1,flipY:n=!1,skewX:i=0,skewY:o=0}=r,a=hl(s?-t:t,n?-e:e);return i&&(a=Wt(a,Mh(i),!0)),o&&(a=Wt(a,Eh(o),!0)),a},Jg=r=>{const{translateX:t=0,translateY:e=0,angle:s=0}=r;let n=gi(t,e);s&&(n=Wt(n,pi({angle:s})));const i=_o(r);return $g(i)||(n=Wt(n,i)),n},Hi=function(r){let{signal:t,crossOrigin:e=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(s,n){if(t&&t.aborted)return n(new Bg("loadImage"));const i=Gg();let o;t&&(o=function(l){i.src="",n(l)},t.addEventListener("abort",o,{once:!0}));const a=function(){i.onload=i.onerror=null,o&&(t==null||t.removeEventListener("abort",o)),s(i)};r?(i.onload=a,i.onerror=function(){o&&(t==null||t.removeEventListener("abort",o)),n(new Ns("Error loading ".concat(i.src)))},e&&(i.crossOrigin=e),i.src=r):a()})},ei=function(r){let{signal:t,reviver:e=lr}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((s,n)=>{const i=[];t&&t.addEventListener("abort",n,{once:!0}),Promise.all(r.map(o=>q.getClass(o.type).fromObject(o,{signal:t}).then(a=>(e(o,a),i.push(a),a)))).then(s).catch(o=>{i.forEach(a=>{a.dispose&&a.dispose()}),n(o)}).finally(()=>{t&&t.removeEventListener("abort",n)})})},yo=function(r){let{signal:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((e,s)=>{const n=[];t&&t.addEventListener("abort",s,{once:!0});const i=Object.values(r).map(a=>a&&a.type&&q.has(a.type)?ei([a],{signal:t}).then(l=>{let[c]=l;return n.push(c),c}):a),o=Object.keys(r);Promise.all(i).then(a=>a.reduce((l,c,h)=>(l[o[h]]=c,l),{})).then(e).catch(a=>{n.forEach(l=>{l.dispose&&l.dispose()}),s(a)}).finally(()=>{t&&t.removeEventListener("abort",s)})})},Cr=function(r){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((t,e)=>(e in r&&(t[e]=r[e]),t),{})},Ah=(r,t)=>Object.keys(r).reduce((e,s)=>(t(r[s],s,r)&&(e[s]=r[s]),e),{}),cf={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},Il=(r,t,e)=>(e<0&&(e+=1),e>1&&(e-=1),e<1/6?r+6*(t-r)*e:e<.5?t:e<2/3?r+(t-r)*(2/3-e)*6:r),hf=(r,t,e,s)=>{r/=255,t/=255,e/=255;const n=Math.max(r,t,e),i=Math.min(r,t,e);let o,a;const l=(n+i)/2;if(n===i)o=a=0;else{const c=n-i;switch(a=l>.5?c/(2-n-i):c/(n+i),n){case r:o=(t-e)/c+(t<e?6:0);break;case t:o=(e-r)/c+2;break;case e:o=(r-t)/c+4}o/=6}return[Math.round(360*o),Math.round(100*a),Math.round(100*l),s]},uf=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(r)/(r.endsWith("%")?100:1)},Oo=r=>Math.min(Math.round(r),255).toString(16).toUpperCase().padStart(2,"0"),ff=r=>{let[t,e,s,n=1]=r;const i=Math.round(.3*t+.59*e+.11*s);return[i,i,i,n]};class kt{constructor(t){if(T(this,"isUnrecognised",!1),t)if(t instanceof kt)this.setSource([...t._source]);else if(Array.isArray(t)){const[e,s,n,i=1]=t;this.setSource([e,s,n,i])}else this.setSource(this._tryParsingColor(t));else this.setSource([0,0,0,1])}_tryParsingColor(t){return(t=t.toLowerCase())in cf&&(t=cf[t]),t==="transparent"?[255,255,255,0]:kt.sourceFromHex(t)||kt.sourceFromRgb(t)||kt.sourceFromHsl(t)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(t){this._source=t}toRgb(){const[t,e,s]=this.getSource();return"rgb(".concat(t,",").concat(e,",").concat(s,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[t,e,s]=hf(...this.getSource());return"hsl(".concat(t,",").concat(e,"%,").concat(s,"%)")}toHsla(){const[t,e,s,n]=hf(...this.getSource());return"hsla(".concat(t,",").concat(e,"%,").concat(s,"%,").concat(n,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[t,e,s,n]=this.getSource();return"".concat(Oo(t)).concat(Oo(e)).concat(Oo(s)).concat(Oo(Math.round(255*n)))}getAlpha(){return this.getSource()[3]}setAlpha(t){return this._source[3]=t,this}toGrayscale(){return this.setSource(ff(this.getSource())),this}toBlackWhite(t){const[e,,,s]=ff(this.getSource()),n=e<(t||127)?0:255;return this.setSource([n,n,n,s]),this}overlayWith(t){t instanceof kt||(t=new kt(t));const e=this.getSource(),s=t.getSource(),[n,i,o]=e.map((a,l)=>Math.round(.5*a+.5*s[l]));return this.setSource([n,i,o,e[3]]),this}static fromRgb(t){return kt.fromRgba(t)}static fromRgba(t){return new kt(kt.sourceFromRgb(t))}static sourceFromRgb(t){const e=t.match(/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i);if(e){const[s,n,i]=e.slice(1,4).map(o=>{const a=parseFloat(o);return o.endsWith("%")?Math.round(2.55*a):a});return[s,n,i,uf(e[4])]}}static fromHsl(t){return kt.fromHsla(t)}static fromHsla(t){return new kt(kt.sourceFromHsl(t))}static sourceFromHsl(t){const e=t.match(/^hsla?\(\s*([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i);if(!e)return;const s=(kt.parseAngletoDegrees(e[1])%360+360)%360/360,n=parseFloat(e[2])/100,i=parseFloat(e[3])/100;let o,a,l;if(n===0)o=a=l=i;else{const c=i<=.5?i*(n+1):i+n-i*n,h=2*i-c;o=Il(h,c,s+1/3),a=Il(h,c,s),l=Il(h,c,s-1/3)}return[Math.round(255*o),Math.round(255*a),Math.round(255*l),uf(e[4])]}static fromHex(t){return new kt(kt.sourceFromHex(t))}static sourceFromHex(t){if(t.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const e=t.slice(t.indexOf("#")+1);let s;s=e.length<=4?e.split("").map(l=>l+l):e.match(/.{2}/g);const[n,i,o,a=255]=s.map(l=>parseInt(l,16));return[n,i,o,a/255]}}static parseAngletoDegrees(t){const e=t.toLowerCase(),s=parseFloat(e);return e.includes("rad")?Nn(s):e.includes("turn")?360*s:s}}const jt=(r,t)=>parseFloat(Number(r).toFixed(t)),cr=function(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ch;const e=/\D{0,2}$/.exec(r),s=parseFloat(r),n=_t.DPI;switch(e==null?void 0:e[0]){case"mm":return s*n/25.4;case"cm":return s*n/2.54;case"in":return s*n;case"pt":return s*n/72;case"pc":return s*n/72*12;case"em":return s*t;default:return s}},Zg=r=>{const[t,e]=r.trim().split(" "),[s,n]=(i=t)&&i!==Re?[i.slice(1,4),i.slice(5,8)]:i===Re?[i,i]:["Mid","Mid"];var i;return{meetOrSlice:e||"meet",alignX:s,alignY:n}},so=r=>"matrix("+r.map(t=>jt(t,_t.NUM_FRACTION_DIGITS)).join(" ")+")",no=function(r,t){let e,s,n=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(t)if(t.toLive)e="url(#SVGID_".concat(t.id,")");else{const i=new kt(t),o=i.getAlpha();e=i.toRgb(),o!==1&&(s=o.toString())}else e="none";return n?"".concat(r,": ").concat(e,"; ").concat(s?"".concat(r,"-opacity: ").concat(s,"; "):""):"".concat(r,'="').concat(e,'" ').concat(s?"".concat(r,'-opacity="').concat(s,'" '):"")},cs=r=>!!r&&r.toLive!==void 0,df=r=>!!r&&typeof r.toObject=="function",gf=r=>!!r&&r.offsetX!==void 0&&"source"in r,sr=r=>!!r&&"multiSelectionStacking"in r;function Qg(r){const t=r&&ys(r);let e=0,s=0;if(!r||!t)return{left:e,top:s};let n=r;const i=t.documentElement,o=t.body||{scrollLeft:0,scrollTop:0};for(;n&&(n.parentNode||n.host)&&(n=n.parentNode||n.host,n===t?(e=o.scrollLeft||i.scrollLeft||0,s=o.scrollTop||i.scrollTop||0):(e+=n.scrollLeft||0,s+=n.scrollTop||0),n.nodeType!==1||n.style.position!=="fixed"););return{left:e,top:s}}const ys=r=>r.ownerDocument||null,tp=r=>{var t;return((t=r.ownerDocument)===null||t===void 0?void 0:t.defaultView)||null},ep=function(r,t,e){let{width:s,height:n}=e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;r.width=s,r.height=n,i>1&&(r.setAttribute("width",(s*i).toString()),r.setAttribute("height",(n*i).toString()),t.scale(i,i))},kc=(r,t)=>{let{width:e,height:s}=t;e&&(r.style.width=typeof e=="number"?"".concat(e,"px"):e),s&&(r.style.height=typeof s=="number"?"".concat(s,"px"):s)};function pf(r){return r.onselectstart!==void 0&&(r.onselectstart=()=>!1),r.style.userSelect=Re,r}class sp{constructor(t){T(this,"_originalCanvasStyle",void 0),T(this,"lower",void 0);const e=this.createLowerCanvas(t);this.lower={el:e,ctx:e.getContext("2d")}}createLowerCanvas(t){const e=(s=t)&&s.getContext!==void 0?t:t&&ui().getElementById(t)||ms();var s;if(e.hasAttribute("data-fabric"))throw new Ns("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=e.style.cssText,e.setAttribute("data-fabric","main"),e.classList.add("lower-canvas"),e}cleanupDOM(t){let{width:e,height:s}=t;const{el:n}=this.lower;n.classList.remove("lower-canvas"),n.removeAttribute("data-fabric"),n.setAttribute("width","".concat(e)),n.setAttribute("height","".concat(s)),n.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(t,e){const{el:s,ctx:n}=this.lower;ep(s,n,t,e)}setCSSDimensions(t){kc(this.lower.el,t)}calcOffset(){return function(t){var e;const s=t&&ys(t),n={left:0,top:0};if(!s)return n;const i=((e=tp(t))===null||e===void 0?void 0:e.getComputedStyle(t,null))||{};n.left+=parseInt(i.borderLeftWidth,10)||0,n.top+=parseInt(i.borderTopWidth,10)||0,n.left+=parseInt(i.paddingLeft,10)||0,n.top+=parseInt(i.paddingTop,10)||0;let o={left:0,top:0};const a=s.documentElement;t.getBoundingClientRect!==void 0&&(o=t.getBoundingClientRect());const l=Qg(t);return{left:o.left+l.left-(a.clientLeft||0)+n.left,top:o.top+l.top-(a.clientTop||0)+n.top}}(this.lower.el)}dispose(){Ks().dispose(this.lower.el),delete this.lower}}const fb={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...Ee]};class bo extends Vg(Wg){get lowerCanvasEl(){var t;return(t=this.elements.lower)===null||t===void 0?void 0:t.el}get contextContainer(){var t;return(t=this.elements.lower)===null||t===void 0?void 0:t.ctx}static getDefaults(){return bo.ownDefaults}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(e),this.initElements(t),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(t){this.elements=new sp(t)}add(){const t=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),t}insertAt(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),n=1;n<e;n++)s[n-1]=arguments[n];const i=super.insertAt(t,...s);return s.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),i}remove(){const t=super.remove(...arguments);return t.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),t}_onObjectAdded(t){t.canvas&&t.canvas!==this&&(jn("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),t.canvas.remove(t)),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added",{target:this})}_onObjectRemoved(t){t._set("canvas",void 0),this.fire("object:removed",{target:t}),t.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?Ng():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(t,e){return this.setDimensions({width:t},e)}setHeight(t,e){return this.setDimensions({height:t},e)}_setDimensionsImpl(t){let{cssOnly:e=!1,backstoreOnly:s=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!e){const n=S({width:this.width,height:this.height},t);this.elements.setDimensions(n,this.getRetinaScaling()),this.hasLostContext=!0,this.width=n.width,this.height=n.height}s||this.elements.setCSSDimensions(t),this.calcOffset()}setDimensions(t,e){this._setDimensionsImpl(t,e),e&&e.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(t){this.viewportTransform=t,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(t,e){const s=t,n=[...this.viewportTransform],i=ue(t,Ke(n));n[0]=e,n[3]=e;const o=ue(i,n);n[4]+=s.x-o.x,n[5]+=s.y-o.y,this.setViewportTransform(n)}setZoom(t){this.zoomToPoint(new M(0,0),t)}absolutePan(t){const e=[...this.viewportTransform];return e[4]=-t.x,e[5]=-t.y,this.setViewportTransform(e)}relativePan(t){return this.absolutePan(new M(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(t){t.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=Ni(()=>this.renderAndReset()))}calcViewportBoundaries(){const t=this.width,e=this.height,s=Ke(this.viewportTransform),n=ue({x:0,y:0},s),i=ue({x:t,y:e},s),o=n.min(i),a=n.max(i);return this.vptCoords={tl:o,tr:new M(a.x,o.y),bl:new M(o.x,a.y),br:a}}cancelRequestedRender(){this.nextRenderHandle&&(Ug(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(t){}renderCanvas(t,e){if(this.destroyed)return;const s=this.viewportTransform,n=this.clipPath;this.calcViewportBoundaries(),this.clearContext(t),t.imageSmoothingEnabled=this.imageSmoothingEnabled,t.patternQuality="best",this.fire("before:render",{ctx:t}),this._renderBackground(t),t.save(),t.transform(s[0],s[1],s[2],s[3],s[4],s[5]),this._renderObjects(t,e),t.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(t),n&&(n._set("canvas",this),n.shouldCache(),n._transformDone=!0,n.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(t,n)),this._renderOverlay(t),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(t),this.fire("after:render",{ctx:t}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(t,e){const s=this.viewportTransform;t.save(),t.transform(...s),t.globalCompositeOperation="destination-in",e.transform(t),t.scale(1/e.zoomX,1/e.zoomY),t.drawImage(e._cacheCanvas,-e.cacheTranslationX,-e.cacheTranslationY),t.restore()}_renderObjects(t,e){for(let s=0,n=e.length;s<n;++s)e[s]&&e[s].render(t)}_renderBackgroundOrOverlay(t,e){const s=this["".concat(e,"Color")],n=this["".concat(e,"Image")],i=this.viewportTransform,o=this["".concat(e,"Vpt")];if(!s&&!n)return;const a=cs(s);if(s){if(t.save(),t.beginPath(),t.moveTo(0,0),t.lineTo(this.width,0),t.lineTo(this.width,this.height),t.lineTo(0,this.height),t.closePath(),t.fillStyle=a?s.toLive(t):s,o&&t.transform(...i),a){t.transform(1,0,0,1,s.offsetX||0,s.offsetY||0);const l=s.gradientTransform||s.patternTransform;l&&t.transform(...l)}t.fill(),t.restore()}if(n){t.save();const{skipOffscreen:l}=this;this.skipOffscreen=o,o&&t.transform(...i),n.render(t),this.skipOffscreen=l,t.restore()}}_renderBackground(t){this._renderBackgroundOrOverlay(t,"background")}_renderOverlay(t){this._renderBackgroundOrOverlay(t,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new M(this.width/2,this.height/2)}centerObjectH(t){return this._centerObject(t,new M(this.getCenterPoint().x,t.getCenterPoint().y))}centerObjectV(t){return this._centerObject(t,new M(t.getCenterPoint().x,this.getCenterPoint().y))}centerObject(t){return this._centerObject(t,this.getCenterPoint())}viewportCenterObject(t){return this._centerObject(t,this.getVpCenter())}viewportCenterObjectH(t){return this._centerObject(t,new M(this.getVpCenter().x,t.getCenterPoint().y))}viewportCenterObjectV(t){return this._centerObject(t,new M(t.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return ue(this.getCenterPoint(),Ke(this.viewportTransform))}_centerObject(t,e){t.setXY(e,gt,gt),t.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(t){return this.toDatalessObject(t)}toObject(t){return this._toObjectMethod("toObject",t)}toJSON(){return this.toObject()}toDatalessObject(t){return this._toObjectMethod("toDatalessObject",t)}_toObjectMethod(t,e){const s=this.clipPath,n=s&&!s.excludeFromExport?this._toObject(s,t,e):null;return S(S(S({version:Tc},Cr(this,e)),{},{objects:this._objects.filter(i=>!i.excludeFromExport).map(i=>this._toObject(i,t,e))},this.__serializeBgOverlay(t,e)),n?{clipPath:n}:null)}_toObject(t,e,s){let n;this.includeDefaultValues||(n=t.includeDefaultValues,t.includeDefaultValues=!1);const i=t[e](s);return this.includeDefaultValues||(t.includeDefaultValues=!!n),i}__serializeBgOverlay(t,e){const s={},n=this.backgroundImage,i=this.overlayImage,o=this.backgroundColor,a=this.overlayColor;return cs(o)?o.excludeFromExport||(s.background=o.toObject(e)):o&&(s.background=o),cs(a)?a.excludeFromExport||(s.overlay=a.toObject(e)):a&&(s.overlay=a),n&&!n.excludeFromExport&&(s.backgroundImage=this._toObject(n,t,e)),i&&!i.excludeFromExport&&(s.overlayImage=this._toObject(i,t,e)),s}toSVG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;t.reviver=e;const s=[];return this._setSVGPreamble(s,t),this._setSVGHeader(s,t),this.clipPath&&s.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(s,"background"),this._setSVGBgOverlayImage(s,"backgroundImage",e),this._setSVGObjects(s,e),this.clipPath&&s.push(`</g>
`),this._setSVGBgOverlayColor(s,"overlay"),this._setSVGBgOverlayImage(s,"overlayImage",e),s.push("</svg>"),s.join("")}_setSVGPreamble(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(t,e){const s=e.width||"".concat(this.width),n=e.height||"".concat(this.height),i=_t.NUM_FRACTION_DIGITS,o=e.viewBox;let a;if(o)a='viewBox="'.concat(o.x," ").concat(o.y," ").concat(o.width," ").concat(o.height,'" ');else if(this.svgViewportTransformation){const l=this.viewportTransform;a='viewBox="'.concat(jt(-l[4]/l[0],i)," ").concat(jt(-l[5]/l[3],i)," ").concat(jt(this.width/l[0],i)," ").concat(jt(this.height/l[3],i),'" ')}else a='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',s,'" ','height="',n,'" ',a,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",Tc,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(e),`</defs>
`)}createSVGClipPathMarkup(t){const e=this.clipPath;return e?(e.clipPathId="CLIPPATH_".concat(Bn()),'<clipPath id="'.concat(e.clipPathId,`" >
`).concat(e.toClipPathSVG(t.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map(t=>{const e=this["".concat(t,"Color")];if(cs(e)){const s=this["".concat(t,"Vpt")],n=this.viewportTransform,i={isType:()=>!1,width:this.width/(s?n[0]:1),height:this.height/(s?n[3]:1)};return e.toSVG(i,{additionalTransform:s?so(n):""})}}).join("")}createSVGFontFacesMarkup(){const t=[],e={},s=_t.fontPaths;this._objects.forEach(function i(o){t.push(o),na(o)&&o._objects.forEach(i)}),t.forEach(i=>{if(!(o=i)||typeof o._renderText!="function")return;var o;const{styles:a,fontFamily:l}=i;!e[l]&&s[l]&&(e[l]=!0,a&&Object.values(a).forEach(c=>{Object.values(c).forEach(h=>{let{fontFamily:u=""}=h;!e[u]&&s[u]&&(e[u]=!0)})}))});const n=Object.keys(e).map(i=>`		@font-face {
			font-family: '`.concat(i,`';
			src: url('`).concat(s[i],`');
		}
`)).join("");return n?`	<style type="text/css"><![CDATA[
`.concat(n,`]]></style>
`):""}_setSVGObjects(t,e){this.forEachObject(s=>{s.excludeFromExport||this._setSVGObject(t,s,e)})}_setSVGObject(t,e,s){t.push(e.toSVG(s))}_setSVGBgOverlayImage(t,e,s){const n=this[e];n&&!n.excludeFromExport&&n.toSVG&&t.push(n.toSVG(s))}_setSVGBgOverlayColor(t,e){const s=this["".concat(e,"Color")];if(s)if(cs(s)){const n=s.repeat||"",i=this.width,o=this.height,a=this["".concat(e,"Vpt")]?so(Ke(this.viewportTransform)):"";t.push('<rect transform="'.concat(a," translate(").concat(i/2,",").concat(o/2,')" x="').concat(s.offsetX-i/2,'" y="').concat(s.offsetY-o/2,'" width="').concat(n!=="repeat-y"&&n!=="no-repeat"||!gf(s)?i:s.source.width,'" height="').concat(n!=="repeat-x"&&n!=="no-repeat"||!gf(s)?o:s.source.height,'" fill="url(#SVGID_').concat(s.id,`)"></rect>
`))}else t.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',s,'"',`></rect>
`)}loadFromJSON(t,e){let{signal:s}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!t)return Promise.reject(new Ns("`json` is undefined"));const n=typeof t=="string"?JSON.parse(t):t,{objects:i=[],backgroundImage:o,background:a,overlayImage:l,overlay:c,clipPath:h}=n,u=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([ei(i,{reviver:e,signal:s}),yo({backgroundImage:o,backgroundColor:a,overlayImage:l,overlayColor:c,clipPath:h},{signal:s})]).then(f=>{let[d,p]=f;return this.clear(),this.add(...d),this.set(n),this.set(p),this.renderOnAddRemove=u,this})}clone(t){const e=this.toObject(t);return this.cloneWithoutData().loadFromJSON(e)}cloneWithoutData(){const t=Ms(this);return new this.constructor(t)}toDataURL(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:e="png",quality:s=1,multiplier:n=1,enableRetinaScaling:i=!1}=t,o=n*(i?this.getRetinaScaling():1);return Oh(this.toCanvasElement(o,t),e,s)}toBlob(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:e="png",quality:s=1,multiplier:n=1,enableRetinaScaling:i=!1}=t,o=n*(i?this.getRetinaScaling():1);return kh(this.toCanvasElement(o,t),e,s)}toCanvasElement(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:e,height:s,left:n,top:i,filter:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=(e||this.width)*t,l=(s||this.height)*t,c=this.getZoom(),h=this.width,u=this.height,f=this.skipControlsDrawing,d=c*t,p=this.viewportTransform,g=[d,0,0,d,(p[4]-(n||0))*t,(p[5]-(i||0))*t],m=this.enableRetinaScaling,v=Ms({width:a,height:l}),_=o?this._objects.filter(y=>o(y)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=g,this.width=a,this.height=l,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(v.getContext("2d"),_),this.viewportTransform=p,this.width=h,this.height=u,this.calcViewportBoundaries(),this.enableRetinaScaling=m,this.skipControlsDrawing=f,v}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),wa.cancelByCanvas(this),this.disposed=!0,new Promise((t,e)=>{const s=()=>{this.destroy(),t(!0)};s.kill=e,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?t(!1):this.nextRenderHandle?this.__cleanupTask=s:s()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(t=>t.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}}T(bo,"ownDefaults",fb);const db=["touchstart","touchmove","touchend"],np=r=>{const t=Qg(r.target),e=function(s){const n=s.changedTouches;return n&&n[0]?n[0]:s}(r);return new M(e.clientX+t.left,e.clientY+t.top)},Sa=r=>db.includes(r.type)||r.pointerType==="touch",Mc=r=>{r.preventDefault(),r.stopPropagation()},Vs=r=>{let t=0,e=0,s=0,n=0;for(let i=0,o=r.length;i<o;i++){const{x:a,y:l}=r[i];(a>s||!i)&&(s=a),(a<t||!i)&&(t=a),(l>n||!i)&&(n=l),(l<e||!i)&&(e=l)}return{left:t,top:e,width:s-t,height:n-e}},gb=["translateX","translateY","scaleX","scaleY"],rp=(r,t)=>si(r,Wt(t,r.calcOwnMatrix())),si=(r,t)=>{const e=ti(t),{translateX:s,translateY:n,scaleX:i,scaleY:o}=e,a=It(e,gb),l=new M(s,n);r.flipX=!1,r.flipY=!1,Object.assign(r,a),r.set({scaleX:i,scaleY:o}),r.setPositionByOrigin(l,gt,gt)},ip=r=>{r.scaleX=1,r.scaleY=1,r.skewX=0,r.skewY=0,r.flipX=!1,r.flipY=!1,r.rotate(0)},Ph=r=>({scaleX:r.scaleX,scaleY:r.scaleY,skewX:r.skewX,skewY:r.skewY,angle:r.angle,left:r.left,flipX:r.flipX,flipY:r.flipY,top:r.top}),ul=(r,t,e)=>{const s=r/2,n=t/2,i=[new M(-s,-n),new M(s,-n),new M(-s,n),new M(s,n)].map(a=>a.transform(e)),o=Vs(i);return new M(o.width,o.height)},xo=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ee;return Wt(Ke(arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ee),r)},un=function(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ee,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ee;return r.transform(xo(t,e))},op=function(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ee,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ee;return r.transform(xo(t,e),!0)},Ec=(r,t,e)=>{const s=xo(t,e);return si(r,Wt(s,r.calcOwnMatrix())),s},Fh=(r,t)=>{var e;const{transform:{target:s}}=t;(e=s.canvas)===null||e===void 0||e.fire("object:".concat(r),S(S({},t),{},{target:s})),s.fire(r,t)},pb={left:-.5,top:-.5,center:0,bottom:.5,right:.5},Zt=r=>typeof r=="string"?pb[r]:r-.5,Ta="not-allowed";function ap(r){return Zt(r.originX)===Zt(gt)&&Zt(r.originY)===Zt(gt)}function mf(r){return .5-Zt(r)}const Ss=(r,t)=>r[t],Dh=(r,t,e,s)=>({e:r,transform:t,pointer:new M(e,s)});function lp(r,t){const e=r.getTotalAngle()+Nn(Math.atan2(t.y,t.x))+360;return Math.round(e%360/45)}function fl(r,t,e,s,n){var i;let{target:o,corner:a}=r;const l=o.controls[a],c=((i=o.canvas)===null||i===void 0?void 0:i.getZoom())||1,h=o.padding/c,u=function(f,d,p,g){const m=f.getRelativeCenterPoint(),v=p!==void 0&&g!==void 0?f.translateToGivenOrigin(m,gt,gt,p,g):new M(f.left,f.top);return(f.angle?d.rotate(-Vt(f.angle),m):d).subtract(v)}(o,new M(s,n),t,e);return u.x>=h&&(u.x-=h),u.x<=-h&&(u.x+=h),u.y>=h&&(u.y-=h),u.y<=h&&(u.y+=h),u.x-=l.offsetX,u.y-=l.offsetY,u}const cp=(r,t,e,s)=>{const{target:n,offsetX:i,offsetY:o}=t,a=e-i,l=s-o,c=!Ss(n,"lockMovementX")&&n.left!==a,h=!Ss(n,"lockMovementY")&&n.top!==l;return c&&n.set(St,a),h&&n.set(De,l),(c||h)&&Fh(Hg,Dh(r,t,e,s)),c||h};class hp{getSvgStyles(t){const e=this.fillRule?this.fillRule:"nonzero",s=this.strokeWidth?this.strokeWidth:"0",n=this.strokeDashArray?this.strokeDashArray.join(" "):Re,i=this.strokeDashOffset?this.strokeDashOffset:"0",o=this.strokeLineCap?this.strokeLineCap:"butt",a=this.strokeLineJoin?this.strokeLineJoin:"miter",l=this.strokeMiterLimit?this.strokeMiterLimit:"4",c=this.opacity!==void 0?this.opacity:"1",h=this.visible?"":" visibility: hidden;",u=t?"":this.getSvgFilter(),f=no(ee,this.fill);return[no(Le,this.stroke),"stroke-width: ",s,"; ","stroke-dasharray: ",n,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",i,"; ","stroke-linejoin: ",a,"; ","stroke-miterlimit: ",l,"; ",f,"fill-rule: ",e,"; ","opacity: ",c,";",u,h].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const s=t?this.calcTransformMatrix():this.calcOwnMatrix(),n='transform="'.concat(so(s));return"".concat(n).concat(e,'" ')}_toSVG(t){return[""]}toSVG(t){return this._createBaseSVGMarkup(this._toSVG(t),{reviver:t})}toClipPathSVG(t){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(t),{reviver:t})}_createBaseClipPathSVGMarkup(t){let{reviver:e,additionalTransform:s=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=[this.getSvgTransform(!0,s),this.getSvgCommons()].join(""),i=t.indexOf("COMMON_PARTS");return t[i]=n,e?e(t.join("")):t.join("")}_createBaseSVGMarkup(t){let{noStyle:e,reviver:s,withShadow:n,additionalTransform:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=e?"":'style="'.concat(this.getSvgStyles(),'" '),a=n?'style="'.concat(this.getSvgFilter(),'" '):"",l=this.clipPath,c=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",h=l&&l.absolutePositioned,u=this.stroke,f=this.fill,d=this.shadow,p=[],g=t.indexOf("COMMON_PARTS");let m;l&&(l.clipPathId="CLIPPATH_".concat(Bn()),m='<clipPath id="'.concat(l.clipPathId,`" >
`).concat(l.toClipPathSVG(s),`</clipPath>
`)),h&&p.push("<g ",a,this.getSvgCommons(),` >
`),p.push("<g ",this.getSvgTransform(!1),h?"":a+this.getSvgCommons(),` >
`);const v=[o,c,e?"":this.addPaintOrder()," ",i?'transform="'.concat(i,'" '):""].join("");return t[g]=v,cs(f)&&p.push(f.toSVG(this)),cs(u)&&p.push(u.toSVG(this)),d&&p.push(d.toSVG(this)),l&&p.push(m),p.push(t.join("")),p.push(`</g>
`),h&&p.push(`</g>
`),s?s(p.join("")):p.join("")}addPaintOrder(){return this.paintFirst!==ee?' paint-order="'.concat(this.paintFirst,'" '):""}}function dl(r){return new RegExp("^("+r.join("|")+")\\b","i")}var vf;const _r=String.raw(vf||(vf=Vn(["(?:[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?)"],["(?:[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?)"]))),mb=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+_r+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+_r+"))?\\s+(.*)"),vb={cx:St,x:St,r:"radius",cy:De,y:De,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},Bl="font-size",Nl="clip-path";dl(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]);dl(["symbol","image","marker","pattern","view","svg"]);const _f=dl(["symbol","g","a","svg","clipPath","defs"]),_b=new M(1,0),up=new M,Rh=(r,t)=>r.rotate(t),Oa=(r,t)=>new M(t).subtract(r),ka=r=>r.distanceFrom(up),Ma=(r,t)=>Math.atan2(Xr(r,t),dp(r,t)),fp=r=>Ma(_b,r),gl=r=>r.eq(up)?r:r.scalarDivide(ka(r)),Lh=function(r){let t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return gl(new M(-r.y,r.x).scalarMultiply(t?1:-1))},Xr=(r,t)=>r.x*t.y-r.y*t.x,dp=(r,t)=>r.x*t.x+r.y*t.y,Ac=(r,t,e)=>{if(r.eq(t)||r.eq(e))return!0;const s=Xr(t,e),n=Xr(t,r),i=Xr(e,r);return s>=0?n>=0&&i<=0:!(n<=0&&i>=0)},yf="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",bf=new RegExp("(?:\\s|^)"+yf+yf+"("+_r+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class Ws{constructor(t){const e=typeof t=="string"?Ws.parseShadow(t):t;Object.assign(this,Ws.ownDefaults,e),this.id=Bn()}static parseShadow(t){const e=t.trim(),[,s=0,n=0,i=0]=(bf.exec(e)||[]).map(o=>parseFloat(o)||0);return{color:(e.replace(bf,"")||"rgb(0,0,0)").trim(),offsetX:s,offsetY:n,blur:i}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(t){const e=Rh(new M(this.offsetX,this.offsetY),Vt(-t.angle)),s=new kt(this.color);let n=40,i=40;return t.width&&t.height&&(n=100*jt((Math.abs(e.x)+this.blur)/t.width,_t.NUM_FRACTION_DIGITS)+20,i=100*jt((Math.abs(e.y)+this.blur)/t.height,_t.NUM_FRACTION_DIGITS)+20),t.flipX&&(e.x*=-1),t.flipY&&(e.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(i,'%" height="').concat(100+2*i,'%" x="-').concat(n,'%" width="').concat(100+2*n,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(jt(this.blur?this.blur/2:0,_t.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(jt(e.x,_t.NUM_FRACTION_DIGITS),'" dy="').concat(jt(e.y,_t.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(s.toRgb(),'" flood-opacity="').concat(s.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const t={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},e=Ws.ownDefaults;return this.includeDefaultValues?t:Ah(t,(s,n)=>s!==e[n])}static async fromObject(t){return new this(t)}}T(Ws,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),T(Ws,"type","shadow"),q.setClass(Ws,"shadow");const yr=(r,t,e)=>Math.max(r,Math.min(t,e)),yb=[De,St,Ae,ss,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",fi,di],vn=[ee,Le,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],bb={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:St,originY:De,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:ee,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},Hl=(r,t,e,s)=>(r<Math.abs(t)?(r=t,s=e/4):s=t===0&&r===0?e/fn*Math.asin(1):e/fn*Math.asin(t/r),{a:r,c:t,p:e,s}),xf=(r,t,e,s,n)=>r*Math.pow(2,10*(s-=1))*Math.sin((s*n-t)*fn/e),gp=(r,t,e,s)=>-e*Math.cos(r/s*In)+e+t,Pc=(r,t,e,s)=>(r/=s)<1/2.75?e*(7.5625*r*r)+t:r<2/2.75?e*(7.5625*(r-=1.5/2.75)*r+.75)+t:r<2.5/2.75?e*(7.5625*(r-=2.25/2.75)*r+.9375)+t:e*(7.5625*(r-=2.625/2.75)*r+.984375)+t,Cf=(r,t,e,s)=>e-Pc(s-r,0,e,s)+t;var xb=Object.freeze({__proto__:null,defaultEasing:gp,easeInBack:function(r,t,e,s){let n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return e*(r/=s)*r*((n+1)*r-n)+t},easeInBounce:Cf,easeInCirc:(r,t,e,s)=>-e*(Math.sqrt(1-(r/=s)*r)-1)+t,easeInCubic:(r,t,e,s)=>e*(r/s)**3+t,easeInElastic:(r,t,e,s)=>{const n=e;let i=0;if(r===0)return t;if((r/=s)===1)return t+e;i||(i=.3*s);const{a:o,s:a,p:l}=Hl(n,e,i,1.70158);return-xf(o,a,l,r,s)+t},easeInExpo:(r,t,e,s)=>r===0?t:e*2**(10*(r/s-1))+t,easeInOutBack:function(r,t,e,s){let n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return(r/=s/2)<1?e/2*(r*r*((1+(n*=1.525))*r-n))+t:e/2*((r-=2)*r*((1+(n*=1.525))*r+n)+2)+t},easeInOutBounce:(r,t,e,s)=>r<s/2?.5*Cf(2*r,0,e,s)+t:.5*Pc(2*r-s,0,e,s)+.5*e+t,easeInOutCirc:(r,t,e,s)=>(r/=s/2)<1?-e/2*(Math.sqrt(1-r**2)-1)+t:e/2*(Math.sqrt(1-(r-=2)*r)+1)+t,easeInOutCubic:(r,t,e,s)=>(r/=s/2)<1?e/2*r**3+t:e/2*((r-2)**3+2)+t,easeInOutElastic:(r,t,e,s)=>{const n=e;let i=0;if(r===0)return t;if((r/=s/2)===2)return t+e;i||(i=s*(.3*1.5));const{a:o,s:a,p:l,c}=Hl(n,e,i,1.70158);return r<1?-.5*xf(o,a,l,r,s)+t:o*Math.pow(2,-10*(r-=1))*Math.sin((r*s-a)*fn/l)*.5+c+t},easeInOutExpo:(r,t,e,s)=>r===0?t:r===s?t+e:(r/=s/2)<1?e/2*2**(10*(r-1))+t:e/2*-(2**(-10*--r)+2)+t,easeInOutQuad:(r,t,e,s)=>(r/=s/2)<1?e/2*r**2+t:-e/2*(--r*(r-2)-1)+t,easeInOutQuart:(r,t,e,s)=>(r/=s/2)<1?e/2*r**4+t:-e/2*((r-=2)*r**3-2)+t,easeInOutQuint:(r,t,e,s)=>(r/=s/2)<1?e/2*r**5+t:e/2*((r-2)**5+2)+t,easeInOutSine:(r,t,e,s)=>-e/2*(Math.cos(Math.PI*r/s)-1)+t,easeInQuad:(r,t,e,s)=>e*(r/=s)*r+t,easeInQuart:(r,t,e,s)=>e*(r/=s)*r**3+t,easeInQuint:(r,t,e,s)=>e*(r/s)**5+t,easeInSine:(r,t,e,s)=>-e*Math.cos(r/s*In)+e+t,easeOutBack:function(r,t,e,s){let n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return e*((r=r/s-1)*r*((n+1)*r+n)+1)+t},easeOutBounce:Pc,easeOutCirc:(r,t,e,s)=>e*Math.sqrt(1-(r=r/s-1)*r)+t,easeOutCubic:(r,t,e,s)=>e*((r/s-1)**3+1)+t,easeOutElastic:(r,t,e,s)=>{const n=e;let i=0;if(r===0)return t;if((r/=s)===1)return t+e;i||(i=.3*s);const{a:o,s:a,p:l,c}=Hl(n,e,i,1.70158);return o*2**(-10*r)*Math.sin((r*s-a)*fn/l)+c+t},easeOutExpo:(r,t,e,s)=>r===s?t+e:e*-(2**(-10*r/s)+1)+t,easeOutQuad:(r,t,e,s)=>-e*(r/=s)*(r-2)+t,easeOutQuart:(r,t,e,s)=>-e*((r=r/s-1)*r**3-1)+t,easeOutQuint:(r,t,e,s)=>e*((r/s-1)**5+1)+t,easeOutSine:(r,t,e,s)=>e*Math.sin(r/s*In)+t});const Cb=()=>!1;class jh{constructor(t){let{startValue:e,byValue:s,duration:n=500,delay:i=0,easing:o=gp,onStart:a=lr,onChange:l=lr,onComplete:c=lr,abort:h=Cb,target:u}=t;T(this,"_state","pending"),T(this,"durationProgress",0),T(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=n,this.delay=i,this.easing=o,this._onStart=a,this._onChange=l,this._onComplete=c,this._abort=h,this.target=u,this.startValue=e,this.byValue=s,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const t=e=>{this._state==="pending"&&(this.startTime=e||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>Ni(t),this.delay):Ni(t)}tick(t){const e=(t||+new Date)-this.startTime,s=Math.min(e,this.duration);this.durationProgress=s/this.duration;const{value:n,valueProgress:i}=this.calculate(s);this.value=Object.freeze(n),this.valueProgress=i,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):e>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),Ni(this.tick)))}register(){wa.push(this)}unregister(){wa.remove(this)}abort(){this._state="aborted",this.unregister()}}const wb=["startValue","endValue"];class Sb extends jh{constructor(t){let{startValue:e=0,endValue:s=100}=t;super(S(S({},It(t,wb)),{},{startValue:e,byValue:s-e}))}calculate(t){const e=this.easing(t,this.startValue,this.byValue,this.duration);return{value:e,valueProgress:Math.abs((e-this.startValue)/this.byValue)}}}const Tb=["startValue","endValue"];class Ob extends jh{constructor(t){let{startValue:e=[0],endValue:s=[100]}=t;super(S(S({},It(t,Tb)),{},{startValue:e,byValue:s.map((n,i)=>n-e[i])}))}calculate(t){const e=this.startValue.map((s,n)=>this.easing(t,s,this.byValue[n],this.duration,n));return{value:e,valueProgress:Math.abs((e[0]-this.startValue[0])/this.byValue[0])}}}const kb=["startValue","endValue","easing","onChange","onComplete","abort"],Mb=(r,t,e,s)=>t+e*(1-Math.cos(r/s*In)),Yl=r=>r&&((t,e,s)=>r(new kt(t).toRgba(),e,s));class Eb extends jh{constructor(t){let{startValue:e,endValue:s,easing:n=Mb,onChange:i,onComplete:o,abort:a}=t,l=It(t,kb);const c=new kt(e).getSource(),h=new kt(s).getSource();super(S(S({},l),{},{startValue:c,byValue:h.map((u,f)=>u-c[f]),easing:n,onChange:Yl(i),onComplete:Yl(o),abort:Yl(a)}))}calculate(t){const[e,s,n,i]=this.startValue.map((a,l)=>this.easing(t,a,this.byValue[l],this.duration,l)),o=[...[e,s,n].map(Math.round),yr(0,i,1)];return{value:o,valueProgress:o.map((a,l)=>this.byValue[l]!==0?Math.abs((a-this.startValue[l])/this.byValue[l]):0).find(a=>a!==0)||0}}}function Ih(r){const t=(e=>Array.isArray(e.startValue)||Array.isArray(e.endValue))(r)?new Ob(r):new Sb(r);return t.start(),t}function pp(r){const t=new Eb(r);return t.start(),t}class Bt{constructor(t){this.status=t,this.points=[]}includes(t){return this.points.some(e=>e.eq(t))}append(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.points=this.points.concat(e.filter(n=>!this.includes(n))),this}static isPointContained(t,e,s){let n=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(e.eq(s))return t.eq(e);if(e.x===s.x)return t.x===e.x&&(n||t.y>=Math.min(e.y,s.y)&&t.y<=Math.max(e.y,s.y));if(e.y===s.y)return t.y===e.y&&(n||t.x>=Math.min(e.x,s.x)&&t.x<=Math.max(e.x,s.x));{const i=Oa(e,s),o=Oa(e,t).divide(i);return n?Math.abs(o.x)===Math.abs(o.y):o.x===o.y&&o.x>=0&&o.x<=1}}static isPointInPolygon(t,e){const s=new M(t).setX(Math.min(t.x-1,...e.map(i=>i.x)));let n=0;for(let i=0;i<e.length;i++){const o=this.intersectSegmentSegment(e[i],e[(i+1)%e.length],t,s);if(o.includes(t))return!0;n+=+(o.status==="Intersection")}return n%2==1}static intersectLineLine(t,e,s,n){let i=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const a=e.x-t.x,l=e.y-t.y,c=n.x-s.x,h=n.y-s.y,u=t.x-s.x,f=t.y-s.y,d=c*f-h*u,p=a*f-l*u,g=h*a-c*l;if(g!==0){const m=d/g,v=p/g;return(i||0<=m&&m<=1)&&(o||0<=v&&v<=1)?new Bt("Intersection").append(new M(t.x+m*a,t.y+m*l)):new Bt}if(d===0||p===0){const m=i||o||Bt.isPointContained(t,s,n)||Bt.isPointContained(e,s,n)||Bt.isPointContained(s,t,e)||Bt.isPointContained(n,t,e);return new Bt(m?"Coincident":void 0)}return new Bt("Parallel")}static intersectSegmentLine(t,e,s,n){return Bt.intersectLineLine(t,e,s,n,!1,!0)}static intersectSegmentSegment(t,e,s,n){return Bt.intersectLineLine(t,e,s,n,!1,!1)}static intersectLinePolygon(t,e,s){let n=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const i=new Bt,o=s.length;for(let a,l,c,h=0;h<o;h++){if(a=s[h],l=s[(h+1)%o],c=Bt.intersectLineLine(t,e,a,l,n,!1),c.status==="Coincident")return c;i.append(...c.points)}return i.points.length>0&&(i.status="Intersection"),i}static intersectSegmentPolygon(t,e,s){return Bt.intersectLinePolygon(t,e,s,!1)}static intersectPolygonPolygon(t,e){const s=new Bt,n=t.length,i=[];for(let o=0;o<n;o++){const a=t[o],l=t[(o+1)%n],c=Bt.intersectSegmentPolygon(a,l,e);c.status==="Coincident"?(i.push(c),s.append(a,l)):s.append(...c.points)}return i.length>0&&i.length===t.length?new Bt("Coincident"):(s.points.length>0&&(s.status="Intersection"),s)}static intersectPolygonRectangle(t,e,s){const n=e.min(s),i=e.max(s),o=new M(i.x,n.y),a=new M(n.x,i.y);return Bt.intersectPolygonPolygon(t,[n,o,i,a])}}class Ab extends Wg{getX(){return this.getXY().x}setX(t){this.setXY(this.getXY().setX(t))}getY(){return this.getXY().y}setY(t){this.setXY(this.getXY().setY(t))}getRelativeX(){return this.left}setRelativeX(t){this.left=t}getRelativeY(){return this.top}setRelativeY(t){this.top=t}getXY(){const t=this.getRelativeXY();return this.group?ue(t,this.group.calcTransformMatrix()):t}setXY(t,e,s){this.group&&(t=ue(t,Ke(this.group.calcTransformMatrix()))),this.setRelativeXY(t,e,s)}getRelativeXY(){return new M(this.left,this.top)}setRelativeXY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(t,e,s)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:t,tr:e,br:s,bl:n}=this.aCoords||(this.aCoords=this.calcACoords()),i=[t,e,s,n];if(this.group){const o=this.group.calcTransformMatrix();return i.map(a=>ue(a,o))}return i}intersectsWithRect(t,e){return Bt.intersectPolygonRectangle(this.getCoords(),t,e).status==="Intersection"}intersectsWithObject(t){const e=Bt.intersectPolygonPolygon(this.getCoords(),t.getCoords());return e.status==="Intersection"||e.status==="Coincident"||t.isContainedWithinObject(this)||this.isContainedWithinObject(t)}isContainedWithinObject(t){return this.getCoords().every(e=>t.containsPoint(e))}isContainedWithinRect(t,e){const{left:s,top:n,width:i,height:o}=this.getBoundingRect();return s>=t.x&&s+i<=e.x&&n>=t.y&&n+o<=e.y}isOverlapping(t){return this.intersectsWithObject(t)||this.isContainedWithinObject(t)||t.isContainedWithinObject(this)}containsPoint(t){return Bt.isPointInPolygon(t,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:t,br:e}=this.canvas.vptCoords;return!!this.getCoords().some(s=>s.x<=e.x&&s.x>=t.x&&s.y<=e.y&&s.y>=t.y)||!!this.intersectsWithRect(t,e)||this.containsPoint(t.midPointFrom(e))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:t,br:e}=this.canvas.vptCoords;return this.intersectsWithRect(t,e)?!0:this.getCoords().every(s=>(s.x>=e.x||s.x<=t.x)&&(s.y>=e.y||s.y<=t.y))&&this.containsPoint(t.midPointFrom(e))}getBoundingRect(){return Vs(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(t){this._set(Ae,t),this._set(ss,t),this.setCoords()}scaleToWidth(t){const e=this.getBoundingRect().width/this.getScaledWidth();return this.scale(t/this.width/e)}scaleToHeight(t){const e=this.getBoundingRect().height/this.getScaledHeight();return this.scale(t/this.height/e)}getCanvasRetinaScaling(){var t;return((t=this.canvas)===null||t===void 0?void 0:t.getRetinaScaling())||1}getTotalAngle(){return this.group?Nn(qg(this.calcTransformMatrix())):this.angle}getViewportTransform(){var t;return((t=this.canvas)===null||t===void 0?void 0:t.viewportTransform)||Ee.concat()}calcACoords(){const t=pi({angle:this.angle}),{x:e,y:s}=this.getRelativeCenterPoint(),n=gi(e,s),i=Wt(n,t),o=this._getTransformedDimensions(),a=o.x/2,l=o.y/2;return{tl:ue({x:-a,y:-l},i),tr:ue({x:a,y:-l},i),bl:ue({x:-a,y:l},i),br:ue({x:a,y:l},i)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],e=[];return!t&&this.group&&(e=this.group.transformMatrixKey(t)),e.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,Zt(this.originX),Zt(this.originY)),e}calcTransformMatrix(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],e=this.calcOwnMatrix();if(t||!this.group)return e;const s=this.transformMatrixKey(t),n=this.matrixCache;return n&&n.key.every((i,o)=>i===s[o])?n.value:(this.group&&(e=Wt(this.group.calcTransformMatrix(!1),e)),this.matrixCache={key:s,value:e},e)}calcOwnMatrix(){const t=this.transformMatrixKey(!0),e=this.ownMatrixCache;if(e&&e.key===t)return e.value;const s=this.getRelativeCenterPoint(),n={angle:this.angle,translateX:s.x,translateY:s.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},i=Jg(n);return this.ownMatrixCache={key:t,value:i},i}_getNonTransformedDimensions(){return new M(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(t){return this._getTransformedDimensions(t).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=S({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},t),s=e.strokeWidth;let n=s,i=0;this.strokeUniform&&(n=0,i=s);const o=e.width+n,a=e.height+n;let l;return l=e.skewX===0&&e.skewY===0?new M(o*e.scaleX,a*e.scaleY):ul(o,a,_o(e)),l.scalarAdd(i)}translateToGivenOrigin(t,e,s,n,i){let o=t.x,a=t.y;const l=Zt(n)-Zt(e),c=Zt(i)-Zt(s);if(l||c){const h=this._getTransformedDimensions();o+=l*h.x,a+=c*h.y}return new M(o,a)}translateToCenterPoint(t,e,s){if(e===gt&&s===gt)return t;const n=this.translateToGivenOrigin(t,e,s,gt,gt);return this.angle?n.rotate(Vt(this.angle),t):n}translateToOriginPoint(t,e,s){const n=this.translateToGivenOrigin(t,gt,gt,e,s);return this.angle?n.rotate(Vt(this.angle),t):n}getCenterPoint(){const t=this.getRelativeCenterPoint();return this.group?ue(t,this.group.calcTransformMatrix()):t}getRelativeCenterPoint(){return this.translateToCenterPoint(new M(this.left,this.top),this.originX,this.originY)}getPointByOrigin(t,e){return this.translateToOriginPoint(this.getRelativeCenterPoint(),t,e)}setPositionByOrigin(t,e,s){const n=this.translateToCenterPoint(t,e,s),i=this.translateToOriginPoint(n,this.originX,this.originY);this.set({left:i.x,top:i.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),St,De)}}const Pb=["type"],Fb=["extraParam"];let tn=class ra extends Ab{static getDefaults(){return ra.ownDefaults}get type(){const t=this.constructor.type;return t==="FabricObject"?"object":t.toLowerCase()}set type(t){jn("warn","Setting type has no effect",t)}constructor(t){super(),T(this,"_cacheContext",null),Object.assign(this,ra.ownDefaults),this.setOptions(t)}_createCacheCanvas(){this._cacheCanvas=ms(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(t){const e=t.width,s=t.height,n=_t.maxCacheSideLimit,i=_t.minCacheSideLimit;if(e<=n&&s<=n&&e*s<=_t.perfLimitSizeTotal)return e<i&&(t.width=i),s<i&&(t.height=i),t;const o=e/s,[a,l]=Bi.limitDimsByArea(o),c=yr(i,a,n),h=yr(i,l,n);return e>c&&(t.zoomX/=e/c,t.width=c,t.capped=!0),s>h&&(t.zoomY/=s/h,t.height=h,t.capped=!0),t}_getCacheCanvasDimensions(){const t=this.getTotalObjectScaling(),e=this._getTransformedDimensions({skewX:0,skewY:0}),s=e.x*t.x/this.scaleX,n=e.y*t.y/this.scaleY;return{width:Math.ceil(s+2),height:Math.ceil(n+2),zoomX:t.x,zoomY:t.y,x:s,y:n}}_updateCacheCanvas(){const t=this._cacheCanvas,e=this._cacheContext,{width:s,height:n,zoomX:i,zoomY:o,x:a,y:l}=this._limitCacheSize(this._getCacheCanvasDimensions()),c=s!==t.width||n!==t.height,h=this.zoomX!==i||this.zoomY!==o;if(!t||!e)return!1;if(c||h){s!==t.width||n!==t.height?(t.width=s,t.height=n):(e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height));const u=a/2,f=l/2;return this.cacheTranslationX=Math.round(t.width/2-u)+u,this.cacheTranslationY=Math.round(t.height/2-f)+f,e.translate(this.cacheTranslationX,this.cacheTranslationY),e.scale(i,o),this.zoomX=i,this.zoomY=o,!0}return!1}setOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(t)}transform(t){const e=this.group&&!this.group._transformDone||this.group&&this.canvas&&t===this.canvas.contextTop,s=this.calcTransformMatrix(!e);t.transform(s[0],s[1],s[2],s[3],s[4],s[5])}getObjectScaling(){if(!this.group)return new M(Math.abs(this.scaleX),Math.abs(this.scaleY));const t=ti(this.calcTransformMatrix());return new M(Math.abs(t.scaleX),Math.abs(t.scaleY))}getTotalObjectScaling(){const t=this.getObjectScaling();if(this.canvas){const e=this.canvas.getZoom(),s=this.getCanvasRetinaScaling();return t.scalarMultiply(e*s)}return t}getObjectOpacity(){let t=this.opacity;return this.group&&(t*=this.group.getObjectOpacity()),t}_constrainScale(t){return Math.abs(t)<this.minScaleLimit?t<0?-this.minScaleLimit:this.minScaleLimit:t===0?1e-4:t}_set(t,e){t!==Ae&&t!==ss||(e=this._constrainScale(e)),t===Ae&&e<0?(this.flipX=!this.flipX,e*=-1):t==="scaleY"&&e<0?(this.flipY=!this.flipY,e*=-1):t!=="shadow"||!e||e instanceof Ws||(e=new Ws(e));const s=this[t]!==e;return this[t]=e,s&&this.constructor.cacheProperties.includes(t)&&(this.dirty=!0),this.parent&&(this.dirty||s&&this.constructor.stateProperties.includes(t))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(t){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(t.save(),this._setupCompositeOperation(t),this.drawSelectionBackground(t),this.transform(t),this._setOpacity(t),this._setShadow(t),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(t)):(this._removeCacheCanvas(),this.drawObject(t,!1,{}),this.dirty=!1),t.restore())}drawSelectionBackground(t){}renderCache(t){if(t=t||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:e,zoomY:s,cacheTranslationX:n,cacheTranslationY:i}=this,{width:o,height:a}=this._cacheCanvas;this.drawObject(this._cacheContext,t.forClipping,{zoomX:e,zoomY:s,cacheTranslationX:n,cacheTranslationY:i,width:o,height:a,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===Le&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(t,e,s){t.save(),e.inverted?t.globalCompositeOperation="destination-out":t.globalCompositeOperation="destination-in",t.setTransform(1,0,0,1,0,0),t.drawImage(s,0,0),t.restore()}drawObject(t,e,s){const n=this.fill,i=this.stroke;e?(this.fill="black",this.stroke="",this._setClippingProperties(t)):this._renderBackground(t),this._render(t),this._drawClipPath(t,this.clipPath,s),this.fill=n,this.stroke=i}createClipPathLayer(t,e){const s=Ms(e),n=s.getContext("2d");if(n.translate(e.cacheTranslationX,e.cacheTranslationY),n.scale(e.zoomX,e.zoomY),t._cacheCanvas=s,e.parentClipPaths.forEach(i=>{i.transform(n)}),e.parentClipPaths.push(t),t.absolutePositioned){const i=Ke(this.calcTransformMatrix());n.transform(i[0],i[1],i[2],i[3],i[4],i[5])}return t.transform(n),t.drawObject(n,!0,e),s}_drawClipPath(t,e,s){if(!e)return;e._transformDone=!0;const n=this.createClipPathLayer(e,s);this.drawClipPathOnCache(t,e,n)}drawCacheOnCanvas(t){t.scale(1/this.zoomX,1/this.zoomY),t.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const e=this._cacheCanvas,s=this._cacheContext;return!(!e||!s||t||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(e&&s&&!t&&(s.save(),s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,e.width,e.height),s.restore()),!0)}_renderBackground(t){if(!this.backgroundColor)return;const e=this._getNonTransformedDimensions();t.fillStyle=this.backgroundColor,t.fillRect(-e.x/2,-e.y/2,e.x,e.y),this._removeShadow(t)}_setOpacity(t){this.group&&!this.group._transformDone?t.globalAlpha=this.getObjectOpacity():t.globalAlpha*=this.opacity}_setStrokeStyles(t,e){const s=e.stroke;s&&(t.lineWidth=e.strokeWidth,t.lineCap=e.strokeLineCap,t.lineDashOffset=e.strokeDashOffset,t.lineJoin=e.strokeLineJoin,t.miterLimit=e.strokeMiterLimit,cs(s)?s.gradientUnits==="percentage"||s.gradientTransform||s.patternTransform?this._applyPatternForTransformedGradient(t,s):(t.strokeStyle=s.toLive(t),this._applyPatternGradientTransform(t,s)):t.strokeStyle=e.stroke)}_setFillStyles(t,e){let{fill:s}=e;s&&(cs(s)?(t.fillStyle=s.toLive(t),this._applyPatternGradientTransform(t,s)):t.fillStyle=s)}_setClippingProperties(t){t.globalAlpha=1,t.strokeStyle="transparent",t.fillStyle="#000000"}_setLineDash(t,e){e&&e.length!==0&&t.setLineDash(e)}_setShadow(t){if(!this.shadow)return;const e=this.shadow,s=this.canvas,n=this.getCanvasRetinaScaling(),[i,,,o]=(s==null?void 0:s.viewportTransform)||Ee,a=i*n,l=o*n,c=e.nonScaling?new M(1,1):this.getObjectScaling();t.shadowColor=e.color,t.shadowBlur=e.blur*_t.browserShadowBlurConstant*(a+l)*(c.x+c.y)/4,t.shadowOffsetX=e.offsetX*a*c.x,t.shadowOffsetY=e.offsetY*l*c.y}_removeShadow(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)}_applyPatternGradientTransform(t,e){if(!cs(e))return{offsetX:0,offsetY:0};const s=e.gradientTransform||e.patternTransform,n=-this.width/2+e.offsetX||0,i=-this.height/2+e.offsetY||0;return e.gradientUnits==="percentage"?t.transform(this.width,0,0,this.height,n,i):t.transform(1,0,0,1,n,i),s&&t.transform(s[0],s[1],s[2],s[3],s[4],s[5]),{offsetX:n,offsetY:i}}_renderPaintInOrder(t){this.paintFirst===Le?(this._renderStroke(t),this._renderFill(t)):(this._renderFill(t),this._renderStroke(t))}_render(t){}_renderFill(t){this.fill&&(t.save(),this._setFillStyles(t,this),this.fillRule==="evenodd"?t.fill("evenodd"):t.fill(),t.restore())}_renderStroke(t){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeUniform){const e=this.getObjectScaling();t.scale(1/e.x,1/e.y)}this._setLineDash(t,this.strokeDashArray),this._setStrokeStyles(t,this),t.stroke(),t.restore()}}_applyPatternForTransformedGradient(t,e){var s;const n=this._limitCacheSize(this._getCacheCanvasDimensions()),i=this.getCanvasRetinaScaling(),o=n.x/this.scaleX/i,a=n.y/this.scaleY/i,l=Ms({width:Math.ceil(o),height:Math.ceil(a)}),c=l.getContext("2d");c&&(c.beginPath(),c.moveTo(0,0),c.lineTo(o,0),c.lineTo(o,a),c.lineTo(0,a),c.closePath(),c.translate(o/2,a/2),c.scale(n.zoomX/this.scaleX/i,n.zoomY/this.scaleY/i),this._applyPatternGradientTransform(c,e),c.fillStyle=e.toLive(t),c.fill(),t.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),t.scale(i*this.scaleX/n.zoomX,i*this.scaleY/n.zoomY),t.strokeStyle=(s=c.createPattern(l,"no-repeat"))!==null&&s!==void 0?s:"")}_findCenterFromElement(){return new M(this.left+this.width/2,this.top+this.height/2)}clone(t){const e=this.toObject(t);return this.constructor.fromObject(e)}cloneAsImage(t){const e=this.toCanvasElement(t);return new(q.getClass("image"))(e)}toCanvasElement(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=Ph(this),s=this.group,n=this.shadow,i=Math.abs,o=t.enableRetinaScaling?Ng():1,a=(t.multiplier||1)*o,l=t.canvasProvider||(_=>new bo(_,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,t.withoutTransform&&ip(this),t.withoutShadow&&(this.shadow=null),t.viewportTransform&&Ec(this,this.getViewportTransform()),this.setCoords();const c=ms(),h=this.getBoundingRect(),u=this.shadow,f=new M;if(u){const _=u.blur,y=u.nonScaling?new M(1,1):this.getObjectScaling();f.x=2*Math.round(i(u.offsetX)+_)*i(y.x),f.y=2*Math.round(i(u.offsetY)+_)*i(y.y)}const d=h.width+f.x,p=h.height+f.y;c.width=Math.ceil(d),c.height=Math.ceil(p);const g=l(c);t.format==="jpeg"&&(g.backgroundColor="#fff"),this.setPositionByOrigin(new M(g.width/2,g.height/2),gt,gt);const m=this.canvas;g._objects=[this],this.set("canvas",g),this.setCoords();const v=g.toCanvasElement(a||1,t);return this.set("canvas",m),this.shadow=n,s&&(this.group=s),this.set(e),this.setCoords(),g._objects=[],g.destroy(),v}toDataURL(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Oh(this.toCanvasElement(t),t.format||"png",t.quality||1)}toBlob(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return kh(this.toCanvasElement(t),t.format||"png",t.quality||1)}isType(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return e.includes(this.constructor.type)||e.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(t){const{centeredRotation:e,originX:s,originY:n}=this;if(e){const{x:i,y:o}=this.getRelativeCenterPoint();this.originX=gt,this.originY=gt,this.left=i,this.top=o}if(this.set("angle",t),e){const{x:i,y:o}=this.translateToOriginPoint(this.getRelativeCenterPoint(),s,n);this.left=i,this.top=o,this.originX=s,this.originY=n}}setOnGroup(){}_setupCompositeOperation(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)}dispose(){wa.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&Ks().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(t,e){return Object.entries(t).reduce((s,n)=>{let[i,o]=n;return s[i]=this._animate(i,o,e),s},{})}_animate(t,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=t.split("."),i=this.constructor.colorProperties.includes(n[n.length-1]),{abort:o,startValue:a,onChange:l,onComplete:c}=s,h=S(S({},s),{},{target:this,startValue:a??n.reduce((u,f)=>u[f],this),endValue:e,abort:o==null?void 0:o.bind(this),onChange:(u,f,d)=>{n.reduce((p,g,m)=>(m===n.length-1&&(p[g]=u),p[g]),this),l&&l(u,f,d)},onComplete:(u,f,d)=>{this.setCoords(),c&&c(u,f,d)}});return i?pp(h):Ih(h)}isDescendantOf(t){const{parent:e,group:s}=this;return e===t||s===t||!!e&&e.isDescendantOf(t)||!!s&&s!==e&&s.isDescendantOf(t)}getAncestors(){const t=[];let e=this;do e=e.parent,e&&t.push(e);while(e);return t}findCommonAncestors(t){if(this===t)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const e=this.getAncestors(),s=t.getAncestors();if(e.length===0&&s.length>0&&this===s[s.length-1])return{fork:[],otherFork:[t,...s.slice(0,s.length-1)],common:[this]};for(let n,i=0;i<e.length;i++){if(n=e[i],n===t)return{fork:[this,...e.slice(0,i)],otherFork:[],common:e.slice(i)};for(let o=0;o<s.length;o++){if(this===s[o])return{fork:[],otherFork:[t,...s.slice(0,o)],common:[this,...e]};if(n===s[o])return{fork:[this,...e.slice(0,i)],otherFork:[t,...s.slice(0,o)],common:e.slice(i)}}}return{fork:[this,...e],otherFork:[t,...s],common:[]}}hasCommonAncestors(t){const e=this.findCommonAncestors(t);return e&&!!e.common.length}isInFrontOf(t){if(this===t)return;const e=this.findCommonAncestors(t);if(e.fork.includes(t))return!0;if(e.otherFork.includes(this))return!1;const s=e.common[0]||this.canvas;if(!s)return;const n=e.fork.pop(),i=e.otherFork.pop(),o=s._objects.indexOf(n),a=s._objects.indexOf(i);return o>-1&&o>a}toObject(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(ra.customProperties,this.constructor.customProperties||[]);let e;const s=_t.NUM_FRACTION_DIGITS,{clipPath:n,fill:i,stroke:o,shadow:a,strokeDashArray:l,left:c,top:h,originX:u,originY:f,width:d,height:p,strokeWidth:g,strokeLineCap:m,strokeDashOffset:v,strokeLineJoin:_,strokeUniform:y,strokeMiterLimit:b,scaleX:w,scaleY:A,angle:O,flipX:E,flipY:D,opacity:Y,visible:K,backgroundColor:st,fillRule:G,paintFirst:rt,globalCompositeOperation:ct,skewX:et,skewY:J}=this;n&&!n.excludeFromExport&&(e=n.toObject(t.concat("inverted","absolutePositioned")));const V=Tt=>jt(Tt,s),pt=S(S({},Cr(this,t)),{},{type:this.constructor.type,version:Tc,originX:u,originY:f,left:V(c),top:V(h),width:V(d),height:V(p),fill:df(i)?i.toObject():i,stroke:df(o)?o.toObject():o,strokeWidth:V(g),strokeDashArray:l&&l.concat(),strokeLineCap:m,strokeDashOffset:v,strokeLineJoin:_,strokeUniform:y,strokeMiterLimit:V(b),scaleX:V(w),scaleY:V(A),angle:V(O),flipX:E,flipY:D,opacity:V(Y),shadow:a&&a.toObject(),visible:K,backgroundColor:st,fillRule:G,paintFirst:rt,globalCompositeOperation:ct,skewX:V(et),skewY:V(J)},e?{clipPath:e}:null);return this.includeDefaultValues?pt:this._removeDefaultValues(pt)}toDatalessObject(t){return this.toObject(t)}_removeDefaultValues(t){const e=this.constructor.getDefaults(),s=Object.keys(e).length>0?e:Object.getPrototypeOf(this);return Ah(t,(n,i)=>{if(i===St||i===De||i==="type")return!0;const o=s[i];return n!==o&&!(Array.isArray(n)&&Array.isArray(o)&&n.length===0&&o.length===0)})}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(t){let e=It(t,Pb),s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:n}=s,i=It(s,Fb);return yo(e,i).then(o=>n?(delete o[n],new this(e[n],o)):new this(o))}static fromObject(t,e){return this._fromObject(t,e)}};T(tn,"stateProperties",yb),T(tn,"cacheProperties",vn),T(tn,"ownDefaults",bb),T(tn,"type","FabricObject"),T(tn,"colorProperties",[ee,Le,"backgroundColor"]),T(tn,"customProperties",[]),q.setClass(tn),q.setClass(tn,"object");const Wn=(r,t,e)=>(s,n,i,o)=>{const a=t(s,n,i,o);return a&&Fh(r,S(S({},Dh(s,n,i,o)),e)),a};function wr(r){return(t,e,s,n)=>{const{target:i,originX:o,originY:a}=e,l=i.getRelativeCenterPoint(),c=i.translateToOriginPoint(l,o,a),h=r(t,e,s,n);return i.setPositionByOrigin(c,e.originX,e.originY),h}}const Fc=Wn(eo,wr((r,t,e,s)=>{const n=fl(t,t.originX,t.originY,e,s);if(Zt(t.originX)===Zt(gt)||Zt(t.originX)===Zt($t)&&n.x<0||Zt(t.originX)===Zt(St)&&n.x>0){const{target:i}=t,o=i.strokeWidth/(i.strokeUniform?i.scaleX:1),a=ap(t)?2:1,l=i.width,c=Math.abs(n.x*a/i.scaleX)-o;return i.set("width",Math.max(c,1)),l!==i.width}return!1}));function mp(r,t,e,s,n){s=s||{};const i=this.sizeX||s.cornerSize||n.cornerSize,o=this.sizeY||s.cornerSize||n.cornerSize,a=s.transparentCorners!==void 0?s.transparentCorners:n.transparentCorners,l=a?Le:ee,c=!a&&(s.cornerStrokeColor||n.cornerStrokeColor);let h,u=t,f=e;r.save(),r.fillStyle=s.cornerColor||n.cornerColor||"",r.strokeStyle=s.cornerStrokeColor||n.cornerStrokeColor||"",i>o?(h=i,r.scale(1,o/i),f=e*i/o):o>i?(h=o,r.scale(i/o,1),u=t*o/i):h=i,r.beginPath(),r.arc(u,f,h/2,0,fn,!1),r[l](),c&&r.stroke(),r.restore()}function vp(r,t,e,s,n){s=s||{};const i=this.sizeX||s.cornerSize||n.cornerSize,o=this.sizeY||s.cornerSize||n.cornerSize,a=s.transparentCorners!==void 0?s.transparentCorners:n.transparentCorners,l=a?Le:ee,c=!a&&(s.cornerStrokeColor||n.cornerStrokeColor),h=i/2,u=o/2;r.save(),r.fillStyle=s.cornerColor||n.cornerColor||"",r.strokeStyle=s.cornerStrokeColor||n.cornerStrokeColor||"",r.translate(t,e);const f=n.getTotalAngle();r.rotate(Vt(f)),r["".concat(l,"Rect")](-h,-u,i,o),c&&r.strokeRect(-h,-u,i,o),r.restore()}class Ce{constructor(t){T(this,"visible",!0),T(this,"actionName",ll),T(this,"angle",0),T(this,"x",0),T(this,"y",0),T(this,"offsetX",0),T(this,"offsetY",0),T(this,"sizeX",0),T(this,"sizeY",0),T(this,"touchSizeX",0),T(this,"touchSizeY",0),T(this,"cursorStyle","crosshair"),T(this,"withConnection",!1),Object.assign(this,t)}shouldActivate(t,e,s,n){var i;let{tl:o,tr:a,br:l,bl:c}=n;return((i=e.canvas)===null||i===void 0?void 0:i.getActiveObject())===e&&e.isControlVisible(t)&&Bt.isPointInPolygon(s,[o,a,l,c])}getActionHandler(t,e,s){return this.actionHandler}getMouseDownHandler(t,e,s){return this.mouseDownHandler}getMouseUpHandler(t,e,s){return this.mouseUpHandler}cursorStyleHandler(t,e,s){return e.cursorStyle}getActionName(t,e,s){return e.actionName}getVisibility(t,e){var s,n;return(s=(n=t._controlsVisibility)===null||n===void 0?void 0:n[e])!==null&&s!==void 0?s:this.visible}setVisibility(t,e,s){this.visible=t}positionHandler(t,e,s,n){return new M(this.x*t.x+this.offsetX,this.y*t.y+this.offsetY).transform(e)}calcCornerCoords(t,e,s,n,i,o){const a=cl([gi(s,n),pi({angle:t}),hl((i?this.touchSizeX:this.sizeX)||e,(i?this.touchSizeY:this.sizeY)||e)]);return{tl:new M(-.5,-.5).transform(a),tr:new M(.5,-.5).transform(a),br:new M(.5,.5).transform(a),bl:new M(-.5,.5).transform(a)}}render(t,e,s,n,i){((n=n||{}).cornerStyle||i.cornerStyle)==="circle"?mp.call(this,t,e,s,n,i):vp.call(this,t,e,s,n,i)}}const _p=(r,t,e)=>e.lockRotation?Ta:t.cursorStyle,yp=Wn(Yg,wr((r,t,e,s)=>{let{target:n,ex:i,ey:o,theta:a,originX:l,originY:c}=t;const h=n.translateToOriginPoint(n.getRelativeCenterPoint(),l,c);if(Ss(n,"lockRotation"))return!1;const u=Math.atan2(o-h.y,i-h.x),f=Math.atan2(s-h.y,e-h.x);let d=Nn(f-u+a);if(n.snapAngle&&n.snapAngle>0){const g=n.snapAngle,m=n.snapThreshold||g,v=Math.ceil(d/g)*g,_=Math.floor(d/g)*g;Math.abs(d-_)<m?d=_:Math.abs(d-v)<m&&(d=v)}d<0&&(d=360+d),d%=360;const p=n.angle!==d;return n.angle=d,p}));function bp(r,t){const e=t.canvas,s=r[e.uniScaleKey];return e.uniformScaling&&!s||!e.uniformScaling&&s}function xp(r,t,e){const s=Ss(r,"lockScalingX"),n=Ss(r,"lockScalingY");if(s&&n||!t&&(s||n)&&e||s&&t==="x"||n&&t==="y")return!0;const{width:i,height:o,strokeWidth:a}=r;return i===0&&a===0&&t!=="y"||o===0&&a===0&&t!=="x"}const Db=["e","se","s","sw","w","nw","n","ne","e"],Fr=(r,t,e)=>{const s=bp(r,e);if(xp(e,t.x!==0&&t.y===0?"x":t.x===0&&t.y!==0?"y":"",s))return Ta;const n=lp(e,t);return"".concat(Db[n],"-resize")};function Bh(r,t,e,s){let n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const i=t.target,o=n.by,a=bp(r,i);let l,c,h,u,f,d;if(xp(i,o,a))return!1;if(t.gestureScale)c=t.scaleX*t.gestureScale,h=t.scaleY*t.gestureScale;else{if(l=fl(t,t.originX,t.originY,e,s),f=o!=="y"?Math.sign(l.x||t.signX||1):1,d=o!=="x"?Math.sign(l.y||t.signY||1):1,t.signX||(t.signX=f),t.signY||(t.signY=d),Ss(i,"lockScalingFlip")&&(t.signX!==f||t.signY!==d))return!1;if(u=i._getTransformedDimensions(),a&&!o){const m=Math.abs(l.x)+Math.abs(l.y),{original:v}=t,_=m/(Math.abs(u.x*v.scaleX/i.scaleX)+Math.abs(u.y*v.scaleY/i.scaleY));c=v.scaleX*_,h=v.scaleY*_}else c=Math.abs(l.x*i.scaleX/u.x),h=Math.abs(l.y*i.scaleY/u.y);ap(t)&&(c*=2,h*=2),t.signX!==f&&o!=="y"&&(t.originX=mf(t.originX),c*=-1,t.signX=f),t.signY!==d&&o!=="x"&&(t.originY=mf(t.originY),h*=-1,t.signY=d)}const p=i.scaleX,g=i.scaleY;return o?(o==="x"&&i.set(Ae,c),o==="y"&&i.set(ss,h)):(!Ss(i,"lockScalingX")&&i.set(Ae,c),!Ss(i,"lockScalingY")&&i.set(ss,h)),p!==i.scaleX||g!==i.scaleY}const Ti=Wn(al,wr((r,t,e,s)=>Bh(r,t,e,s))),Cp=Wn(al,wr((r,t,e,s)=>Bh(r,t,e,s,{by:"x"}))),wp=Wn(al,wr((r,t,e,s)=>Bh(r,t,e,s,{by:"y"}))),Rb=["target","ex","ey","skewingSide"],zl={x:{counterAxis:"y",scale:Ae,skew:fi,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:ss,skew:di,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},Lb=["ns","nesw","ew","nwse"],Sp=(r,t,e)=>{if(t.x!==0&&Ss(e,"lockSkewingY")||t.y!==0&&Ss(e,"lockSkewingX"))return Ta;const s=lp(e,t)%4;return"".concat(Lb[s],"-resize")};function Tp(r,t,e,s,n){const{target:i}=e,{counterAxis:o,origin:a,lockSkewing:l,skew:c,flip:h}=zl[r];if(Ss(i,l))return!1;const{origin:u,flip:f}=zl[o],d=Zt(e[u])*(i[f]?-1:1),p=-Math.sign(d)*(i[h]?-1:1),g=.5*-((i[c]===0&&fl(e,gt,gt,s,n)[r]>0||i[c]>0?1:-1)*p)+.5;return Wn(zg,wr((v,_,y,b)=>function(w,A,O){let{target:E,ex:D,ey:Y,skewingSide:K}=A,st=It(A,Rb);const{skew:G}=zl[w],rt=O.subtract(new M(D,Y)).divide(new M(E.scaleX,E.scaleY))[w],ct=E[G],et=st[G],J=Math.tan(Vt(et)),V=w==="y"?E._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:E._getTransformedDimensions({scaleX:1,scaleY:1}).y,pt=2*rt*K/Math.max(V,1)+J,Tt=Nn(Math.atan(pt));E.set(G,Tt);const At=ct!==E[G];if(At&&w==="y"){const{skewX:B,scaleX:N}=E,W=E._getTransformedDimensions({skewY:ct}),Xt=E._getTransformedDimensions(),Rt=B!==0?W.x/Xt.x:1;Rt!==1&&E.set(Ae,Rt*N)}return At}(r,_,new M(y,b))))(t,S(S({},e),{},{[a]:g,skewingSide:p}),s,n)}const Op=(r,t,e,s)=>Tp("x",r,t,e,s),kp=(r,t,e,s)=>Tp("y",r,t,e,s);function pl(r,t){return r[t.canvas.altActionKey]}const Oi=(r,t,e)=>{const s=pl(r,e);return t.x===0?s?fi:ss:t.y===0?s?di:Ae:""},ir=(r,t,e)=>pl(r,e)?Sp(0,t,e):Fr(r,t,e),Dc=(r,t,e,s)=>pl(r,t.target)?kp(r,t,e,s):Cp(r,t,e,s),Rc=(r,t,e,s)=>pl(r,t.target)?Op(r,t,e,s):wp(r,t,e,s),Nh=()=>({ml:new Ce({x:-.5,y:0,cursorStyleHandler:ir,actionHandler:Dc,getActionName:Oi}),mr:new Ce({x:.5,y:0,cursorStyleHandler:ir,actionHandler:Dc,getActionName:Oi}),mb:new Ce({x:0,y:.5,cursorStyleHandler:ir,actionHandler:Rc,getActionName:Oi}),mt:new Ce({x:0,y:-.5,cursorStyleHandler:ir,actionHandler:Rc,getActionName:Oi}),tl:new Ce({x:-.5,y:-.5,cursorStyleHandler:Fr,actionHandler:Ti}),tr:new Ce({x:.5,y:-.5,cursorStyleHandler:Fr,actionHandler:Ti}),bl:new Ce({x:-.5,y:.5,cursorStyleHandler:Fr,actionHandler:Ti}),br:new Ce({x:.5,y:.5,cursorStyleHandler:Fr,actionHandler:Ti}),mtr:new Ce({x:0,y:-.5,actionHandler:yp,cursorStyleHandler:_p,offsetY:-40,withConnection:!0,actionName:Sh})}),Mp=()=>({mr:new Ce({x:.5,y:0,actionHandler:Fc,cursorStyleHandler:ir,actionName:eo}),ml:new Ce({x:-.5,y:0,actionHandler:Fc,cursorStyleHandler:ir,actionName:eo})}),Ep=()=>S(S({},Nh()),Mp());class Fn extends tn{static getDefaults(){return S(S({},super.getDefaults()),Fn.ownDefaults)}constructor(t){super(),Object.assign(this,this.constructor.createControls(),Fn.ownDefaults),this.setOptions(t)}static createControls(){return{controls:Nh()}}_updateCacheCanvas(){const t=this.canvas;if(this.noScaleCache&&t&&t._currentTransform){const e=t._currentTransform,s=e.target,n=e.action;if(this===s&&n&&n.startsWith(ll))return!1}return super._updateCacheCanvas()}getActiveControl(){const t=this.__corner;return t?{key:t,control:this.controls[t],coord:this.oCoords[t]}:void 0}findControl(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const s=Object.entries(this.oCoords);for(let n=s.length-1;n>=0;n--){const[i,o]=s[n],a=this.controls[i];if(a.shouldActivate(i,this,t,e?o.touchCorner:o.corner))return this.__corner=i,{key:i,control:a,coord:this.oCoords[i]}}}calcOCoords(){const t=this.getViewportTransform(),e=this.getCenterPoint(),s=gi(e.x,e.y),n=pi({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),i=Wt(s,n),o=Wt(t,i),a=Wt(o,[1/t[0],0,0,1/t[3],0,0]),l=this.group?ti(this.calcTransformMatrix()):void 0;l&&(l.scaleX=Math.abs(l.scaleX),l.scaleY=Math.abs(l.scaleY));const c=this._calculateCurrentDimensions(l),h={};return this.forEachControl((u,f)=>{const d=u.positionHandler(c,a,this,u);h[f]=Object.assign(d,this._calcCornerCoords(u,d))}),h}_calcCornerCoords(t,e){const s=this.getTotalAngle();return{corner:t.calcCornerCoords(s,this.cornerSize,e.x,e.y,!1,this),touchCorner:t.calcCornerCoords(s,this.touchCornerSize,e.x,e.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(t){for(const e in this.controls)t(this.controls[e],e,this)}drawSelectionBackground(t){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;t.save();const e=this.getRelativeCenterPoint(),s=this._calculateCurrentDimensions(),n=this.getViewportTransform();t.translate(e.x,e.y),t.scale(1/n[0],1/n[3]),t.rotate(Vt(this.angle)),t.fillStyle=this.selectionBackgroundColor,t.fillRect(-s.x/2,-s.y/2,s.x,s.y),t.restore()}strokeBorders(t,e){t.strokeRect(-e.x/2,-e.y/2,e.x,e.y)}_drawBorders(t,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=S({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},s);t.save(),t.strokeStyle=n.borderColor,this._setLineDash(t,n.borderDashArray),this.strokeBorders(t,e),n.hasControls&&this.drawControlsConnectingLines(t,e),t.restore()}_renderControls(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:s,hasControls:n}=this,i=S({hasBorders:s,hasControls:n},e),o=this.getViewportTransform(),a=i.hasBorders,l=i.hasControls,c=Wt(o,this.calcTransformMatrix()),h=ti(c);t.save(),t.translate(h.translateX,h.translateY),t.lineWidth=this.borderScaleFactor,this.group===this.parent&&(t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(h.angle-=180),t.rotate(Vt(this.group?h.angle:this.angle)),a&&this.drawBorders(t,h,e),l&&this.drawControls(t,e),t.restore()}drawBorders(t,e,s){let n;if(s&&s.forActiveSelection||this.group){const i=ul(this.width,this.height,_o(e)),o=this.isStrokeAccountedForInDimensions()?Th:(this.strokeUniform?new M().scalarAdd(this.canvas?this.canvas.getZoom():1):new M(e.scaleX,e.scaleY)).scalarMultiply(this.strokeWidth);n=i.add(o).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else n=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(t,n,s)}drawControlsConnectingLines(t,e){let s=!1;t.beginPath(),this.forEachControl((n,i)=>{n.withConnection&&n.getVisibility(this,i)&&(s=!0,t.moveTo(n.x*e.x,n.y*e.y),t.lineTo(n.x*e.x+n.offsetX,n.y*e.y+n.offsetY))}),s&&t.stroke()}drawControls(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t.save();const s=this.getCanvasRetinaScaling(),{cornerStrokeColor:n,cornerDashArray:i,cornerColor:o}=this,a=S({cornerStrokeColor:n,cornerDashArray:i,cornerColor:o},e);t.setTransform(s,0,0,s,0,0),t.strokeStyle=t.fillStyle=a.cornerColor,this.transparentCorners||(t.strokeStyle=a.cornerStrokeColor),this._setLineDash(t,a.cornerDashArray),this.forEachControl((l,c)=>{if(l.getVisibility(this,c)){const h=this.oCoords[c];l.render(t,h.x,h.y,a,this)}}),t.restore()}isControlVisible(t){return this.controls[t]&&this.controls[t].getVisibility(this,t)}setControlVisible(t,e){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[t]=e}setControlsVisibility(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(t).forEach(e=>{let[s,n]=e;return this.setControlVisible(s,n)})}clearContextTop(t){if(!this.canvas)return;const e=this.canvas.contextTop;if(!e)return;const s=this.canvas.viewportTransform;e.save(),e.transform(s[0],s[1],s[2],s[3],s[4],s[5]),this.transform(e);const n=this.width+4,i=this.height+4;return e.clearRect(-n/2,-i/2,n,i),t||e.restore(),e}onDeselect(t){return!1}onSelect(t){return!1}shouldStartDragging(t){return!1}onDragStart(t){return!1}canDrop(t){return!1}renderDragSourceEffect(t){}renderDropTargetEffect(t){}}function Ap(r,t){return t.forEach(e=>{Object.getOwnPropertyNames(e.prototype).forEach(s=>{s!=="constructor"&&Object.defineProperty(r.prototype,s,Object.getOwnPropertyDescriptor(e.prototype,s)||Object.create(null))})}),r}T(Fn,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class ne extends Fn{}Ap(ne,[hp]),q.setClass(ne),q.setClass(ne,"object");const Pp=(r,t,e,s)=>{const n=2*(s=Math.round(s))+1,{data:i}=r.getImageData(t-s,e-s,n,n);for(let o=3;o<i.length;o+=4)if(i[o]>0)return!1;return!0};class Fp{constructor(t){this.options=t,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new M(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new M(1/this.options.scaleX,1/this.options.scaleY):new M(1,1)}createSideVector(t,e){const s=Oa(t,e);return this.options.strokeUniform?s.multiply(this.scale):s}projectOrthogonally(t,e,s){return this.applySkew(t.add(this.calcOrthogonalProjection(t,e,s)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(t){const e=new M(t);return e.y+=e.x*Math.tan(Vt(this.options.skewY)),e.x+=e.y*Math.tan(Vt(this.options.skewX)),e}scaleUnitVector(t,e){return t.multiply(this.strokeUniformScalar).scalarMultiply(e)}}const jb=new M;class Vr extends Fp{static getOrthogonalRotationFactor(t,e){const s=e?Ma(t,e):fp(t);return Math.abs(s)<In?-1:1}constructor(t,e,s,n){super(n),T(this,"AB",void 0),T(this,"AC",void 0),T(this,"alpha",void 0),T(this,"bisector",void 0),this.A=new M(t),this.B=new M(e),this.C=new M(s),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=Ma(this.AB,this.AC),this.bisector=gl(Rh(this.AB.eq(jb)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(t,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const n=this.createSideVector(t,e),i=Lh(n),o=Vr.getOrthogonalRotationFactor(i,this.bisector);return this.scaleUnitVector(i,s*o)}projectBevel(){const t=[];return(this.alpha%fn==0?[this.B]:[this.B,this.C]).forEach(e=>{t.push(this.projectOrthogonally(this.A,e)),t.push(this.projectOrthogonally(this.A,e,-this.strokeProjectionMagnitude))}),t}projectMiter(){const t=[],e=Math.abs(this.alpha),s=1/Math.sin(e/2),n=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*s),i=this.options.strokeUniform?ka(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return ka(n)/this.strokeProjectionMagnitude<=i&&t.push(this.applySkew(this.A.add(n))),t.push(...this.projectBevel()),t}projectRoundNoSkew(t,e){const s=[],n=new M(Vr.getOrthogonalRotationFactor(this.bisector),Vr.getOrthogonalRotationFactor(new M(this.bisector.y,this.bisector.x)));return[new M(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(n),new M(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(n)].forEach(i=>{Ac(i,t,e)&&s.push(this.A.add(i))}),s}projectRoundWithSkew(t,e){const s=[],{skewX:n,skewY:i,scaleX:o,scaleY:a,strokeUniform:l}=this.options,c=new M(Math.tan(Vt(n)),Math.tan(Vt(i))),h=this.strokeProjectionMagnitude,u=l?h/a/Math.sqrt(1/a**2+1/o**2*c.y**2):h/Math.sqrt(1+c.y**2),f=new M(Math.sqrt(Math.max(h**2-u**2,0)),u),d=l?h/Math.sqrt(1+c.x**2*(1/a)**2/(1/o+1/o*c.x*c.y)**2):h/Math.sqrt(1+c.x**2/(1+c.x*c.y)**2),p=new M(d,Math.sqrt(Math.max(h**2-d**2,0)));return[p,p.scalarMultiply(-1),f,f.scalarMultiply(-1)].map(g=>this.applySkew(l?g.multiply(this.strokeUniformScalar):g)).forEach(g=>{Ac(g,t,e)&&s.push(this.applySkew(this.A).add(g))}),s}projectRound(){const t=[];t.push(...this.projectBevel());const e=this.alpha%fn==0,s=this.applySkew(this.A),n=t[e?0:2].subtract(s),i=t[e?1:0].subtract(s),o=e?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),a=Xr(n,o)>0,l=a?n:i,c=a?i:n;return this.isSkewed()?t.push(...this.projectRoundWithSkew(l,c)):t.push(...this.projectRoundNoSkew(l,c)),t}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(t=>({originPoint:this.A,projectedPoint:t,angle:this.alpha,bisector:this.bisector}))}}class wf extends Fp{constructor(t,e,s){super(s),this.A=new M(t),this.T=new M(e)}calcOrthogonalProjection(t,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const n=this.createSideVector(t,e);return this.scaleUnitVector(Lh(n),s)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const t=[];if(!this.isSkewed()&&this.A.eq(this.T)){const e=new M(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);t.push(this.applySkew(this.A.add(e)),this.applySkew(this.A.subtract(e)))}else t.push(...new Vr(this.A,this.T,this.T,this.options).projectRound());return t}projectSquare(){const t=[];if(this.A.eq(this.T)){const e=new M(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);t.push(this.A.add(e),this.A.subtract(e))}else{const e=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),s=this.scaleUnitVector(gl(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),n=this.A.add(s);t.push(n.add(e),n.subtract(e))}return t.map(e=>this.applySkew(e))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(t=>({originPoint:this.A,projectedPoint:t}))}}const Dp=function(r,t){let e=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const s=[];if(r.length===0)return s;const n=r.reduce((i,o)=>(i[i.length-1].eq(o)||i.push(new M(o)),i),[new M(r[0])]);if(n.length===1)e=!0;else if(!e){const i=n[0],o=((a,l)=>{for(let c=a.length-1;c>=0;c--)if(l(a[c],c,a))return c;return-1})(n,a=>!a.eq(i));n.splice(o+1)}return n.forEach((i,o,a)=>{let l,c;o===0?(c=a[1],l=e?i:a[a.length-1]):o===a.length-1?(l=a[o-1],c=e?i:a[0]):(l=a[o-1],c=a[o+1]),e&&a.length===1?s.push(...new wf(i,i,t).project()):!e||o!==0&&o!==a.length-1?s.push(...new Vr(i,l,c,t).project()):s.push(...new wf(i,o===0?c:l,t).project())}),s},Hh=r=>{const t={};return Object.keys(r).forEach(e=>{t[e]={},Object.keys(r[e]).forEach(s=>{t[e][s]=S({},r[e][s])})}),t},Rp=r=>r.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),ml=r=>{const t=[];for(let e,s=0;s<r.length;s++)(e=Ib(r,s))!==!1&&t.push(e);return t},Ib=(r,t)=>{const e=r.charCodeAt(t);if(isNaN(e))return"";if(e<55296||e>57343)return r.charAt(t);if(55296<=e&&e<=56319){if(r.length<=t+1)throw"High surrogate without following low surrogate";const n=r.charCodeAt(t+1);if(56320>n||n>57343)throw"High surrogate without following low surrogate";return r.charAt(t)+r.charAt(t+1)}if(t===0)throw"Low surrogate without preceding high surrogate";const s=r.charCodeAt(t-1);if(55296>s||s>56319)throw"Low surrogate without preceding high surrogate";return!1};var Bb=Object.freeze({__proto__:null,capitalize:function(r){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return"".concat(r.charAt(0).toUpperCase()).concat(t?r.slice(1):r.slice(1).toLowerCase())},escapeXml:Rp,graphemeSplit:ml});const vl=function(r,t){let e=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return r.fill!==t.fill||r.stroke!==t.stroke||r.strokeWidth!==t.strokeWidth||r.fontSize!==t.fontSize||r.fontFamily!==t.fontFamily||r.fontWeight!==t.fontWeight||r.fontStyle!==t.fontStyle||r.textBackgroundColor!==t.textBackgroundColor||r.deltaY!==t.deltaY||e&&(r.overline!==t.overline||r.underline!==t.underline||r.linethrough!==t.linethrough)},Lp=(r,t)=>{const e=t.split(`
`),s=[];let n=-1,i={};r=Hh(r);for(let o=0;o<e.length;o++){const a=ml(e[o]);if(r[o])for(let l=0;l<a.length;l++){n++;const c=r[o][l];c&&Object.keys(c).length>0&&(vl(i,c,!0)?s.push({start:n,end:n+1,style:c}):s[s.length-1].end++),i=c||{}}else n+=a.length,i={}}return s},jp=(r,t)=>{if(!Array.isArray(r))return Hh(r);const e=t.split(wh),s={};let n=-1,i=0;for(let o=0;o<e.length;o++){const a=ml(e[o]);for(let l=0;l<a.length;l++)n++,r[i]&&r[i].start<=n&&n<r[i].end&&(s[o]=s[o]||{},s[o][l]=S({},r[i].style),n===r[i].end-1&&i++)}return s},Un=["display","transform",ee,"fill-opacity","fill-rule","opacity",Le,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function Sf(r,t){const e=r.nodeName,s=r.getAttribute("class"),n=r.getAttribute("id"),i="(?![a-zA-Z\\-]+)";let o;if(o=new RegExp("^"+e,"i"),t=t.replace(o,""),n&&t.length&&(o=new RegExp("#"+n+i,"i"),t=t.replace(o,"")),s&&t.length){const a=s.split(" ");for(let l=a.length;l--;)o=new RegExp("\\."+a[l]+i,"i"),t=t.replace(o,"")}return t.length===0}function Nb(r,t){let e=!0;const s=Sf(r,t.pop());return s&&t.length&&(e=function(n,i){let o,a=!0;for(;n.parentElement&&n.parentElement.nodeType===1&&i.length;)a&&(o=i.pop()),a=Sf(n=n.parentElement,o);return i.length===0}(r,t)),s&&e&&t.length===0}const Hb=r=>{var t;return(t=vb[r])!==null&&t!==void 0?t:r},Yb=new RegExp("(".concat(_r,")"),"gi"),zb=r=>r.replace(Yb," $1 ").replace(/,/gi," ").replace(/\s+/gi," ");var Tf,Of,kf,Mf,Ef,Af,Pf;const Te="(".concat(_r,")"),Xb=String.raw(Tf||(Tf=Vn(["(skewX)(",")"],["(skewX)\\(","\\)"])),Te),Vb=String.raw(Of||(Of=Vn(["(skewY)(",")"],["(skewY)\\(","\\)"])),Te),Wb=String.raw(kf||(kf=Vn(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),Te,Te,Te),Ub=String.raw(Mf||(Mf=Vn(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),Te,Te),Gb=String.raw(Ef||(Ef=Vn(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),Te,Te),$b=String.raw(Af||(Af=Vn(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),Te,Te,Te,Te,Te,Te),Yh="(?:".concat($b,"|").concat(Gb,"|").concat(Wb,"|").concat(Ub,"|").concat(Xb,"|").concat(Vb,")"),qb="(?:".concat(Yh,"*)"),Kb=String.raw(Pf||(Pf=Vn(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),qb),Jb=new RegExp(Kb),Zb=new RegExp(Yh),Qb=new RegExp(Yh,"g");function Lc(r){const t=[];if(!(r=zb(r).replace(/\s*([()])\s*/gi,"$1"))||r&&!Jb.test(r))return[...Ee];for(const e of r.matchAll(Qb)){const s=Zb.exec(e[0]);if(!s)continue;let n=Ee;const i=s.filter(p=>!!p),[,o,...a]=i,[l,c,h,u,f,d]=a.map(p=>parseFloat(p));switch(o){case"translate":n=gi(l,c);break;case Sh:n=pi({angle:l},{x:c,y:h});break;case ll:n=hl(l,c);break;case fi:n=Mh(l);break;case di:n=Eh(l);break;case"matrix":n=[l,c,h,u,f,d]}t.push(n)}return cl(t)}function tx(r,t,e,s){const n=Array.isArray(t);let i,o=t;if(r!==ee&&r!==Le||t!==Re){if(r==="strokeUniform")return t==="non-scaling-stroke";if(r==="strokeDashArray")o=t===Re?null:t.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(r==="transformMatrix")o=e&&e.transformMatrix?Wt(e.transformMatrix,Lc(t)):Lc(t);else if(r==="visible")o=t!==Re&&t!=="hidden",e&&e.visible===!1&&(o=!1);else if(r==="opacity")o=parseFloat(t),e&&e.opacity!==void 0&&(o*=e.opacity);else if(r==="textAnchor")o=t==="start"?St:t==="end"?$t:gt;else if(r==="charSpacing")i=cr(t,s)/s*1e3;else if(r==="paintFirst"){const a=t.indexOf(ee),l=t.indexOf(Le);o=ee,(a>-1&&l>-1&&l<a||a===-1&&l>-1)&&(o=Le)}else{if(r==="href"||r==="xlink:href"||r==="font"||r==="id")return t;if(r==="imageSmoothing")return t==="optimizeQuality";i=n?t.map(cr):cr(t,s)}}else o="";return!n&&isNaN(i)?o:i}function ex(r,t){const e=r.match(mb);if(!e)return;const s=e[1],n=e[3],i=e[4],o=e[5],a=e[6];s&&(t.fontStyle=s),n&&(t.fontWeight=isNaN(parseFloat(n))?n:parseFloat(n)),i&&(t.fontSize=cr(i)),a&&(t.fontFamily=a),o&&(t.lineHeight=o==="normal"?1:o)}function sx(r,t){r.replace(/;\s*$/,"").split(";").forEach(e=>{if(!e)return;const[s,n]=e.split(":");t[s.trim().toLowerCase()]=n.trim()})}function nx(r){const t={},e=r.getAttribute("style");return e&&(typeof e=="string"?sx(e,t):function(s,n){Object.entries(s).forEach(i=>{let[o,a]=i;a!==void 0&&(n[o.toLowerCase()]=a)})}(e,t)),t}const rx={stroke:"strokeOpacity",fill:"fillOpacity"};function _n(r,t,e){if(!r)return{};let s,n={},i=Ch;r.parentNode&&_f.test(r.parentNode.nodeName)&&(n=_n(r.parentElement,t,e),n.fontSize&&(s=i=cr(n.fontSize)));const o=S(S(S({},t.reduce((c,h)=>{const u=r.getAttribute(h);return u&&(c[h]=u),c},{})),function(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u={};for(const f in h)Nb(c,f.split(" "))&&(u=S(S({},u),h[f]));return u}(r,e)),nx(r));o[Nl]&&r.setAttribute(Nl,o[Nl]),o[Bl]&&(s=cr(o[Bl],i),o[Bl]="".concat(s));const a={};for(const c in o){const h=Hb(c),u=tx(h,o[c],n,s);a[h]=u}a&&a.font&&ex(a.font,a);const l=S(S({},n),a);return _f.test(r.nodeName)?l:function(c){const h=ne.getDefaults();return Object.entries(rx).forEach(u=>{let[f,d]=u;if(c[d]===void 0||c[f]==="")return;if(c[f]===void 0){if(!h[f])return;c[f]=h[f]}if(c[f].indexOf("url(")===0)return;const p=new kt(c[f]);c[f]=p.setAlpha(jt(p.getAlpha()*c[d],2)).toRgba()}),c}(l)}const ix=["left","top","width","height","visible"],Ip=["rx","ry"];class ls extends ne{static getDefaults(){return S(S({},super.getDefaults()),ls.ownDefaults)}constructor(t){super(),Object.assign(this,ls.ownDefaults),this.setOptions(t),this._initRxRy()}_initRxRy(){const{rx:t,ry:e}=this;t&&!e?this.ry=t:e&&!t&&(this.rx=e)}_render(t){const{width:e,height:s}=this,n=-e/2,i=-s/2,o=this.rx?Math.min(this.rx,e/2):0,a=this.ry?Math.min(this.ry,s/2):0,l=o!==0||a!==0;t.beginPath(),t.moveTo(n+o,i),t.lineTo(n+e-o,i),l&&t.bezierCurveTo(n+e-bn*o,i,n+e,i+bn*a,n+e,i+a),t.lineTo(n+e,i+s-a),l&&t.bezierCurveTo(n+e,i+s-bn*a,n+e-bn*o,i+s,n+e-o,i+s),t.lineTo(n+o,i+s),l&&t.bezierCurveTo(n+bn*o,i+s,n,i+s-bn*a,n,i+s-a),t.lineTo(n,i+a),l&&t.bezierCurveTo(n,i+bn*a,n+bn*o,i,n+o,i),t.closePath(),this._renderPaintInOrder(t)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...Ip,...t])}_toSVG(){const{width:t,height:e,rx:s,ry:n}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-t/2,'" y="').concat(-e/2,'" rx="').concat(s,'" ry="').concat(n,'" width="').concat(t,'" height="').concat(e,`" />
`)]}static async fromElement(t,e,s){const n=_n(t,this.ATTRIBUTE_NAMES,s),{left:i=0,top:o=0,width:a=0,height:l=0,visible:c=!0}=n,h=It(n,ix);return new this(S(S(S({},e),h),{},{left:i,top:o,width:a,height:l,visible:!!(c&&a&&l)}))}}T(ls,"type","Rect"),T(ls,"cacheProperties",[...vn,...Ip]),T(ls,"ownDefaults",{rx:0,ry:0}),T(ls,"ATTRIBUTE_NAMES",[...Un,"x","y","rx","ry","width","height"]),q.setClass(ls),q.setSVGClass(ls);const ln="initialization",Ea="added",zh="removed",Aa="imperative",Bp=(r,t)=>{const{strokeUniform:e,strokeWidth:s,width:n,height:i,group:o}=t,a=o&&o!==r?xo(o.calcTransformMatrix(),r.calcTransformMatrix()):null,l=a?t.getRelativeCenterPoint().transform(a):t.getRelativeCenterPoint(),c=!t.isStrokeAccountedForInDimensions(),h=e&&c?op(new M(s,s),void 0,r.calcTransformMatrix()):Th,u=!e&&c?s:0,f=ul(n+u,i+u,cl([a,t.calcOwnMatrix()],!0)).add(h).scalarDivide(2);return[l.subtract(f),l.add(f)]};class _l{calcLayoutResult(t,e){if(this.shouldPerformLayout(t))return this.calcBoundingBox(e,t)}shouldPerformLayout(t){let{type:e,prevStrategy:s,strategy:n}=t;return e===ln||e===Aa||!!s&&n!==s}shouldLayoutClipPath(t){let{type:e,target:{clipPath:s}}=t;return e!==ln&&s&&!s.absolutePositioned}getInitialSize(t,e){return e.size}calcBoundingBox(t,e){const{type:s,target:n}=e;if(s===Aa&&e.overrides)return e.overrides;if(t.length===0)return;const{left:i,top:o,width:a,height:l}=Vs(t.map(u=>Bp(n,u)).reduce((u,f)=>u.concat(f),[])),c=new M(a,l),h=new M(i,o).add(c.scalarDivide(2));if(s===ln){const u=this.getInitialSize(e,{size:c,center:h});return{center:h,relativeCorrection:new M(0,0),size:u}}return{center:h.transform(n.calcOwnMatrix()),size:c}}}T(_l,"type","strategy");class jc extends _l{shouldPerformLayout(t){return!0}}T(jc,"type","fit-content"),q.setClass(jc);const ox=["strategy"],ax=["target","strategy","bubbles","prevStrategy"],Np="layoutManager";class ro{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new jc;T(this,"strategy",void 0),this.strategy=t,this._subscriptions=new Map}performLayout(t){const e=S(S({bubbles:!0,strategy:this.strategy},t),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(e);const s=this.getLayoutResult(e);s&&this.commitLayout(e,s),this.onAfterLayout(e,s),this._prevLayoutStrategy=e.strategy}attachHandlers(t,e){const{target:s}=e;return[Ca,Hg,eo,Yg,al,zg,xa,Xg,cb].map(n=>t.on(n,i=>this.performLayout(n===Ca?{type:"object_modified",trigger:n,e:i,target:s}:{type:"object_modifying",trigger:n,e:i,target:s})))}subscribe(t,e){this.unsubscribe(t,e);const s=this.attachHandlers(t,e);this._subscriptions.set(t,s)}unsubscribe(t,e){(this._subscriptions.get(t)||[]).forEach(s=>s()),this._subscriptions.delete(t)}unsubscribeTargets(t){t.targets.forEach(e=>this.unsubscribe(e,t))}subscribeTargets(t){t.targets.forEach(e=>this.subscribe(e,t))}onBeforeLayout(t){const{target:e,type:s}=t,{canvas:n}=e;if(s===ln||s===Ea?this.subscribeTargets(t):s===zh&&this.unsubscribeTargets(t),e.fire("layout:before",{context:t}),n&&n.fire("object:layout:before",{target:e,context:t}),s===Aa&&t.deep){const i=It(t,ox);e.forEachObject(o=>o.layoutManager&&o.layoutManager.performLayout(S(S({},i),{},{bubbles:!1,target:o})))}}getLayoutResult(t){const{target:e,strategy:s,type:n}=t,i=s.calcLayoutResult(t,e.getObjects());if(!i)return;const o=n===ln?new M:e.getRelativeCenterPoint(),{center:a,correction:l=new M,relativeCorrection:c=new M}=i,h=o.subtract(a).add(l).transform(n===ln?Ee:Ke(e.calcOwnMatrix()),!0).add(c);return{result:i,prevCenter:o,nextCenter:a,offset:h}}commitLayout(t,e){const{target:s}=t,{result:{size:n},nextCenter:i}=e;var o,a;s.set({width:n.x,height:n.y}),this.layoutObjects(t,e),t.type===ln?s.set({left:(o=t.x)!==null&&o!==void 0?o:i.x+n.x*Zt(s.originX),top:(a=t.y)!==null&&a!==void 0?a:i.y+n.y*Zt(s.originY)}):(s.setPositionByOrigin(i,gt,gt),s.setCoords(),s.set("dirty",!0))}layoutObjects(t,e){const{target:s}=t;s.forEachObject(n=>{n.group===s&&this.layoutObject(t,e,n)}),t.strategy.shouldLayoutClipPath(t)&&this.layoutObject(t,e,s.clipPath)}layoutObject(t,e,s){let{offset:n}=e;s.set({left:s.left+n.x,top:s.top+n.y})}onAfterLayout(t,e){const{target:s,strategy:n,bubbles:i,prevStrategy:o}=t,a=It(t,ax),{canvas:l}=s;s.fire("layout:after",{context:t,result:e}),l&&l.fire("object:layout:after",{context:t,result:e,target:s});const c=s.parent;i&&c!=null&&c.layoutManager&&((a.path||(a.path=[])).push(s),c.layoutManager.performLayout(S(S({},a),{},{target:c}))),s.set("dirty",!0)}dispose(){const{_subscriptions:t}=this;t.forEach(e=>e.forEach(s=>s())),t.clear()}toObject(){return{type:Np,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}q.setClass(ro,Np);const lx=["type","objects","layoutManager"];class cx extends ro{performLayout(){}}class gs extends Vg(ne){static getDefaults(){return S(S({},super.getDefaults()),gs.ownDefaults)}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),T(this,"_activeObjects",[]),T(this,"__objectSelectionTracker",void 0),T(this,"__objectSelectionDisposer",void 0),Object.assign(this,gs.ownDefaults),this.setOptions(e),this.groupInit(t,e)}groupInit(t,e){var s;this._objects=[...t],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(n=>{this.enterGroup(n,!1)}),this.layoutManager=(s=e.layoutManager)!==null&&s!==void 0?s:new ro,this.layoutManager.performLayout({type:ln,target:this,targets:[...t],x:e.left,y:e.top})}canEnterGroup(t){return t===this||this.isDescendantOf(t)?(jn("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(t)===-1||(jn("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(t){return t.filter((e,s,n)=>this.canEnterGroup(e)&&n.indexOf(e)===s)}add(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];const n=this._filterObjectsBeforeEnteringGroup(e),i=super.add(...n);return this._onAfterObjectsChange(Ea,n),i}insertAt(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),n=1;n<e;n++)s[n-1]=arguments[n];const i=this._filterObjectsBeforeEnteringGroup(s),o=super.insertAt(t,...i);return this._onAfterObjectsChange(Ea,i),o}remove(){const t=super.remove(...arguments);return this._onAfterObjectsChange(zh,t),t}_onObjectAdded(t){this.enterGroup(t,!0),this.fire("object:added",{target:t}),t.fire("added",{target:this})}_onObjectRemoved(t,e){this.exitGroup(t,e),this.fire("object:removed",{target:t}),t.fire("removed",{target:this})}_onAfterObjectsChange(t,e){this.layoutManager.performLayout({type:t,targets:e,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(t,e){const s=this[t];return super._set(t,e),t==="canvas"&&s!==e&&(this._objects||[]).forEach(n=>{n._set(t,e)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(t,e){let{target:s}=e;const n=this._activeObjects;if(t)n.push(s),this._set("dirty",!0);else if(n.length>0){const i=n.indexOf(s);i>-1&&(n.splice(i,1),this._set("dirty",!0))}}_watchObject(t,e){t&&this._watchObject(!1,e),t?(e.on("selected",this.__objectSelectionTracker),e.on("deselected",this.__objectSelectionDisposer)):(e.off("selected",this.__objectSelectionTracker),e.off("deselected",this.__objectSelectionDisposer))}enterGroup(t,e){t.group&&t.group.remove(t),t._set("parent",this),this._enterGroup(t,e)}_enterGroup(t,e){e&&si(t,Wt(Ke(this.calcTransformMatrix()),t.calcTransformMatrix())),this._shouldSetNestedCoords()&&t.setCoords(),t._set("group",this),t._set("canvas",this.canvas),this._watchObject(!0,t);const s=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();s&&(s===t||t.isDescendantOf(s))&&this._activeObjects.push(t)}exitGroup(t,e){this._exitGroup(t,e),t._set("parent",void 0),t._set("canvas",void 0)}_exitGroup(t,e){t._set("group",void 0),e||(si(t,Wt(this.calcTransformMatrix(),t.calcTransformMatrix())),t.setCoords()),this._watchObject(!1,t);const s=this._activeObjects.length>0?this._activeObjects.indexOf(t):-1;s>-1&&this._activeObjects.splice(s,1)}shouldCache(){const t=ne.prototype.shouldCache.call(this);if(t){for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return this.ownCaching=!1,!1}return t}willDrawShadow(){if(super.willDrawShadow())return!0;for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(t,e,s){this._renderBackground(t);for(let i=0;i<this._objects.length;i++){var n;const o=this._objects[i];(n=this.canvas)!==null&&n!==void 0&&n.preserveObjectStacking&&o.group!==this?(t.save(),t.transform(...Ke(this.calcTransformMatrix())),o.render(t),t.restore()):o.group===this&&o.render(t)}this._drawClipPath(t,this.clipPath,s)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(t=>t.setCoords())}triggerLayout(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(S({target:this,type:Aa},t))}render(t){this._transformDone=!0,super.render(t),this._transformDone=!1}__serializeObjects(t,e){const s=this.includeDefaultValues;return this._objects.filter(function(n){return!n.excludeFromExport}).map(function(n){const i=n.includeDefaultValues;n.includeDefaultValues=s;const o=n[t||"toObject"](e);return n.includeDefaultValues=i,o})}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=this.layoutManager.toObject();return S(S(S({},super.toObject(["subTargetCheck","interactive",...t])),e.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:e}:{}),{},{objects:this.__serializeObjects("toObject",t)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(t=>{this._watchObject(!1,t),t.dispose()}),super.dispose()}_createSVGBgRect(t){if(!this.backgroundColor)return"";const e=ls.prototype._toSVG.call(this),s=e.indexOf("COMMON_PARTS");e[s]='for="group" ';const n=e.join("");return t?t(n):n}_toSVG(t){const e=["<g ","COMMON_PARTS",` >
`],s=this._createSVGBgRect(t);s&&e.push("		",s);for(let n=0;n<this._objects.length;n++)e.push("		",this._objects[n].toSVG(t));return e.push(`</g>
`),e}getSvgStyles(){const t=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",e=this.visible?"":" visibility: hidden;";return[t,this.getSvgFilter(),e].join("")}toClipPathSVG(t){const e=[],s=this._createSVGBgRect(t);s&&e.push("	",s);for(let n=0;n<this._objects.length;n++)e.push("	",this._objects[n].toClipPathSVG(t));return this._createBaseClipPathSVGMarkup(e,{reviver:t})}static fromObject(t,e){let{type:s,objects:n=[],layoutManager:i}=t,o=It(t,lx);return Promise.all([ei(n,e),yo(o,e)]).then(a=>{let[l,c]=a;const h=new this(l,S(S(S({},o),c),{},{layoutManager:new cx}));if(i){const u=q.getClass(i.type),f=q.getClass(i.strategy);h.layoutManager=new u(new f)}else h.layoutManager=new ro;return h.layoutManager.subscribeTargets({type:ln,target:h,targets:h.getObjects()}),h.setCoords(),h})}}T(gs,"type","Group"),T(gs,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),q.setClass(gs);const Hp=(r,t)=>Math.min(t.width/r.width,t.height/r.height),Yp=(r,t)=>Math.max(t.width/r.width,t.height/r.height),Ic="\\s*,?\\s*",Ci="".concat(Ic,"(").concat(_r,")"),hx="".concat(Ci).concat(Ci).concat(Ci).concat(Ic,"([01])").concat(Ic,"([01])").concat(Ci).concat(Ci),ux={m:"l",M:"L"},fx=(r,t,e,s,n,i,o,a,l,c,h)=>{const u=Os(r),f=ks(r),d=Os(t),p=ks(t),g=e*n*d-s*i*p+o,m=s*n*d+e*i*p+a;return["C",c+l*(-e*n*f-s*i*u),h+l*(-s*n*f+e*i*u),g+l*(e*n*p+s*i*d),m+l*(s*n*p-e*i*d),g,m]},Ff=(r,t,e,s)=>{const n=Math.atan2(t,r),i=Math.atan2(s,e);return i>=n?i-n:2*Math.PI-(n-i)};function Bc(r,t,e,s,n,i,o,a){let l;if(_t.cachesBoundsOfCurve&&(l=[...arguments].join(),Bi.boundsOfCurveCache[l]))return Bi.boundsOfCurveCache[l];const c=Math.sqrt,h=Math.abs,u=[],f=[[0,0],[0,0]];let d=6*r-12*e+6*n,p=-3*r+9*e-9*n+3*o,g=3*e-3*r;for(let b=0;b<2;++b){if(b>0&&(d=6*t-12*s+6*i,p=-3*t+9*s-9*i+3*a,g=3*s-3*t),h(p)<1e-12){if(h(d)<1e-12)continue;const D=-g/d;0<D&&D<1&&u.push(D);continue}const w=d*d-4*g*p;if(w<0)continue;const A=c(w),O=(-d+A)/(2*p);0<O&&O<1&&u.push(O);const E=(-d-A)/(2*p);0<E&&E<1&&u.push(E)}let m=u.length;const v=m,_=Xp(r,t,e,s,n,i,o,a);for(;m--;){const{x:b,y:w}=_(u[m]);f[0][m]=b,f[1][m]=w}f[0][v]=r,f[1][v]=t,f[0][v+1]=o,f[1][v+1]=a;const y=[new M(Math.min(...f[0]),Math.min(...f[1])),new M(Math.max(...f[0]),Math.max(...f[1]))];return _t.cachesBoundsOfCurve&&(Bi.boundsOfCurveCache[l]=y),y}const dx=(r,t,e)=>{let[s,n,i,o,a,l,c,h]=e;const u=((f,d,p,g,m,v,_)=>{if(p===0||g===0)return[];let y=0,b=0,w=0;const A=Math.PI,O=_*xh,E=ks(O),D=Os(O),Y=.5*(-D*f-E*d),K=.5*(-D*d+E*f),st=p**2,G=g**2,rt=K**2,ct=Y**2,et=st*G-st*rt-G*ct;let J=Math.abs(p),V=Math.abs(g);if(et<0){const Q=Math.sqrt(1-et/(st*G));J*=Q,V*=Q}else w=(m===v?-1:1)*Math.sqrt(et/(st*rt+G*ct));const pt=w*J*K/V,Tt=-w*V*Y/J,At=D*pt-E*Tt+.5*f,B=E*pt+D*Tt+.5*d;let N=Ff(1,0,(Y-pt)/J,(K-Tt)/V),W=Ff((Y-pt)/J,(K-Tt)/V,(-Y-pt)/J,(-K-Tt)/V);v===0&&W>0?W-=2*A:v===1&&W<0&&(W+=2*A);const Xt=Math.ceil(Math.abs(W/A*2)),Rt=[],R=W/Xt,Z=8/3*Math.sin(R/4)*Math.sin(R/4)/Math.sin(R/2);let z=N+R;for(let Q=0;Q<Xt;Q++)Rt[Q]=fx(N,z,D,E,J,V,At,B,Z,y,b),y=Rt[Q][5],b=Rt[Q][6],N=z,z+=R;return Rt})(c-r,h-t,n,i,a,l,o);for(let f=0,d=u.length;f<d;f++)u[f][1]+=r,u[f][2]+=t,u[f][3]+=r,u[f][4]+=t,u[f][5]+=r,u[f][6]+=t;return u},zp=r=>{let t=0,e=0,s=0,n=0;const i=[];let o,a=0,l=0;for(const c of r){const h=[...c];let u;switch(h[0]){case"l":h[1]+=t,h[2]+=e;case"L":t=h[1],e=h[2],u=["L",t,e];break;case"h":h[1]+=t;case"H":t=h[1],u=["L",t,e];break;case"v":h[1]+=e;case"V":e=h[1],u=["L",t,e];break;case"m":h[1]+=t,h[2]+=e;case"M":t=h[1],e=h[2],s=h[1],n=h[2],u=["M",t,e];break;case"c":h[1]+=t,h[2]+=e,h[3]+=t,h[4]+=e,h[5]+=t,h[6]+=e;case"C":a=h[3],l=h[4],t=h[5],e=h[6],u=["C",h[1],h[2],a,l,t,e];break;case"s":h[1]+=t,h[2]+=e,h[3]+=t,h[4]+=e;case"S":o==="C"?(a=2*t-a,l=2*e-l):(a=t,l=e),t=h[3],e=h[4],u=["C",a,l,h[1],h[2],t,e],a=u[3],l=u[4];break;case"q":h[1]+=t,h[2]+=e,h[3]+=t,h[4]+=e;case"Q":a=h[1],l=h[2],t=h[3],e=h[4],u=["Q",a,l,t,e];break;case"t":h[1]+=t,h[2]+=e;case"T":o==="Q"?(a=2*t-a,l=2*e-l):(a=t,l=e),t=h[1],e=h[2],u=["Q",a,l,t,e];break;case"a":h[6]+=t,h[7]+=e;case"A":dx(t,e,h).forEach(f=>i.push(f)),t=h[6],e=h[7];break;case"z":case"Z":t=s,e=n,u=["Z"]}u?(i.push(u),o=u[0]):o=""}return i},Pa=(r,t,e,s)=>Math.sqrt((e-r)**2+(s-t)**2),Xp=(r,t,e,s,n,i,o,a)=>l=>{const c=l**3,h=(d=>3*d**2*(1-d))(l),u=(d=>3*d*(1-d)**2)(l),f=(d=>(1-d)**3)(l);return new M(o*c+n*h+e*u+r*f,a*c+i*h+s*u+t*f)},Vp=r=>r**2,Wp=r=>2*r*(1-r),Up=r=>(1-r)**2,gx=(r,t,e,s,n,i,o,a)=>l=>{const c=Vp(l),h=Wp(l),u=Up(l),f=3*(u*(e-r)+h*(n-e)+c*(o-n)),d=3*(u*(s-t)+h*(i-s)+c*(a-i));return Math.atan2(d,f)},px=(r,t,e,s,n,i)=>o=>{const a=Vp(o),l=Wp(o),c=Up(o);return new M(n*a+e*l+r*c,i*a+s*l+t*c)},mx=(r,t,e,s,n,i)=>o=>{const a=1-o,l=2*(a*(e-r)+o*(n-e)),c=2*(a*(s-t)+o*(i-s));return Math.atan2(c,l)},Df=(r,t,e)=>{let s=new M(t,e),n=0;for(let i=1;i<=100;i+=1){const o=r(i/100);n+=Pa(s.x,s.y,o.x,o.y),s=o}return n},vx=(r,t)=>{let e,s=0,n=0,i={x:r.x,y:r.y},o=S({},i),a=.01,l=0;const c=r.iterator,h=r.angleFinder;for(;n<t&&a>1e-4;)o=c(s),l=s,e=Pa(i.x,i.y,o.x,o.y),e+n>t?(s-=a,a/=2):(i=o,s+=a,n+=e);return S(S({},o),{},{angle:h(l)})},Xh=r=>{let t,e,s=0,n=0,i=0,o=0,a=0;const l=[];for(const c of r){const h={x:n,y:i,command:c[0],length:0};switch(c[0]){case"M":e=h,e.x=o=n=c[1],e.y=a=i=c[2];break;case"L":e=h,e.length=Pa(n,i,c[1],c[2]),n=c[1],i=c[2];break;case"C":t=Xp(n,i,c[1],c[2],c[3],c[4],c[5],c[6]),e=h,e.iterator=t,e.angleFinder=gx(n,i,c[1],c[2],c[3],c[4],c[5],c[6]),e.length=Df(t,n,i),n=c[5],i=c[6];break;case"Q":t=px(n,i,c[1],c[2],c[3],c[4]),e=h,e.iterator=t,e.angleFinder=mx(n,i,c[1],c[2],c[3],c[4]),e.length=Df(t,n,i),n=c[3],i=c[4];break;case"Z":e=h,e.destX=o,e.destY=a,e.length=Pa(n,i,o,a),n=o,i=a}s+=e.length,l.push(e)}return l.push({length:s,x:n,y:i}),l},Gp=function(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Xh(r),s=0;for(;t-e[s].length>0&&s<e.length-2;)t-=e[s].length,s++;const n=e[s],i=t/n.length,o=r[s];switch(n.command){case"M":return{x:n.x,y:n.y,angle:0};case"Z":return S(S({},new M(n.x,n.y).lerp(new M(n.destX,n.destY),i)),{},{angle:Math.atan2(n.destY-n.y,n.destX-n.x)});case"L":return S(S({},new M(n.x,n.y).lerp(new M(o[1],o[2]),i)),{},{angle:Math.atan2(o[2]-n.y,o[1]-n.x)});case"C":case"Q":return vx(n,t)}},_x=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),Rf=new RegExp(hx,"g"),yx=new RegExp(_r,"gi"),bx={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},$p=r=>{var t;const e=[],s=(t=r.match(_x))!==null&&t!==void 0?t:[];for(const n of s){const i=n[0];if(i==="z"||i==="Z"){e.push([i]);continue}const o=bx[i.toLowerCase()];let a=[];if(i==="a"||i==="A"){Rf.lastIndex=0;for(let l=null;l=Rf.exec(n);)a.push(...l.slice(1))}else a=n.match(yx)||[];for(let l=0;l<a.length;l+=o){const c=new Array(o),h=ux[i];c[0]=l>0&&h?h:i;for(let u=0;u<o;u++)c[u+1]=parseFloat(a[l+u]);e.push(c)}}return e},xx=function(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=new M(r[0]),s=new M(r[1]),n=1,i=0;const o=[],a=r.length,l=a>2;let c;for(l&&(n=r[2].x<s.x?-1:r[2].x===s.x?0:1,i=r[2].y<s.y?-1:r[2].y===s.y?0:1),o.push(["M",e.x-n*t,e.y-i*t]),c=1;c<a;c++){if(!e.eq(s)){const h=e.midPointFrom(s);o.push(["Q",e.x,e.y,h.x,h.y])}e=r[c],c+1<r.length&&(s=r[c+1])}return l&&(n=e.x>r[c-2].x?1:e.x===r[c-2].x?0:-1,i=e.y>r[c-2].y?1:e.y===r[c-2].y?0:-1),o.push(["L",e.x+n*t,e.y+i*t]),o},qp=(r,t)=>r.map(e=>e.map((s,n)=>n===0||t===void 0?s:jt(s,t)).join(" ")).join(" ");function Fa(r,t){const e=r.style;e&&t&&(typeof t=="string"?e.cssText+=";"+t:Object.entries(t).forEach(s=>{let[n,i]=s;return e.setProperty(n,i)}))}const Cx=(r,t)=>Math.floor(Math.random()*(t-r+1))+r;function wx(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const e=t.onComplete||lr,s=new(ol()).XMLHttpRequest,n=t.signal,i=function(){s.abort()},o=function(){n&&n.removeEventListener("abort",i),s.onerror=s.ontimeout=lr};if(n&&n.aborted)throw new Bg("request");return n&&n.addEventListener("abort",i,{once:!0}),s.onreadystatechange=function(){s.readyState===4&&(o(),e(s),s.onreadystatechange=lr)},s.onerror=s.ontimeout=o,s.open("get",r,!0),s.send(),s}const Sx=(r,t)=>{let e=r._findCenterFromElement();r.transformMatrix&&((s=>{if(s.transformMatrix){const{scaleX:n,scaleY:i,angle:o,skewX:a}=ti(s.transformMatrix);s.flipX=!1,s.flipY=!1,s.set(Ae,n),s.set(ss,i),s.angle=o,s.skewX=a,s.skewY=0}})(r),e=e.transform(r.transformMatrix)),delete r.transformMatrix,t&&(r.scaleX*=t.scaleX,r.scaleY*=t.scaleY,r.cropX=t.cropX,r.cropY=t.cropY,e.x+=t.offsetLeft,e.y+=t.offsetTop,r.width=t.width,r.height=t.height),r.setPositionByOrigin(e,gt,gt)};var Dn=Object.freeze({__proto__:null,addTransformToObject:rp,animate:Ih,animateColor:pp,applyTransformToObject:si,calcAngleBetweenVectors:Ma,calcDimensionsMatrix:_o,calcPlaneChangeMatrix:xo,calcVectorRotation:fp,cancelAnimFrame:Ug,capValue:yr,composeMatrix:Jg,copyCanvasElement:r=>{var t;const e=Ms(r);return(t=e.getContext("2d"))===null||t===void 0||t.drawImage(r,0,0),e},cos:Os,createCanvasElement:ms,createImage:Gg,createRotateMatrix:pi,createScaleMatrix:hl,createSkewXMatrix:Mh,createSkewYMatrix:Eh,createTranslateMatrix:gi,createVector:Oa,crossProduct:Xr,degreesToRadians:Vt,dotProduct:dp,ease:xb,enlivenObjectEnlivables:yo,enlivenObjects:ei,findScaleToCover:Yp,findScaleToFit:Hp,getBoundsOfCurve:Bc,getOrthonormalVector:Lh,getPathSegmentsInfo:Xh,getPointOnPath:Gp,getPointer:np,getRandomInt:Cx,getRegularPolygonPath:(r,t)=>{const e=2*Math.PI/r;let s=-In;r%2==0&&(s+=e/2);const n=new Array(r+1);for(let i=0;i<r;i++){const o=i*e+s,{x:a,y:l}=new M(Os(o),ks(o)).scalarMultiply(t);n[i]=[i===0?"M":"L",a,l]}return n[r]=["Z"],n},getSmoothPathFromPoints:xx,getSvgAttributes:r=>{const t=["instantiated_by_use","style","id","class"];switch(r){case"linearGradient":return t.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);case"radialGradient":return t.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);case"stop":return t.concat(["offset","stop-color","stop-opacity"])}return t},getUnitVector:gl,groupSVGElements:(r,t)=>r&&r.length===1?r[0]:new gs(r,t),hasStyleChanged:vl,invertTransform:Ke,isBetweenVectors:Ac,isIdentityMatrix:$g,isTouchEvent:Sa,isTransparent:Pp,joinPath:qp,loadImage:Hi,magnitude:ka,makeBoundingBoxFromPoints:Vs,makePathSimpler:zp,matrixToSVG:so,mergeClipPaths:(r,t)=>{var e;let s=r,n=t;s.inverted&&!n.inverted&&(s=t,n=r),Ec(n,(e=n.group)===null||e===void 0?void 0:e.calcTransformMatrix(),s.calcTransformMatrix());const i=s.inverted&&n.inverted;return i&&(s.inverted=n.inverted=!1),new gs([s],{clipPath:n,inverted:i})},multiplyTransformMatrices:Wt,multiplyTransformMatrixArray:cl,parsePath:$p,parsePreserveAspectRatioAttribute:Zg,parseUnit:cr,pick:Cr,projectStrokeOnPoints:Dp,qrDecompose:ti,radiansToDegrees:Nn,removeFromArray:er,removeTransformFromObject:(r,t)=>{const e=Ke(t),s=Wt(e,r.calcOwnMatrix());si(r,s)},removeTransformMatrixForSvgParsing:Sx,request:wx,requestAnimFrame:Ni,resetObjectTransform:ip,rotatePoint:(r,t,e)=>r.rotate(e,t),rotateVector:Rh,saveObjectTransform:Ph,sendObjectToPlane:Ec,sendPointToPlane:un,sendVectorToPlane:op,setStyle:Fa,sin:ks,sizeAfterTransform:ul,string:Bb,stylesFromArray:jp,stylesToArray:Lp,toBlob:kh,toDataURL:Oh,toFixed:jt,transformPath:(r,t,e)=>(e&&(t=Wt(t,[1,0,0,1,-e.x,-e.y])),r.map(s=>{const n=[...s];for(let i=1;i<s.length-1;i+=2){const{x:o,y:a}=ue({x:s[i],y:s[i+1]},t);n[i]=o,n[i+1]=a}return n})),transformPoint:ue});class Tx extends sp{constructor(t){let{allowTouchScrolling:e=!1,containerClass:s=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t),T(this,"upper",void 0),T(this,"container",void 0);const{el:n}=this.lower,i=this.createUpperCanvas();this.upper={el:i,ctx:i.getContext("2d")},this.applyCanvasStyle(n,{allowTouchScrolling:e}),this.applyCanvasStyle(i,{allowTouchScrolling:e,styles:{position:"absolute",left:"0",top:"0"}});const o=this.createContainerElement();o.classList.add(s),n.parentNode&&n.parentNode.replaceChild(o,n),o.append(n,i),this.container=o}createUpperCanvas(){const{el:t}=this.lower,e=ms();return e.className=t.className,e.classList.remove("lower-canvas"),e.classList.add("upper-canvas"),e.setAttribute("data-fabric","top"),e.style.cssText=t.style.cssText,e.setAttribute("draggable","true"),e}createContainerElement(){const t=ui().createElement("div");return t.setAttribute("data-fabric","wrapper"),Fa(t,{position:"relative"}),pf(t),t}applyCanvasStyle(t,e){const{styles:s,allowTouchScrolling:n}=e;Fa(t,S(S({},s),{},{"touch-action":n?"manipulation":Re})),pf(t)}setDimensions(t,e){super.setDimensions(t,e);const{el:s,ctx:n}=this.upper;ep(s,n,t,e)}setCSSDimensions(t){super.setCSSDimensions(t),kc(this.upper.el,t),kc(this.container,t)}cleanupDOM(t){const e=this.container,{el:s}=this.lower,{el:n}=this.upper;super.cleanupDOM(t),e.removeChild(n),e.removeChild(s),e.parentNode&&e.parentNode.replaceChild(s,e)}dispose(){super.dispose(),Ks().dispose(this.upper.el),delete this.upper,delete this.container}}class yl extends bo{constructor(){super(...arguments),T(this,"targets",[]),T(this,"_hoveredTargets",[]),T(this,"_objectsToRender",void 0),T(this,"_currentTransform",null),T(this,"_groupSelector",null),T(this,"contextTopDirty",!1)}static getDefaults(){return S(S({},super.getDefaults()),yl.ownDefaults)}get upperCanvasEl(){var t;return(t=this.elements.upper)===null||t===void 0?void 0:t.el}get contextTop(){var t;return(t=this.elements.upper)===null||t===void 0?void 0:t.ctx}get wrapperEl(){return this.elements.container}initElements(t){this.elements=new Tx(t,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(t){this._objectsToRender=void 0,super._onObjectAdded(t)}_onObjectRemoved(t){this._objectsToRender=void 0,t===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[t]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[t]}),t.fire("deselected",{target:t})),t===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(t)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const t=this._activeObject;return!this.preserveObjectStacking&&t?this._objects.filter(e=>!e.group&&e!==t).concat(t):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(t){t.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(t),this.contextTopDirty=!0),t.restore()}renderTop(){const t=this.contextTop;this.clearContext(t),this.renderTopLayer(t),this.fire("after:render",{ctx:t})}setTargetFindTolerance(t){t=Math.round(t),this.targetFindTolerance=t;const e=this.getRetinaScaling(),s=Math.ceil((2*t+1)*e);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=s,this.pixelFindContext.scale(e,e)}isTargetTransparent(t,e,s){const n=this.targetFindTolerance,i=this.pixelFindContext;this.clearContext(i),i.save(),i.translate(-e+n,-s+n),i.transform(...this.viewportTransform);const o=t.selectionBackgroundColor;t.selectionBackgroundColor="",t.render(i),t.selectionBackgroundColor=o,i.restore();const a=Math.round(n*this.getRetinaScaling());return Pp(i,a,a,a)}_isSelectionKeyPressed(t){const e=this.selectionKey;return!!e&&(Array.isArray(e)?!!e.find(s=>!!s&&t[s]===!0):t[e])}_shouldClearSelection(t,e){const s=this.getActiveObjects(),n=this._activeObject;return!!(!e||e&&n&&s.length>1&&s.indexOf(e)===-1&&n!==e&&!this._isSelectionKeyPressed(t)||e&&!e.evented||e&&!e.selectable&&n&&n!==e)}_shouldCenterTransform(t,e,s){if(!t)return;let n;return e===ll||e===Ae||e===ss||e===eo?n=this.centeredScaling||t.centeredScaling:e===Sh&&(n=this.centeredRotation||t.centeredRotation),n?!s:s}_getOriginFromCorner(t,e){const s={x:t.originX,y:t.originY};return e&&(["ml","tl","bl"].includes(e)?s.x=$t:["mr","tr","br"].includes(e)&&(s.x=St),["tl","mt","tr"].includes(e)?s.y=Oc:["bl","mb","br"].includes(e)&&(s.y=De)),s}_setupCurrentTransform(t,e,s){var n;const i=e.group?un(this.getScenePoint(t),void 0,e.group.calcTransformMatrix()):this.getScenePoint(t),{key:o="",control:a}=e.getActiveControl()||{},l=s&&a?(n=a.getActionHandler(t,e,a))===null||n===void 0?void 0:n.bind(a):cp,c=((d,p,g,m)=>{if(!p||!d)return"drag";const v=m.controls[p];return v.getActionName(g,v,m)})(s,o,t,e),h=t[this.centeredKey],u=this._shouldCenterTransform(e,c,h)?{x:gt,y:gt}:this._getOriginFromCorner(e,o),f={target:e,action:c,actionHandler:l,actionPerformed:!1,corner:o,scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX,skewY:e.skewY,offsetX:i.x-e.left,offsetY:i.y-e.top,originX:u.x,originY:u.y,ex:i.x,ey:i.y,lastX:i.x,lastY:i.y,theta:Vt(e.angle),width:e.width,height:e.height,shiftKey:t.shiftKey,altKey:h,original:S(S({},Ph(e)),{},{originX:u.x,originY:u.y})};this._currentTransform=f,this.fire("before:transform",{e:t,transform:f})}setCursor(t){this.upperCanvasEl.style.cursor=t}_drawSelection(t){const{x:e,y:s,deltaX:n,deltaY:i}=this._groupSelector,o=new M(e,s).transform(this.viewportTransform),a=new M(e+n,s+i).transform(this.viewportTransform),l=this.selectionLineWidth/2;let c=Math.min(o.x,a.x),h=Math.min(o.y,a.y),u=Math.max(o.x,a.x),f=Math.max(o.y,a.y);this.selectionColor&&(t.fillStyle=this.selectionColor,t.fillRect(c,h,u-c,f-h)),this.selectionLineWidth&&this.selectionBorderColor&&(t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,c+=l,h+=l,u-=l,f-=l,ne.prototype._setLineDash.call(this,t,this.selectionDashArray),t.strokeRect(c,h,u-c,f-h))}findTarget(t){if(this.skipTargetFind)return;const e=this.getViewportPoint(t),s=this._activeObject,n=this.getActiveObjects();if(this.targets=[],s&&n.length>=1){if(s.findControl(e,Sa(t))||n.length>1&&this.searchPossibleTargets([s],e))return s;if(s===this.searchPossibleTargets([s],e)){if(this.preserveObjectStacking){const i=this.targets;this.targets=[];const o=this.searchPossibleTargets(this._objects,e);return t[this.altSelectionKey]&&o&&o!==s?(this.targets=i,s):o}return s}}return this.searchPossibleTargets(this._objects,e)}_pointIsInObjectSelectionArea(t,e){let s=t.getCoords();const n=this.getZoom(),i=t.padding/n;if(i){const[o,a,l,c]=s,h=Math.atan2(a.y-o.y,a.x-o.x),u=Os(h)*i,f=ks(h)*i,d=u+f,p=u-f;s=[new M(o.x-p,o.y-d),new M(a.x+d,a.y-p),new M(l.x+p,l.y+d),new M(c.x-d,c.y+p)]}return Bt.isPointInPolygon(e,s)}_checkTarget(t,e){return!!(t&&t.visible&&t.evented&&this._pointIsInObjectSelectionArea(t,un(e,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!t.perPixelTargetFind||t.isEditing||!this.isTargetTransparent(t,e.x,e.y)))}_searchPossibleTargets(t,e){let s=t.length;for(;s--;){const n=t[s];if(this._checkTarget(n,e)){if(na(n)&&n.subTargetCheck){const i=this._searchPossibleTargets(n._objects,e);i&&this.targets.push(i)}return n}}}searchPossibleTargets(t,e){const s=this._searchPossibleTargets(t,e);if(s&&na(s)&&s.interactive&&this.targets[0]){const n=this.targets;for(let i=n.length-1;i>0;i--){const o=n[i];if(!na(o)||!o.interactive)return o}return n[0]}return s}getViewportPoint(t){return this._pointer?this._pointer:this.getPointer(t,!0)}getScenePoint(t){return this._absolutePointer?this._absolutePointer:this.getPointer(t)}getPointer(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const s=this.upperCanvasEl,n=s.getBoundingClientRect();let i=np(t),o=n.width||0,a=n.height||0;o&&a||(De in n&&Oc in n&&(a=Math.abs(n.top-n.bottom)),$t in n&&St in n&&(o=Math.abs(n.right-n.left))),this.calcOffset(),i.x=i.x-this._offset.left,i.y=i.y-this._offset.top,e||(i=un(i,void 0,this.viewportTransform));const l=this.getRetinaScaling();l!==1&&(i.x/=l,i.y/=l);const c=o===0||a===0?new M(1,1):new M(s.width/o,s.height/a);return i.multiply(c)}_setDimensionsImpl(t,e){this._resetTransformEventData(),super._setDimensionsImpl(t,e),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=ms(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const t=this._activeObject;return sr(t)?t.getObjects():t?[t]:[]}_fireSelectionEvents(t,e){let s=!1,n=!1;const i=this.getActiveObjects(),o=[],a=[];t.forEach(l=>{i.includes(l)||(s=!0,l.fire("deselected",{e,target:l}),a.push(l))}),i.forEach(l=>{t.includes(l)||(s=!0,l.fire("selected",{e,target:l}),o.push(l))}),t.length>0&&i.length>0?(n=!0,s&&this.fire("selection:updated",{e,selected:o,deselected:a})):i.length>0?(n=!0,this.fire("selection:created",{e,selected:o})):t.length>0&&(n=!0,this.fire("selection:cleared",{e,deselected:a})),n&&(this._objectsToRender=void 0)}setActiveObject(t,e){const s=this.getActiveObjects(),n=this._setActiveObject(t,e);return this._fireSelectionEvents(s,e),n}_setActiveObject(t,e){const s=this._activeObject;return s!==t&&!(!this._discardActiveObject(e,t)&&this._activeObject)&&!t.onSelect({e})&&(this._activeObject=t,sr(t)&&s!==t&&t.set("canvas",this),t.setCoords(),!0)}_discardActiveObject(t,e){const s=this._activeObject;return!!s&&!s.onDeselect({e:t,object:e})&&(this._currentTransform&&this._currentTransform.target===s&&this.endCurrentTransform(t),sr(s)&&s===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(t){const e=this.getActiveObjects(),s=this.getActiveObject();e.length&&this.fire("before:selection:cleared",{e:t,deselected:[s]});const n=this._discardActiveObject(t);return this._fireSelectionEvents(e,t),n}endCurrentTransform(t){const e=this._currentTransform;this._finalizeCurrentTransform(t),e&&e.target&&(e.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(t){const e=this._currentTransform,s=e.target,n={e:t,target:s,transform:e,action:e.action};s._scaling&&(s._scaling=!1),s.setCoords(),e.actionPerformed&&(this.fire("object:modified",n),s.fire(Ca,n))}setViewportTransform(t){super.setViewportTransform(t);const e=this._activeObject;e&&e.setCoords()}destroy(){const t=this._activeObject;sr(t)&&(t.removeAll(),t.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(t){const e=this._activeObject;e&&e._renderControls(t)}_toObject(t,e,s){const n=this._realizeGroupTransformOnObject(t),i=super._toObject(t,e,s);return t.set(n),i}_realizeGroupTransformOnObject(t){const{group:e}=t;if(e&&sr(e)&&this._activeObject===e){const s=Cr(t,["angle","flipX","flipY",St,Ae,ss,fi,di,De]);return rp(t,e.calcOwnMatrix()),s}return{}}_setSVGObject(t,e,s){const n=this._realizeGroupTransformOnObject(e);super._setSVGObject(t,e,s),e.set(n)}}T(yl,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class Ox{constructor(t){T(this,"targets",[]),T(this,"__disposer",void 0);const e=()=>{const{hiddenTextarea:n}=t.getActiveObject()||{};n&&n.focus()},s=t.upperCanvasEl;s.addEventListener("click",e),this.__disposer=()=>s.removeEventListener("click",e)}exitTextEditing(){this.target=void 0,this.targets.forEach(t=>{t.isEditing&&t.exitEditing()})}add(t){this.targets.push(t)}remove(t){this.unregister(t),er(this.targets,t)}register(t){this.target=t}unregister(t){t===this.target&&(this.target=void 0)}onMouseMove(t){var e;!((e=this.target)===null||e===void 0)&&e.isEditing&&this.target.updateSelectionOnMouseMove(t)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const kx=["target","oldTarget","fireCanvas","e"],Ve={passive:!1},Mr=(r,t)=>{const e=r.getViewportPoint(t),s=r.getScenePoint(t);return{viewportPoint:e,scenePoint:s,pointer:e,absolutePointer:s}},xn=function(r){for(var t=arguments.length,e=new Array(t>1?t-1:0),s=1;s<t;s++)e[s-1]=arguments[s];return r.addEventListener(...e)},is=function(r){for(var t=arguments.length,e=new Array(t>1?t-1:0),s=1;s<t;s++)e[s-1]=arguments[s];return r.removeEventListener(...e)},Mx={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class io extends yl{constructor(t){super(t,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),T(this,"_isClick",void 0),T(this,"textEditingManager",new Ox(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onDoubleClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(e=>{this[e]=this[e].bind(this)}),this.addOrRemove(xn,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(t,e){const s=this.upperCanvasEl,n=this._getEventPrefix();t(tp(s),"resize",this._onResize),t(s,n+"down",this._onMouseDown),t(s,"".concat(n,"move"),this._onMouseMove,Ve),t(s,"".concat(n,"out"),this._onMouseOut),t(s,"".concat(n,"enter"),this._onMouseEnter),t(s,"wheel",this._onMouseWheel),t(s,"contextmenu",this._onContextMenu),t(s,"dblclick",this._onDoubleClick),t(s,"dragstart",this._onDragStart),t(s,"dragend",this._onDragEnd),t(s,"dragover",this._onDragOver),t(s,"dragenter",this._onDragEnter),t(s,"dragleave",this._onDragLeave),t(s,"drop",this._onDrop),this.enablePointerEvents||t(s,"touchstart",this._onTouchStart,Ve)}removeListeners(){this.addOrRemove(is,"remove");const t=this._getEventPrefix(),e=ys(this.upperCanvasEl);is(e,"".concat(t,"up"),this._onMouseUp),is(e,"touchend",this._onTouchEnd,Ve),is(e,"".concat(t,"move"),this._onMouseMove,Ve),is(e,"touchmove",this._onMouseMove,Ve),clearTimeout(this._willAddMouseDown)}_onMouseWheel(t){this.__onMouseWheel(t)}_onMouseOut(t){const e=this._hoveredTarget,s=S({e:t},Mr(this,t));this.fire("mouse:out",S(S({},s),{},{target:e})),this._hoveredTarget=void 0,e&&e.fire("mouseout",S({},s)),this._hoveredTargets.forEach(n=>{this.fire("mouse:out",S(S({},s),{},{target:n})),n&&n.fire("mouseout",S({},s))}),this._hoveredTargets=[]}_onMouseEnter(t){this._currentTransform||this.findTarget(t)||(this.fire("mouse:over",S({e:t},Mr(this,t))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(t){this._isClick=!1;const e=this.getActiveObject();if(e&&e.onDragStart(t)){this._dragSource=e;const s={e:t,target:e};return this.fire("dragstart",s),e.fire("dragstart",s),void xn(this.upperCanvasEl,"drag",this._onDragProgress)}Mc(t)}_renderDragEffects(t,e,s){let n=!1;const i=this._dropTarget;i&&i!==e&&i!==s&&(i.clearContextTop(),n=!0),e==null||e.clearContextTop(),s!==e&&(s==null||s.clearContextTop());const o=this.contextTop;o.save(),o.transform(...this.viewportTransform),e&&(o.save(),e.transform(o),e.renderDragSourceEffect(t),o.restore(),n=!0),s&&(o.save(),s.transform(o),s.renderDropTargetEffect(t),o.restore(),n=!0),o.restore(),n&&(this.contextTopDirty=!0)}_onDragEnd(t){const e=!!t.dataTransfer&&t.dataTransfer.dropEffect!==Re,s=e?this._activeObject:void 0,n={e:t,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:e,dropTarget:s};is(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",n),this._dragSource&&this._dragSource.fire("dragend",n),delete this._dragSource,this._onMouseUp(t)}_onDragProgress(t){const e={e:t,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",e),this._dragSource&&this._dragSource.fire("drag",e)}findDragTargets(t){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(t)),targets:[...this.targets]}}_onDragOver(t){const e="dragover",{target:s,targets:n}=this.findDragTargets(t),i=this._dragSource,o={e:t,target:s,subTargets:n,dragSource:i,canDrop:!1,dropTarget:void 0};let a;this.fire(e,o),this._fireEnterLeaveEvents(s,o),s&&(s.canDrop(t)&&(a=s),s.fire(e,o));for(let l=0;l<n.length;l++){const c=n[l];c.canDrop(t)&&(a=c),c.fire(e,o)}this._renderDragEffects(t,i,a),this._dropTarget=a}_onDragEnter(t){const{target:e,targets:s}=this.findDragTargets(t),n={e:t,target:e,subTargets:s,dragSource:this._dragSource};this.fire("dragenter",n),this._fireEnterLeaveEvents(e,n)}_onDragLeave(t){const e={e:t,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",e),this._fireEnterLeaveEvents(void 0,e),this._renderDragEffects(t,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(t){const{target:e,targets:s}=this.findDragTargets(t),n=this._basicEventHandler("drop:before",S({e:t,target:e,subTargets:s,dragSource:this._dragSource},Mr(this,t)));n.didDrop=!1,n.dropTarget=void 0,this._basicEventHandler("drop",n),this.fire("drop:after",n)}_onContextMenu(t){const e=this.findTarget(t),s=this.targets||[],n=this._basicEventHandler("contextmenu:before",{e:t,target:e,subTargets:s});return this.stopContextMenu&&Mc(t),this._basicEventHandler("contextmenu",n),!1}_onDoubleClick(t){this._cacheTransformEventData(t),this._handleEvent(t,"dblclick"),this._resetTransformEventData()}getPointerId(t){const e=t.changedTouches;return e?e[0]&&e[0].identifier:this.enablePointerEvents?t.pointerId:-1}_isMainEvent(t){return t.isPrimary===!0||t.isPrimary!==!1&&(t.type==="touchend"&&t.touches.length===0||!t.changedTouches||t.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(t){let e=!this.allowTouchScrolling;const s=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(t)),this.__onMouseDown(t),(this.isDrawingMode||s&&this._target===s)&&(e=!0),e&&t.preventDefault(),this._resetTransformEventData();const n=this.upperCanvasEl,i=this._getEventPrefix(),o=ys(n);xn(o,"touchend",this._onTouchEnd,Ve),e&&xn(o,"touchmove",this._onMouseMove,Ve),is(n,"".concat(i,"down"),this._onMouseDown)}_onMouseDown(t){this.__onMouseDown(t),this._resetTransformEventData();const e=this.upperCanvasEl,s=this._getEventPrefix();is(e,"".concat(s,"move"),this._onMouseMove,Ve);const n=ys(e);xn(n,"".concat(s,"up"),this._onMouseUp),xn(n,"".concat(s,"move"),this._onMouseMove,Ve)}_onTouchEnd(t){if(t.touches.length>0)return;this.__onMouseUp(t),this._resetTransformEventData(),delete this.mainTouchId;const e=this._getEventPrefix(),s=ys(this.upperCanvasEl);is(s,"touchend",this._onTouchEnd,Ve),is(s,"touchmove",this._onMouseMove,Ve),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{xn(this.upperCanvasEl,"".concat(e,"down"),this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(t){this.__onMouseUp(t),this._resetTransformEventData();const e=this.upperCanvasEl,s=this._getEventPrefix();if(this._isMainEvent(t)){const n=ys(this.upperCanvasEl);is(n,"".concat(s,"up"),this._onMouseUp),is(n,"".concat(s,"move"),this._onMouseMove,Ve),xn(e,"".concat(s,"move"),this._onMouseMove,Ve)}}_onMouseMove(t){const e=this.getActiveObject();!this.allowTouchScrolling&&(!e||!e.shouldStartDragging(t))&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(t){const e=this.getActiveObject();return!!e!=!!t||e&&t&&e!==t}__onMouseUp(t){var e;this._cacheTransformEventData(t),this._handleEvent(t,"up:before");const s=this._currentTransform,n=this._isClick,i=this._target,{button:o}=t;if(o)return(this.fireMiddleClick&&o===1||this.fireRightClick&&o===2)&&this._handleEvent(t,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(t);if(!this._isMainEvent(t))return;let a,l,c=!1;if(s&&(this._finalizeCurrentTransform(t),c=s.actionPerformed),!n){const h=i===this._activeObject;this.handleSelection(t),c||(c=this._shouldRender(i)||!h&&i===this._activeObject)}if(i){const h=i.findControl(this.getViewportPoint(t),Sa(t)),{key:u,control:f}=h||{};if(l=u,i.selectable&&i!==this._activeObject&&i.activeOn==="up")this.setActiveObject(i,t),c=!0;else if(f){const d=f.getMouseUpHandler(t,i,f);d&&(a=this.getScenePoint(t),d.call(f,t,s,a.x,a.y))}i.isMoving=!1}if(s&&(s.target!==i||s.corner!==l)){const h=s.target&&s.target.controls[s.corner],u=h&&h.getMouseUpHandler(t,s.target,h);a=a||this.getScenePoint(t),u&&u.call(h,t,s,a.x,a.y)}this._setCursorFromEvent(t,i),this._handleEvent(t,"up"),this._groupSelector=null,this._currentTransform=null,i&&(i.__corner=void 0),c?this.requestRenderAll():n||(e=this._activeObject)!==null&&e!==void 0&&e.isEditing||this.renderTop()}_basicEventHandler(t,e){const{target:s,subTargets:n=[]}=e;this.fire(t,e),s&&s.fire(t,e);for(let i=0;i<n.length;i++)n[i]!==s&&n[i].fire(t,e);return e}_handleEvent(t,e){const s=this._target,n=this.targets||[],i=S(S({e:t,target:s,subTargets:n},Mr(this,t)),{},{transform:this._currentTransform},e==="up:before"||e==="up"?{isClick:this._isClick,currentTarget:this.findTarget(t),currentSubTargets:this.targets}:{});this.fire("mouse:".concat(e),i),s&&s.fire("mouse".concat(e),i);for(let o=0;o<n.length;o++)n[o]!==s&&n[o].fire("mouse".concat(e),i)}_onMouseDownInDrawingMode(t){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(t),this.requestRenderAll());const e=this.getScenePoint(t);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(e,{e:t,pointer:e}),this._handleEvent(t,"down")}_onMouseMoveInDrawingMode(t){if(this._isCurrentlyDrawing){const e=this.getScenePoint(t);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(e,{e:t,pointer:e})}this.setCursor(this.freeDrawingCursor),this._handleEvent(t,"move")}_onMouseUpInDrawingMode(t){const e=this.getScenePoint(t);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e:t,pointer:e}):this._isCurrentlyDrawing=!1,this._handleEvent(t,"up")}__onMouseDown(t){this._isClick=!0,this._cacheTransformEventData(t),this._handleEvent(t,"down:before");let e=this._target;const{button:s}=t;if(s)return(this.fireMiddleClick&&s===1||this.fireRightClick&&s===2)&&this._handleEvent(t,"down"),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(t);if(!this._isMainEvent(t)||this._currentTransform)return;let n=this._shouldRender(e),i=!1;if(this.handleMultiSelection(t,e)?(e=this._activeObject,i=!0,n=!0):this._shouldClearSelection(t,e)&&this.discardActiveObject(t),this.selection&&(!e||!e.selectable&&!e.isEditing&&e!==this._activeObject)){const o=this.getScenePoint(t);this._groupSelector={x:o.x,y:o.y,deltaY:0,deltaX:0}}if(e){const o=e===this._activeObject;e.selectable&&e.activeOn==="down"&&this.setActiveObject(e,t);const a=e.findControl(this.getViewportPoint(t),Sa(t));if(e===this._activeObject&&(a||!i)){this._setupCurrentTransform(t,e,o);const l=a?a.control:void 0,c=this.getScenePoint(t),h=l&&l.getMouseDownHandler(t,e,l);h&&h.call(l,t,this._currentTransform,c.x,c.y)}}n&&(this._objectsToRender=void 0),this._handleEvent(t,"down"),n&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(t){this._resetTransformEventData(),this._pointer=this.getViewportPoint(t),this._absolutePointer=un(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(t)}__onMouseMove(t){if(this._isClick=!1,this._cacheTransformEventData(t),this._handleEvent(t,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(t);if(!this._isMainEvent(t))return;const e=this._groupSelector;if(e){const s=this.getScenePoint(t);e.deltaX=s.x-e.x,e.deltaY=s.y-e.y,this.renderTop()}else if(this._currentTransform)this._transformObject(t);else{const s=this.findTarget(t);this._setCursorFromEvent(t,s),this._fireOverOutEvents(t,s)}this.textEditingManager.onMouseMove(t),this._handleEvent(t,"move"),this._resetTransformEventData()}_fireOverOutEvents(t,e){const s=this._hoveredTarget,n=this._hoveredTargets,i=this.targets,o=Math.max(n.length,i.length);this.fireSyntheticInOutEvents("mouse",{e:t,target:e,oldTarget:s,fireCanvas:!0});for(let a=0;a<o;a++)this.fireSyntheticInOutEvents("mouse",{e:t,target:i[a],oldTarget:n[a]});this._hoveredTarget=e,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(t,e){const s=this._draggedoverTarget,n=this._hoveredTargets,i=this.targets,o=Math.max(n.length,i.length);this.fireSyntheticInOutEvents("drag",S(S({},e),{},{target:t,oldTarget:s,fireCanvas:!0}));for(let a=0;a<o;a++)this.fireSyntheticInOutEvents("drag",S(S({},e),{},{target:i[a],oldTarget:n[a]}));this._draggedoverTarget=t}fireSyntheticInOutEvents(t,e){let{target:s,oldTarget:n,fireCanvas:i,e:o}=e,a=It(e,kx);const{targetIn:l,targetOut:c,canvasIn:h,canvasOut:u}=Mx[t],f=n!==s;if(n&&f){const d=S(S({},a),{},{e:o,target:n,nextTarget:s},Mr(this,o));i&&this.fire(u,d),n.fire(c,d)}if(s&&f){const d=S(S({},a),{},{e:o,target:s,previousTarget:n},Mr(this,o));i&&this.fire(h,d),s.fire(l,d)}}__onMouseWheel(t){this._cacheTransformEventData(t),this._handleEvent(t,"wheel"),this._resetTransformEventData()}_transformObject(t){const e=this.getScenePoint(t),s=this._currentTransform,n=s.target,i=n.group?un(e,void 0,n.group.calcTransformMatrix()):e;s.shiftKey=t.shiftKey,s.altKey=!!this.centeredKey&&t[this.centeredKey],this._performTransformAction(t,s,i),s.actionPerformed&&this.requestRenderAll()}_performTransformAction(t,e,s){const{action:n,actionHandler:i,target:o}=e,a=!!i&&i(t,e,s.x,s.y);a&&o.setCoords(),n==="drag"&&a&&(e.target.isMoving=!0,this.setCursor(e.target.moveCursor||this.moveCursor)),e.actionPerformed=e.actionPerformed||a}_setCursorFromEvent(t,e){if(!e)return void this.setCursor(this.defaultCursor);let s=e.hoverCursor||this.hoverCursor;const n=sr(this._activeObject)?this._activeObject:null,i=(!n||e.group!==n)&&e.findControl(this.getViewportPoint(t));if(i){const o=i.control;this.setCursor(o.cursorStyleHandler(t,o,e))}else e.subTargetCheck&&this.targets.concat().reverse().map(o=>{s=o.hoverCursor||s}),this.setCursor(s)}handleMultiSelection(t,e){const s=this._activeObject,n=sr(s);if(s&&this._isSelectionKeyPressed(t)&&this.selection&&e&&e.selectable&&(s!==e||n)&&(n||!e.isDescendantOf(s)&&!s.isDescendantOf(e))&&!e.onSelect({e:t})&&!s.getActiveControl()){if(n){const i=s.getObjects();if(e===s){const o=this.getViewportPoint(t);if(!(e=this.searchPossibleTargets(i,o)||this.searchPossibleTargets(this._objects,o))||!e.selectable)return!1}e.group===s?(s.remove(e),this._hoveredTarget=e,this._hoveredTargets=[...this.targets],s.size()===1&&this._setActiveObject(s.item(0),t)):(s.multiSelectAdd(e),this._hoveredTarget=s,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(i,t)}else{s.isEditing&&s.exitEditing();const i=new(q.getClass("ActiveSelection"))([],{canvas:this});i.multiSelectAdd(s,e),this._hoveredTarget=i,this._setActiveObject(i,t),this._fireSelectionEvents([s],t)}return!0}return!1}handleSelection(t){if(!this.selection||!this._groupSelector)return!1;const{x:e,y:s,deltaX:n,deltaY:i}=this._groupSelector,o=new M(e,s),a=o.add(new M(n,i)),l=o.min(a),c=o.max(a).subtract(l),h=this.collectObjects({left:l.x,top:l.y,width:c.x,height:c.y},{includeIntersecting:!this.selectionFullyContained}),u=o.eq(a)?h[0]?[h[0]]:[]:h.length>1?h.filter(f=>!f.onSelect({e:t})).reverse():h;if(u.length===1)this.setActiveObject(u[0],t);else if(u.length>1){const f=q.getClass("ActiveSelection");this.setActiveObject(new f(u,{canvas:this}),t)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const Kp={x1:0,y1:0,x2:0,y2:0},Ex=S(S({},Kp),{},{r1:0,r2:0}),Dr=(r,t)=>isNaN(r)&&typeof t=="number"?t:r,Ax=/^(\d+\.\d+)%|(\d+)%$/;function Jp(r){return r&&Ax.test(r)}function Zp(r,t){const e=typeof r=="number"?r:typeof r=="string"?parseFloat(r)/(Jp(r)?100:1):NaN;return yr(0,Dr(e,t),1)}const Px=/\s*;\s*/,Fx=/\s*:\s*/;function Dx(r,t){let e,s;const n=r.getAttribute("style");if(n){const o=n.split(Px);o[o.length-1]===""&&o.pop();for(let a=o.length;a--;){const[l,c]=o[a].split(Fx).map(h=>h.trim());l==="stop-color"?e=c:l==="stop-opacity"&&(s=c)}}const i=new kt(e||r.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:Zp(r.getAttribute("offset"),0),color:i.toRgb(),opacity:Dr(parseFloat(s||r.getAttribute("stop-opacity")||""),1)*i.getAlpha()*t}}function Rx(r,t){const e=[],s=r.getElementsByTagName("stop"),n=Zp(t,1);for(let i=s.length;i--;)e.push(Dx(s[i],n));return e}function Qp(r){return r.nodeName==="linearGradient"||r.nodeName==="LINEARGRADIENT"?"linear":"radial"}function tm(r){return r.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function _s(r,t){return r.getAttribute(t)}function Lx(r,t){return function(e,s){let n,{width:i,height:o,gradientUnits:a}=s;return Object.keys(e).reduce((l,c)=>{const h=e[c];return h==="Infinity"?n=1:h==="-Infinity"?n=0:(n=typeof h=="string"?parseFloat(h):h,typeof h=="string"&&Jp(h)&&(n*=.01,a==="pixels"&&(c!=="x1"&&c!=="x2"&&c!=="r2"||(n*=i),c!=="y1"&&c!=="y2"||(n*=o)))),l[c]=n,l},{})}(Qp(r)==="linear"?function(e){return{x1:_s(e,"x1")||0,y1:_s(e,"y1")||0,x2:_s(e,"x2")||"100%",y2:_s(e,"y2")||0}}(r):function(e){return{x1:_s(e,"fx")||_s(e,"cx")||"50%",y1:_s(e,"fy")||_s(e,"cy")||"50%",r1:0,x2:_s(e,"cx")||"50%",y2:_s(e,"cy")||"50%",r2:_s(e,"r")||"50%"}}(r),S(S({},t),{},{gradientUnits:tm(r)}))}class ko{constructor(t){const{type:e="linear",gradientUnits:s="pixels",coords:n={},colorStops:i=[],offsetX:o=0,offsetY:a=0,gradientTransform:l,id:c}=t||{};Object.assign(this,{type:e,gradientUnits:s,coords:S(S({},e==="radial"?Ex:Kp),n),colorStops:i,offsetX:o,offsetY:a,gradientTransform:l,id:c?"".concat(c,"_").concat(Bn()):Bn()})}addColorStop(t){for(const e in t){const s=new kt(t[e]);this.colorStops.push({offset:parseFloat(e),color:s.toRgb(),opacity:s.getAlpha()})}return this}toObject(t){return S(S({},Cr(this,t)),{},{type:this.type,coords:S({},this.coords),colorStops:this.colorStops.map(e=>S({},e)),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(t){let{additionalTransform:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=[],n=this.gradientTransform?this.gradientTransform.concat():Ee.concat(),i=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",o=this.colorStops.map(u=>S({},u)).sort((u,f)=>u.offset-f.offset);let a=-this.offsetX,l=-this.offsetY;var c;i==="objectBoundingBox"?(a/=t.width,l/=t.height):(a+=t.width/2,l+=t.height/2),(c=t)&&typeof c._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(a-=t.pathOffset.x,l-=t.pathOffset.y),n[4]-=a,n[5]-=l;const h=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(i,'"'),'gradientTransform="'.concat(e?e+" ":"").concat(so(n),'"'),""].join(" ");if(this.type==="linear"){const{x1:u,y1:f,x2:d,y2:p}=this.coords;s.push("<linearGradient ",h,' x1="',u,'" y1="',f,'" x2="',d,'" y2="',p,`">
`)}else if(this.type==="radial"){const{x1:u,y1:f,x2:d,y2:p,r1:g,r2:m}=this.coords,v=g>m;s.push("<radialGradient ",h,' cx="',v?u:d,'" cy="',v?f:p,'" r="',v?g:m,'" fx="',v?d:u,'" fy="',v?p:f,`">
`),v&&(o.reverse(),o.forEach(y=>{y.offset=1-y.offset}));const _=Math.min(g,m);if(_>0){const y=_/Math.max(g,m);o.forEach(b=>{b.offset+=y*(1-b.offset)})}}return o.forEach(u=>{let{color:f,offset:d,opacity:p}=u;s.push("<stop ",'offset="',100*d+"%",'" style="stop-color:',f,p!==void 0?";stop-opacity: "+p:";",`"/>
`)}),s.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),s.join("")}toLive(t){const{x1:e,y1:s,x2:n,y2:i,r1:o,r2:a}=this.coords,l=this.type==="linear"?t.createLinearGradient(e,s,n,i):t.createRadialGradient(e,s,o,n,i,a);return this.colorStops.forEach(c=>{let{color:h,opacity:u,offset:f}=c;l.addColorStop(f,u!==void 0?new kt(h).setAlpha(u).toRgba():h)}),l}static async fromObject(t){const{colorStops:e,gradientTransform:s}=t;return new this(S(S({},t),{},{colorStops:e?e.map(n=>S({},n)):void 0,gradientTransform:s?[...s]:void 0}))}static fromElement(t,e,s){const n=tm(t),i=e._findCenterFromElement();return new this(S({id:t.getAttribute("id")||void 0,type:Qp(t),coords:Lx(t,{width:s.viewBoxWidth||s.width,height:s.viewBoxHeight||s.height}),colorStops:Rx(t,s.opacity),gradientUnits:n,gradientTransform:Lc(t.getAttribute("gradientTransform")||"")},n==="pixels"?{offsetX:e.width/2-i.x,offsetY:e.height/2-i.y}:{offsetX:0,offsetY:0}))}}T(ko,"type","Gradient"),q.setClass(ko,"gradient"),q.setClass(ko,"linear"),q.setClass(ko,"radial");const jx=["type","source","patternTransform"];class Xl{get type(){return"pattern"}set type(t){jn("warn","Setting type has no effect",t)}constructor(t){T(this,"repeat","repeat"),T(this,"offsetX",0),T(this,"offsetY",0),T(this,"crossOrigin",""),this.id=Bn(),Object.assign(this,t)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(t){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?t.createPattern(this.source,this.repeat):null}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:e,crossOrigin:s}=this;return S(S({},Cr(this,t)),{},{type:"pattern",source:this.sourceToString(),repeat:e,crossOrigin:s,offsetX:jt(this.offsetX,_t.NUM_FRACTION_DIGITS),offsetY:jt(this.offsetY,_t.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(t){let{width:e,height:s}=t;const{source:n,repeat:i,id:o}=this,a=Dr(this.offsetX/e,0),l=Dr(this.offsetY/s,0),c=i==="repeat-y"||i==="no-repeat"?1+Math.abs(a||0):Dr(n.width/e,0),h=i==="repeat-x"||i==="no-repeat"?1+Math.abs(l||0):Dr(n.height/s,0);return['<pattern id="SVGID_'.concat(o,'" x="').concat(a,'" y="').concat(l,'" width="').concat(c,'" height="').concat(h,'">'),'<image x="0" y="0" width="'.concat(n.width,'" height="').concat(n.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(t,e){let{type:s,source:n,patternTransform:i}=t,o=It(t,jx);const a=await Hi(n,S(S({},e),{},{crossOrigin:o.crossOrigin}));return new this(S(S({},o),{},{patternTransform:i&&i.slice(0),source:a}))}}T(Xl,"type","Pattern"),q.setClass(Xl),q.setClass(Xl,"pattern");const Ix=["path","left","top"],Bx=["d"];class nr extends ne{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:s,left:n,top:i}=e,o=It(e,Ix);super(),Object.assign(this,nr.ownDefaults),this.setOptions(o),this._setPath(t||[],!0),typeof n=="number"&&this.set(St,n),typeof i=="number"&&this.set(De,i)}_setPath(t,e){this.path=zp(Array.isArray(t)?t:$p(t)),this.setBoundingBox(e)}_findCenterFromElement(){const t=this._calcBoundsFromPath();return new M(t.left+t.width/2,t.top+t.height/2)}_renderPathCommands(t){const e=-this.pathOffset.x,s=-this.pathOffset.y;t.beginPath();for(const n of this.path)switch(n[0]){case"L":t.lineTo(n[1]+e,n[2]+s);break;case"M":t.moveTo(n[1]+e,n[2]+s);break;case"C":t.bezierCurveTo(n[1]+e,n[2]+s,n[3]+e,n[4]+s,n[5]+e,n[6]+s);break;case"Q":t.quadraticCurveTo(n[1]+e,n[2]+s,n[3]+e,n[4]+s);break;case"Z":t.closePath()}}_render(t){this._renderPathCommands(t),this._renderPaintInOrder(t)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return S(S({},super.toObject(t)),{},{path:this.path.map(e=>e.slice())})}toDatalessObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=this.toObject(t);return this.sourcePath&&(delete e.path,e.sourcePath=this.sourcePath),e}_toSVG(){const t=qp(this.path,_t.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(t,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const t=_t.NUM_FRACTION_DIGITS;return" translate(".concat(jt(-this.pathOffset.x,t),", ").concat(jt(-this.pathOffset.y,t),")")}toClipPathSVG(t){const e=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})}toSVG(t){const e=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(t){const{width:e,height:s,pathOffset:n}=this._calcDimensions();this.set({width:e,height:s,pathOffset:n}),t&&this.setPositionByOrigin(n,gt,gt)}_calcBoundsFromPath(){const t=[];let e=0,s=0,n=0,i=0;for(const o of this.path)switch(o[0]){case"L":n=o[1],i=o[2],t.push({x:e,y:s},{x:n,y:i});break;case"M":n=o[1],i=o[2],e=n,s=i;break;case"C":t.push(...Bc(n,i,o[1],o[2],o[3],o[4],o[5],o[6])),n=o[5],i=o[6];break;case"Q":t.push(...Bc(n,i,o[1],o[2],o[1],o[2],o[3],o[4])),n=o[3],i=o[4];break;case"Z":n=e,i=s}return Vs(t)}_calcDimensions(){const t=this._calcBoundsFromPath();return S(S({},t),{},{pathOffset:new M(t.left+t.width/2,t.top+t.height/2)})}static fromObject(t){return this._fromObject(t,{extraParam:"path"})}static async fromElement(t,e,s){const n=_n(t,this.ATTRIBUTE_NAMES,s),{d:i}=n;return new this(i,S(S(S({},It(n,Bx)),e),{},{left:void 0,top:void 0}))}}T(nr,"type","Path"),T(nr,"cacheProperties",[...vn,"path","fillRule"]),T(nr,"ATTRIBUTE_NAMES",[...Un,"d"]),q.setClass(nr),q.setSVGClass(nr);const Nx=["left","top","radius"],em=["radius","startAngle","endAngle","counterClockwise"];class js extends ne{static getDefaults(){return S(S({},super.getDefaults()),js.ownDefaults)}constructor(t){super(),Object.assign(this,js.ownDefaults),this.setOptions(t)}_set(t,e){return super._set(t,e),t==="radius"&&this.setRadius(e),this}_render(t){t.beginPath(),t.arc(0,0,this.radius,Vt(this.startAngle),Vt(this.endAngle),this.counterClockwise),this._renderPaintInOrder(t)}getRadiusX(){return this.get("radius")*this.get(Ae)}getRadiusY(){return this.get("radius")*this.get(ss)}setRadius(t){this.radius=t,this.set({width:2*t,height:2*t})}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...em,...t])}_toSVG(){const t=(this.endAngle-this.startAngle)%360;if(t===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:e}=this,s=Vt(this.startAngle),n=Vt(this.endAngle),i=Os(s)*e,o=ks(s)*e,a=Os(n)*e,l=ks(n)*e,c=t>180?1:0,h=this.counterClockwise?0:1;return['<path d="M '.concat(i," ").concat(o," A ").concat(e," ").concat(e," 0 ").concat(c," ").concat(h," ").concat(a," ").concat(l,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(t,e,s){const n=_n(t,this.ATTRIBUTE_NAMES,s),{left:i=0,top:o=0,radius:a=0}=n;return new this(S(S({},It(n,Nx)),{},{radius:a,left:i-a,top:o-a}))}static fromObject(t){return super._fromObject(t)}}T(js,"type","Circle"),T(js,"cacheProperties",[...vn,...em]),T(js,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),T(js,"ATTRIBUTE_NAMES",["cx","cy","r",...Un]),q.setClass(js),q.setSVGClass(js);const Hx=["x1","y1","x2","y2"],Yx=["x1","y1","x2","y2"],Nc=["x1","x2","y1","y2"];class Tn extends ne{constructor(){let[t,e,s,n]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Tn.ownDefaults),this.setOptions(i),this.x1=t,this.x2=s,this.y1=e,this.y2=n,this._setWidthHeight();const{left:o,top:a}=i;typeof o=="number"&&this.set(St,o),typeof a=="number"&&this.set(De,a)}_setWidthHeight(){const{x1:t,y1:e,x2:s,y2:n}=this;this.width=Math.abs(s-t),this.height=Math.abs(n-e);const{left:i,top:o,width:a,height:l}=Vs([{x:t,y:e},{x:s,y:n}]),c=new M(i+a/2,o+l/2);this.setPositionByOrigin(c,gt,gt)}_set(t,e){return super._set(t,e),Nc.includes(t)&&this._setWidthHeight(),this}_render(t){t.beginPath();const e=this.calcLinePoints();t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2),t.lineWidth=this.strokeWidth;const s=t.strokeStyle;var n;cs(this.stroke)?t.strokeStyle=this.stroke.toLive(t):t.strokeStyle=(n=this.stroke)!==null&&n!==void 0?n:t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=s}_findCenterFromElement(){return new M((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return S(S({},super.toObject(t)),this.calcLinePoints())}_getNonTransformedDimensions(){const t=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(t.y-=this.strokeWidth),this.height===0&&(t.x-=this.strokeWidth)),t}calcLinePoints(){const{x1:t,x2:e,y1:s,y2:n,width:i,height:o}=this,a=t<=e?-1:1,l=s<=n?-1:1;return{x1:a*i/2,x2:a*-i/2,y1:l*o/2,y2:l*-o/2}}_toSVG(){const{x1:t,x2:e,y1:s,y2:n}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(t,'" y1="').concat(s,'" x2="').concat(e,'" y2="').concat(n,`" />
`)]}static async fromElement(t,e,s){const n=_n(t,this.ATTRIBUTE_NAMES,s),{x1:i=0,y1:o=0,x2:a=0,y2:l=0}=n;return new this([i,o,a,l],It(n,Hx))}static fromObject(t){let{x1:e,y1:s,x2:n,y2:i}=t,o=It(t,Yx);return this._fromObject(S(S({},o),{},{points:[e,s,n,i]}),{extraParam:"points"})}}T(Tn,"type","Line"),T(Tn,"cacheProperties",[...vn,...Nc]),T(Tn,"ATTRIBUTE_NAMES",Un.concat(Nc)),q.setClass(Tn),q.setSVGClass(Tn);class On extends ne{static getDefaults(){return S(S({},super.getDefaults()),On.ownDefaults)}constructor(t){super(),Object.assign(this,On.ownDefaults),this.setOptions(t)}_render(t){const e=this.width/2,s=this.height/2;t.beginPath(),t.moveTo(-e,s),t.lineTo(0,-s),t.lineTo(e,s),t.closePath(),this._renderPaintInOrder(t)}_toSVG(){const t=this.width/2,e=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-t," ").concat(e,",0 ").concat(-e,",").concat(t," ").concat(e),'" />']}}T(On,"type","Triangle"),T(On,"ownDefaults",{width:100,height:100}),q.setClass(On),q.setSVGClass(On);const sm=["rx","ry"];class nn extends ne{static getDefaults(){return S(S({},super.getDefaults()),nn.ownDefaults)}constructor(t){super(),Object.assign(this,nn.ownDefaults),this.setOptions(t)}_set(t,e){switch(super._set(t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e)}return this}getRx(){return this.get("rx")*this.get(Ae)}getRy(){return this.get("ry")*this.get(ss)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...sm,...t])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(t){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(0,0,this.rx,0,fn,!1),t.restore(),this._renderPaintInOrder(t)}static async fromElement(t,e,s){const n=_n(t,this.ATTRIBUTE_NAMES,s);return n.left=(n.left||0)-n.rx,n.top=(n.top||0)-n.ry,new this(n)}}function zx(r){if(!r)return[];const t=r.replace(/,/g," ").trim().split(/\s+/),e=[];for(let s=0;s<t.length;s+=2)e.push({x:parseFloat(t[s]),y:parseFloat(t[s+1])});return e}T(nn,"type","Ellipse"),T(nn,"cacheProperties",[...vn,...sm]),T(nn,"ownDefaults",{rx:0,ry:0}),T(nn,"ATTRIBUTE_NAMES",[...Un,"cx","cy","rx","ry"]),q.setClass(nn),q.setSVGClass(nn);const Xx=["left","top"],nm={exactBoundingBox:!1};class as extends ne{static getDefaults(){return S(S({},super.getDefaults()),as.ownDefaults)}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),T(this,"strokeDiff",void 0),Object.assign(this,as.ownDefaults),this.setOptions(e),this.points=t;const{left:s,top:n}=e;this.initialized=!0,this.setBoundingBox(!0),typeof s=="number"&&this.set(St,s),typeof n=="number"&&this.set(De,n)}isOpen(){return!0}_projectStrokeOnPoints(t){return Dp(this.points,t,this.isOpen())}_calcDimensions(t){t=S({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},t||{});const e=this.exactBoundingBox?this._projectStrokeOnPoints(t).map(c=>c.projectedPoint):this.points;if(e.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new M,strokeOffset:new M,strokeDiff:new M};const s=Vs(e),n=_o(S(S({},t),{},{scaleX:1,scaleY:1})),i=Vs(this.points.map(c=>ue(c,n,!0))),o=new M(this.scaleX,this.scaleY);let a=s.left+s.width/2,l=s.top+s.height/2;return this.exactBoundingBox&&(a-=l*Math.tan(Vt(this.skewX)),l-=a*Math.tan(Vt(this.skewY))),S(S({},s),{},{pathOffset:new M(a,l),strokeOffset:new M(i.left,i.top).subtract(new M(s.left,s.top)).multiply(o),strokeDiff:new M(s.width,s.height).subtract(new M(i.width,i.height)).multiply(o)})}_findCenterFromElement(){const t=Vs(this.points);return new M(t.left+t.width/2,t.top+t.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(t){const{left:e,top:s,width:n,height:i,pathOffset:o,strokeOffset:a,strokeDiff:l}=this._calcDimensions();this.set({width:n,height:i,pathOffset:o,strokeOffset:a,strokeDiff:l}),t&&this.setPositionByOrigin(new M(e+n/2,s+i/2),gt,gt)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new M(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let o;if(Object.keys(t).some(a=>this.strokeUniform||this.constructor.layoutProperties.includes(a))){var e,s;const{width:a,height:l}=this._calcDimensions(t);o=new M((e=t.width)!==null&&e!==void 0?e:a,(s=t.height)!==null&&s!==void 0?s:l)}else{var n,i;o=new M((n=t.width)!==null&&n!==void 0?n:this.width,(i=t.height)!==null&&i!==void 0?i:this.height)}return o.multiply(new M(t.scaleX||this.scaleX,t.scaleY||this.scaleY))}return super._getTransformedDimensions(t)}_set(t,e){const s=this.initialized&&this[t]!==e,n=super._set(t,e);return this.exactBoundingBox&&s&&((t===Ae||t===ss)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(t))&&this.setDimensions(),n}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return S(S({},super.toObject(t)),{},{points:this.points.map(e=>{let{x:s,y:n}=e;return{x:s,y:n}})})}_toSVG(){const t=[],e=this.pathOffset.x,s=this.pathOffset.y,n=_t.NUM_FRACTION_DIGITS;for(let i=0,o=this.points.length;i<o;i++)t.push(jt(this.points[i].x-e,n),",",jt(this.points[i].y-s,n)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(t.join(""),`" />
`)]}_render(t){const e=this.points.length,s=this.pathOffset.x,n=this.pathOffset.y;if(e&&!isNaN(this.points[e-1].y)){t.beginPath(),t.moveTo(this.points[0].x-s,this.points[0].y-n);for(let i=0;i<e;i++){const o=this.points[i];t.lineTo(o.x-s,o.y-n)}!this.isOpen()&&t.closePath(),this._renderPaintInOrder(t)}}complexity(){return this.points.length}static async fromElement(t,e,s){return new this(zx(t.getAttribute("points")),S(S({},It(_n(t,this.ATTRIBUTE_NAMES,s),Xx)),e))}static fromObject(t){return this._fromObject(t,{extraParam:"points"})}}T(as,"ownDefaults",nm),T(as,"type","Polyline"),T(as,"layoutProperties",[fi,di,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),T(as,"cacheProperties",[...vn,"points"]),T(as,"ATTRIBUTE_NAMES",[...Un]),q.setClass(as),q.setSVGClass(as);class Mo extends as{isOpen(){return!1}}T(Mo,"ownDefaults",nm),T(Mo,"type","Polygon"),q.setClass(Mo),q.setSVGClass(Mo);const rm=["fontSize","fontWeight","fontFamily","fontStyle"],im=["underline","overline","linethrough"],om=[...rm,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],am=[...om,...im,"textBackgroundColor","direction"],Vx=[...rm,...im,Le,"strokeWidth",ee,"deltaY","textBackgroundColor"],Wx={_reNewline:wh,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:St,fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:St,pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2},Is="justify",Da="justify-left",Yi="justify-right",zi="justify-center";class lm extends ne{isEmptyStyles(t){if(!this.styles||t!==void 0&&!this.styles[t])return!0;const e=t===void 0?this.styles:{line:this.styles[t]};for(const s in e)for(const n in e[s])for(const i in e[s][n])return!1;return!0}styleHas(t,e){if(!this.styles||e!==void 0&&!this.styles[e])return!1;const s=e===void 0?this.styles:{0:this.styles[e]};for(const n in s)for(const i in s[n])if(s[n][i][t]!==void 0)return!0;return!1}cleanStyle(t){if(!this.styles)return!1;const e=this.styles;let s,n,i=0,o=!0,a=0;for(const l in e){s=0;for(const c in e[l]){const h=e[l][c]||{};i++,h[t]!==void 0?(n?h[t]!==n&&(o=!1):n=h[t],h[t]===this[t]&&delete h[t]):o=!1,Object.keys(h).length!==0?s++:delete e[l][c]}s===0&&delete e[l]}for(let l=0;l<this._textLines.length;l++)a+=this._textLines[l].length;o&&i===a&&(this[t]=n,this.removeStyle(t))}removeStyle(t){if(!this.styles)return;const e=this.styles;let s,n,i;for(n in e){for(i in s=e[n],s)delete s[i][t],Object.keys(s[i]).length===0&&delete s[i];Object.keys(s).length===0&&delete e[n]}}_extendStyles(t,e){const{lineIndex:s,charIndex:n}=this.get2DCursorLocation(t);this._getLineStyle(s)||this._setLineStyle(s);const i=Ah(S(S({},this._getStyleDeclaration(s,n)),e),o=>o!==void 0);this._setStyleDeclaration(s,n,i)}getSelectionStyles(t,e,s){const n=[];for(let i=t;i<(e||t);i++)n.push(this.getStyleAtPosition(i,s));return n}getStyleAtPosition(t,e){const{lineIndex:s,charIndex:n}=this.get2DCursorLocation(t);return e?this.getCompleteStyleDeclaration(s,n):this._getStyleDeclaration(s,n)}setSelectionStyles(t,e,s){for(let n=e;n<(s||e);n++)this._extendStyles(n,t);this._forceClearCache=!0}_getStyleDeclaration(t,e){var s;const n=this.styles&&this.styles[t];return n&&(s=n[e])!==null&&s!==void 0?s:{}}getCompleteStyleDeclaration(t,e){return S(S({},Cr(this,this.constructor._styleProperties)),this._getStyleDeclaration(t,e))}_setStyleDeclaration(t,e,s){this.styles[t][e]=s}_deleteStyleDeclaration(t,e){delete this.styles[t][e]}_getLineStyle(t){return!!this.styles[t]}_setLineStyle(t){this.styles[t]={}}_deleteLineStyle(t){delete this.styles[t]}}T(lm,"_styleProperties",Vx);const Ux=/  +/g,Gx=/"/g;function Vl(r,t,e,s,n){return"		".concat(function(i,o){let{left:a,top:l,width:c,height:h}=o,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_t.NUM_FRACTION_DIGITS;const f=no(ee,i,!1),[d,p,g,m]=[a,l,c,h].map(v=>jt(v,u));return"<rect ".concat(f,' x="').concat(d,'" y="').concat(p,'" width="').concat(g,'" height="').concat(m,'"></rect>')}(r,{left:t,top:e,width:s,height:n}),`
`)}const $x=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let Wl;class he extends lm{static getDefaults(){return S(S({},super.getDefaults()),he.ownDefaults)}constructor(t,e){super(),T(this,"__charBounds",[]),Object.assign(this,he.ownDefaults),this.setOptions(e),this.styles||(this.styles={}),this.text=t,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const t=this.path;t&&(t.segmentsInfo=Xh(t.path))}_splitText(){const t=this._splitTextIntoLines(this.text);return this.textLines=t.lines,this._textLines=t.graphemeLines,this._unwrappedTextLines=t._unwrappedLines,this._text=t.graphemeText,t}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(Is)&&this.enlargeSpaces()}enlargeSpaces(){let t,e,s,n,i,o,a;for(let l=0,c=this._textLines.length;l<c;l++)if((this.textAlign===Is||l!==c-1&&!this.isEndOfWrapping(l))&&(n=0,i=this._textLines[l],e=this.getLineWidth(l),e<this.width&&(a=this.textLines[l].match(this._reSpacesAndTabs)))){s=a.length,t=(this.width-e)/s;for(let h=0;h<=i.length;h++)o=this.__charBounds[l][h],this._reSpaceAndTab.test(i[h])?(o.width+=t,o.kernedWidth+=t,o.left+=n,n+=t):o.left+=n}}isEndOfWrapping(t){return t===this._textLines.length-1}missingNewlineOffset(t){return 1}get2DCursorLocation(t,e){const s=e?this._unwrappedTextLines:this._textLines;let n;for(n=0;n<s.length;n++){if(t<=s[n].length)return{lineIndex:n,charIndex:t};t-=s[n].length+this.missingNewlineOffset(n,e)}return{lineIndex:n-1,charIndex:s[n-1].length<t?s[n-1].length:t}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const t=super._getCacheCanvasDimensions(),e=this.fontSize;return t.width+=e*t.zoomX,t.height+=e*t.zoomY,t}_render(t){const e=this.path;e&&!e.isNotVisible()&&e._render(t),this._setTextStyles(t),this._renderTextLinesBackground(t),this._renderTextDecoration(t,"underline"),this._renderText(t),this._renderTextDecoration(t,"overline"),this._renderTextDecoration(t,"linethrough")}_renderText(t){this.paintFirst===Le?(this._renderTextStroke(t),this._renderTextFill(t)):(this._renderTextFill(t),this._renderTextStroke(t))}_setTextStyles(t,e,s){if(t.textBaseline="alphabetic",this.path)switch(this.pathAlign){case gt:t.textBaseline="middle";break;case"ascender":t.textBaseline=De;break;case"descender":t.textBaseline=Oc}t.font=this._getFontDeclaration(e,s)}calcTextWidth(){let t=this.getLineWidth(0);for(let e=1,s=this._textLines.length;e<s;e++){const n=this.getLineWidth(e);n>t&&(t=n)}return t}_renderTextLine(t,e,s,n,i,o){this._renderChars(t,e,s,n,i,o)}_renderTextLinesBackground(t){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const e=t.fillStyle,s=this._getLeftOffset();let n=this._getTopOffset();for(let i=0,o=this._textLines.length;i<o;i++){const a=this.getHeightOfLine(i);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",i)){n+=a;continue}const l=this._textLines[i].length,c=this._getLineLeftOffset(i);let h,u,f=0,d=0,p=this.getValueOfPropertyAt(i,0,"textBackgroundColor");for(let g=0;g<l;g++){const m=this.__charBounds[i][g];u=this.getValueOfPropertyAt(i,g,"textBackgroundColor"),this.path?(t.save(),t.translate(m.renderLeft,m.renderTop),t.rotate(m.angle),t.fillStyle=u,u&&t.fillRect(-m.width/2,-a/this.lineHeight*(1-this._fontSizeFraction),m.width,a/this.lineHeight),t.restore()):u!==p?(h=s+c+d,this.direction==="rtl"&&(h=this.width-h-f),t.fillStyle=p,p&&t.fillRect(h,n,f,a/this.lineHeight),d=m.left,f=m.width,p=u):f+=m.kernedWidth}u&&!this.path&&(h=s+c+d,this.direction==="rtl"&&(h=this.width-h-f),t.fillStyle=u,t.fillRect(h,n,f,a/this.lineHeight)),n+=a}t.fillStyle=e,this._removeShadow(t)}_measureChar(t,e,s,n){const i=Bi.getFontCache(e),o=this._getFontDeclaration(e),a=s+t,l=s&&o===this._getFontDeclaration(n),c=e.fontSize/this.CACHE_FONT_SIZE;let h,u,f,d;if(s&&i[s]!==void 0&&(f=i[s]),i[t]!==void 0&&(d=h=i[t]),l&&i[a]!==void 0&&(u=i[a],d=u-f),h===void 0||f===void 0||u===void 0){const p=function(){return Wl||(Wl=Ms({width:0,height:0}).getContext("2d")),Wl}();this._setTextStyles(p,e,!0),h===void 0&&(d=h=p.measureText(t).width,i[t]=h),f===void 0&&l&&s&&(f=p.measureText(s).width,i[s]=f),l&&u===void 0&&(u=p.measureText(a).width,i[a]=u,d=u-f)}return{width:h*c,kernedWidth:d*c}}getHeightOfChar(t,e){return this.getValueOfPropertyAt(t,e,"fontSize")}measureLine(t){const e=this._measureLine(t);return this.charSpacing!==0&&(e.width-=this._getWidthOfCharSpacing()),e.width<0&&(e.width=0),e}_measureLine(t){let e,s,n=0;const i=this.pathSide===$t,o=this.path,a=this._textLines[t],l=a.length,c=new Array(l);this.__charBounds[t]=c;for(let h=0;h<l;h++){const u=a[h];s=this._getGraphemeBox(u,t,h,e),c[h]=s,n+=s.kernedWidth,e=u}if(c[l]={left:s?s.left+s.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},o&&o.segmentsInfo){let h=0;const u=o.segmentsInfo[o.segmentsInfo.length-1].length;switch(this.textAlign){case St:h=i?u-n:0;break;case gt:h=(u-n)/2;break;case $t:h=i?0:u-n}h+=this.pathStartOffset*(i?-1:1);for(let f=i?l-1:0;i?f>=0:f<l;i?f--:f++)s=c[f],h>u?h%=u:h<0&&(h+=u),this._setGraphemeOnPath(h,s),h+=s.kernedWidth}return{width:n,numOfSpaces:0}}_setGraphemeOnPath(t,e){const s=t+e.kernedWidth/2,n=this.path,i=Gp(n.path,s,n.segmentsInfo);e.renderLeft=i.x-n.pathOffset.x,e.renderTop=i.y-n.pathOffset.y,e.angle=i.angle+(this.pathSide===$t?Math.PI:0)}_getGraphemeBox(t,e,s,n,i){const o=this.getCompleteStyleDeclaration(e,s),a=n?this.getCompleteStyleDeclaration(e,s-1):{},l=this._measureChar(t,o,n,a);let c,h=l.kernedWidth,u=l.width;this.charSpacing!==0&&(c=this._getWidthOfCharSpacing(),u+=c,h+=c);const f={width:u,left:0,height:o.fontSize,kernedWidth:h,deltaY:o.deltaY};if(s>0&&!i){const d=this.__charBounds[e][s-1];f.left=d.left+d.width+l.kernedWidth-l.width}return f}getHeightOfLine(t){if(this.__lineHeights[t])return this.__lineHeights[t];let e=this.getHeightOfChar(t,0);for(let s=1,n=this._textLines[t].length;s<n;s++)e=Math.max(this.getHeightOfChar(t,s),e);return this.__lineHeights[t]=e*this.lineHeight*this._fontSizeMult}calcTextHeight(){let t,e=0;for(let s=0,n=this._textLines.length;s<n;s++)t=this.getHeightOfLine(s),e+=s===n-1?t/this.lineHeight:t;return e}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(t,e){t.save();let s=0;const n=this._getLeftOffset(),i=this._getTopOffset();for(let o=0,a=this._textLines.length;o<a;o++){const l=this.getHeightOfLine(o),c=l/this.lineHeight,h=this._getLineLeftOffset(o);this._renderTextLine(e,t,this._textLines[o],n+h,i+s+c,o),s+=l}t.restore()}_renderTextFill(t){(this.fill||this.styleHas(ee))&&this._renderTextCommon(t,"fillText")}_renderTextStroke(t){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray),t.beginPath(),this._renderTextCommon(t,"strokeText"),t.closePath(),t.restore())}_renderChars(t,e,s,n,i,o){const a=this.getHeightOfLine(o),l=this.textAlign.includes(Is),c=this.path,h=!l&&this.charSpacing===0&&this.isEmptyStyles(o)&&!c,u=this.direction==="ltr",f=this.direction==="ltr"?1:-1,d=e.direction;let p,g,m,v,_,y="",b=0;if(e.save(),d!==this.direction&&(e.canvas.setAttribute("dir",u?"ltr":"rtl"),e.direction=u?"ltr":"rtl",e.textAlign=u?St:$t),i-=a*this._fontSizeFraction/this.lineHeight,h)return this._renderChar(t,e,o,0,s.join(""),n,i),void e.restore();for(let w=0,A=s.length-1;w<=A;w++)v=w===A||this.charSpacing||c,y+=s[w],m=this.__charBounds[o][w],b===0?(n+=f*(m.kernedWidth-m.width),b+=m.width):b+=m.kernedWidth,l&&!v&&this._reSpaceAndTab.test(s[w])&&(v=!0),v||(p=p||this.getCompleteStyleDeclaration(o,w),g=this.getCompleteStyleDeclaration(o,w+1),v=vl(p,g,!1)),v&&(c?(e.save(),e.translate(m.renderLeft,m.renderTop),e.rotate(m.angle),this._renderChar(t,e,o,w,y,-b/2,0),e.restore()):(_=n,this._renderChar(t,e,o,w,y,_,i)),y="",p=g,n+=f*b,b=0);e.restore()}_applyPatternGradientTransformText(t){const e=this.width+this.strokeWidth,s=this.height+this.strokeWidth,n=Ms({width:e,height:s}),i=n.getContext("2d");return n.width=e,n.height=s,i.beginPath(),i.moveTo(0,0),i.lineTo(e,0),i.lineTo(e,s),i.lineTo(0,s),i.closePath(),i.translate(e/2,s/2),i.fillStyle=t.toLive(i),this._applyPatternGradientTransform(i,t),i.fill(),i.createPattern(n,"no-repeat")}handleFiller(t,e,s){let n,i;return cs(s)?s.gradientUnits==="percentage"||s.gradientTransform||s.patternTransform?(n=-this.width/2,i=-this.height/2,t.translate(n,i),t[e]=this._applyPatternGradientTransformText(s),{offsetX:n,offsetY:i}):(t[e]=s.toLive(t),this._applyPatternGradientTransform(t,s)):(t[e]=s,{offsetX:0,offsetY:0})}_setStrokeStyles(t,e){let{stroke:s,strokeWidth:n}=e;return t.lineWidth=n,t.lineCap=this.strokeLineCap,t.lineDashOffset=this.strokeDashOffset,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,this.handleFiller(t,"strokeStyle",s)}_setFillStyles(t,e){let{fill:s}=e;return this.handleFiller(t,"fillStyle",s)}_renderChar(t,e,s,n,i,o,a){const l=this._getStyleDeclaration(s,n),c=this.getCompleteStyleDeclaration(s,n),h=t==="fillText"&&c.fill,u=t==="strokeText"&&c.stroke&&c.strokeWidth;if(u||h){if(e.save(),e.font=this._getFontDeclaration(c),l.textBackgroundColor&&this._removeShadow(e),l.deltaY&&(a+=l.deltaY),h){const f=this._setFillStyles(e,c);e.fillText(i,o-f.offsetX,a-f.offsetY)}if(u){const f=this._setStrokeStyles(e,c);e.strokeText(i,o-f.offsetX,a-f.offsetY)}e.restore()}}setSuperscript(t,e){this._setScript(t,e,this.superscript)}setSubscript(t,e){this._setScript(t,e,this.subscript)}_setScript(t,e,s){const n=this.get2DCursorLocation(t,!0),i=this.getValueOfPropertyAt(n.lineIndex,n.charIndex,"fontSize"),o=this.getValueOfPropertyAt(n.lineIndex,n.charIndex,"deltaY"),a={fontSize:i*s.size,deltaY:o+i*s.baseline};this.setSelectionStyles(a,t,e)}_getLineLeftOffset(t){const e=this.getLineWidth(t),s=this.width-e,n=this.textAlign,i=this.direction,o=this.isEndOfWrapping(t);let a=0;return n===Is||n===zi&&!o||n===Yi&&!o||n===Da&&!o?0:(n===gt&&(a=s/2),n===$t&&(a=s),n===zi&&(a=s/2),n===Yi&&(a=s),i==="rtl"&&(n===$t||n===Is||n===Yi?a=0:n===St||n===Da?a=-s:n!==gt&&n!==zi||(a=-s/2)),a)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(t){if(this.__lineWidths[t]!==void 0)return this.__lineWidths[t];const{width:e}=this.measureLine(t);return this.__lineWidths[t]=e,e}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(t,e,s){var n;return(n=this._getStyleDeclaration(t,e)[s])!==null&&n!==void 0?n:this[s]}_renderTextDecoration(t,e){if(!this[e]&&!this.styleHas(e))return;let s=this._getTopOffset();const n=this._getLeftOffset(),i=this.path,o=this._getWidthOfCharSpacing(),a=this.offsets[e];for(let l=0,c=this._textLines.length;l<c;l++){const h=this.getHeightOfLine(l);if(!this[e]&&!this.styleHas(e,l)){s+=h;continue}const u=this._textLines[l],f=h/this.lineHeight,d=this._getLineLeftOffset(l);let p,g,m=0,v=0,_=this.getValueOfPropertyAt(l,0,e),y=this.getValueOfPropertyAt(l,0,ee);const b=s+f*(1-this._fontSizeFraction);let w=this.getHeightOfChar(l,0),A=this.getValueOfPropertyAt(l,0,"deltaY");for(let E=0,D=u.length;E<D;E++){const Y=this.__charBounds[l][E];p=this.getValueOfPropertyAt(l,E,e),g=this.getValueOfPropertyAt(l,E,ee);const K=this.getHeightOfChar(l,E),st=this.getValueOfPropertyAt(l,E,"deltaY");if(i&&p&&g)t.save(),t.fillStyle=y,t.translate(Y.renderLeft,Y.renderTop),t.rotate(Y.angle),t.fillRect(-Y.kernedWidth/2,a*K+st,Y.kernedWidth,this.fontSize/15),t.restore();else if((p!==_||g!==y||K!==w||st!==A)&&v>0){let G=n+d+m;this.direction==="rtl"&&(G=this.width-G-v),_&&y&&(t.fillStyle=y,t.fillRect(G,b+a*w+A,v,this.fontSize/15)),m=Y.left,v=Y.width,_=p,y=g,w=K,A=st}else v+=Y.kernedWidth}let O=n+d+m;this.direction==="rtl"&&(O=this.width-O-v),t.fillStyle=g,p&&g&&t.fillRect(O,b+a*w+A,v-o,this.fontSize/15),s+=h}this._removeShadow(t)}_getFontDeclaration(){let{fontFamily:t=this.fontFamily,fontStyle:e=this.fontStyle,fontWeight:s=this.fontWeight,fontSize:n=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;const o=t.includes("'")||t.includes('"')||t.includes(",")||he.genericFonts.includes(t.toLowerCase())?t:'"'.concat(t,'"');return[e,s,"".concat(i?this.CACHE_FONT_SIZE:n,"px"),o].join(" ")}render(t){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(t)))}graphemeSplit(t){return ml(t)}_splitTextIntoLines(t){const e=t.split(this._reNewline),s=new Array(e.length),n=[`
`];let i=[];for(let o=0;o<e.length;o++)s[o]=this.graphemeSplit(e[o]),i=i.concat(s[o],n);return i.pop(),{_unwrappedLines:s,lines:e,graphemeText:i,graphemeLines:s}}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return S(S({},super.toObject([...am,...t])),{},{styles:Lp(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(t,e){const{textLayoutProperties:s}=this.constructor;super.set(t,e);let n=!1,i=!1;if(typeof t=="object")for(const o in t)o==="path"&&this.setPathInfo(),n=n||s.includes(o),i=i||o==="path";else n=s.includes(t),i=t==="path";return i&&this.setPathInfo(),n&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(t,e,s){const n=_n(t,he.ATTRIBUTE_NAMES,s),i=S(S({},e),n),{textAnchor:o=St,textDecoration:a="",dx:l=0,dy:c=0,top:h=0,left:u=0,fontSize:f=Ch,strokeWidth:d=1}=i,p=It(i,$x),g=new this((t.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),S({left:u+l,top:h+c,underline:a.includes("underline"),overline:a.includes("overline"),linethrough:a.includes("line-through"),strokeWidth:0,fontSize:f},p)),m=g.getScaledHeight()/g.height,v=((g.height+g.strokeWidth)*g.lineHeight-g.height)*m,_=g.getScaledHeight()+v;let y=0;return o===gt&&(y=g.getScaledWidth()/2),o===$t&&(y=g.getScaledWidth()),g.set({left:g.left-y,top:g.top-(_-g.fontSize*(.07+g._fontSizeFraction))/g.lineHeight,strokeWidth:d}),g}static fromObject(t){return this._fromObject(S(S({},t),{},{styles:jp(t.styles||{},t.text)}),{extraParam:"text"})}}T(he,"textLayoutProperties",om),T(he,"cacheProperties",[...vn,...am]),T(he,"ownDefaults",Wx),T(he,"type","Text"),T(he,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),T(he,"ATTRIBUTE_NAMES",Un.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),Ap(he,[class extends hp{_toSVG(){const r=this._getSVGLeftTopOffsets(),t=this._getSVGTextAndBg(r.textTop,r.textLeft);return this._wrapSVGTextAndBg(t)}toSVG(r){return this._createBaseSVGMarkup(this._toSVG(),{reviver:r,noStyle:!0,withShadow:!0})}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(r){let{textBgRects:t,textSpans:e}=r;const s=this.getSvgTextDecoration(this);return[t.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'.concat(this.fontFamily.replace(Gx,"'"),'" '):"",this.fontSize?'font-size="'.concat(this.fontSize,'" '):"",this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",s?'text-decoration="'.concat(s,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",e.join(""),`</text>
`]}_getSVGTextAndBg(r,t){const e=[],s=[];let n,i=r;this.backgroundColor&&s.push(...Vl(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let o=0,a=this._textLines.length;o<a;o++)n=this._getLineLeftOffset(o),this.direction==="rtl"&&(n+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",o))&&this._setSVGTextLineBg(s,o,t+n,i),this._setSVGTextLineText(e,o,t+n,i),i+=this.getHeightOfLine(o);return{textSpans:e,textBgRects:s}}_createTextCharSpan(r,t,e,s){const n=this.getSvgSpanStyles(t,r!==r.trim()||!!r.match(Ux)),i=n?'style="'.concat(n,'"'):"",o=t.deltaY,a=o?' dy="'.concat(jt(o,_t.NUM_FRACTION_DIGITS),'" '):"";return'<tspan x="'.concat(jt(e,_t.NUM_FRACTION_DIGITS),'" y="').concat(jt(s,_t.NUM_FRACTION_DIGITS),'" ').concat(a).concat(i,">").concat(Rp(r),"</tspan>")}_setSVGTextLineText(r,t,e,s){const n=this.getHeightOfLine(t),i=this.textAlign.includes(Is),o=this._textLines[t];let a,l,c,h,u,f="",d=0;s+=n*(1-this._fontSizeFraction)/this.lineHeight;for(let p=0,g=o.length-1;p<=g;p++)u=p===g||this.charSpacing,f+=o[p],c=this.__charBounds[t][p],d===0?(e+=c.kernedWidth-c.width,d+=c.width):d+=c.kernedWidth,i&&!u&&this._reSpaceAndTab.test(o[p])&&(u=!0),u||(a=a||this.getCompleteStyleDeclaration(t,p),l=this.getCompleteStyleDeclaration(t,p+1),u=vl(a,l,!0)),u&&(h=this._getStyleDeclaration(t,p),r.push(this._createTextCharSpan(f,h,e,s)),f="",a=l,this.direction==="rtl"?e-=d:e+=d,d=0)}_setSVGTextLineBg(r,t,e,s){const n=this._textLines[t],i=this.getHeightOfLine(t)/this.lineHeight;let o,a=0,l=0,c=this.getValueOfPropertyAt(t,0,"textBackgroundColor");for(let h=0;h<n.length;h++){const{left:u,width:f,kernedWidth:d}=this.__charBounds[t][h];o=this.getValueOfPropertyAt(t,h,"textBackgroundColor"),o!==c?(c&&r.push(...Vl(c,e+l,s,a,i)),l=u,a=f,c=o):a+=d}o&&r.push(...Vl(c,e+l,s,a,i))}_getSVGLineTopOffset(r){let t,e=0;for(t=0;t<r;t++)e+=this.getHeightOfLine(t);const s=this.getHeightOfLine(t);return{lineTop:e,offset:(this._fontSizeMult-this._fontSizeFraction)*s/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(r){return"".concat(super.getSvgStyles(r)," white-space: pre;")}getSvgSpanStyles(r,t){const{fontFamily:e,strokeWidth:s,stroke:n,fill:i,fontSize:o,fontStyle:a,fontWeight:l,deltaY:c}=r,h=this.getSvgTextDecoration(r);return[n?no(Le,n):"",s?"stroke-width: ".concat(s,"; "):"",e?"font-family: ".concat(e.includes("'")||e.includes('"')?e:"'".concat(e,"'"),"; "):"",o?"font-size: ".concat(o,"px; "):"",a?"font-style: ".concat(a,"; "):"",l?"font-weight: ".concat(l,"; "):"",h&&"text-decoration: ".concat(h,"; "),i?no(ee,i):"",c?"baseline-shift: ".concat(-c,"; "):"",t?"white-space: pre; ":""].join("")}getSvgTextDecoration(r){return["overline","underline","line-through"].filter(t=>r[t.replace("-","")]).join(" ")}}]),q.setClass(he),q.setSVGClass(he);class qx{constructor(t){T(this,"target",void 0),T(this,"__mouseDownInPlace",!1),T(this,"__dragStartFired",!1),T(this,"__isDraggingOver",!1),T(this,"__dragStartSelection",void 0),T(this,"__dragImageDisposer",void 0),T(this,"_dispose",void 0),this.target=t;const e=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{e.forEach(s=>s()),this._dispose=void 0}}isPointerOverSelection(t){const e=this.target,s=e.getSelectionStartFromPointer(t);return e.isEditing&&s>=e.selectionStart&&s<=e.selectionEnd&&e.selectionStart<e.selectionEnd}start(t){return this.__mouseDownInPlace=this.isPointerOverSelection(t)}isActive(){return this.__mouseDownInPlace}end(t){const e=this.isActive();return e&&!this.__dragStartFired&&(this.target.setCursorByClick(t),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,e}getDragStartSelection(){return this.__dragStartSelection}setDragImage(t,e){var s;let{selectionStart:n,selectionEnd:i}=e;const o=this.target,a=o.canvas,l=new M(o.flipX?-1:1,o.flipY?-1:1),c=o._getCursorBoundaries(n),h=new M(c.left+c.leftOffset,c.top+c.topOffset).multiply(l).transform(o.calcTransformMatrix()),u=a.getScenePoint(t).subtract(h),f=o.getCanvasRetinaScaling(),d=o.getBoundingRect(),p=h.subtract(new M(d.left,d.top)),g=a.viewportTransform,m=p.add(u).transform(g,!0),v=o.backgroundColor,_=Hh(o.styles);o.backgroundColor="";const y={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};o.setSelectionStyles(y,0,n),o.setSelectionStyles(y,i,o.text.length),o.dirty=!0;const b=o.toCanvasElement({enableRetinaScaling:a.enableRetinaScaling,viewportTransform:!0});o.backgroundColor=v,o.styles=_,o.dirty=!0,Fa(b,{position:"fixed",left:"".concat(-b.width,"px"),border:Re,width:"".concat(b.width/f,"px"),height:"".concat(b.height/f,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{b.remove()},ys(t.target||this.target.hiddenTextarea).body.appendChild(b),(s=t.dataTransfer)===null||s===void 0||s.setDragImage(b,m.x,m.y)}onDragStart(t){this.__dragStartFired=!0;const e=this.target,s=this.isActive();if(s&&t.dataTransfer){const n=this.__dragStartSelection={selectionStart:e.selectionStart,selectionEnd:e.selectionEnd},i=e._text.slice(n.selectionStart,n.selectionEnd).join(""),o=S({text:e.text,value:i},n);t.dataTransfer.setData("text/plain",i),t.dataTransfer.setData("application/fabric",JSON.stringify({value:i,styles:e.getSelectionStyles(n.selectionStart,n.selectionEnd,!0)})),t.dataTransfer.effectAllowed="copyMove",this.setDragImage(t,o)}return e.abortCursorAnimation(),s}canDrop(t){if(this.target.editable&&!this.target.getActiveControl()&&!t.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const e=this.target.getSelectionStartFromPointer(t),s=this.__dragStartSelection;return e<s.selectionStart||e>s.selectionEnd}return!0}return!1}targetCanDrop(t){return this.target.canDrop(t)}dragEnterHandler(t){let{e}=t;const s=this.targetCanDrop(e);!this.__isDraggingOver&&s&&(this.__isDraggingOver=!0)}dragOverHandler(t){const{e}=t,s=this.targetCanDrop(e);!this.__isDraggingOver&&s?this.__isDraggingOver=!0:this.__isDraggingOver&&!s&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(e.preventDefault(),t.canDrop=!0,t.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(t){var e;const{e:s}=t,n=s.defaultPrevented;this.__isDraggingOver=!1,s.preventDefault();let i=(e=s.dataTransfer)===null||e===void 0?void 0:e.getData("text/plain");if(i&&!n){const o=this.target,a=o.canvas;let l=o.getSelectionStartFromPointer(s);const{styles:c}=s.dataTransfer.types.includes("application/fabric")?JSON.parse(s.dataTransfer.getData("application/fabric")):{},h=i[Math.max(0,i.length-1)],u=0;if(this.__dragStartSelection){const f=this.__dragStartSelection.selectionStart,d=this.__dragStartSelection.selectionEnd;l>f&&l<=d?l=f:l>d&&(l-=d-f),o.removeChars(f,d),delete this.__dragStartSelection}o._reNewline.test(h)&&(o._reNewline.test(o._text[l])||l===o._text.length)&&(i=i.trimEnd()),t.didDrop=!0,t.dropTarget=o,o.insertChars(i,c,l),a.setActiveObject(o),o.enterEditing(s),o.selectionStart=Math.min(l+u,o._text.length),o.selectionEnd=Math.min(o.selectionStart+i.length,o._text.length),o.hiddenTextarea.value=o.text,o._updateTextarea(),o.hiddenTextarea.focus(),o.fire(xa,{index:l+u,action:"drop"}),a.fire("text:changed",{target:o}),a.contextTopDirty=!0,a.requestRenderAll()}}dragEndHandler(t){let{e}=t;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var s;const n=this.target,i=this.target.canvas,{selectionStart:o,selectionEnd:a}=this.__dragStartSelection,l=((s=e.dataTransfer)===null||s===void 0?void 0:s.dropEffect)||Re;l===Re?(n.selectionStart=o,n.selectionEnd=a,n._updateTextarea(),n.hiddenTextarea.focus()):(n.clearContextTop(),l==="move"&&(n.removeChars(o,a),n.selectionStart=n.selectionEnd=o,n.hiddenTextarea&&(n.hiddenTextarea.value=n.text),n._updateTextarea(),n.fire(xa,{index:o,action:"dragend"}),i.fire("text:changed",{target:n}),i.requestRenderAll()),n.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const Lf=/[ \n\.,;!\?\-]/;class Kx extends he{constructor(){super(...arguments),T(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(t){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(t)}_animateCursor(t){let{toValue:e,duration:s,delay:n,onComplete:i}=t;return Ih({startValue:this._currentCursorOpacity,endValue:e,duration:s,delay:n,onComplete:i,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:o=>{this._currentCursorOpacity=o,this.renderCursorOrSelection()}})}_tick(t){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(t||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var t;(t=this._currentTickCompleteState)===null||t===void 0||t.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(t){this.abortCursorAnimation(),this._tick(t?0:this.cursorDelay)}abortCursorAnimation(){let t=!1;[this._currentTickState,this._currentTickCompleteState].forEach(e=>{e&&!e.isDone()&&(t=!0,e.abort())}),this._currentCursorOpacity=1,t&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(t=>!t||t.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(t){let e=0,s=t-1;if(this._reSpace.test(this._text[s]))for(;this._reSpace.test(this._text[s]);)e++,s--;for(;/\S/.test(this._text[s])&&s>-1;)e++,s--;return t-e}findWordBoundaryRight(t){let e=0,s=t;if(this._reSpace.test(this._text[s]))for(;this._reSpace.test(this._text[s]);)e++,s++;for(;/\S/.test(this._text[s])&&s<this._text.length;)e++,s++;return t+e}findLineBoundaryLeft(t){let e=0,s=t-1;for(;!/\n/.test(this._text[s])&&s>-1;)e++,s--;return t-e}findLineBoundaryRight(t){let e=0,s=t;for(;!/\n/.test(this._text[s])&&s<this._text.length;)e++,s++;return t+e}searchWordBoundary(t,e){const s=this._text;let n=t>0&&this._reSpace.test(s[t])&&(e===-1||!wh.test(s[t-1]))?t-1:t,i=s[n];for(;n>0&&n<s.length&&!Lf.test(i);)n+=e,i=s[n];return e===-1&&Lf.test(i)&&n++,n}selectWord(t){t=t||this.selectionStart;const e=this.searchWordBoundary(t,-1),s=Math.max(e,this.searchWordBoundary(t,1));this.selectionStart=e,this.selectionEnd=s,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(t){t=t||this.selectionStart;const e=this.findLineBoundaryLeft(t),s=this.findLineBoundaryRight(t);return this.selectionStart=e,this.selectionEnd=s,this._fireSelectionChanged(),this._updateTextarea(),this}enterEditing(t){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",t?{e:t}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e:t}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(t){if(this.getActiveControl())return;const e=this.hiddenTextarea;ys(e).activeElement!==e&&e.focus();const s=this.getSelectionStartFromPointer(t),n=this.selectionStart,i=this.selectionEnd;(s===this.__selectionStartOnMouseDown&&n!==i||n!==s&&i!==s)&&(s>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=s):(this.selectionStart=s,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===n&&this.selectionEnd===i||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(t,e,s){const n=s.slice(0,t),i=this.graphemeSplit(n).length;if(t===e)return{selectionStart:i,selectionEnd:i};const o=s.slice(t,e);return{selectionStart:i,selectionEnd:i+this.graphemeSplit(o).length}}fromGraphemeToStringSelection(t,e,s){const n=s.slice(0,t).join("").length;return t===e?{selectionStart:n,selectionEnd:n}:{selectionStart:n,selectionEnd:n+s.slice(t,e).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const t=this.hiddenTextarea;this.text=t.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const e=this.fromStringToGraphemeSelection(t.selectionStart,t.selectionEnd,t.value);this.selectionEnd=this.selectionStart=e.selectionEnd,this.inCompositionMode||(this.selectionStart=e.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const t=this.inCompositionMode?this.compositionStart:this.selectionStart,e=this._getCursorBoundaries(t),s=this.get2DCursorLocation(t),n=s.lineIndex,i=s.charIndex,o=this.getValueOfPropertyAt(n,i,"fontSize")*this.lineHeight,a=e.leftOffset,l=this.getCanvasRetinaScaling(),c=this.canvas.upperCanvasEl,h=c.width/l,u=c.height/l,f=h-o,d=u-o,p=new M(e.left+a,e.top+e.topOffset+o).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new M(c.clientWidth/h,c.clientHeight/u));return p.x<0&&(p.x=0),p.x>f&&(p.x=f),p.y<0&&(p.y=0),p.y>d&&(p.y=d),p.x+=this.canvas._offset.left,p.y+=this.canvas._offset.top,{left:"".concat(p.x,"px"),top:"".concat(p.y,"px"),fontSize:"".concat(o,"px"),charHeight:o}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const t=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,t&&(t.blur&&t.blur(),t.parentNode&&t.parentNode.removeChild(t)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const t=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),t&&this.fire(Ca),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const t in this.styles)this._textLines[t]||delete this.styles[t]}removeStyleFromTo(t,e){const{lineIndex:s,charIndex:n}=this.get2DCursorLocation(t,!0),{lineIndex:i,charIndex:o}=this.get2DCursorLocation(e,!0);if(s!==i){if(this.styles[s])for(let a=n;a<this._unwrappedTextLines[s].length;a++)delete this.styles[s][a];if(this.styles[i])for(let a=o;a<this._unwrappedTextLines[i].length;a++){const l=this.styles[i][a];l&&(this.styles[s]||(this.styles[s]={}),this.styles[s][n+a-o]=l)}for(let a=s+1;a<=i;a++)delete this.styles[a];this.shiftLineStyles(i,s-i)}else if(this.styles[s]){const a=this.styles[s],l=o-n;for(let c=n;c<o;c++)delete a[c];for(const c in this.styles[s]){const h=parseInt(c,10);h>=o&&(a[h-l]=a[c],delete a[c])}}}shiftLineStyles(t,e){const s=Object.assign({},this.styles);for(const n in this.styles){const i=parseInt(n,10);i>t&&(this.styles[i+e]=s[i],s[i-e]||delete this.styles[i])}}insertNewlineStyleObject(t,e,s,n){const i={},o=this._unwrappedTextLines[t].length,a=o===e;let l=!1;s||(s=1),this.shiftLineStyles(t,s);const c=this.styles[t]?this.styles[t][e===0?e:e-1]:void 0;for(const u in this.styles[t]){const f=parseInt(u,10);f>=e&&(l=!0,i[f-e]=this.styles[t][u],a&&e===0||delete this.styles[t][u])}let h=!1;for(l&&!a&&(this.styles[t+s]=i,h=!0),(h||o>e)&&s--;s>0;)n&&n[s-1]?this.styles[t+s]={0:S({},n[s-1])}:c?this.styles[t+s]={0:S({},c)}:delete this.styles[t+s],s--;this._forceClearCache=!0}insertCharStyleObject(t,e,s,n){this.styles||(this.styles={});const i=this.styles[t],o=i?S({},i):{};s||(s=1);for(const l in o){const c=parseInt(l,10);c>=e&&(i[c+s]=o[c],o[c-s]||delete i[c])}if(this._forceClearCache=!0,n){for(;s--;)Object.keys(n[s]).length&&(this.styles[t]||(this.styles[t]={}),this.styles[t][e+s]=S({},n[s]));return}if(!i)return;const a=i[e?e-1:1];for(;a&&s--;)this.styles[t][e+s]=S({},a)}insertNewStyleBlock(t,e,s){const n=this.get2DCursorLocation(e,!0),i=[0];let o,a=0;for(let l=0;l<t.length;l++)t[l]===`
`?(a++,i[a]=0):i[a]++;for(i[0]>0&&(this.insertCharStyleObject(n.lineIndex,n.charIndex,i[0],s),s=s&&s.slice(i[0]+1)),a&&this.insertNewlineStyleObject(n.lineIndex,n.charIndex+i[0],a),o=1;o<a;o++)i[o]>0?this.insertCharStyleObject(n.lineIndex+o,0,i[o],s):s&&this.styles[n.lineIndex+o]&&s[0]&&(this.styles[n.lineIndex+o][0]=s[0]),s=s&&s.slice(i[o]+1);i[o]>0&&this.insertCharStyleObject(n.lineIndex+o,0,i[o],s)}removeChars(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t+1;this.removeStyleFromTo(t,e),this._text.splice(t,e-t),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(t,e,s){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:s;n>s&&this.removeStyleFromTo(s,n);const i=this.graphemeSplit(t);this.insertNewStyleBlock(i,s,e),this._text=[...this._text.slice(0,s),...i,...this._text.slice(n)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(t,e,s){s<=t?(e===t?this._selectionDirection=St:this._selectionDirection===$t&&(this._selectionDirection=St,this.selectionEnd=t),this.selectionStart=s):s>t&&s<e?this._selectionDirection===$t?this.selectionEnd=s:this.selectionStart=s:(e===t?this._selectionDirection=$t:this._selectionDirection===St&&(this._selectionDirection=$t,this.selectionStart=e),this.selectionEnd=s)}}class Jx extends Kx{initHiddenTextarea(){const t=this.canvas&&ys(this.canvas.getElement())||ui(),e=t.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map(o=>{let[a,l]=o;return e.setAttribute(a,l)});const{top:s,left:n,fontSize:i}=this._calcTextareaPosition();e.style.cssText="position: absolute; top: ".concat(s,"; left: ").concat(n,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(i,";"),(this.hiddenTextareaContainer||t.body).appendChild(e),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(o=>{let[a,l]=o;return e.addEventListener(a,this[l].bind(this))}),this.hiddenTextarea=e}blur(){this.abortCursorAnimation()}onKeyDown(t){if(!this.isEditing)return;const e=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(t.keyCode in e)this[e[t.keyCode]](t);else{if(!(t.keyCode in this.ctrlKeysMapDown)||!t.ctrlKey&&!t.metaKey)return;this[this.ctrlKeysMapDown[t.keyCode]](t)}t.stopImmediatePropagation(),t.preventDefault(),t.keyCode>=33&&t.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(t){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:t.keyCode in this.ctrlKeysMapUp&&(t.ctrlKey||t.metaKey)&&(this[this.ctrlKeysMapUp[t.keyCode]](t),t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(t){const e=this.fromPaste;if(this.fromPaste=!1,t&&t.stopPropagation(),!this.isEditing)return;const s=()=>{this.updateFromTextArea(),this.fire(xa),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void s();const n=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,i=this._text.length,o=n.length,a=this.selectionStart,l=this.selectionEnd,c=a!==l;let h,u,f,d,p=o-i;const g=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),m=a>g.selectionStart;c?(u=this._text.slice(a,l),p+=l-a):o<i&&(u=m?this._text.slice(l+p,l):this._text.slice(a,a-p));const v=n.slice(g.selectionEnd-p,g.selectionEnd);if(u&&u.length&&(v.length&&(h=this.getSelectionStyles(a,a+1,!1),h=v.map(()=>h[0])),c?(f=a,d=l):m?(f=l-u.length,d=l):(f=l,d=l+u.length),this.removeStyleFromTo(f,d)),v.length){const{copyPasteData:_}=Ks();e&&v.join("")===_.copiedText&&!_t.disableStyleCopyPaste&&(h=_.copiedTextStyle),this.insertNewStyleBlock(v,a,h)}s()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(t){let{target:e}=t;const{selectionStart:s,selectionEnd:n}=e;this.compositionStart=s,this.compositionEnd=n,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:t}=Ks();t.copiedText=this.getSelectedText(),_t.disableStyleCopyPaste?t.copiedTextStyle=void 0:t.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(t,e){let s,n=this._getLineLeftOffset(t);return e>0&&(s=this.__charBounds[t][e-1],n+=s.left+s.width),n}getDownCursorOffset(t,e){const s=this._getSelectionForOffset(t,e),n=this.get2DCursorLocation(s),i=n.lineIndex;if(i===this._textLines.length-1||t.metaKey||t.keyCode===34)return this._text.length-s;const o=n.charIndex,a=this._getWidthBeforeCursor(i,o),l=this._getIndexOnLine(i+1,a);return this._textLines[i].slice(o).length+l+1+this.missingNewlineOffset(i)}_getSelectionForOffset(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart}getUpCursorOffset(t,e){const s=this._getSelectionForOffset(t,e),n=this.get2DCursorLocation(s),i=n.lineIndex;if(i===0||t.metaKey||t.keyCode===33)return-s;const o=n.charIndex,a=this._getWidthBeforeCursor(i,o),l=this._getIndexOnLine(i-1,a),c=this._textLines[i].slice(0,o),h=this.missingNewlineOffset(i-1);return-this._textLines[i-1].length+l-c.length+(1-h)}_getIndexOnLine(t,e){const s=this._textLines[t];let n,i,o=this._getLineLeftOffset(t),a=0;for(let l=0,c=s.length;l<c;l++)if(n=this.__charBounds[t][l].width,o+=n,o>e){i=!0;const h=o-n,u=o,f=Math.abs(h-e);a=Math.abs(u-e)<f?l:l-1;break}return i||(a=s.length-1),a}moveCursorDown(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",t)}moveCursorUp(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",t)}_moveCursorUpOrDown(t,e){const s=this["get".concat(t,"CursorOffset")](e,this._selectionDirection===$t);if(e.shiftKey?this.moveCursorWithShift(s):this.moveCursorWithoutShift(s),s!==0){const n=this.text.length;this.selectionStart=yr(0,this.selectionStart,n),this.selectionEnd=yr(0,this.selectionEnd,n),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(t){const e=this._selectionDirection===St?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),t!==0}moveCursorWithoutShift(t){return t<0?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),t!==0}moveCursorLeft(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",t)}_move(t,e,s){let n;if(t.altKey)n=this["findWordBoundary".concat(s)](this[e]);else{if(!t.metaKey&&t.keyCode!==35&&t.keyCode!==36)return this[e]+=s==="Left"?-1:1,!0;n=this["findLineBoundary".concat(s)](this[e])}return n!==void 0&&this[e]!==n&&(this[e]=n,!0)}_moveLeft(t,e){return this._move(t,e,"Left")}_moveRight(t,e){return this._move(t,e,"Right")}moveCursorLeftWithoutShift(t){let e=!0;return this._selectionDirection=St,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e}moveCursorLeftWithShift(t){return this._selectionDirection===$t&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=St,this._moveLeft(t,"selectionStart")):void 0}moveCursorRight(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",t)}_moveCursorLeftOrRight(t,e){const s="moveCursor".concat(t).concat(e.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[s](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(t){return this._selectionDirection===St&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=$t,this._moveRight(t,"selectionEnd")):void 0}moveCursorRightWithoutShift(t){let e=!0;return this._selectionDirection=$t,this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e}}const Ul=r=>!!r.button;class Zx extends Jx{constructor(){super(...arguments),T(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler),this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown),this.draggableTextDelegate=new qx(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(t){return this.draggableTextDelegate.onDragStart(t)}canDrop(t){return this.draggableTextDelegate.canDrop(t)}onMouseDown(t){if(!this.canvas)return;this.__newClickTime=+new Date;const e=t.pointer;this.isTripleClick(e)&&(this.fire("tripleclick",t),Mc(t.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e,this.__lastSelected=this.selected&&!this.getActiveControl()}isTripleClick(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y}doubleClickHandler(t){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(t.e))}tripleClickHandler(t){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(t.e))}_mouseDownHandler(t){let{e}=t;this.canvas&&this.editable&&!Ul(e)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(e)||(this.canvas.textEditingManager.register(this),this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection())))}_mouseDownHandlerBefore(t){let{e}=t;this.canvas&&this.editable&&!Ul(e)&&(this.selected=this===this.canvas._activeObject)}mouseUpHandler(t){let{e,transform:s}=t;const n=this.draggableTextDelegate.end(e);if(this.canvas){this.canvas.textEditingManager.unregister(this);const i=this.canvas._activeObject;if(i&&i!==this)return}!this.editable||this.group&&!this.group.interactive||s&&s.actionPerformed||Ul(e)||n||(this.__lastSelected&&!this.getActiveControl()?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0)}setCursorByClick(t){const e=this.getSelectionStartFromPointer(t),s=this.selectionStart,n=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(s,n,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(t){const e=this.canvas.getScenePoint(t).transform(Ke(this.calcTransformMatrix())).add(new M(-this._getLeftOffset(),-this._getTopOffset()));let s=0,n=0,i=0;for(let c=0;c<this._textLines.length&&s<=e.y;c++)s+=this.getHeightOfLine(c),i=c,c>0&&(n+=this._textLines[c-1].length+this.missingNewlineOffset(c-1));let o=Math.abs(this._getLineLeftOffset(i));const a=this._textLines[i].length,l=this.__charBounds[i];for(let c=0;c<a;c++){const h=o+l[c].kernedWidth;if(e.x<=h){Math.abs(e.x-h)<=Math.abs(e.x-o)&&n++;break}o=h,n++}return Math.min(this.flipX?a-n:n,this._text.length)}}const Eo="moveCursorUp",Ao="moveCursorDown",Po="moveCursorLeft",Fo="moveCursorRight",Do="exitEditing",Qx=S({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:Do,27:Do,33:Eo,34:Ao,35:Fo,36:Po,37:Po,38:Eo,39:Fo,40:Ao},keysMapRtl:{9:Do,27:Do,33:Eo,34:Ao,35:Po,36:Fo,37:Fo,38:Eo,39:Po,40:Ao},ctrlKeysMapDown:{65:"selectAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class bs extends Zx{static getDefaults(){return S(S({},super.getDefaults()),bs.ownDefaults)}get type(){const t=super.type;return t==="itext"?"i-text":t}constructor(t,e){super(t,S(S({},bs.ownDefaults),e)),this.initBehavior()}_set(t,e){return this.isEditing&&this._savedProps&&t in this._savedProps?(this._savedProps[t]=e,this):(t==="canvas"&&(this.canvas instanceof io&&this.canvas.textEditingManager.remove(this),e instanceof io&&e.textEditingManager.add(this)),super._set(t,e))}setSelectionStart(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)}setSelectionEnd(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)}_updateAndFire(t,e){this[t]!==e&&(this._fireSelectionChanged(),this[t]=e),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,s=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(t,e,s)}setSelectionStyles(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(t,e,s)}get2DCursorLocation(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(t,e)}render(t){super.render(t),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(t){const e=this.isEditing;this.isEditing=!1;const s=super.toCanvasElement(t);return this.isEditing=e,s}renderCursorOrSelection(){if(!this.isEditing)return;const t=this.clearContextTop(!0);if(!t)return;const e=this._getCursorBoundaries();this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(t,e):this.renderCursor(t,e),this.canvas.contextTopDirty=!0,t.restore()}_getCursorBoundaries(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1?arguments[1]:void 0;const s=this._getLeftOffset(),n=this._getTopOffset(),i=this._getCursorBoundariesOffsets(t,e);return{left:s,top:n,leftOffset:i.left,topOffset:i.top}}_getCursorBoundariesOffsets(t,e){return e?this.__getCursorBoundariesOffsets(t):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(t)}__getCursorBoundariesOffsets(t){let e=0,s=0;const{charIndex:n,lineIndex:i}=this.get2DCursorLocation(t);for(let c=0;c<i;c++)e+=this.getHeightOfLine(c);const o=this._getLineLeftOffset(i),a=this.__charBounds[i][n];a&&(s=a.left),this.charSpacing!==0&&n===this._textLines[i].length&&(s-=this._getWidthOfCharSpacing());const l={top:e,left:o+(s>0?s:0)};return this.direction==="rtl"&&(this.textAlign===$t||this.textAlign===Is||this.textAlign===Yi?l.left*=-1:this.textAlign===St||this.textAlign===Da?l.left=o-(s>0?s:0):this.textAlign!==gt&&this.textAlign!==zi||(l.left=o-(s>0?s:0))),l}renderCursorAt(t){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(t,!0),t)}renderCursor(t,e){this._renderCursor(t,e,this.selectionStart)}getCursorRenderingData(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(t);const s=this.get2DCursorLocation(t),n=s.lineIndex,i=s.charIndex>0?s.charIndex-1:0,o=this.getValueOfPropertyAt(n,i,"fontSize"),a=this.getObjectScaling().x*this.canvas.getZoom(),l=this.cursorWidth/a,c=this.getValueOfPropertyAt(n,i,"deltaY"),h=e.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(n)/this.lineHeight-o*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(n,i,"fill"),opacity:this._currentCursorOpacity,left:e.left+e.leftOffset-l/2,top:h+e.top+c,width:l,height:o}}_renderCursor(t,e,s){const{color:n,opacity:i,left:o,top:a,width:l,height:c}=this.getCursorRenderingData(s,e);t.fillStyle=n,t.globalAlpha=i,t.fillRect(o,a,l,c)}renderSelection(t,e){const s={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(t,s,e)}renderDragSourceEffect(){const t=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,t,this._getCursorBoundaries(t.selectionStart,!0))}renderDropTargetEffect(t){const e=this.getSelectionStartFromPointer(t);this.renderCursorAt(e)}_renderSelection(t,e,s){const n=e.selectionStart,i=e.selectionEnd,o=this.textAlign.includes(Is),a=this.get2DCursorLocation(n),l=this.get2DCursorLocation(i),c=a.lineIndex,h=l.lineIndex,u=a.charIndex<0?0:a.charIndex,f=l.charIndex<0?0:l.charIndex;for(let d=c;d<=h;d++){const p=this._getLineLeftOffset(d)||0;let g=this.getHeightOfLine(d),m=0,v=0,_=0;if(d===c&&(v=this.__charBounds[c][u].left),d>=c&&d<h)_=o&&!this.isEndOfWrapping(d)?this.width:this.getLineWidth(d)||5;else if(d===h)if(f===0)_=this.__charBounds[h][f].left;else{const O=this._getWidthOfCharSpacing();_=this.__charBounds[h][f-1].left+this.__charBounds[h][f-1].width-O}m=g,(this.lineHeight<1||d===h&&this.lineHeight>1)&&(g/=this.lineHeight);let y=s.left+p+v,b=g,w=0;const A=_-v;this.inCompositionMode?(t.fillStyle=this.compositionColor||"black",b=1,w=g):t.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===$t||this.textAlign===Is||this.textAlign===Yi?y=this.width-y-A:this.textAlign===St||this.textAlign===Da?y=s.left+p-_:this.textAlign!==gt&&this.textAlign!==zi||(y=s.left+p-_)),t.fillRect(y,s.top+s.topOffset+w,A,b),s.topOffset+=m}}getCurrentCharFontSize(){const t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")}getCurrentCharColor(){const t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,ee)}_getCurrentCharIndex(){const t=this.get2DCursorLocation(this.selectionStart,!0),e=t.charIndex>0?t.charIndex-1:0;return{l:t.lineIndex,c:e}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}T(bs,"ownDefaults",Qx),T(bs,"type","IText"),q.setClass(bs),q.setClass(bs,"i-text");class Hs extends bs{static getDefaults(){return S(S({},super.getDefaults()),Hs.ownDefaults)}constructor(t,e){super(t,S(S({},Hs.ownDefaults),e))}static createControls(){return{controls:Ep()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(Is)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(t){let e=0,s=0,n=0;const i={};for(let o=0;o<t.graphemeLines.length;o++)t.graphemeText[n]===`
`&&o>0?(s=0,n++,e++):!this.splitByGrapheme&&this._reSpaceAndTab.test(t.graphemeText[n])&&o>0&&(s++,n++),i[o]={line:e,offset:s},n+=t.graphemeLines[o].length,s+=t.graphemeLines[o].length;return i}styleHas(t,e){if(this._styleMap&&!this.isWrapping){const s=this._styleMap[e];s&&(e=s.line)}return super.styleHas(t,e)}isEmptyStyles(t){if(!this.styles)return!0;let e,s=0,n=t+1,i=!1;const o=this._styleMap[t],a=this._styleMap[t+1];o&&(t=o.line,s=o.offset),a&&(n=a.line,i=n===t,e=a.offset);const l=t===void 0?this.styles:{line:this.styles[t]};for(const c in l)for(const h in l[c]){const u=parseInt(h,10);if(u>=s&&(!i||u<e))for(const f in l[c][h])return!1}return!0}_getStyleDeclaration(t,e){if(this._styleMap&&!this.isWrapping){const s=this._styleMap[t];if(!s)return{};t=s.line,e=s.offset+e}return super._getStyleDeclaration(t,e)}_setStyleDeclaration(t,e,s){const n=this._styleMap[t];super._setStyleDeclaration(n.line,n.offset+e,s)}_deleteStyleDeclaration(t,e){const s=this._styleMap[t];super._deleteStyleDeclaration(s.line,s.offset+e)}_getLineStyle(t){const e=this._styleMap[t];return!!this.styles[e.line]}_setLineStyle(t){const e=this._styleMap[t];super._setLineStyle(e.line)}_wrapText(t,e){this.isWrapping=!0;const s=this.getGraphemeDataForRender(t),n=[];for(let i=0;i<s.wordsData.length;i++)n.push(...this._wrapLine(i,e,s));return this.isWrapping=!1,n}getGraphemeDataForRender(t){const e=this.splitByGrapheme,s=e?"":" ";let n=0;return{wordsData:t.map((i,o)=>{let a=0;const l=e?this.graphemeSplit(i):this.wordSplit(i);return l.length===0?[{word:[],width:0}]:l.map(c=>{const h=e?[c]:this.graphemeSplit(c),u=this._measureWord(h,o,a);return n=Math.max(u,n),a+=h.length+s.length,{word:h,width:u}})}),largestWordWidth:n}}_measureWord(t,e){let s,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=0;for(let o=0,a=t.length;o<a;o++)i+=this._getGraphemeBox(t[o],e,o+n,s,!0).kernedWidth,s=t[o];return i}wordSplit(t){return t.split(this._wordJoiners)}_wrapLine(t,e,s){let{largestWordWidth:n,wordsData:i}=s,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const a=this._getWidthOfCharSpacing(),l=this.splitByGrapheme,c=[],h=l?"":" ";let u=0,f=[],d=0,p=0,g=!0;e-=o;const m=Math.max(e,n,this.dynamicMinWidth),v=i[t];let _;for(d=0,_=0;_<v.length;_++){const{word:y,width:b}=v[_];d+=y.length,u+=p+b-a,u>m&&!g?(c.push(f),f=[],u=b,g=!0):u+=a,g||l||f.push(h),f=f.concat(y),p=l?0:this._measureWord([h],t,d),d++,g=!1}return _&&c.push(f),n+o>this.dynamicMinWidth&&(this.dynamicMinWidth=n-a+o),c}isEndOfWrapping(t){return!this._styleMap[t+1]||this._styleMap[t+1].line!==this._styleMap[t].line}missingNewlineOffset(t,e){return this.splitByGrapheme&&!e?this.isEndOfWrapping(t)?1:0:1}_splitTextIntoLines(t){const e=super._splitTextIntoLines(t),s=this._wrapText(e.lines,this.width),n=new Array(s.length);for(let i=0;i<s.length;i++)n[i]=s[i].join("");return e.lines=n,e.graphemeLines=s,e}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const t=new Map;for(const e in this._styleMap){const s=parseInt(e,10);if(this._textLines[s]){const n=this._styleMap[e].line;t.set("".concat(n),!0)}}for(const e in this.styles)t.has(e)||delete this.styles[e]}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...t])}}T(Hs,"type","Textbox"),T(Hs,"textLayoutProperties",[...bs.textLayoutProperties,"width"]),T(Hs,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),q.setClass(Hs);class jf extends _l{shouldPerformLayout(t){return!!t.target.clipPath&&super.shouldPerformLayout(t)}shouldLayoutClipPath(){return!1}calcLayoutResult(t,e){const{target:s}=t,{clipPath:n,group:i}=s;if(!n||!this.shouldPerformLayout(t))return;const{width:o,height:a}=Vs(Bp(s,n)),l=new M(o,a);if(n.absolutePositioned)return{center:un(n.getRelativeCenterPoint(),void 0,i?i.calcTransformMatrix():void 0),size:l};{const c=n.getRelativeCenterPoint().transform(s.calcOwnMatrix(),!0);if(this.shouldPerformLayout(t)){const{center:h=new M,correction:u=new M}=this.calcBoundingBox(e,t)||{};return{center:h.add(c),correction:u.subtract(c),size:l}}return{center:s.getRelativeCenterPoint().add(c),size:l}}}}T(jf,"type","clip-path"),q.setClass(jf);class If extends _l{getInitialSize(t,e){let{target:s}=t,{size:n}=e;return new M(s.width||n.x,s.height||n.y)}}T(If,"type","fixed"),q.setClass(If);class tC extends ro{subscribeTargets(t){const e=t.target;t.targets.reduce((s,n)=>(n.parent&&s.add(n.parent),s),new Set).forEach(s=>{s.layoutManager.subscribeTargets({target:s,targets:[e]})})}unsubscribeTargets(t){const e=t.target,s=e.getObjects();t.targets.reduce((n,i)=>(i.parent&&n.add(i.parent),n),new Set).forEach(n=>{!s.some(i=>i.parent===n)&&n.layoutManager.unsubscribeTargets({target:n,targets:[e]})})}}class kn extends gs{static getDefaults(){return S(S({},super.getDefaults()),kn.ownDefaults)}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,kn.ownDefaults),this.setOptions(e);const{left:s,top:n,layoutManager:i}=e;this.groupInit(t,{left:s,top:n,layoutManager:i??new tC})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this.multiSelectionStacking==="selection-order"?this.add(...e):e.forEach(n=>{const i=this._objects.findIndex(a=>a.isInFrontOf(n)),o=i===-1?this.size():i;this.insertAt(o,n)})}canEnterGroup(t){return this.getObjects().some(e=>e.isDescendantOf(t)||t.isDescendantOf(e))?(jn("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(t)}enterGroup(t,e){t.parent&&t.parent===t.group?t.parent._exitGroup(t):t.group&&t.parent!==t.group&&t.group.remove(t),this._enterGroup(t,e)}exitGroup(t,e){this._exitGroup(t,e),t.parent&&t.parent._enterGroup(t,!0)}_onAfterObjectsChange(t,e){super._onAfterObjectsChange(t,e);const s=new Set;e.forEach(n=>{const{parent:i}=n;i&&s.add(i)}),t===zh?s.forEach(n=>{n._onAfterObjectsChange(Ea,e)}):s.forEach(n=>{n._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(t,e,s){t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const n=S(S({hasControls:!1},s),{},{forActiveSelection:!0});for(let i=0;i<this._objects.length;i++)this._objects[i]._renderControls(t,n);super._renderControls(t,e),t.restore()}}T(kn,"type","ActiveSelection"),T(kn,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),q.setClass(kn),q.setClass(kn,"activeSelection");class eC{constructor(){T(this,"resources",{})}applyFilters(t,e,s,n,i){const o=i.getContext("2d");if(!o)return;o.drawImage(e,0,0,s,n);const a={sourceWidth:s,sourceHeight:n,imageData:o.getImageData(0,0,s,n),originalEl:e,originalImageData:o.getImageData(0,0,s,n),canvasEl:i,ctx:o,filterBackend:this};t.forEach(c=>{c.applyTo(a)});const{imageData:l}=a;return l.width===s&&l.height===n||(i.width=l.width,i.height=l.height),o.putImageData(l,0,0),a}}class cm{constructor(){let{tileSize:t=_t.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};T(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),T(this,"resources",{}),this.tileSize=t,this.setupGLContext(t,t),this.captureGPUInfo()}setupGLContext(t,e){this.dispose(),this.createWebGLCanvas(t,e)}createWebGLCanvas(t,e){const s=Ms({width:t,height:e}),n=s.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});n&&(n.clearColor(0,0,0,0),this.canvas=s,this.gl=n)}applyFilters(t,e,s,n,i,o){const a=this.gl,l=i.getContext("2d");if(!a||!l)return;let c;o&&(c=this.getCachedTexture(o,e));const h={originalWidth:e.width||e.naturalWidth||0,originalHeight:e.height||e.naturalHeight||0,sourceWidth:s,sourceHeight:n,destinationWidth:s,destinationHeight:n,context:a,sourceTexture:this.createTexture(a,s,n,c?void 0:e),targetTexture:this.createTexture(a,s,n),originalTexture:c||this.createTexture(a,s,n,c?void 0:e),passes:t.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:i},u=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,u),t.forEach(f=>{f&&f.applyTo(h)}),function(f){const d=f.targetCanvas,p=d.width,g=d.height,m=f.destinationWidth,v=f.destinationHeight;p===m&&g===v||(d.width=m,d.height=v)}(h),this.copyGLTo2D(a,h),a.bindTexture(a.TEXTURE_2D,null),a.deleteTexture(h.sourceTexture),a.deleteTexture(h.targetTexture),a.deleteFramebuffer(u),l.setTransform(1,0,0,1,0,0),h}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(t,e,s,n,i){const{NEAREST:o,TEXTURE_2D:a,RGBA:l,UNSIGNED_BYTE:c,CLAMP_TO_EDGE:h,TEXTURE_MAG_FILTER:u,TEXTURE_MIN_FILTER:f,TEXTURE_WRAP_S:d,TEXTURE_WRAP_T:p}=t,g=t.createTexture();return t.bindTexture(a,g),t.texParameteri(a,u,i||o),t.texParameteri(a,f,i||o),t.texParameteri(a,d,h),t.texParameteri(a,p,h),n?t.texImage2D(a,0,l,l,c,n):t.texImage2D(a,0,l,e,s,0,l,c,null),g}getCachedTexture(t,e,s){const{textureCache:n}=this;if(n[t])return n[t];{const i=this.createTexture(this.gl,e.width,e.height,e,s);return i&&(n[t]=i),i}}evictCachesForKey(t){this.textureCache[t]&&(this.gl.deleteTexture(this.textureCache[t]),delete this.textureCache[t])}copyGLTo2D(t,e){const s=t.canvas,n=e.targetCanvas,i=n.getContext("2d");if(!i)return;i.translate(0,n.height),i.scale(1,-1);const o=s.height-n.height;i.drawImage(s,0,o,n.width,n.height,0,0,n.width,n.height)}copyGLTo2DPutImageData(t,e){const s=e.targetCanvas.getContext("2d"),n=e.destinationWidth,i=e.destinationHeight,o=n*i*4;if(!s)return;const a=new Uint8Array(this.imageBuffer,0,o),l=new Uint8ClampedArray(this.imageBuffer,0,o);t.readPixels(0,0,n,i,t.RGBA,t.UNSIGNED_BYTE,a);const c=new ImageData(l,n,i);s.putImageData(c,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const t=this.gl,e={renderer:"",vendor:""};if(!t)return e;const s=t.getExtension("WEBGL_debug_renderer_info");if(s){const n=t.getParameter(s.UNMASKED_RENDERER_WEBGL),i=t.getParameter(s.UNMASKED_VENDOR_WEBGL);n&&(e.renderer=n.toLowerCase()),i&&(e.vendor=i.toLowerCase())}return this.gpuInfo=e,e}}let Gl;function sC(){const{WebGLProbe:r}=Ks();return r.queryWebGL(ms()),_t.enableGLFiltering&&r.isSupported(_t.textureSize)?new cm({tileSize:_t.textureSize}):new eC}function $l(){return!Gl&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(Gl=sC()),Gl}const nC=["filters","resizeFilter","src","crossOrigin","type"],hm=["cropX","cropY"];class we extends ne{static getDefaults(){return S(S({},super.getDefaults()),we.ownDefaults)}constructor(t,e){super(),T(this,"_lastScaleX",1),T(this,"_lastScaleY",1),T(this,"_filterScalingX",1),T(this,"_filterScalingY",1),this.filters=[],Object.assign(this,we.ownDefaults),this.setOptions(e),this.cacheKey="texture".concat(Bn()),this.setElement(typeof t=="string"?(this.canvas&&ys(this.canvas.getElement())||ui()).getElementById(t):t,e)}getElement(){return this._element}setElement(t){var e;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=t,this._originalElement=t,this._setWidthHeight(s),(e=t.classList)===null||e===void 0||e.add(we.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(t){const e=$l(!1);e instanceof cm&&e.evictCachesForKey(t)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(t=>{const e=this[t];e&&Ks().dispose(e),this[t]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const t=this.getElement();return t?{width:t.naturalWidth||t.width,height:t.naturalHeight||t.height}:{width:0,height:0}}_stroke(t){if(!this.stroke||this.strokeWidth===0)return;const e=this.width/2,s=this.height/2;t.beginPath(),t.moveTo(-e,-s),t.lineTo(e,-s),t.lineTo(e,s),t.lineTo(-e,s),t.lineTo(-e,-s),t.closePath()}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=[];return this.filters.forEach(s=>{s&&e.push(s.toObject())}),S(S({},super.toObject([...hm,...t])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:e},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const t=[],e=this._element,s=-this.width/2,n=-this.height/2;let i=[],o=[],a="",l="";if(!e)return[];if(this.hasCrop()){const c=Bn();i.push('<clipPath id="imageCrop_'+c+`">
`,'	<rect x="'+s+'" y="'+n+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),a=' clip-path="url(#imageCrop_'+c+')" '}if(this.imageSmoothing||(l=' image-rendering="optimizeSpeed"'),t.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(s-this.cropX,'" y="').concat(n-this.cropY,'" width="').concat(e.width||e.naturalWidth,'" height="').concat(e.height||e.naturalHeight,'"').concat(l).concat(a,`></image>
`)),this.stroke||this.strokeDashArray){const c=this.fill;this.fill=null,o=['	<rect x="'.concat(s,'" y="').concat(n,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=c}return i=this.paintFirst!==ee?i.concat(o,t):i.concat(t,o),i}getSrc(t){const e=t?this._element:this._originalElement;return e?e.toDataURL?e.toDataURL():this.srcFromAttribute?e.getAttribute("src")||"":e.src:this.src||""}getSvgSrc(t){return this.getSrc(t)}setSrc(t){let{crossOrigin:e,signal:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Hi(t,{crossOrigin:e,signal:s}).then(n=>{e!==void 0&&this.set({crossOrigin:e}),this.setElement(n)})}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const t=this.resizeFilter,e=this.minimumScaleTrigger,s=this.getTotalObjectScaling(),n=s.x,i=s.y,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!t||n>e&&i>e)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=n,void(this._lastScaleY=i);const a=Ms(o),{width:l,height:c}=o;this._element=a,this._lastScaleX=t.scaleX=n,this._lastScaleY=t.scaleY=i,$l().applyFilters([t],o,l,c,this._element),this._filterScalingX=a.width/this._originalElement.width,this._filterScalingY=a.height/this._originalElement.height}applyFilters(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(t=t.filter(i=>i&&!i.isNeutralState()),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),t.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const e=this._originalElement,s=e.naturalWidth||e.width,n=e.naturalHeight||e.height;if(this._element===this._originalElement){const i=Ms({width:s,height:n});this._element=i,this._filteredEl=i}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,s,n),this._lastScaleX=1,this._lastScaleY=1);$l().applyFilters(t,this._originalElement,s,n,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(t){t.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(t),this._renderPaintInOrder(t)}drawCacheOnCanvas(t){t.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(t)}shouldCache(){return this.needsItsOwnCache()}_renderFill(t){const e=this._element;if(!e)return;const s=this._filterScalingX,n=this._filterScalingY,i=this.width,o=this.height,a=Math.max(this.cropX,0),l=Math.max(this.cropY,0),c=e.naturalWidth||e.width,h=e.naturalHeight||e.height,u=a*s,f=l*n,d=Math.min(i*s,c-u),p=Math.min(o*n,h-f),g=-i/2,m=-o/2,v=Math.min(i,c/s-a),_=Math.min(o,h/n-l);e&&t.drawImage(e,u,f,d,p,g,m,v,_)}_needsResize(){const t=this.getTotalObjectScaling();return t.x!==this._lastScaleX||t.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:t,height:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const s=this.getOriginalSize();this.width=t||s.width,this.height=e||s.height}parsePreserveAspectRatioAttribute(){const t=Zg(this.preserveAspectRatio||""),e=this.width,s=this.height,n={width:e,height:s};let i,o=this._element.width,a=this._element.height,l=1,c=1,h=0,u=0,f=0,d=0;return!t||t.alignX===Re&&t.alignY===Re?(l=e/o,c=s/a):(t.meetOrSlice==="meet"&&(l=c=Hp(this._element,n),i=(e-o*l)/2,t.alignX==="Min"&&(h=-i),t.alignX==="Max"&&(h=i),i=(s-a*c)/2,t.alignY==="Min"&&(u=-i),t.alignY==="Max"&&(u=i)),t.meetOrSlice==="slice"&&(l=c=Yp(this._element,n),i=o-e/l,t.alignX==="Mid"&&(f=i/2),t.alignX==="Max"&&(f=i),i=a-s/c,t.alignY==="Mid"&&(d=i/2),t.alignY==="Max"&&(d=i),o=e/l,a=s/c)),{width:o,height:a,scaleX:l,scaleY:c,offsetLeft:h,offsetTop:u,cropX:f,cropY:d}}static fromObject(t,e){let{filters:s,resizeFilter:n,src:i,crossOrigin:o,type:a}=t,l=It(t,nC);return Promise.all([Hi(i,S(S({},e),{},{crossOrigin:o})),s&&ei(s,e),n&&ei([n],e),yo(l,e)]).then(c=>{let[h,u=[],[f]=[],d={}]=c;return new this(h,S(S({},l),{},{src:i,filters:u,resizeFilter:f},d))})}static fromURL(t){let{crossOrigin:e=null,signal:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return Hi(t,{crossOrigin:e,signal:s}).then(i=>new this(i,n))}static async fromElement(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;const n=_n(t,this.ATTRIBUTE_NAMES,s);return this.fromURL(n["xlink:href"],e,n).catch(i=>(jn("log","Unable to parse Image",i),null))}}T(we,"type","Image"),T(we,"cacheProperties",[...vn,...hm]),T(we,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),T(we,"CSS_CANVAS","canvas-img"),T(we,"ATTRIBUTE_NAMES",[...Un,"x","y","width","height","preserveAspectRatio","xlink:href","crossOrigin","image-rendering"]),q.setClass(we),q.setSVGClass(we);dl(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);const um=Xg,Bf=r=>function(t,e,s){const{points:n,pathOffset:i}=s;return new M(n[r]).subtract(i).transform(Wt(s.getViewportTransform(),s.calcTransformMatrix()))},fm=(r,t,e,s)=>{const{target:n,pointIndex:i}=t,o=n,a=un(new M(e,s),void 0,o.calcOwnMatrix());return o.points[i]=a.add(o.pathOffset),o.setDimensions(),!0},dm=(r,t)=>function(e,s,n,i){const o=s.target,a=new M(o.points[(r>0?r:o.points.length)-1]),l=a.subtract(o.pathOffset).transform(o.calcOwnMatrix()),c=t(e,S(S({},s),{},{pointIndex:r}),n,i),h=a.subtract(o.pathOffset).transform(o.calcOwnMatrix()).subtract(l);return o.left-=h.x,o.top-=h.y,c},Nf=r=>Wn(um,dm(r,fm)),Hc=(r,t,e)=>{const{path:s,pathOffset:n}=r,i=s[t];return new M(i[e]-n.x,i[e+1]-n.y).transform(Wt(r.getViewportTransform(),r.calcTransformMatrix()))};function rC(r,t,e){const{commandIndex:s,pointIndex:n}=this;return Hc(e,s,n)}function iC(r,t,e,s){const{target:n}=t,{commandIndex:i,pointIndex:o}=this,a=((l,c,h,u,f)=>{const{path:d,pathOffset:p}=l,g=d[(u>0?u:d.length)-1],m=new M(g[f],g[f+1]),v=m.subtract(p).transform(l.calcOwnMatrix()),_=un(new M(c,h),void 0,l.calcOwnMatrix());d[u][f]=_.x+p.x,d[u][f+1]=_.y+p.y,l.setDimensions();const y=m.subtract(l.pathOffset).transform(l.calcOwnMatrix()).subtract(v);return l.left-=y.x,l.top-=y.y,l.set("dirty",!0),!0})(n,e,s,i,o);return Fh(this.actionName,S(S({},Dh(r,t,e,s)),{},{commandIndex:i,pointIndex:o})),a}class gm extends Ce{constructor(t){super(t)}render(t,e,s,n,i){const o=S(S({},n),{},{cornerColor:this.controlFill,cornerStrokeColor:this.controlStroke,transparentCorners:!this.controlFill});super.render(t,e,s,o,i)}}class oC extends gm{constructor(t){super(t)}render(t,e,s,n,i){const{path:o}=i,{commandIndex:a,pointIndex:l,connectToCommandIndex:c,connectToPointIndex:h}=this;t.save(),t.strokeStyle=this.controlStroke,this.connectionDashArray&&t.setLineDash(this.connectionDashArray);const[u]=o[a],f=Hc(i,c,h);if(u==="Q"){const d=Hc(i,a,l+2);t.moveTo(d.x,d.y),t.lineTo(e,s)}else t.moveTo(e,s);t.lineTo(f.x,f.y),t.stroke(),t.restore(),super.render(t,e,s,n,i)}}const Ro=(r,t,e,s,n,i)=>new(e?oC:gm)(S(S({commandIndex:r,pointIndex:t,actionName:"modifyPath",positionHandler:rC,actionHandler:iC,connectToCommandIndex:n,connectToPointIndex:i},s),e?s.controlPointStyle:s.pointStyle));var Wr=Object.freeze({__proto__:null,changeWidth:Fc,createObjectDefaultControls:Nh,createPathControls:function(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const e={};let s="M";return r.path.forEach((n,i)=>{const o=n[0];switch(o!=="Z"&&(e["c_".concat(i,"_").concat(o)]=Ro(i,n.length-2,!1,t)),o){case"C":e["c_".concat(i,"_C_CP_1")]=Ro(i,1,!0,t,i-1,(a=>a==="C"?5:a==="Q"?3:1)(s)),e["c_".concat(i,"_C_CP_2")]=Ro(i,3,!0,t,i,5);break;case"Q":e["c_".concat(i,"_Q_CP_1")]=Ro(i,1,!0,t,i,3)}s=o}),e},createPolyActionHandler:Nf,createPolyControls:function(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const e={};for(let s=0;s<(typeof r=="number"?r:r.points.length);s++)e["p".concat(s)]=new Ce(S({actionName:um,positionHandler:Bf(s),actionHandler:Nf(s)},t));return e},createPolyPositionHandler:Bf,createResizeControls:Mp,createTextboxDefaultControls:Ep,dragHandler:cp,factoryPolyActionHandler:dm,getLocalPoint:fl,polyActionHandler:fm,renderCircleControl:mp,renderSquareControl:vp,rotationStyleHandler:_p,rotationWithSnapping:yp,scaleCursorStyleHandler:Fr,scaleOrSkewActionName:Oi,scaleSkewCursorStyleHandler:ir,scalingEqually:Ti,scalingX:Cp,scalingXOrSkewingY:Dc,scalingY:wp,scalingYOrSkewingX:Rc,skewCursorStyleHandler:Sp,skewHandlerX:Op,skewHandlerY:kp,wrapWithFireEvent:Wn,wrapWithFixedAnchor:wr});const bl=r=>r.webgl!==void 0,Vh="precision highp float",aC=`
    `.concat(Vh,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),lC=["type"],cC=["type"],hC=new RegExp(Vh,"g");class se{get type(){return this.constructor.type}constructor(){let t=It(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},lC);Object.assign(this,this.constructor.defaults,t)}getFragmentSource(){return aC}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:n="highp"}}=Ks();n!=="highp"&&(e=e.replace(hC,Vh.replace("highp",n)));const i=t.createShader(t.VERTEX_SHADER),o=t.createShader(t.FRAGMENT_SHADER),a=t.createProgram();if(!i||!o||!a)throw new Ns("Vertex, fragment shader or program creation error");if(t.shaderSource(i,s),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS))throw new Ns("Vertex shader compile error for ".concat(this.type,": ").concat(t.getShaderInfoLog(i)));if(t.shaderSource(o,e),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS))throw new Ns("Fragment shader compile error for ".concat(this.type,": ").concat(t.getShaderInfoLog(o)));if(t.attachShader(a,i),t.attachShader(a,o),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS))throw new Ns('Shader link error for "'.concat(this.type,'" ').concat(t.getProgramInfoLog(a)));const l=this.getUniformLocations(t,a)||{};return l.uStepW=t.getUniformLocation(a,"uStepW"),l.uStepH=t.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:this.getAttributeLocations(t,a),uniformLocations:l}}getAttributeLocations(t,e){return{aPosition:t.getAttribLocation(e,"aPosition")}}getUniformLocations(t,e){const s=this.constructor.uniformLocations,n={};for(let i=0;i<s.length;i++)n[s[i]]=t.getUniformLocation(e,s[i]);return n}sendAttributeData(t,e,s){const n=e.aPosition,i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i),t.enableVertexAttribArray(n),t.vertexAttribPointer(n,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,s,t.STATIC_DRAW)}_setupFrameBuffer(t){const e=t.context;if(t.passes>1){const s=t.destinationWidth,n=t.destinationHeight;t.sourceWidth===s&&t.sourceHeight===n||(e.deleteTexture(t.targetTexture),t.targetTexture=t.filterBackend.createTexture(e,s,n)),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.targetTexture,0)}else e.bindFramebuffer(e.FRAMEBUFFER,null),e.finish()}_swapTextures(t){t.passes--,t.pass++;const e=t.targetTexture;t.targetTexture=t.sourceTexture,t.sourceTexture=e}isNeutralState(t){return!1}applyTo(t){bl(t)?(this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)}applyTo2d(t){}getCacheKey(){return this.type}retrieveShader(t){const e=this.getCacheKey();return t.programCache[e]||(t.programCache[e]=this.createProgram(t.context)),t.programCache[e]}applyToWebGL(t){const e=t.context,s=this.retrieveShader(t);t.pass===0&&t.originalTexture?e.bindTexture(e.TEXTURE_2D,t.originalTexture):e.bindTexture(e.TEXTURE_2D,t.sourceTexture),e.useProgram(s.program),this.sendAttributeData(e,s.attributeLocations,t.aPosition),e.uniform1f(s.uniformLocations.uStepW,1/t.sourceWidth),e.uniform1f(s.uniformLocations.uStepH,1/t.sourceHeight),this.sendUniformData(e,s.uniformLocations),e.viewport(0,0,t.destinationWidth,t.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(t,e,s){t.activeTexture(s),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE0)}unbindAdditionalTexture(t,e){t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0)}sendUniformData(t,e){}createHelpLayer(t){if(!t.helpLayer){const{sourceWidth:e,sourceHeight:s}=t,n=Ms({width:e,height:s});t.helpLayer=n}}toObject(){const t=Object.keys(this.constructor.defaults||{});return S({type:this.type},t.reduce((e,s)=>(e[s]=this[s],e),{}))}toJSON(){return this.toObject()}static async fromObject(t,e){return new this(It(t,cC))}}T(se,"type","BaseFilter"),T(se,"uniformLocations",[]);const uC={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class Lo extends se{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(uC[this.mode],`
        }
      }
      `)}applyTo2d(t){let{imageData:{data:e}}=t;const s=new kt(this.color).getSource(),n=this.alpha,i=s[0]*n,o=s[1]*n,a=s[2]*n,l=1-n;for(let c=0;c<e.length;c+=4){const h=e[c],u=e[c+1],f=e[c+2];let d,p,g;switch(this.mode){case"multiply":d=h*i/255,p=u*o/255,g=f*a/255;break;case"screen":d=255-(255-h)*(255-i)/255,p=255-(255-u)*(255-o)/255,g=255-(255-f)*(255-a)/255;break;case"add":d=h+i,p=u+o,g=f+a;break;case"difference":d=Math.abs(h-i),p=Math.abs(u-o),g=Math.abs(f-a);break;case"subtract":d=h-i,p=u-o,g=f-a;break;case"darken":d=Math.min(h,i),p=Math.min(u,o),g=Math.min(f,a);break;case"lighten":d=Math.max(h,i),p=Math.max(u,o),g=Math.max(f,a);break;case"overlay":d=i<128?2*h*i/255:255-2*(255-h)*(255-i)/255,p=o<128?2*u*o/255:255-2*(255-u)*(255-o)/255,g=a<128?2*f*a/255:255-2*(255-f)*(255-a)/255;break;case"exclusion":d=i+h-2*i*h/255,p=o+u-2*o*u/255,g=a+f-2*a*f/255;break;case"tint":d=i+h*l,p=o+u*l,g=a+f*l}e[c]=d,e[c+1]=p,e[c+2]=g}}sendUniformData(t,e){const s=new kt(this.color).getSource();s[0]=this.alpha*s[0]/255,s[1]=this.alpha*s[1]/255,s[2]=this.alpha*s[2]/255,s[3]=this.alpha,t.uniform4fv(e.uColor,s)}}T(Lo,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),T(Lo,"type","BlendColor"),T(Lo,"uniformLocations",["uColor"]),q.setClass(Lo);const fC={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},dC=["type","image"];class jo extends se{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return fC[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(t){const e=t.context,s=this.createTexture(t.filterBackend,this.image);this.bindAdditionalTexture(e,s,e.TEXTURE1),super.applyToWebGL(t),this.unbindAdditionalTexture(e,e.TEXTURE1)}createTexture(t,e){return t.getCachedTexture(e.cacheKey,e.getElement())}calculateMatrix(){const t=this.image,{width:e,height:s}=t.getElement();return[1/t.scaleX,0,0,0,1/t.scaleY,0,-t.left/e,-t.top/s,1]}applyTo2d(t){let{imageData:{data:e,width:s,height:n},filterBackend:{resources:i}}=t;const o=this.image;i.blendImage||(i.blendImage=ms());const a=i.blendImage,l=a.getContext("2d");a.width!==s||a.height!==n?(a.width=s,a.height=n):l.clearRect(0,0,s,n),l.setTransform(o.scaleX,0,0,o.scaleY,o.left,o.top),l.drawImage(o.getElement(),0,0,s,n);const c=l.getImageData(0,0,s,n).data;for(let h=0;h<e.length;h+=4){const u=e[h],f=e[h+1],d=e[h+2],p=e[h+3],g=c[h],m=c[h+1],v=c[h+2],_=c[h+3];switch(this.mode){case"multiply":e[h]=u*g/255,e[h+1]=f*m/255,e[h+2]=d*v/255,e[h+3]=p*_/255;break;case"mask":e[h+3]=_}}}sendUniformData(t,e){const s=this.calculateMatrix();t.uniform1i(e.uImage,1),t.uniformMatrix3fv(e.uTransformMatrix,!1,s)}toObject(){return S(S({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(t,e){let{type:s,image:n}=t,i=It(t,dC);return we.fromObject(n,e).then(o=>new this(S(S({},i),{},{image:o})))}}T(jo,"type","BlendImage"),T(jo,"defaults",{mode:"multiply",alpha:1}),T(jo,"uniformLocations",["uTransformMatrix","uImage"]),q.setClass(jo);class Io extends se{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float total = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        float weight = 1.0 - abs(percent);
        color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
        total += weight;
      }
      gl_FragColor = color / total;
    }
  `}applyTo(t){bl(t)?(this.aspectRatio=t.sourceWidth/t.sourceHeight,t.passes++,this._setupFrameBuffer(t),this.horizontal=!0,this.applyToWebGL(t),this._swapTextures(t),this._setupFrameBuffer(t),this.horizontal=!1,this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)}applyTo2d(t){t.imageData=this.simpleBlur(t)}simpleBlur(t){let{ctx:e,imageData:s,filterBackend:{resources:n}}=t;const{width:i,height:o}=s;n.blurLayer1||(n.blurLayer1=ms(),n.blurLayer2=ms());const a=n.blurLayer1,l=n.blurLayer2;a.width===i&&a.height===o||(l.width=a.width=i,l.height=a.height=o);const c=a.getContext("2d"),h=l.getContext("2d"),u=15,f=.06*this.blur*.5;let d,p,g,m;for(c.putImageData(s,0,0),h.clearRect(0,0,i,o),m=-15;m<=u;m++)d=(Math.random()-.5)/4,p=m/u,g=f*p*i+d,h.globalAlpha=1-Math.abs(p),h.drawImage(a,g,d),c.drawImage(l,0,0),h.globalAlpha=1,h.clearRect(0,0,l.width,l.height);for(m=-15;m<=u;m++)d=(Math.random()-.5)/4,p=m/u,g=f*p*o+d,h.globalAlpha=1-Math.abs(p),h.drawImage(a,d,g),c.drawImage(l,0,0),h.globalAlpha=1,h.clearRect(0,0,l.width,l.height);e.drawImage(a,0,0);const v=e.getImageData(0,0,a.width,a.height);return c.globalAlpha=1,c.clearRect(0,0,a.width,a.height),v}sendUniformData(t,e){const s=this.chooseRightDelta();t.uniform2fv(e.uDelta,s)}isNeutralState(){return this.blur===0}chooseRightDelta(){let t=1;const e=[0,0];this.horizontal?this.aspectRatio>1&&(t=1/this.aspectRatio):this.aspectRatio<1&&(t=this.aspectRatio);const s=t*this.blur*.12;return this.horizontal?e[0]=s:e[1]=s,e}}T(Io,"type","Blur"),T(Io,"defaults",{blur:0}),T(Io,"uniformLocations",["uDelta"]),q.setClass(Io);class Bo extends se{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const s=Math.round(255*this.brightness);for(let n=0;n<e.length;n+=4)e[n]+=s,e[n+1]+=s,e[n+2]+=s}isNeutralState(){return this.brightness===0}sendUniformData(t,e){t.uniform1f(e.uBrightness,this.brightness)}}T(Bo,"type","Brightness"),T(Bo,"defaults",{brightness:0}),T(Bo,"uniformLocations",["uBrightness"]),q.setClass(Bo);const pm={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class Rr extends se{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(t){const e=t.imageData.data,s=this.matrix,n=this.colorsOnly;for(let i=0;i<e.length;i+=4){const o=e[i],a=e[i+1],l=e[i+2];if(e[i]=o*s[0]+a*s[1]+l*s[2]+255*s[4],e[i+1]=o*s[5]+a*s[6]+l*s[7]+255*s[9],e[i+2]=o*s[10]+a*s[11]+l*s[12]+255*s[14],!n){const c=e[i+3];e[i]+=c*s[3],e[i+1]+=c*s[8],e[i+2]+=c*s[13],e[i+3]=o*s[15]+a*s[16]+l*s[17]+c*s[18]+255*s[19]}}}sendUniformData(t,e){const s=this.matrix,n=[s[0],s[1],s[2],s[3],s[5],s[6],s[7],s[8],s[10],s[11],s[12],s[13],s[15],s[16],s[17],s[18]],i=[s[4],s[9],s[14],s[19]];t.uniformMatrix4fv(e.uColorMatrix,!1,n),t.uniform4fv(e.uConstants,i)}toObject(){return S(S({},super.toObject()),{},{matrix:[...this.matrix]})}}function Sr(r,t){var e;const s=(T(e=class extends Rr{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",r),T(e,"defaults",{colorsOnly:!1,matrix:t}),e);return q.setClass(s,r),s}T(Rr,"type","ColorMatrix"),T(Rr,"defaults",pm),T(Rr,"uniformLocations",["uColorMatrix","uConstants"]),q.setClass(Rr);Sr("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]);Sr("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]);Sr("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]);Sr("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]);Sr("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]);Sr("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]);Sr("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class Hf extends se{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(t),this.subFilters=t.subFilters||[]}applyTo(t){bl(t)&&(t.passes+=this.subFilters.length-1),this.subFilters.forEach(e=>{e.applyTo(t)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(t=>t.toObject())}}isNeutralState(){return!this.subFilters.some(t=>!t.isNeutralState())}static fromObject(t,e){return Promise.all((t.subFilters||[]).map(s=>q.getClass(s.type).fromObject(s,e))).then(s=>new this({subFilters:s}))}}T(Hf,"type","Composed"),q.setClass(Hf);class No extends se{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(t){let{imageData:{data:e}}=t;const s=Math.floor(255*this.contrast),n=259*(s+255)/(255*(259-s));for(let i=0;i<e.length;i+=4)e[i]=n*(e[i]-128)+128,e[i+1]=n*(e[i+1]-128)+128,e[i+2]=n*(e[i+2]-128)+128}sendUniformData(t,e){t.uniform1f(e.uContrast,this.contrast)}}T(No,"type","Contrast"),T(No,"defaults",{contrast:0}),T(No,"uniformLocations",["uContrast"]),q.setClass(No);const gC={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class Ho extends se{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return gC[this.getCacheKey()]}applyTo2d(t){const e=t.imageData,s=e.data,n=this.matrix,i=Math.round(Math.sqrt(n.length)),o=Math.floor(i/2),a=e.width,l=e.height,c=t.ctx.createImageData(a,l),h=c.data,u=this.opaque?1:0;let f,d,p,g,m,v,_,y,b,w,A,O,E;for(A=0;A<l;A++)for(w=0;w<a;w++){for(m=4*(A*a+w),f=0,d=0,p=0,g=0,E=0;E<i;E++)for(O=0;O<i;O++)_=A+E-o,v=w+O-o,_<0||_>=l||v<0||v>=a||(y=4*(_*a+v),b=n[E*i+O],f+=s[y]*b,d+=s[y+1]*b,p+=s[y+2]*b,u||(g+=s[y+3]*b));h[m]=f,h[m+1]=d,h[m+2]=p,h[m+3]=u?s[m+3]:g}t.imageData=c}sendUniformData(t,e){t.uniform1fv(e.uMatrix,this.matrix)}toObject(){return S(S({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}T(Ho,"type","Convolute"),T(Ho,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),T(Ho,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),q.setClass(Ho);const mm="Gamma";class Yo extends se{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(t),this.gamma=t.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(t){let{imageData:{data:e}}=t;const s=this.gamma,n=1/s[0],i=1/s[1],o=1/s[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const a=this.rgbValues;for(let l=0;l<256;l++)a.r[l]=255*Math.pow(l/255,n),a.g[l]=255*Math.pow(l/255,i),a.b[l]=255*Math.pow(l/255,o);for(let l=0;l<e.length;l+=4)e[l]=a.r[e[l]],e[l+1]=a.g[e[l+1]],e[l+2]=a.b[e[l+2]]}sendUniformData(t,e){t.uniform3fv(e.uGamma,this.gamma)}isNeutralState(){const{gamma:t}=this;return t[0]===1&&t[1]===1&&t[2]===1}toObject(){return{type:mm,gamma:this.gamma.concat()}}}T(Yo,"type",mm),T(Yo,"defaults",{gamma:[1,1,1]}),T(Yo,"uniformLocations",["uGamma"]),q.setClass(Yo);const pC={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class zo extends se{applyTo2d(t){let{imageData:{data:e}}=t;for(let s,n=0;n<e.length;n+=4){const i=e[n],o=e[n+1],a=e[n+2];switch(this.mode){case"average":s=(i+o+a)/3;break;case"lightness":s=(Math.min(i,o,a)+Math.max(i,o,a))/2;break;case"luminosity":s=.21*i+.72*o+.07*a}e[n+2]=e[n+1]=e[n]=s}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return pC[this.mode]}sendUniformData(t,e){t.uniform1i(e.uMode,1)}isNeutralState(){return!1}}T(zo,"type","Grayscale"),T(zo,"defaults",{mode:"average"}),T(zo,"uniformLocations",["uMode"]),q.setClass(zo);const mC=S(S({},pm),{},{rotation:0});class ql extends Rr{calculateMatrix(){const t=this.rotation*Math.PI,e=Os(t),s=ks(t),n=1/3,i=Math.sqrt(n)*s,o=1-e;this.matrix=[e+o/3,n*o-i,n*o+i,0,0,n*o+i,e+n*o,n*o-i,0,0,n*o-i,n*o+i,e+n*o,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(t){this.calculateMatrix(),super.applyTo(t)}toObject(){return{type:this.type,rotation:this.rotation}}}T(ql,"type","HueRotation"),T(ql,"defaults",mC),q.setClass(ql);class Xo extends se{applyTo2d(t){let{imageData:{data:e}}=t;for(let s=0;s<e.length;s+=4)e[s]=255-e[s],e[s+1]=255-e[s+1],e[s+2]=255-e[s+2],this.alpha&&(e[s+3]=255-e[s+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(t,e){t.uniform1i(e.uInvert,Number(this.invert)),t.uniform1i(e.uAlpha,Number(this.alpha))}}T(Xo,"type","Invert"),T(Xo,"defaults",{alpha:!1,invert:!0}),T(Xo,"uniformLocations",["uInvert","uAlpha"]),q.setClass(Xo);class Vo extends se{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const s=this.noise;for(let n=0;n<e.length;n+=4){const i=(.5-Math.random())*s;e[n]+=i,e[n+1]+=i,e[n+2]+=i}}sendUniformData(t,e){t.uniform1f(e.uNoise,this.noise/255),t.uniform1f(e.uSeed,Math.random())}isNeutralState(){return this.noise===0}}T(Vo,"type","Noise"),T(Vo,"defaults",{noise:0}),T(Vo,"uniformLocations",["uNoise","uSeed"]),q.setClass(Vo);class Wo extends se{applyTo2d(t){let{imageData:{data:e,width:s,height:n}}=t;for(let i=0;i<n;i+=this.blocksize)for(let o=0;o<s;o+=this.blocksize){const a=4*i*s+4*o,l=e[a],c=e[a+1],h=e[a+2],u=e[a+3];for(let f=i;f<Math.min(i+this.blocksize,n);f++)for(let d=o;d<Math.min(o+this.blocksize,s);d++){const p=4*f*s+4*d;e[p]=l,e[p+1]=c,e[p+2]=h,e[p+3]=u}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(t,e){t.uniform1f(e.uBlocksize,this.blocksize)}}T(Wo,"type","Pixelate"),T(Wo,"defaults",{blocksize:4}),T(Wo,"uniformLocations",["uBlocksize"]),q.setClass(Wo);class Uo extends se{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(t){let{imageData:{data:e}}=t;const s=255*this.distance,n=new kt(this.color).getSource(),i=[n[0]-s,n[1]-s,n[2]-s],o=[n[0]+s,n[1]+s,n[2]+s];for(let a=0;a<e.length;a+=4){const l=e[a],c=e[a+1],h=e[a+2];l>i[0]&&c>i[1]&&h>i[2]&&l<o[0]&&c<o[1]&&h<o[2]&&(e[a+3]=0)}}sendUniformData(t,e){const s=new kt(this.color).getSource(),n=this.distance,i=[0+s[0]/255-n,0+s[1]/255-n,0+s[2]/255-n,1],o=[s[0]/255+n,s[1]/255+n,s[2]/255+n,1];t.uniform4fv(e.uLow,i),t.uniform4fv(e.uHigh,o)}}T(Uo,"type","RemoveColor"),T(Uo,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),T(Uo,"uniformLocations",["uLow","uHigh"]),q.setClass(Uo);class Go extends se{sendUniformData(t,e){t.uniform2fv(e.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),t.uniform1fv(e.uTaps,this.taps)}getFilterWindow(){const t=this.tempScale;return Math.ceil(this.lanczosLobes/t)}getCacheKey(){const t=this.getFilterWindow();return"".concat(this.type,"_").concat(t)}getFragmentSource(){const t=this.getFilterWindow();return this.generateShader(t)}getTaps(){const t=this.lanczosCreate(this.lanczosLobes),e=this.tempScale,s=this.getFilterWindow(),n=new Array(s);for(let i=1;i<=s;i++)n[i-1]=t(i*e);return n}generateShader(t){const e=new Array(t);for(let s=1;s<=t;s++)e[s-1]="".concat(s,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(t,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(e.map((s,n)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(s,") * uTaps[").concat(n,"] + texture2D(uTexture, vTexCoord - ").concat(s,") * uTaps[").concat(n,`];
              sum += 2.0 * uTaps[`).concat(n,`];
            `)).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(t){t.passes++,this.width=t.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=t.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),t.destinationWidth=this.dW,super.applyTo(t),t.sourceWidth=t.destinationWidth,this.height=t.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),t.destinationHeight=this.dH,super.applyTo(t),t.sourceHeight=t.destinationHeight}applyTo(t){bl(t)?this.applyToForWebgl(t):this.applyTo2d(t)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(t){return e=>{if(e>=t||e<=-t)return 0;if(e<11920929e-14&&e>-11920929e-14)return 1;const s=(e*=Math.PI)/t;return Math.sin(e)/e*Math.sin(s)/s}}applyTo2d(t){const e=t.imageData,s=this.scaleX,n=this.scaleY;this.rcpScaleX=1/s,this.rcpScaleY=1/n;const i=e.width,o=e.height,a=Math.round(i*s),l=Math.round(o*n);let c;c=this.resizeType==="sliceHack"?this.sliceByTwo(t,i,o,a,l):this.resizeType==="hermite"?this.hermiteFastResize(t,i,o,a,l):this.resizeType==="bilinear"?this.bilinearFiltering(t,i,o,a,l):this.resizeType==="lanczos"?this.lanczosResize(t,i,o,a,l):new ImageData(a,l),t.imageData=c}sliceByTwo(t,e,s,n,i){const o=t.imageData,a=.5;let l=!1,c=!1,h=e*a,u=s*a;const f=t.filterBackend.resources;let d=0,p=0;const g=e;let m=0;f.sliceByTwo||(f.sliceByTwo=ms());const v=f.sliceByTwo;(v.width<1.5*e||v.height<s)&&(v.width=1.5*e,v.height=s);const _=v.getContext("2d");for(_.clearRect(0,0,1.5*e,s),_.putImageData(o,0,0),n=Math.floor(n),i=Math.floor(i);!l||!c;)e=h,s=u,n<Math.floor(h*a)?h=Math.floor(h*a):(h=n,l=!0),i<Math.floor(u*a)?u=Math.floor(u*a):(u=i,c=!0),_.drawImage(v,d,p,e,s,g,m,h,u),d=g,p=m,m+=u;return _.getImageData(d,p,n,i)}lanczosResize(t,e,s,n,i){const o=t.imageData.data,a=t.ctx.createImageData(n,i),l=a.data,c=this.lanczosCreate(this.lanczosLobes),h=this.rcpScaleX,u=this.rcpScaleY,f=2/this.rcpScaleX,d=2/this.rcpScaleY,p=Math.ceil(h*this.lanczosLobes/2),g=Math.ceil(u*this.lanczosLobes/2),m={},v={x:0,y:0},_={x:0,y:0};return function y(b){let w,A,O,E,D,Y,K,st,G,rt,ct;for(v.x=(b+.5)*h,_.x=Math.floor(v.x),w=0;w<i;w++){for(v.y=(w+.5)*u,_.y=Math.floor(v.y),D=0,Y=0,K=0,st=0,G=0,A=_.x-p;A<=_.x+p;A++)if(!(A<0||A>=e)){rt=Math.floor(1e3*Math.abs(A-v.x)),m[rt]||(m[rt]={});for(let et=_.y-g;et<=_.y+g;et++)et<0||et>=s||(ct=Math.floor(1e3*Math.abs(et-v.y)),m[rt][ct]||(m[rt][ct]=c(Math.sqrt(Math.pow(rt*f,2)+Math.pow(ct*d,2))/1e3)),O=m[rt][ct],O>0&&(E=4*(et*e+A),D+=O,Y+=O*o[E],K+=O*o[E+1],st+=O*o[E+2],G+=O*o[E+3]))}E=4*(w*n+b),l[E]=Y/D,l[E+1]=K/D,l[E+2]=st/D,l[E+3]=G/D}return++b<n?y(b):a}(0)}bilinearFiltering(t,e,s,n,i){let o,a,l,c,h,u,f,d,p,g,m,v,_,y=0;const b=this.rcpScaleX,w=this.rcpScaleY,A=4*(e-1),O=t.imageData.data,E=t.ctx.createImageData(n,i),D=E.data;for(f=0;f<i;f++)for(d=0;d<n;d++)for(h=Math.floor(b*d),u=Math.floor(w*f),p=b*d-h,g=w*f-u,_=4*(u*e+h),m=0;m<4;m++)o=O[_+m],a=O[_+4+m],l=O[_+A+m],c=O[_+A+4+m],v=o*(1-p)*(1-g)+a*p*(1-g)+l*g*(1-p)+c*p*g,D[y++]=v;return E}hermiteFastResize(t,e,s,n,i){const o=this.rcpScaleX,a=this.rcpScaleY,l=Math.ceil(o/2),c=Math.ceil(a/2),h=t.imageData.data,u=t.ctx.createImageData(n,i),f=u.data;for(let d=0;d<i;d++)for(let p=0;p<n;p++){const g=4*(p+d*n);let m=0,v=0,_=0,y=0,b=0,w=0,A=0;const O=(d+.5)*a;for(let E=Math.floor(d*a);E<(d+1)*a;E++){const D=Math.abs(O-(E+.5))/c,Y=(p+.5)*o,K=D*D;for(let st=Math.floor(p*o);st<(p+1)*o;st++){let G=Math.abs(Y-(st+.5))/l;const rt=Math.sqrt(K+G*G);rt>1&&rt<-1||(m=2*rt*rt*rt-3*rt*rt+1,m>0&&(G=4*(st+E*e),A+=m*h[G+3],_+=m,h[G+3]<255&&(m=m*h[G+3]/250),y+=m*h[G],b+=m*h[G+1],w+=m*h[G+2],v+=m))}}f[g]=y/v,f[g+1]=b/v,f[g+2]=w/v,f[g+3]=A/_}return u}}T(Go,"type","Resize"),T(Go,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),T(Go,"uniformLocations",["uDelta","uTaps"]),q.setClass(Go);class $o extends se{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const s=-this.saturation;for(let n=0;n<e.length;n+=4){const i=e[n],o=e[n+1],a=e[n+2],l=Math.max(i,o,a);e[n]+=l!==i?(l-i)*s:0,e[n+1]+=l!==o?(l-o)*s:0,e[n+2]+=l!==a?(l-a)*s:0}}sendUniformData(t,e){t.uniform1f(e.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}T($o,"type","Saturation"),T($o,"defaults",{saturation:0}),T($o,"uniformLocations",["uSaturation"]),q.setClass($o);class qo extends se{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const s=-this.vibrance;for(let n=0;n<e.length;n+=4){const i=e[n],o=e[n+1],a=e[n+2],l=Math.max(i,o,a),c=(i+o+a)/3,h=2*Math.abs(l-c)/255*s;e[n]+=l!==i?(l-i)*h:0,e[n+1]+=l!==o?(l-o)*h:0,e[n+2]+=l!==a?(l-a)*h:0}}sendUniformData(t,e){t.uniform1f(e.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}T(qo,"type","Vibrance"),T(qo,"defaults",{vibrance:0}),T(qo,"uniformLocations",["uVibrance"]),q.setClass(qo);const Ko={FRAME:{WIDTH:579,HEIGHT:326},PAGE_FRAME:{WIDTH:1280,HEIGHT:720}},Me={PRIMARY:"#3564FF",TRANSPARENT:"transparent",TEXT:"#333333",BORDER:{DEFAULT:"transparent",HOVER:"#3564FF",SELECTED:"#3564FF",UNSELECTED:"#747C87"},BACKGROUND:{DEFAULT:"#ffffff",HOVER:"#f0f0f0"}},Ys={PADDING_0:0,CORNER_SIZE:8,STROKE_WIDTH:1,BORDER_LINE_WIDTH_TEXT:1.5,BORDER_SCALE_FACTOR:1,MIN_ZOOM:.1,MAX_ZOOM:100},Mn={CORNER:{STYLE:"circle",COLOR:Me.PRIMARY,SIZE:Ys.CORNER_SIZE,TRANSPARENT:!1}},xe=class xe{static getRandomColor(t=xe.FRAME_COLORS){return t[Math.floor(Math.random()*t.length)]}static generateRandomColor(t=1){const e=Math.floor(Math.random()*256),s=Math.floor(Math.random()*256),n=Math.floor(Math.random()*256);return t===1?`#${e.toString(16).padStart(2,"0")}${s.toString(16).padStart(2,"0")}${n.toString(16).padStart(2,"0")}`:`rgba(${e}, ${s}, ${n}, ${t})`}static generateSoftRandomColor(){const t=Math.floor(Math.random()*360),e=Math.floor(Math.random()*30)+70,s=Math.floor(Math.random()*15)+80;return`hsl(${t}, ${e}%, ${s}%)`}static getColorByIndex(t,e=xe.FRAME_COLORS){return e[t%e.length]}static setColorOpacity(t,e){if(t.startsWith("#")){const s=parseInt(t.slice(1,3),16),n=parseInt(t.slice(3,5),16),i=parseInt(t.slice(5,7),16);return`rgba(${s}, ${n}, ${i}, ${e})`}if(t.startsWith("rgb(")){const s=t.match(/\d+/g);if(s&&s.length>=3)return`rgba(${s[0]}, ${s[1]}, ${s[2]}, ${e})`}return t}static rgbToHex(t,e,s){return`#${t.toString(16).padStart(2,"0")}${e.toString(16).padStart(2,"0")}${s.toString(16).padStart(2,"0")}`}static hexToRgb(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}static shadeColor(t,e){const s=xe.hexToRgb(t);if(!s)return t;const{r:n,g:i,b:o}=s,a=Math.max(0,Math.min(255,n+e)),l=Math.max(0,Math.min(255,i+e)),c=Math.max(0,Math.min(255,o+e));return xe.rgbToHex(a,l,c)}static getColorPickerHtml(t,e="#1890ff"){return`
      <div class="color-picker-container" style="margin: 10px 0;">
        <label for="${t}" style="display: block; margin-bottom: 5px;">选择颜色:</label>
        <input type="color" id="${t}" value="${e}" style="width: 50px; height: 30px;">
        <input type="text" id="${t}-text" value="${e}" style="margin-left: 10px; width: 80px;">
        <div class="color-presets" style="margin-top: 5px; display: flex; flex-wrap: wrap;">
          ${xe.THEME_COLORS.map(s=>`<div class="color-preset" data-color="${s}" style="width: 20px; height: 20px; background-color: ${s}; margin: 2px; cursor: pointer; border-radius: 2px;"></div>`).join("")}
        </div>
      </div>
    `}static initColorPicker(t,e){if(typeof document>"u")return;const s=document.getElementById(t),n=document.getElementById(`${t}-text`),i=document.querySelectorAll(`#${t}-container .color-preset`);s&&n&&(s.addEventListener("input",()=>{n.value=s.value,e==null||e(s.value)}),n.addEventListener("input",()=>{/^#[0-9A-F]{6}$/i.test(n.value)&&(s.value=n.value,e==null||e(n.value))}),i.forEach(o=>{o.addEventListener("click",a=>{const l=a.currentTarget.getAttribute("data-color")||"#1890ff";s.value=l,n.value=l,e==null||e(l)})}))}};F(xe,"FRAME_COLORS",["#FFE5E5","#E5FFE5","#E5E5FF","#FFFFE5","#FFE5FF","#E5FFFF","#F5E6D3","#E6E6FA","#F0FFF0","#F5F5DC"]),F(xe,"THEME_COLORS",["#1890ff","#52c41a","#faad14","#f5222d","#722ed1","#eb2f96","#fa8c16","#13c2c2"]),F(xe,"FLAT_UI_COLORS",["#1abc9c","#2ecc71","#3498db","#9b59b6","#34495e","#16a085","#27ae60","#2980b9","#8e44ad","#2c3e50"]),F(xe,"MATERIAL_COLORS",["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4caf50"]),F(xe,"GRADIENT_COLORS",["#a18cd1","#fbc2eb","#84fab0","#8fd3f4","#d4fc79","#96e6a1","#fda085","#f6d365","#fad0c4","#ffecd2"]),F(xe,"NORDIC_COLORS",["#f9f9f9","#e8e8e8","#d9e2ec","#b3c2cf","#4a5568","#2d3748","#e2e8f0","#edf2f7","#f7fafc","#cbd5e0"]),F(xe,"TECH_COLORS",["#00b8d4","#00bfa5","#00c853","#2979ff","#3d5afe","#651fff","#d500f9","#f50057","#ff3d00","#1a237e"]),F(xe,"TRADITIONAL_CHINESE_COLORS",["#e4c6d0","#789262","#493131","#a98175","#1c1c1c","#9d2933","#d4f2e7","#f2be45","#61649f","#8d4bbb","#d71345","#45b97c","#4b5cc4","#f05654","#8e453f","#ffb3a7","#e0eee8","#96c37d","#9b4400","#f35336"]);let Xi=xe;const vC={fill:"rgba(255, 255, 255, 0)",customBorderColor:"rgba(0, 0, 0, 0.4)",rx:3,ry:3,shadow:new Ws({color:"rgba(0, 0, 0, 0.1)",blur:15,offsetX:0,offsetY:0}),opacity:.8,backgroundColor:"rgba(255, 255, 255, 0)"},ie=[];for(let r=0;r<256;++r)ie.push((r+256).toString(16).slice(1));function _C(r,t=0){return(ie[r[t+0]]+ie[r[t+1]]+ie[r[t+2]]+ie[r[t+3]]+"-"+ie[r[t+4]]+ie[r[t+5]]+"-"+ie[r[t+6]]+ie[r[t+7]]+"-"+ie[r[t+8]]+ie[r[t+9]]+"-"+ie[r[t+10]]+ie[r[t+11]]+ie[r[t+12]]+ie[r[t+13]]+ie[r[t+14]]+ie[r[t+15]]).toLowerCase()}let Kl;const yC=new Uint8Array(16);function bC(){if(!Kl){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Kl=crypto.getRandomValues.bind(crypto)}return Kl(yC)}const xC=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Yf={randomUUID:xC};function CC(r,t,e){var n;if(Yf.randomUUID&&!r)return Yf.randomUUID();r=r||{};const s=r.random??((n=r.rng)==null?void 0:n.call(r))??bC();if(s.length<16)throw new Error("Random bytes length must be >= 16");return s[6]=s[6]&15|64,s[8]=s[8]&63|128,_C(s)}let vm=null;function wC(r){vm=r}function _m(){return vm}function zf(r,t){const e=new he("加载中...",{left:r.getWidth()/2,top:r.getHeight()/2,originX:"center",originY:"center",fill:"#666",fontSize:20,selectable:!1,evented:!1});r.add(e),r.requestRenderAll(),we.fromURL(t,{crossOrigin:"anonymous"}).then(s=>{const n=r.getWidth(),i=r.getHeight(),o=Math.max(n/s.width,i/s.height);s.scale(o),s.set({left:n/2,top:i/2,originX:"center",originY:"center",selectable:!1,evented:!1}),r.backgroundImage=s,r.remove(e),r.requestRenderAll(),yt.emit(ft.CANVAS.BACKGROUND_IMAGE_CHANGE,{canvas:r,image:s})})}function SC(r,t){r.backgroundColor=t,r.requestRenderAll(),yt.emit(ft.CANVAS.CANVAS_UPDATE,{type:"change",target:r}),yt.emit(ft.CANVAS.BACKGROUND_COLOR_CHANGE,{canvas:r,color:t})}function TC(r,t){const e=r.getObjects(),s=[],n=r.viewportTransform,i=r.getZoom(),o=Dn.transformPoint(new M(t.x,t.y),Dn.invertTransform(n)),a={left:-n[4]/i,top:-n[5]/i,width:r.width/i,height:r.height/i};for(let l=e.length-1;l>=0;l--){const c=e[l];if(!c.visible)continue;const h=c.getBoundingRect();h.left>a.left+a.width||h.left+h.width<a.left||h.top>a.top+a.height||h.top+h.height<a.top||o.x<h.left||o.x>h.left+h.width||o.y<h.top||o.y>h.top+h.height||c.containsPoint(o)&&s.push(c)}return s}function OC(r,t,e=1){const s=t.left+t.width,n=t.top+t.height,i=t.left+e,o=t.top+e,a=s-e,l=n-e,c=r.x>=t.left&&r.x<=s&&r.y>=t.top&&r.y<=n,h=r.x>=i&&r.x<=a&&r.y>=o&&r.y<=l;return c&&!h}function Jl(r,t){const e=TC(r,t),s=e.find(i=>i instanceof Qt&&OC(t,i,10));let n=null;return s||(n=e.find(i=>i.type!==Qt.type&&!(i instanceof Qt))),{target:n||s,targets:e}}let Zl=!1;const ia=[];async function kC(r,t,e){const s=async()=>{var a;if(!r)return;const n={waitForRender:!0};if(!r)return;const i=((a=r.viewportTransform)==null?void 0:a.slice())||[1,0,0,1,0,0],o=r.getZoom();try{const l=rr(r,e),c=t.getContext("2d");if(!c)return;r.setViewportTransform(l.transform),await new Promise(f=>{n.waitForRender&&requestAnimationFrame(()=>{r.renderAll(),requestAnimationFrame(()=>{setTimeout(f,500)})})});const h=r.getWidth(),u=r.getHeight();t.width=h,t.height=u,c.clearRect(0,0,t.width,t.height),c.drawImage(r.lowerCanvasEl,0,0,h,u,0,0,t.width,t.height)}catch(l){console.error("生成可靠缩略图失败:",l);return}finally{r.setViewportTransform(i),r.setZoom(o)}};return new Promise((n,i)=>{ia.push(async()=>{try{await s(),n()}catch(o){i(o)}}),ym()})}async function ym(){if(!(Zl||ia.length===0)){Zl=!0;try{const r=ia.shift();r&&await r()}finally{Zl=!1,ia.length>0&&ym()}}}function rr(r,t,e=0,s=0,n=!1){const i=r.viewportTransform;r.setViewportTransform([1,0,0,1,0,0]);const o=t.getCenterPoint(),a=o.x,l=o.y;let c=r.getWidth(),h=r.getHeight();n?(c=window.screen.width*window.devicePixelRatio,c=window.screen.height*window.devicePixelRatio):(c=r.getWidth()||window.innerWidth-e,h=(r.getHeight()||window.innerHeight)-s);const u=t.getBoundingRect(),f=u.width,d=u.height,p=c*.99/f,g=h*.99/d,m=Math.min(p,g),v=c/2-a*m,_=h/2-l*m,y=u.left*m+v,b=u.top*m+_,w=f*m,A=d*m;return{transform:[m,0,0,m,v,_],scale:m,centerX:a,centerY:l,width:f,height:d,left:u.left,top:u.top,right:u.left+f,bottom:u.top+d,scaledLeft:y,scaledTop:b,scaledWidth:w,scaledHeight:A,currentTransform:i}}const za=class za extends ls{constructor(e){e={...vC,...e,strokeUniform:!0};super(e);F(this,"thumbnail",async e=>{if(!e.getContext("2d"))return null;const n=_m();await kC(n.getPresentationCanvas(),e,this)});this.id=e.id||CC(),this.initializeControls(),this.initEventHandlers(),this.customBorderColor=e.customBorderColor,this.customControls=e.customControls||[],this.controlsVisibilityMap=e.controlsVisibilityMap||{},this.objectCaching=!0,this.noScaleCache=!1,this.set("willReadFrequently",!1),this.set("cacheProperties",["fill","stroke","strokeWidth"]),this.strokeUniform=!0}initializeControls(){this.cornerSize=Mn.CORNER.SIZE,this.cornerColor=Mn.CORNER.COLOR,this.cornerStyle=Mn.CORNER.STYLE,this.transparentCorners=Mn.CORNER.TRANSPARENT,this.setControlsVisibility({mtr:!1}),this.lockRotation=!0}containsPoint(e){const n=this.getBoundingRect();return e.x>=n.left&&e.x<=n.left+10||e.x<=n.left+n.width&&e.x>=n.left+n.width-10||e.y>=n.top&&e.y<=n.top+10||e.y<=n.top+n.height&&e.y>=n.top+n.height-10}initEventHandlers(){}requestRender(){this.canvas&&requestAnimationFrame(()=>{this.canvas.requestRenderAll()})}setCu1stomBorderColor(e){this.customBorderColor=e,this.requestRender()}setControlVisibility(e,s){const n={[e]:s};super.setControlsVisibility(n),this.controlsVisibilityMap[e]=s,s?this.customControls.includes(e)||this.customControls.push(e):this.customControls=this.customControls.filter(i=>i!==e),this.requestRender()}setControlsVisibilityBatch(e){Object.entries(e).forEach(([s,n])=>{this.setControlVisibility(s,n)})}render(e){super.render(e),this.drawCustomBorder(e),this.canvas&&this.canvas.getActiveObject()===this?this.drawCustomControls(e):this.shouldRenderCustomControlsWhenInactive()&&this.renderCustomControlsWhenInactive(e)}shouldRenderCustomControlsWhenInactive(){return!1}renderCustomControlsWhenInactive(e){e.save();const s=this.getViewportTransform(),n=Dn.multiplyTransformMatrices(s,this.calcTransformMatrix()),i=Dn.qrDecompose(n),{tl:o}=this.oCoords||{};o?e.translate(o.x,o.y):e.translate(i.translateX,i.translateY),e.rotate(Dn.degreesToRadians(i.angle)),this.drawCustomControls(e),e.restore()}getCustomControlsToShow(){return this.customControls.filter(e=>this.controlsVisibilityMap[e]!==!1)}drawCustomControls(e,s={}){e.save();const n=this.getCanvasRetinaScaling(),{cornerStrokeColor:i,cornerDashArray:o,cornerColor:a}=this,l={cornerStrokeColor:i,cornerDashArray:o,cornerColor:a,...s};e.setTransform(n,0,0,n,0,0),e.strokeStyle=e.fillStyle=l.cornerColor,this.transparentCorners||(e.strokeStyle=l.cornerStrokeColor),this._setLineDash(e,l.cornerDashArray);const c=this.getCustomControlsToShow();this.forEachControl((h,u)=>{if(c.includes(u)&&h.getVisibility(this,u)&&this.controls[u].visible!==!1){const d=this.oCoords[u];h.render(e,d.x,d.y,l,this)}}),e.restore()}drawCustomBorder(e){if(!this.canvas)return;e.save();const s=this.canvas.getZoom();e.lineWidth=1/s,e.strokeStyle=this.customBorderColor;const n=this.calcTransformMatrix();e.transform(n[0],n[1],n[2],n[3],n[4],n[5]);const i=this.width,o=this.height,a=this.rx?Math.min(this.rx,i/2):0,l=this.ry?Math.min(this.ry,o/2):0;e.beginPath(),e.moveTo(-i/2+a,-o/2),e.lineTo(i/2-a,-o/2),e.quadraticCurveTo(i/2,-o/2,i/2,-o/2+l),e.lineTo(i/2,o/2-l),e.quadraticCurveTo(i/2,o/2,i/2-a,o/2),e.lineTo(-i/2+a,o/2),e.quadraticCurveTo(-i/2,o/2,-i/2,o/2-l),e.lineTo(-i/2,-o/2+l),e.quadraticCurveTo(-i/2,-o/2,-i/2+a,-o/2),e.stroke(),e.restore()}toJSON(){return{...super.toJSON(),type:za.type,id:this.id,customBorderColor:this.customBorderColor,customControls:this.customControls,controlsVisibilityMap:this.controlsVisibilityMap}}toObject(e=[]){return super.toObject([...e,"type","id","customBorderColor","customControls","controlsVisibilityMap"])}};F(za,"type","slides");let Qt=za;q.setClass(Qt,Qt.type);q.setSVGClass(Qt,Qt.type);class zt extends Qt{constructor(e){console.log("Frame options",e);const s={...e};super(s);F(this,"renderCustomCorner",(e,s,n,i,o)=>{this.canvas&&this.canvas.getZoom();const a=18;e.save(),e.translate(s,n),e.rotate(Dn.degreesToRadians(o.angle)),e.beginPath(),e.arc(0,0,a/2,0,2*Math.PI),e.fillStyle=this.isCurrentSelected?Me.BORDER.HOVER:Me.BORDER.UNSELECTED,e.fill(),e.fillStyle="white",e.font="14px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText(this.order.toString(),0,0),e.restore()});this.parentPage=e.parentPage,this.contents=new Set,this._originalLeft=e.left,this._originalTop=e.top,this.order=e.order||0,console.log("初始化Frame当前Frame Order:",this.order),this.initFrameNumberControl()}initFrameNumberControl(){const e=this.controls.tl;this.controls.frameNumberCorner=new Ce({x:-.5,y:-.5,offsetX:3,offsetY:3,cursorStyle:"nwse-resize",render:this.renderCustomCorner,mouseDownHandler:function(s,n,i,o){var a;return n.originX="right",n.originY="bottom",n.corner="tl",(a=e.mouseDownHandler)==null?void 0:a.call(e,s,n,i,o)},actionHandler:function(s,n,i,o){return Wr.scalingEqually(s,n,i,o)}})}setNumberControlVisibility(e){this.setControlVisibility("frameNumberCorner",e)}shouldRenderCustomControlsWhenInactive(){return!0}getCustomControlsToShow(){return["frameNumberCorner"]}updateContents(){if(this.contents.size>0){console.log("updateContents",this.contents);const{scaleX:e,scaleY:s,left:n,top:i,angle:o}=this;this.contents.forEach(a=>{if(a&&a.set){a.objectCaching||(a.objectCaching=!0,a.statefull=!1,a.noScaleCache=!1,a.set("willReadFrequently",!1),a.set("cacheProperties",["fill","stroke","strokeWidth"]));const l=a.left-n,c=a.top-i;a._originalLeft=l,a._originalTop=c,a.set({left:a.left+(this.left-a._prevFrameLeft||0),top:a.top+(this.top-a._prevFrameTop||0),angle:o+(a.angle||0)},{statefull:!1,skipRender:!0}),a._prevFrameLeft=this.left,a._prevFrameTop=this.top,a.setCoords()}}),this.canvas&&requestAnimationFrame(()=>{this.canvas.requestRenderAll()})}}addContent(e){console.log("Frame addContent",e),e._originalLeft=e.left-this.left,e._originalTop=e.top-this.top,e._originalAngle=e.angle||0,e.objectCaching=!0,e.statefull=!1,e.noScaleCache=!1,e.set("willReadFrequently",!1),e.set("cacheProperties",["fill","stroke","strokeWidth"]),this.contents.add(e)}removeContent(e){this.contents.delete(e)}clearContents(){this.canvas&&this.contents.forEach(e=>{this.canvas.remove(e)}),this.contents.clear()}toggleContentSelectable(e){this.contents.forEach(s=>{s&&s.set&&s.set({selectable:e,evented:e})})}toJSON(){return{...super.toJSON(),id:this.id,parentPage:this.parentPage,contents:Array.from(this.contents),order:this.order}}toObject(e=[]){return super.toObject([...e,"parentPage","contents","order","isCurrentSelected"])}}F(zt,"type","frame");q.setClass(zt,zt.type);q.setSVGClass(zt,zt.type);class ce extends Qt{constructor(e){const s={...e};super(s);F(this,"initialLeft");F(this,"initialTop");this.initialLeft=e.left,this.initialTop=e.top}initializeControls(){super.initializeControls(),this.setControlsVisibility({mtr:!1,bl:!0,br:!0,tl:!0,tr:!0,mb:!1,ml:!1,mr:!1,mt:!1})}toJSON(){return{...super.toJSON(),initialLeft:this.initialLeft,initialTop:this.initialTop}}}F(ce,"type","pageframe");q.setClass(ce,ce.type);q.setSVGClass(ce,ce.type);class MC{constructor(t,e){F(this,"canvas");F(this,"frameManager");this.canvas=t,this.frameManager=e}setupFrameEvents(t){t.off("moving"),t.off("rotating"),t.off("scaling"),t.on("moving",()=>this.handleFrameMoving(t)),t.on("rotating",()=>this.handleFrameRotating(t)),t.on("scaling",()=>this.handleFrameScaling(t)),this.frameManager&&(t.on("moving",()=>this.updateFrameNumberPosition(t)),t.on("rotating",()=>this.updateFrameNumberPosition(t)),t.on("scaling",()=>this.updateFrameNumberPosition(t)))}handleFrameMoving(t){t.updateContents()}handleFrameRotating(t){t.updateContents()}handleFrameScaling(t){t.updateContents()}updateFrameNumberPosition(t){this.frameManager&&this.frameManager.updateNumberPositionForFrame(t)}bringFrameToFront(t){const e=this.canvas.getObjects();e.indexOf(t)!==e.length-1&&(this.canvas.bringObjectToFront(t),t.contents.forEach(n=>{this.canvas.bringObjectToFront(n)}),this.canvas.requestRenderAll())}}class EC{constructor(t){F(this,"frames",new Map);F(this,"canvas");F(this,"frameEventHandler");F(this,"currentFrame",null);this.canvas=t,this.frameEventHandler=new MC(t,this)}createFrame(t){const e=this.frames.size+1;console.log("Creating frame with order:",e);const s=new zt({...t,order:e});return this.frameEventHandler.setupFrameEvents(s),this.frames.set(s.id,s),this.canvas.add(s),this.canvas.requestRenderAll(),yt.emit(ft.FRAME.FRAME_ADDED,{frameId:s.id,frame:s,framesCount:this.frames.size,frames:this.getAllFrames()}),s}updateNumberPositionForFrame(t){}deleteFrame(t){const e=this.frames.get(t);e&&(e.clearContents(),this.canvas.remove(e),this.frames.delete(t),yt.emit(ft.FRAME.FRAME_REMOVED,{frameId:t,framesCount:this.frames.size,frames:this.getAllFrames()})),this.updateFrameOrder()}getFrame(t){return this.frames.get(t)}getAllFrames(){return Array.from(this.frames.values()).sort((t,e)=>t.order-e.order)}setCurrentFrame(t){this.currentFrame=t,t&&yt.emit(ft.FRAME.FRAME_UPDATED,{frameId:t.id,frame:t,isCurrent:!0})}getCurrentFrame(){return this.currentFrame}updateFrameOrder(){const t=Array.from(this.frames.values());t.sort((e,s)=>e.order-s.order),t.forEach((e,s)=>{const n=s+1;e.order=n}),yt.emit(ft.FRAME.FRAMES_REORDERED,{frames:this.getAllFrames()})}updateReferences(){const s=this.canvas.getObjects().filter(n=>n.type===zt.type);this.frames.clear(),s.forEach(n=>{this.frames.set(n.id,n),yt.emit(ft.CANVAS.CANVAS_UPDATE,{type:ft.CANVAS.CANVAS_UPDATE,target:n})}),!this.currentFrame&&s.length>0&&(this.currentFrame=s[0])}moveFrameUp(t){const e=this.frames.get(t);if(e&&e.order>1){const s=this.findFrameByOrder(e.order-1);if(s){const n=e.order;e.order=s.order,s.order=n,this.canvas.requestRenderAll(),this.updateFrameOrder()}}}moveFrameDown(t){const e=this.frames.get(t);if(e&&e.order<this.frames.size){const s=this.findFrameByOrder(e.order+1);if(s){const n=e.order;e.order=s.order,s.order=n,this.canvas.requestRenderAll(),this.updateFrameOrder()}}}findFrameByOrder(t){return Array.from(this.frames.values()).find(e=>e.order===t)}findParentFrame(t){return this.canvas.getObjects().filter(e=>e instanceof zt).find(e=>e.contents.has(t))||null}clear(){this.frames.forEach(t=>{this.canvas.remove(t)}),this.frames.clear(),this.currentFrame=null,yt.emit(ft.FRAME.FRAMES_CLEARED,{framesCount:0})}}class AC{constructor(t,e){F(this,"canvas");F(this,"pageFrameManager");this.canvas=t,this.pageFrameManager=e}setupPageFrameEvents(t){t.off("moving"),t.off("scaling"),t.on("moving",e=>this.handlePageFrameMoving(t,e)),t.on("scaling",e=>this.handlePageFrameScaling(t,e))}handlePageFrameMoving(t,e){if(!e||!e.target)return;const s=e.target;s.left-s.initialLeft,s.top-s.initialTop,s.initialLeft=s.left,s.initialTop=s.top,this.canvas.requestRenderAll()}handlePageFrameScaling(t,e){}}class PC{constructor(t){F(this,"canvas");F(this,"pageFrame");F(this,"frameManager");F(this,"pageFrameEventHandler");this.canvas=t,this.frameManager=new EC(t),this.pageFrameEventHandler=new AC(t,this),this.initializeCanvas()}initializeCanvas(){this.createDefaultPage()}createDefaultPage(){const{width:t,height:e}=this.calculatePageDimensions(),s=this.calculatePagePosition(t,e);return this.pageFrame=new ce({...s,width:t,height:e}),this.pageFrameEventHandler.setupPageFrameEvents(this.pageFrame),this.pageFrame}calculatePageDimensions(){const t=this.canvas.getZoom();return{width:Ko.PAGE_FRAME.WIDTH/t,height:Ko.PAGE_FRAME.HEIGHT/t}}calculatePagePosition(t,e){const s=this.canvas.getVpCenter();return{left:s.x-t/2,top:s.y-e/2}}addNewFrame(){if(!this.pageFrame)return console.error("No active page"),null;const t=this.createFrame();return t?(this.arrangeFrameInCanvas(t),t):null}createFrame(){const{width:t,height:e}=this.calculateFrameDimensions(),s=this.calculateFramePosition(t,e);return this.frameManager.createFrame({...s,width:t,height:e,parentPage:this.pageFrame})}calculateFrameDimensions(){const t=this.canvas.getZoom();return{width:Ko.FRAME.WIDTH/t,height:Ko.FRAME.HEIGHT/t}}calculateFramePosition(t,e){const s=this.canvas.getVpCenter();return{left:s.x-t/2,top:s.y-e/2}}arrangeFrameInCanvas(t){if(!this.pageFrame)return;this.canvas.sendObjectToBack(this.pageFrame),this.canvas.getObjects().filter(s=>s instanceof zt).forEach(s=>{s!==t&&this.canvas.bringObjectToFront(s)}),this.canvas.bringObjectToFront(t),this.canvas.setActiveObject(t)}updateReferences(){const s=this.canvas.getObjects().find(n=>n.type===ce);s&&(this.pageFrame=s),this.frameManager.updateReferences()}getPageFrame(){return this.pageFrame}deleteFrame(t){const e=this.frameManager.getFrame(t);e&&this.pageFrame&&(this.pageFrame.removeFrame(e),this.frameManager.deleteFrame(t))}getCurrentFrame(){return this.frameManager.getCurrentFrame()}getFrameManager(){return this.frameManager}setPageSize(t,e){this.pageFrame&&(this.pageFrame.set({width:t,height:e}),this.canvas.requestRenderAll())}clear(){this.pageFrame&&this.canvas.remove(this.pageFrame),this.frameManager.clear(),this.canvas.requestRenderAll()}destroy(){this.clear()}}const Xa=class Xa extends bs{constructor(e,s){const n={fill:"#333333",cornerSize:Ys.CORNER_SIZE,cornerColor:Me.PRIMARY,cornerStyle:"circle",transparentCorners:!1,lockRotation:!0,hasRotatingPoint:!1,splitByGrapheme:!0,editable:!0,padding:8,textAlign:"left",lockScalingFlip:!0,...s};super(e,n);F(this,"_showBorder",!1);F(this,"_hoverBorderColor",Me.BORDER.HOVER);F(this,"lineWidth",1);F(this,"preventDistortion",!0);F(this,"_originalWidth",0);F(this,"_originalHeight",0);F(this,"_skipDimension",!1);F(this,"_minFontSize",1);F(this,"_originalFontSize",this.fontSize);F(this,"_isMoving",!1);F(this,"handleEditingKeyDown",e=>{this.isEditing&&(e.ctrlKey&&e.code==="KeyC"&&this.handleCopy(e),e.ctrlKey&&e.code==="KeyV"&&this.handlePaste(e),(e.code==="Enter"||e.code==="NumpadEnter"||e.key==="Enter"||e.keyCode===13)&&this.handleEnterKey(e))});this._hoverBorderColor=s.hoverBorderColor||Me.BORDER.HOVER,this.lineWidth=s.lineWidth||1,Object.defineProperty(this,"type",{value:Xa.type,configurable:!1,writable:!1}),this.setControlsVisibility({mtr:!1}),this._originalWidth=this.width,this._originalHeight=this.height,this._originalFontSize=this.fontSize||40,this._minFontSize=this._minFontSize,this.on("scaling",this.handleScaling.bind(this)),this.on("editing:entered",this.handleEditingEntered.bind(this)),this.on("editing:exited",this.handleEditingExited.bind(this)),this.on("moving",this.handleMoving.bind(this)),this.on("mouseup",this.handleMoveEnd.bind(this)),this.on("deselected",this.handleMoveEnd.bind(this))}handleEditingEntered(){document.addEventListener("keydown",this.handleEditingKeyDown)}handleEditingExited(){document.removeEventListener("keydown",this.handleEditingKeyDown)}_render(e){if(this.backgroundColor){e.save(),e.fillStyle=this.backgroundColor;const i=this.width+this.padding*2,o=this.height+this.padding*2;e.fillRect(-i/2,-o/2,i,o),e.restore()}if(super._render(e),this.selected)return;e.save(),this._showBorder?e.strokeStyle=this._hoverBorderColor:e.strokeStyle=Me.BORDER.DEFAULT,e.lineWidth=this.lineWidth,e.setLineDash([]);const s=this.width+this.padding*2,n=this.height+this.padding*2;e.strokeRect(-s/2,-n/2,s,n),e.restore()}_renderText(e){super._renderText(e)}initDimensions(){if(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),!this._skipDimension){if(this._splitText(),this._clearCache(),this.path)this.width=this.path.width,this.height=this.path.height;else{const e=this.width,s=this.calcTextWidth();s>e?this.width=s:this.width=e,this.height=this.height||this.calcTextHeight();const n=this.calcTextHeight();this.isEditing&&n>this.height&&(this.height=n)}this.textAlign&&this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.dirty=!0,this.canvas&&this.canvas.requestRenderAll()}}handlePaste(e){e.preventDefault(),navigator.clipboard.readText().then(s=>{if(!s){console.error("剪贴板中没有文本内容");return}this.insertTextAtCursor(s),this.styles={},this.updateTextDimensions()}).catch(s=>{console.error("读取剪贴板失败:",s)})}handleCopy(e){const s=this.getSelectedText();s&&navigator.clipboard.writeText(s).then(()=>{console.log("文本已成功复制到剪贴板:",s)}).catch(n=>{console.error("复制到剪贴板失败:",n)})}handleEnterKey(e){e.preventDefault(),this.insertTextAtCursor(`
`),this.updateTextDimensions()}insertTextAtCursor(e){const s=this.selectionStart||0,n=this.selectionEnd||0,i=this.text.slice(0,s)+e+this.text.slice(n);this.text=i,this.selectionStart=s+e.length,this.selectionEnd=s+e.length}updateTextDimensions(){var e;this._skipDimension=!1,this.initDimensions(),this.setCoords(),this.dirty=!0,(e=this.canvas)==null||e.requestRenderAll()}showBorder(e){var s;this._showBorder!==e&&(this._showBorder=e,this.dirty=!0,(s=this.canvas)==null||s.requestRenderAll())}increaseFontSize(e=.5){const s=Math.min((this.fontSize||16)+e,720);this.setFontSize(s,!0)}decreaseFontSize(e=.5){const s=Math.max((this.fontSize||16)-e,this._minFontSize);this.setFontSize(s,!0)}setFontSize(e,s=!1){var l;const n=Math.max(Math.min(e,720),this._minFontSize),i=this.width;this.height,this.set("fontSize",n),s&&(this._originalFontSize=n),this._skipDimension=!1;const o=this.calcTextWidth(),a=this.calcTextHeight();(o>i||n>this.fontSize)&&this.set("width",o),this.set("height",a),this.initDimensions(),this.setCoords(),this.dirty=!0,(l=this.canvas)==null||l.requestRenderAll()}setHoverBorderColor(e){this._hoverBorderColor=e,this._showBorder&&this.showBorder(!0)}adjustTextSize(e,s,n){if(!this.canvas)return;const i=this.calcTextWidth(),o=this.calcTextHeight(),a=this.width,l=this.height,c=a/i,h=l/o;if(console.log("容器宽度比例:",c,"容器高度比例:",h),c<1||h<1){const u=Math.min(c,h),f=Math.max(Number((this.fontSize*u).toFixed(3)),this._minFontSize);console.log("文本超出容器，缩小字体到:",f),this.set("fontSize",f)}else if(e&&s&&n){const u=e.width?e.width/s:1,f=e.height?e.height/n:1,d=Math.max(u,f);if(console.log("缩放因子:",d,"当前字号:",this.fontSize),d>1){const p=Math.min(Number((this.fontSize*d).toFixed(3)),this._originalFontSize);console.log("放大字体到:",p),this.set("fontSize",p)}else if(d<1&&(c<1||h<1)){const p=Math.max(Number((this.fontSize*d).toFixed(3)),this._minFontSize);console.log("缩小字体到:",p),this.set("fontSize",p)}}}handleScaling(){if(!this.preventDistortion||!this.canvas)return;let e=!1;const s={},n=this.width,i=this.height;if(this.scaleX!==1&&(s.scaleX=1,s.width=this.width*this.scaleX,e=!0),this.scaleY!==1){s.scaleY=1;const o=this.calcTextHeight()*(this._minFontSize/this.fontSize);s.height=Math.max(this.height*this.scaleY,o),e=!0}e&&(this.set(s),this.setCoords(),this.adjustTextSize(s,n,i))}handleMoving(){this._isMoving=!0,yt.emit(ft.CONTROL_PANEL.HIDE_TEXT_SETTING_TOOLBAR)}handleMoveEnd(){this._isMoving=!1,yt.emit(ft.CONTROL_PANEL.SHOW_TEXT_SETTING_TOOLBAR,{target:this,canvas:this.canvas,canvasManager:_m()})}isObjMoving(){return this._isMoving}};F(Xa,"type","text");let ni=Xa;const Gi=class Gi extends we{static async create(t,e){return new Promise((s,n)=>{const i={originX:"center",originY:"center",padding:0,...e};Gi.fromURL(t,{crossOrigin:"anonymous"},i).then(o=>{s(o)}).catch(o=>{n(o)})})}constructor(t,e){const s={cornerSize:Ys.CORNER_SIZE,cornerColor:Me.PRIMARY,cornerStyle:"circle",transparentCorners:!1,hasRotatingPoint:!1,padding:0,borderColor:Me.PRIMARY,lockRotation:!0,lockScalingX:!1,lockScalingY:!1,lockUniScaling:!1,...e};super(t,s),this.setControlsVisibility({mtr:!1}),Object.defineProperty(this,"type",{value:Gi.type,configurable:!1,writable:!1})}};F(Gi,"type","image");let ri=Gi;const Va=class Va extends ne{static create(t,e){let s;const n={cornerSize:8,cornerColor:"#1890ff",cornerStyle:"circle",transparentCorners:!1,lockRotation:!0,hasRotatingPoint:!1,padding:0,borderColor:"#1890ff",...e};switch(t){case"square":case"rect":s=new ls(n),s.type="rect";break;case"circle":s=new js(n),s.type="circle";break;case"triangle":s=new On(n),s.type="triangle";break;case"line":s=new Tn([0,0,n.width,0],{...n,stroke:n.stroke||"#333",strokeWidth:n.strokeWidth||2}),s.type="line";break;case"arrow":const i=n.width||100,o=20,a=[{x:0,y:0},{x:i-o,y:0},{x:i-o,y:-10},{x:i,y:0},{x:i-o,y:10},{x:i-o,y:0}];s=new as(a,{...n,fill:"transparent",stroke:n.stroke||"#333",strokeWidth:n.strokeWidth||2,strokeLineJoin:"round",strokeLineCap:"round"}),s.type="arrow";break}return s&&(Object.defineProperty(s,"type",{value:Va.type,configurable:!1,writable:!1}),s.setControlsVisibility({mtr:!1})),s}};F(Va,"type","shape");let oo=Va;class FC{constructor(t,e){F(this,"canvas");F(this,"canvasManager");this.canvas=t,this.canvasManager=e,this.initPageFrame()}initPageFrame(){console.warn("initPageFrame",this.canvasManager.getPageFrameManager())}getTargetFrame(){const t=this.canvas.getVpCenter(),e={x:t.x,y:t.y};return this.getFrameContainingPoint(e)}getFrameContainingPoint(t){const e=this.canvasManager.getAllFrames();for(const n of e){const i=n.getBoundingRect();if(t.x>=i.left&&t.x<=i.left+i.width&&t.y>=i.top&&t.y<=i.top+i.height)return n}return this.canvasManager.getPageFrame()}getVisibleCenter(){const t=this.canvas.getVpCenter();return{x:t.x,y:t.y}}async addControl(t,e={}){const s=this.getTargetFrame();if(!s)return console.warn("No active frame and no page frame found"),null;console.log("addControl targetFrame:",s);try{const n=await t(e);return console.log("addControl control:",n),n.set("_originalLeft",n.left-s.left),n.set("_originalTop",n.top-s.top),n.set("_originalAngle",n.angle||0),s instanceof zt&&s.addContent(n),this.canvas.add(Ld(n)),this.canvas.setActiveObject(n),n}catch(n){return console.error("Failed to add control:",n),null}}addText(t={}){const e=this.getVisibleCenter(),s=40,n=this.canvas.getZoom(),i=o=>new ni("双击编辑文本",{left:o.left!==void 0?o.left:e.x,top:o.top!==void 0?o.top:e.y,borderWidth:1/n,lineWidth:Ys.BORDER_LINE_WIDTH_TEXT/n,fontSize:Math.round(s/n),...o});return this.addControl(i,t)}addImage(t,e={}){const s=this.getVisibleCenter(),n=this.canvas.getZoom(),i=async o=>await ri.create(t,{left:o.left!==void 0?o.left:s.x,top:o.top!==void 0?o.top:s.y,scaleX:.5/n,scaleY:.5/n,...o});return this.addControl(i,e)}addShape(t,e={}){const s=this.getVisibleCenter();this.canvas.getZoom();const n=i=>{const o={left:i.left!==void 0?i.left:s.x,top:i.top!==void 0?i.top:s.y,...i};console.warn("addShape active frame",oo);const a=oo.create(t,o);if(!a)throw new Error(`Failed to create shape of type: ${t}`);return a};return this.addControl(n,e)}async addClonedObject(t,e={}){const s=this.getVisibleCenter(),n=t.type;if(t instanceof ri){const o=t.getElement().src;return this.addImage(o,{left:e.left!==void 0?e.left:s.x,top:e.top!==void 0?e.top:s.y,scaleX:t.scaleX,scaleY:t.scaleY,angle:t.angle,flipX:t.flipX,flipY:t.flipY,opacity:t.opacity,...e})}else if(n==="text"||t instanceof ni){const i=t;return this.addText({left:e.left!==void 0?e.left:s.x,top:e.top!==void 0?e.top:s.y,text:i.text,fontSize:i.fontSize,fontFamily:i.fontFamily,fontWeight:i.fontWeight,fontStyle:i.fontStyle,textAlign:i.textAlign,fill:i.fill,...e})}else{if(["rect","circle","triangle"].includes(n))return this.addShape(n,{left:e.left!==void 0?e.left:s.x,top:e.top!==void 0?e.top:s.y,width:t.width,height:t.height,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,rx:t.rx,ry:t.ry,...e});{console.warn(`未知对象类型: ${n}，使用通用克隆方法`);const i=async o=>{try{const a=await t.clone();return a.set({left:o.left!==void 0?o.left:s.x,top:o.top!==void 0?o.top:s.y,...o}),a}catch(a){throw console.error("克隆对象失败:",a),a}};return this.addControl(i,e)}}}}class Ur extends io{constructor(e,s){super(e,{...s,...{enableRetinaScaling:!0,renderOnAddRemove:!0,webgl:!0,webglPrecision:"highp"}});F(this,"pageFrameIndex",-1);this.isDraggingObject=!1,this.contextContainer instanceof WebGLRenderingContext?console.log("WebGL 已成功启用"):console.log("使用 Canvas 2D 渲染")}add(...e){let s=0;for(const n of e)n instanceof ce&&(super.insertAt(0,n),this.pageFrameIndex=0,s++),n instanceof zt&&(this.pageFrameIndex>=0?(super.insertAt(this.pageFrameIndex+1,n),s++):(super.add(n),s++)),n instanceof Qt||(this.pageFrameIndex>=0?(super.insertAt(this.pageFrameIndex,n),s++):(super.add(n),s++));return console.log("[CustomCanvas] add 元素",this._objects),this.updatePageFrameIndex(),s}updatePageFrameIndex(){const e=this.getObjects();this.pageFrameIndex=e.findIndex(s=>s instanceof ce),console.log("[CustomCanvas] updatePageFrameIndex",this.pageFrameIndex)}remove(...e){return super.remove(...e)}bringObjectToFront(e){return e instanceof Qt?!1:(this.pageFrameIndex>0&&super.moveObjectTo(e,this.pageFrameIndex-1),console.log("[CustomCanvas] bringObjectToFront 元素",this._objects),!0)}sendObjectToBack(e){return e instanceof Qt?!1:(super.sendObjectToBack(e),console.log("[CustomCanvas] sendObjectToBack 元素",this._objects),!0)}bringObjectForward(e,s){if(e instanceof Qt)return console.warn("Slides元素不支持移动！"),!1;const n=this._objects.indexOf(e);return this.item(n+1)instanceof Qt?(console.warn("上一层已经是Slides元素不能再移动！"),!1):(console.log("[CustomCanvas] bringObjectForward 元素",this._objects),super.bringObjectForward(e,!1))}sendObjectBackwards(e,s){return e instanceof Qt?(console.warn("Slides元素不支持移动！"),!1):(console.log("[CustomCanvas] sendObjectBackwards 元素",this._objects),super.sendObjectBackwards(e,s))}}F(Ur,"type","CustomCanvas");class DC{static getPageFrameMenuItems(t){return[{label:"插入一页",action:t.insertFrame},{label:"更换背景",action:t.changeBackground},{label:"更换配色",action:t.changeColorScheme},{label:"插入文本",action:t.insertText},{label:"插入图片",action:t.insertImage}]}static getCanvasMenuItems(t){return[{label:"插入一页",action:t.insertFrame},{label:"粘贴",action:t.paste},{label:"更换背景",action:t.changeBackground},{label:"更换配色",action:t.changeColorScheme},{label:"插入文本",action:t.insertText},{label:"插入图片",action:t.insertImage},{separator:!0,label:"",action:()=>{}},{label:"开始演示",action:t.startPresentation}]}static getFrameMenuItems(t){return[{label:"向上一层",action:()=>t.moveLayer("up")},{label:"向下一层",action:()=>t.moveLayer("down")},{label:"置于顶层",action:()=>t.moveLayer("top")},{label:"置于底层",action:()=>t.moveLayer("bottom")},{separator:!0,label:"",action:()=>{}},{label:"插入文本",action:t.insertText},{label:"插入图片",action:t.insertImage},{label:"插入形状",action:t.insertShape},{separator:!0,label:"",action:()=>{}},{label:"复制",action:t.copyObject},{label:"剪切",action:t.cutObject},{label:"删除",action:t.deleteObject}]}static getContentMenuItems(t){return[{label:"向上一层",action:()=>t.moveLayer("up")},{label:"向下一层",action:()=>t.moveLayer("down")},{label:"置于顶层",action:()=>t.moveLayer("top")},{label:"置于底层",action:()=>t.moveLayer("bottom")},{separator:!0,label:"",action:()=>{}},{label:"复制",action:t.copyObject},{label:"剪切",action:t.cutObject},{label:"删除",action:t.deleteObject}]}static getAllMenuItems(t){const e=new Map;return e.set(ce.type,this.getPageFrameMenuItems(t)),e.set(Ur.type,this.getCanvasMenuItems(t)),e.set(zt.type,this.getFrameMenuItems(t)),e.set(ni.type,this.getContentMenuItems(t)),e.set(ri.type,this.getContentMenuItems(t)),e.set(oo.type,this.getContentMenuItems(t)),e}}class RC{constructor(t){F(this,"context");this.context=t}handleInsertFrame(t){t.position}handleDeleteFrame(t){if(!t.target)return;const e=t.target;this.context.canvasManager.getFrameManager().deleteFrame(e.id)}}class LC{constructor(t){F(this,"context");this.context=t}handleChangeBackground(t){yt.emit(ft.CONTROL_PANEL.OPEN,{type:ft.PANEL_TYPE.BACKGROUND_IMAGE,canvas:this.context.canvas,target:t.target,position:t.position})}handleChangeColorScheme(t){console.log("更换配色方案",t),yt.emit(ft.CONTROL_PANEL.OPEN,{type:ft.PANEL_TYPE.BACKGROUND_COLOR,canvas:this.context.canvas,target:t.target,position:t.position})}}class jC{constructor(t){F(this,"context");this.context=t}handleInsertText(t){var e,s;t.position&&((s=(e=this.context.canvasManager)==null?void 0:e.getControlsManager())==null||s.addText({left:t.position.x,top:t.position.y}))}handleInsertImage(t){yt.emit(ft.CONTROL_PANEL.OPEN,{type:ft.PANEL_TYPE.INSERT_IMAGE,canvas:this.context.canvas,canvasManager:this.context.canvasManager,target:t.target,position:t.position})}handleCopyObject(t){if(!t.target)return;const e=new KeyboardEvent("keydown",{key:"c",code:"KeyC",ctrlKey:!0,bubbles:!0});document.dispatchEvent(e)}handleCutObject(t){t.target}handlePaste(t){if(!t.position)return;console.log("鼠标右键 粘贴事件触发");const e=new KeyboardEvent("keydown",{key:"v",code:"KeyV",ctrlKey:!0,bubbles:!0});document.dispatchEvent(e)}handleDeleteObject(t){t.target&&this.context.canvasManager.removeObject(t.target)}handleInsertShape(t){}}class IC{constructor(t){F(this,"context");this.context=t}handleMoveLayer(t,e){t.target&&this.moveActiveObject(e,t.target)}moveActiveObject(t,e){const s=e;if(s)switch(t){case"up":this.context.canvas.bringObjectForward(s,!1);break;case"down":this.context.canvas.sendObjectBackwards(s,!1);break;case"top":this.context.canvas.bringObjectToFront(s);break;case"bottom":this.context.canvas.sendObjectToBack(s);break}}}class BC{constructor(t){F(this,"context");this.context=t}handleStartPresentation(t){}}class NC{constructor(t){F(this,"frame");F(this,"background");F(this,"content");F(this,"layer");F(this,"presentation");this.frame=new RC(t),this.background=new LC(t),this.content=new jC(t),this.layer=new IC(t),this.presentation=new BC(t)}}class HC{constructor(t,e){F(this,"canvas");F(this,"menuElement");F(this,"menuItems");F(this,"handlerManager");F(this,"canvasManager");F(this,"lastEvent",null);F(this,"handleMouseDown",t=>{if(t.button===2){this.lastEvent=t,t.preventDefault();let e=this.canvas.findTarget(t);e||(e=this.canvas),e?(e instanceof Ur||this.canvas.setActiveObject(e),this.showContextMenu(t,e)):this.showCanvasContextMenu(t)}});this.canvas=t,this.canvasManager=e,this.menuElement=this.createMenuElement(),this.menuItems=this.initializeMenuItems(),this.handlerManager=new NC({canvas:t,canvasManager:e,contextMenuManager:this}),this.initializeEventListeners()}createMenuElement(){const t=document.createElement("div");return t.style.position="fixed",t.style.display="none",t.style.backgroundColor="#ffffff",t.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)",t.style.borderRadius="4px",t.style.padding="4px 0",t.style.zIndex="1000",document.body.appendChild(t),t}initializeMenuItems(){const t={insertFrame:()=>this.insertFrame(),changeBackground:()=>this.changeBackground(),changeColorScheme:()=>this.changeColorScheme(),insertText:()=>this.insertText(),insertImage:()=>this.insertImage(),paste:()=>this.paste(),copyObject:()=>this.copyObject(),cutObject:()=>this.cutObject(),deleteObject:()=>this.deleteObject(),moveLayer:e=>this.moveActiveObject(e),startPresentation:()=>this.startPresentation(),insertShape:()=>this.insertShape()};return DC.getAllMenuItems(t)}createMenuItem(t){if(t.separator){const s=document.createElement("div");return s.style.height="1px",s.style.backgroundColor="#e8e8e8",s.style.margin="4px 0",s}const e=document.createElement("div");if(e.textContent=t.label,e.style.padding="8px 16px",e.style.cursor=t.disabled?"not-allowed":"pointer",e.style.fontSize="14px",e.style.userSelect="none",e.style.color=t.disabled?"#bfbfbf":"#000000",e.style.display="flex",e.style.alignItems="center",t.icon){const s=document.createElement("span");s.innerHTML=t.icon,s.style.marginRight="8px",e.prepend(s)}return t.disabled||(e.addEventListener("mouseover",()=>{e.style.backgroundColor="#f5f5f5"}),e.addEventListener("mouseout",()=>{e.style.backgroundColor="transparent"}),e.addEventListener("click",t.action)),e}initializeEventListeners(){const t=this.canvas.upperCanvasEl;t.addEventListener("contextmenu",e=>(e.preventDefault(),!1),!1),t.addEventListener("mousedown",this.handleMouseDown),document.addEventListener("click",()=>{this.hideContextMenu()}),document.addEventListener("keydown",e=>{e.key==="Escape"&&this.hideContextMenu()})}showCanvasContextMenu(t){const e=this.menuItems.get("canvas")||[];this.renderContextMenu(t,e)}showContextMenu(t,e){let s;e instanceof ce?s=ce.type:e instanceof zt?s=zt.type:e instanceof Ur?s=Ur.type:s=ni.type;const n=this.menuItems.get(s)||[];this.renderContextMenu(t,n)}renderContextMenu(t,e){this.menuElement.innerHTML="",e.forEach(l=>{this.menuElement.appendChild(this.createMenuItem(l))});const s=t.clientX,n=t.clientY;this.menuElement.style.left=`${s}px`,this.menuElement.style.top=`${n}px`,this.menuElement.style.display="block";const i=this.menuElement.getBoundingClientRect(),o=window.innerWidth,a=window.innerHeight;i.right>o&&(this.menuElement.style.left=`${s-i.width}px`),i.bottom>a&&(this.menuElement.style.top=`${n-i.height}px`)}hideContextMenu(){this.menuElement.style.display="none"}getCurrentPosition(){if(this.lastEvent)return this.canvas.getPointer(this.lastEvent)}moveActiveObject(t){const e=this.canvas.getActiveObject();if(!e)return;const s=this.getCurrentPosition(),n={canvas:this.canvas,target:e,position:s};this.handlerManager.layer.handleMoveLayer(n,t),this.hideContextMenu()}insertFrame(){const t=this.getCurrentPosition();if(!t)return;const e={canvas:this.canvas,position:t,target:this.canvas.getActiveObject()};this.handlerManager.frame.handleInsertFrame(e),this.hideContextMenu()}changeBackground(){const t={canvas:this.canvas,target:this.canvas.getActiveObject(),position:this.getCurrentPosition()};this.handlerManager.background.handleChangeBackground(t),this.hideContextMenu()}changeColorScheme(){const t={canvas:this.canvas,target:this.canvas.getActiveObject(),position:this.getCurrentPosition()};this.handlerManager.background.handleChangeColorScheme(t),this.hideContextMenu()}insertText(){const t=this.getCurrentPosition();if(!t)return;const e={canvas:this.canvas,target:this.canvas.getActiveObject(),position:t};this.handlerManager.content.handleInsertText(e),this.hideContextMenu()}insertImage(){const t={canvas:this.canvas,target:this.canvas.getActiveObject(),position:this.getCurrentPosition()};this.handlerManager.content.handleInsertImage(t),this.hideContextMenu()}insertShape(){const t={canvas:this.canvas,target:this.canvas.getActiveObject(),position:this.getCurrentPosition()};this.handlerManager.content.handleInsertShape(t),this.hideContextMenu()}paste(){const t=this.getCurrentPosition();if(!t)return;const e={canvas:this.canvas,target:this.canvas.getActiveObject(),position:t};this.handlerManager.content.handlePaste(e),this.hideContextMenu()}copyObject(){const t=this.canvas.getActiveObject();if(!t)return;const e={canvas:this.canvas,target:t,position:this.getCurrentPosition()};this.handlerManager.content.handleCopyObject(e),this.hideContextMenu()}cutObject(){const t=this.canvas.getActiveObject();if(!t)return;const e={canvas:this.canvas,target:t,position:this.getCurrentPosition()};this.handlerManager.content.handleCutObject(e),this.hideContextMenu()}deleteObject(){const t=this.canvas.getActiveObject();if(!t)return;const e={canvas:this.canvas,target:t,position:this.getCurrentPosition()};t instanceof zt?this.handlerManager.frame.handleDeleteFrame(e):this.handlerManager.content.handleDeleteObject(e),this.hideContextMenu()}startPresentation(){const t={canvas:this.canvas,target:this.canvas.getActiveObject(),position:this.getCurrentPosition()};this.handlerManager.presentation.handleStartPresentation(t),this.hideContextMenu()}destroy(){const t=this.canvas.upperCanvasEl;t.removeEventListener("contextmenu",e=>e.preventDefault()),t.removeEventListener("mousedown",this.handleMouseDown),document.removeEventListener("click",this.hideContextMenu),this.menuElement&&this.menuElement.parentNode&&this.menuElement.parentNode.removeChild(this.menuElement)}}const mi={margin:4,width:1,color:"rgb(255,0,0,0.9)"};function bm(r,t){return Math.abs(r-t)}function YC(r,t,e){const s=r.translateToCenterPoint(t,"center","center"),n=r.translateToOriginPoint(s,r.originX,r.originY);e=="x"?r.setX(n.x):r.setY(n.y)}const zC=["left","center","right"],XC=["top","center","bottom"];function VC(r){var y;const t=mi.margin,{activeObject:e,isScale:s,index:n,point:i,list:o}=r,{dis:a,arr:l}=xm(i,o,"x"),c=t/(((y=e.canvas)==null?void 0:y.getZoom())??1);if(a>c)return[];let h=l[l.length-1].x-i.x;const u=n==0||n==3?-1:1;h*=u;const{width:f,scaleX:d,left:p}=e,g=e._getTransformedDimensions(),m=(h+g.x)/g.x;s?e.set("scaleX",d*m):e.set("width",f*m);const v=[0,h/2*u,h*u];u<0&&v.reverse();const _=v[zC.indexOf(e.originX)];return e.set("left",p+_),e.setCoords(),l.map(b=>({x:b.x,y1:b.y,y2:i.y}))}function WC(r){var y;const t=mi.margin,{activeObject:e,isScale:s,index:n,point:i,list:o}=r,{dis:a,arr:l}=xm(i,o,"y"),c=t/(((y=e.canvas)==null?void 0:y.getZoom())??1);if(a>c)return[];let h=l[l.length-1].y-i.y;const u=n<2?-1:1;h*=u;const{height:f,scaleY:d,top:p}=e,g=e._getTransformedDimensions(),m=(h+g.y)/g.y;s?e.set("scaleY",d*m):e.set("height",f*m);const v=[0,h/2*u,h*u];u<0&&v.reverse();const _=v[XC.indexOf(e.originY)];return e.set("top",p+_),e.setCoords(),l.map(b=>({y:b.y,x1:b.x,x2:i.x}))}function xm(r,t,e){let s=1/0,n=[];for(const i of t){const o=bm(r[e],i[e]);s>o&&(n=[],s=o),s==o&&n.push(i)}return{dis:s,arr:n}}function Cm(r,t,e){const{width:s,color:n}=mi,i=r.getSelectionContext(),o=r.viewportTransform,a=r.getZoom();i.save(),i.transform(...o),i.lineWidth=s/a,i.strokeStyle=n,i.beginPath(),i.moveTo(t.x,t.y),i.lineTo(e.x,e.y),i.stroke(),Yc(i,a,t),Yc(i,a,e),i.restore()}const UC=2.4;function Yc(r,t,e){const s=UC/t;r.save(),r.translate(e.x,e.y),r.beginPath(),r.moveTo(-s,-s),r.lineTo(s,s),r.moveTo(s,-s),r.lineTo(-s,s),r.stroke(),r.restore()}function GC(r,t){const{width:e,color:s}=mi,n=r.getSelectionContext(),i=r.viewportTransform,o=r.getZoom();n.save(),n.transform(...i),n.lineWidth=e/o,n.strokeStyle=s;for(const a of t)Yc(n,o,a);n.restore()}function $C(r,t){const e=t.map(s=>{const n="y2"in s,i=n?s.x:s.x1,o=n?s.y1:s.y;return new M(i,o)});GC(r,e)}function qC(r,t){const e=t.x,s=new M(e,t.y1),n=new M(e,t.y2);Cm(r,s,n)}function KC(r,t){const e=t.y,s=new M(t.x1,e),n=new M(t.x2,e);Cm(r,s,n)}function Xf(r){const t=new Set,e=r.canvas;if(!e)return t;const s=r instanceof kn?r.getObjects():[r];return e.forEachObject(n=>{if(n.isOnScreen()&&n.visible){if(n.constructor==gs){Sm(t,n);return}t.add(n)}}),wm(t,s),t}function wm(r,t){for(const e of t)e.constructor==gs?wm(r,e.getObjects()):r.delete(e)}function Sm(r,t){const e=t.getObjects();for(const s of e)if(s.visible){if(s.constructor==gs){Sm(r,s);continue}r.add(s)}}function JC(r){var u;const t=mi.margin,{activeObject:e,activeObjectRect:s,objectRect:n}=r,i=Vf(n),o=Vf(s),a=t/(((u=e.canvas)==null?void 0:u.getZoom())??1),l={target:e,list:i,aList:o,margin:a},c=ZC(l),h=QC(l);return{vLines:c,hLines:h}}function ZC(r){const{target:t,list:e,aList:s,margin:n}=r,i=s.map(u=>Tm(u,e,"x")),o=Math.min(...i.map(u=>u.dis));if(o>n)return[];const a=[],l=s[0].x2-s[0].x,c=s[0].y2-s[0].y;let h=!1;for(let u=0;u<i.length;u++){const f=i[u];if(o==f.dis){const d=e[f.index],p=s[f.index],g=d.x,m=p.y,v=Math.min(d.y,d.y2,m,p.y2),_=Math.max(d.y,d.y2,m,p.y2);if(a.push({x:g,y1:v,y2:_}),h)continue;h=!0,Om({target:t,x:g,y:m,centerX:u-1,centerY:f.index-1,width:l,height:c,dir:"x"});const y=o*f.dir;s.forEach(b=>b.x-=y)}}return a}function QC(r){const{target:t,list:e,aList:s,margin:n}=r,i=s.map(u=>Tm(u,e,"y")),o=Math.min(...i.map(u=>u.dis));if(o>n)return[];const a=[],l=s[0].x2-s[0].x,c=s[0].y2-s[0].y;let h=!1;for(let u=0;u<i.length;u++){const f=i[u];if(o==f.dis){const d=e[f.index],p=s[f.index],g=d.y,m=p.x,v=Math.min(d.x,d.x2,m,p.x2),_=Math.max(d.x,d.x2,m,p.x2);if(a.push({y:g,x1:v,x2:_}),h)continue;h=!0,Om({target:t,x:m,y:g,centerX:f.index-1,centerY:u-1,width:l,height:c,dir:"y"});const y=o*f.dir;s.forEach(b=>b.y-=y)}}return a}function Tm(r,t,e){let s=1/0,n=-1,i=1;for(let o=0;o<t.length;o++){const a=bm(r[e],t[o][e]);s>a&&(n=o,s=a,i=r[e]>t[o][e]?1:-1)}return{dis:s,index:n,dir:i}}function Vf(r){const{left:t,top:e,width:s,height:n}=r,i={x:t,y:e,x2:t+s,y2:e+n},o=t+s/2,a=e+n/2,l={x:o,y:a,x2:o,y2:a},c={x:t+s,x2:t,y:e+n,y2:e};return[i,l,c]}function Om(r){const{target:t,centerX:e,centerY:s,width:n,height:i,dir:o}=r;let{x:a,y:l}=r;a-=e*n/2,l-=s*i/2,YC(t,new M(a,l),o),t.setCoords()}function t1(r,t={}){Object.assign(mi,t);const e=new Set,s=new Set;let n=!1;const i=new Map,o=f=>{const d=[f.calcTransformMatrix().toString(),f.width,f.height].join(),p=i.get(d);if(p)return p;const g=f.getCoords(),v=[Dn.makeBoundingBoxFromPoints(g),g];return i.set(d,v),v};function a(f){const d=f.target;d.setCoords(),n=!1,s.clear(),e.clear();const p=Xf(d),g=d.getBoundingRect();for(const m of p){const v=o(m)[0],{vLines:_,hLines:y}=JC({activeObject:d,activeObjectRect:g,objectRect:v});_.forEach(b=>{s.add(JSON.stringify(b))}),y.forEach(b=>{e.add(JSON.stringify(b))})}}function l(f){const d=f.target;d.setCoords();const p=String(f.transform.action).startsWith("scale");s.clear(),e.clear();const g=Xf(d);let m=f.transform.corner;d.flipX&&(m=m.replace("l","r").replace("r","l")),d.flipY&&(m=m.replace("t","b").replace("b","t"));let v=["tl","tr","br","bl","mt","mr","mb","ml"].indexOf(m);if(v==-1)return;if(n=v>3,n){if(d.getTotalAngle()%90!=0)return;v-=4}let _=d.getCoords()[v];for(const y of g){const[b,w]=o(y),A=new M(b.left+b.width/2,b.top+b.height/2),O=[...w,A],E={activeObject:d,point:_,list:O,isScale:p,index:v},D=VC(E),Y=WC(E);D.forEach(K=>{s.add(JSON.stringify(K))}),Y.forEach(K=>{e.add(JSON.stringify(K))}),(D.length||Y.length)&&(_=d.getCoords()[v])}}function c(){r.clearContext(r.contextTop)}function h(){if(n){const f=[];for(const d of s)f.push(JSON.parse(d));for(const d of e)f.push(JSON.parse(d));$C(r,f)}else{for(const f of s)qC(r,JSON.parse(f));for(const f of e)KC(r,JSON.parse(f))}}function u(){s.clear(),e.clear(),i.clear(),r.requestRenderAll()}return r.on("object:resizing",l),r.on("object:scaling",l),r.on("object:moving",a),r.on("before:render",c),r.on("after:render",h),r.on("mouse:up",u),()=>{r.off("object:resizing",l),r.off("object:scaling",l),r.off("object:moving",a),r.off("before:render",c),r.off("after:render",h),r.off("mouse:up",u)}}function sn(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function km(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t}/*!
 * GSAP 3.12.7
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var ts={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},ii={duration:.5,overwrite:!1,delay:0},Wh,le,Lt,Us=1e8,me=1/Us,zc=Math.PI*2,e1=zc/4,s1=0,Mm=Math.sqrt,n1=Math.cos,r1=Math.sin,re=function(t){return typeof t=="string"},Ut=function(t){return typeof t=="function"},dn=function(t){return typeof t=="number"},Uh=function(t){return typeof t>"u"},Js=function(t){return typeof t=="object"},je=function(t){return t!==!1},Gh=function(){return typeof window<"u"},Jo=function(t){return Ut(t)||re(t)},Em=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},_e=Array.isArray,Xc=/(?:-?\.?\d|\.)+/gi,Am=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Lr=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Ql=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Pm=/[+-]=-?[.\d]+/,Fm=/[^,'"\[\]\s]+/gi,i1=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,Nt,Rs,Vc,$h,ns={},Ra={},Dm,Rm=function(t){return(Ra=oi(t,ns))&&He},qh=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},ao=function(t,e){return!e&&console.warn(t)},Lm=function(t,e){return t&&(ns[t]=e)&&Ra&&(Ra[t]=e)||ns},lo=function(){return 0},o1={suppressEvents:!0,isStart:!0,kill:!1},oa={suppressEvents:!0,kill:!1},a1={suppressEvents:!0},Kh={},Rn=[],Wc={},jm,Ge={},tc={},Wf=30,aa=[],Jh="",Zh=function(t){var e=t[0],s,n;if(Js(e)||Ut(e)||(t=[t]),!(s=(e._gsap||{}).harness)){for(n=aa.length;n--&&!aa[n].targetTest(e););s=aa[n]}for(n=t.length;n--;)t[n]&&(t[n]._gsap||(t[n]._gsap=new o0(t[n],s)))||t.splice(n,1);return t},hr=function(t){return t._gsap||Zh(us(t))[0]._gsap},Im=function(t,e,s){return(s=t[e])&&Ut(s)?t[e]():Uh(s)&&t.getAttribute&&t.getAttribute(e)||s},Ie=function(t,e){return(t=t.split(",")).forEach(e)||t},Gt=function(t){return Math.round(t*1e5)/1e5||0},Jt=function(t){return Math.round(t*1e7)/1e7||0},Gr=function(t,e){var s=e.charAt(0),n=parseFloat(e.substr(2));return t=parseFloat(t),s==="+"?t+n:s==="-"?t-n:s==="*"?t*n:t/n},l1=function(t,e){for(var s=e.length,n=0;t.indexOf(e[n])<0&&++n<s;);return n<s},La=function(){var t=Rn.length,e=Rn.slice(0),s,n;for(Wc={},Rn.length=0,s=0;s<t;s++)n=e[s],n&&n._lazy&&(n.render(n._lazy[0],n._lazy[1],!0)._lazy=0)},Bm=function(t,e,s,n){Rn.length&&!le&&La(),t.render(e,s,le&&e<0&&(t._initted||t._startAt)),Rn.length&&!le&&La()},Nm=function(t){var e=parseFloat(t);return(e||e===0)&&(t+"").match(Fm).length<2?e:re(t)?t.trim():t},Hm=function(t){return t},rs=function(t,e){for(var s in e)s in t||(t[s]=e[s]);return t},c1=function(t){return function(e,s){for(var n in s)n in e||n==="duration"&&t||n==="ease"||(e[n]=s[n])}},oi=function(t,e){for(var s in e)t[s]=e[s];return t},Uf=function r(t,e){for(var s in e)s!=="__proto__"&&s!=="constructor"&&s!=="prototype"&&(t[s]=Js(e[s])?r(t[s]||(t[s]={}),e[s]):e[s]);return t},ja=function(t,e){var s={},n;for(n in t)n in e||(s[n]=t[n]);return s},Vi=function(t){var e=t.parent||Nt,s=t.keyframes?c1(_e(t.keyframes)):rs;if(je(t.inherit))for(;e;)s(t,e.vars.defaults),e=e.parent||e._dp;return t},h1=function(t,e){for(var s=t.length,n=s===e.length;n&&s--&&t[s]===e[s];);return s<0},Ym=function(t,e,s,n,i){var o=t[n],a;if(i)for(a=e[i];o&&o[i]>a;)o=o._prev;return o?(e._next=o._next,o._next=e):(e._next=t[s],t[s]=e),e._next?e._next._prev=e:t[n]=e,e._prev=o,e.parent=e._dp=t,e},xl=function(t,e,s,n){s===void 0&&(s="_first"),n===void 0&&(n="_last");var i=e._prev,o=e._next;i?i._next=o:t[s]===e&&(t[s]=o),o?o._prev=i:t[n]===e&&(t[n]=i),e._next=e._prev=e.parent=null},Hn=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove&&t.parent.remove(t),t._act=0},ur=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var s=t;s;)s._dirty=1,s=s.parent;return t},u1=function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t},Uc=function(t,e,s,n){return t._startAt&&(le?t._startAt.revert(oa):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(e,!0,n))},f1=function r(t){return!t||t._ts&&r(t.parent)},Gf=function(t){return t._repeat?ai(t._tTime,t=t.duration()+t._rDelay)*t:0},ai=function(t,e){var s=Math.floor(t=Jt(t/e));return t&&s===t?s-1:s},Ia=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},Cl=function(t){return t._end=Jt(t._start+(t._tDur/Math.abs(t._ts||t._rts||me)||0))},wl=function(t,e){var s=t._dp;return s&&s.smoothChildTiming&&t._ts&&(t._start=Jt(s._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),Cl(t),s._dirty||ur(s,t)),t},zm=function(t,e){var s;if((e._time||!e._dur&&e._initted||e._start<t._time&&(e._dur||!e.add))&&(s=Ia(t.rawTime(),e),(!e._dur||Co(0,e.totalDuration(),s)-e._tTime>me)&&e.render(s,!0)),ur(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(s=t;s._dp;)s.rawTime()>=0&&s.totalTime(s._tTime),s=s._dp;t._zTime=-1e-8}},Bs=function(t,e,s,n){return e.parent&&Hn(e),e._start=Jt((dn(s)?s:s||t!==Nt?os(t,s,e):t._time)+e._delay),e._end=Jt(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),Ym(t,e,"_first","_last",t._sort?"_start":0),Gc(e)||(t._recent=e),n||zm(t,e),t._ts<0&&wl(t,t._tTime),t},Xm=function(t,e){return(ns.ScrollTrigger||qh("scrollTrigger",e))&&ns.ScrollTrigger.create(e,t)},Vm=function(t,e,s,n,i){if(tu(t,e,i),!t._initted)return 1;if(!s&&t._pt&&!le&&(t._dur&&t.vars.lazy!==!1||!t._dur&&t.vars.lazy)&&jm!==qe.frame)return Rn.push(t),t._lazy=[i,n],1},d1=function r(t){var e=t.parent;return e&&e._ts&&e._initted&&!e._lock&&(e.rawTime()<0||r(e))},Gc=function(t){var e=t.data;return e==="isFromStart"||e==="isStart"},g1=function(t,e,s,n){var i=t.ratio,o=e<0||!e&&(!t._start&&d1(t)&&!(!t._initted&&Gc(t))||(t._ts<0||t._dp._ts<0)&&!Gc(t))?0:1,a=t._rDelay,l=0,c,h,u;if(a&&t._repeat&&(l=Co(0,t._tDur,e),h=ai(l,a),t._yoyo&&h&1&&(o=1-o),h!==ai(t._tTime,a)&&(i=1-o,t.vars.repeatRefresh&&t._initted&&t.invalidate())),o!==i||le||n||t._zTime===me||!e&&t._zTime){if(!t._initted&&Vm(t,e,n,s,l))return;for(u=t._zTime,t._zTime=e||(s?me:0),s||(s=e&&!u),t.ratio=o,t._from&&(o=1-o),t._time=0,t._tTime=l,c=t._pt;c;)c.r(o,c.d),c=c._next;e<0&&Uc(t,e,s,!0),t._onUpdate&&!s&&Je(t,"onUpdate"),l&&t._repeat&&!s&&t.parent&&Je(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===o&&(o&&Hn(t,1),!s&&!le&&(Je(t,o?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)},p1=function(t,e,s){var n;if(s>e)for(n=t._first;n&&n._start<=s;){if(n.data==="isPause"&&n._start>e)return n;n=n._next}else for(n=t._last;n&&n._start>=s;){if(n.data==="isPause"&&n._start<e)return n;n=n._prev}},li=function(t,e,s,n){var i=t._repeat,o=Jt(e)||0,a=t._tTime/t._tDur;return a&&!n&&(t._time*=o/t._dur),t._dur=o,t._tDur=i?i<0?1e10:Jt(o*(i+1)+t._rDelay*i):o,a>0&&!n&&wl(t,t._tTime=t._tDur*a),t.parent&&Cl(t),s||ur(t.parent,t),t},$f=function(t){return t instanceof Oe?ur(t):li(t,t._dur)},m1={_start:0,endTime:lo,totalDuration:lo},os=function r(t,e,s){var n=t.labels,i=t._recent||m1,o=t.duration()>=Us?i.endTime(!1):t._dur,a,l,c;return re(e)&&(isNaN(e)||e in n)?(l=e.charAt(0),c=e.substr(-1)==="%",a=e.indexOf("="),l==="<"||l===">"?(a>=0&&(e=e.replace(/=/,"")),(l==="<"?i._start:i.endTime(i._repeat>=0))+(parseFloat(e.substr(1))||0)*(c?(a<0?i:s).totalDuration()/100:1)):a<0?(e in n||(n[e]=o),n[e]):(l=parseFloat(e.charAt(a-1)+e.substr(a+1)),c&&s&&(l=l/100*(_e(s)?s[0]:s).totalDuration()),a>1?r(t,e.substr(0,a-1),s)+l:o+l)):e==null?o:+e},Wi=function(t,e,s){var n=dn(e[1]),i=(n?2:1)+(t<2?0:1),o=e[i],a,l;if(n&&(o.duration=e[1]),o.parent=s,t){for(a=o,l=s;l&&!("immediateRender"in a);)a=l.vars.defaults||{},l=je(l.vars.inherit)&&l.parent;o.immediateRender=je(a.immediateRender),t<2?o.runBackwards=1:o.startAt=e[i-1]}return new Kt(e[0],o,e[i+1])},Gn=function(t,e){return t||t===0?e(t):e},Co=function(t,e,s){return s<t?t:s>e?e:s},ge=function(t,e){return!re(t)||!(e=i1.exec(t))?"":e[1]},v1=function(t,e,s){return Gn(s,function(n){return Co(t,e,n)})},$c=[].slice,Wm=function(t,e){return t&&Js(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&Js(t[0]))&&!t.nodeType&&t!==Rs},_1=function(t,e,s){return s===void 0&&(s=[]),t.forEach(function(n){var i;return re(n)&&!e||Wm(n,1)?(i=s).push.apply(i,us(n)):s.push(n)})||s},us=function(t,e,s){return Lt&&!e&&Lt.selector?Lt.selector(t):re(t)&&!s&&(Vc||!ci())?$c.call((e||$h).querySelectorAll(t),0):_e(t)?_1(t,s):Wm(t)?$c.call(t,0):t?[t]:[]},qc=function(t){return t=us(t)[0]||ao("Invalid scope")||{},function(e){var s=t.current||t.nativeElement||t;return us(e,s.querySelectorAll?s:s===t?ao("Invalid scope")||$h.createElement("div"):t)}},Um=function(t){return t.sort(function(){return .5-Math.random()})},Gm=function(t){if(Ut(t))return t;var e=Js(t)?t:{each:t},s=fr(e.ease),n=e.from||0,i=parseFloat(e.base)||0,o={},a=n>0&&n<1,l=isNaN(n)||a,c=e.axis,h=n,u=n;return re(n)?h=u={center:.5,edges:.5,end:1}[n]||0:!a&&l&&(h=n[0],u=n[1]),function(f,d,p){var g=(p||e).length,m=o[g],v,_,y,b,w,A,O,E,D;if(!m){if(D=e.grid==="auto"?0:(e.grid||[1,Us])[1],!D){for(O=-1e8;O<(O=p[D++].getBoundingClientRect().left)&&D<g;);D<g&&D--}for(m=o[g]=[],v=l?Math.min(D,g)*h-.5:n%D,_=D===Us?0:l?g*u/D-.5:n/D|0,O=0,E=Us,A=0;A<g;A++)y=A%D-v,b=_-(A/D|0),m[A]=w=c?Math.abs(c==="y"?b:y):Mm(y*y+b*b),w>O&&(O=w),w<E&&(E=w);n==="random"&&Um(m),m.max=O-E,m.min=E,m.v=g=(parseFloat(e.amount)||parseFloat(e.each)*(D>g?g-1:c?c==="y"?g/D:D:Math.max(D,g/D))||0)*(n==="edges"?-1:1),m.b=g<0?i-g:i,m.u=ge(e.amount||e.each)||0,s=s&&g<0?n0(s):s}return g=(m[f]-m.min)/m.max||0,Jt(m.b+(s?s(g):g)*m.v)+m.u}},Kc=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(s){var n=Jt(Math.round(parseFloat(s)/t)*t*e);return(n-n%1)/e+(dn(s)?0:ge(s))}},$m=function(t,e){var s=_e(t),n,i;return!s&&Js(t)&&(n=s=t.radius||Us,t.values?(t=us(t.values),(i=!dn(t[0]))&&(n*=n)):t=Kc(t.increment)),Gn(e,s?Ut(t)?function(o){return i=t(o),Math.abs(i-o)<=n?i:o}:function(o){for(var a=parseFloat(i?o.x:o),l=parseFloat(i?o.y:0),c=Us,h=0,u=t.length,f,d;u--;)i?(f=t[u].x-a,d=t[u].y-l,f=f*f+d*d):f=Math.abs(t[u]-a),f<c&&(c=f,h=u);return h=!n||c<=n?t[h]:o,i||h===o||dn(o)?h:h+ge(o)}:Kc(t))},qm=function(t,e,s,n){return Gn(_e(t)?!e:s===!0?!!(s=0):!n,function(){return _e(t)?t[~~(Math.random()*t.length)]:(s=s||1e-5)&&(n=s<1?Math.pow(10,(s+"").length-2):1)&&Math.floor(Math.round((t-s/2+Math.random()*(e-t+s*.99))/s)*s*n)/n})},y1=function(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return function(n){return e.reduce(function(i,o){return o(i)},n)}},b1=function(t,e){return function(s){return t(parseFloat(s))+(e||ge(s))}},x1=function(t,e,s){return Jm(t,e,0,1,s)},Km=function(t,e,s){return Gn(s,function(n){return t[~~e(n)]})},C1=function r(t,e,s){var n=e-t;return _e(t)?Km(t,r(0,t.length),e):Gn(s,function(i){return(n+(i-t)%n)%n+t})},w1=function r(t,e,s){var n=e-t,i=n*2;return _e(t)?Km(t,r(0,t.length-1),e):Gn(s,function(o){return o=(i+(o-t)%i)%i||0,t+(o>n?i-o:o)})},co=function(t){for(var e=0,s="",n,i,o,a;~(n=t.indexOf("random(",e));)o=t.indexOf(")",n),a=t.charAt(n+7)==="[",i=t.substr(n+7,o-n-7).match(a?Fm:Xc),s+=t.substr(e,n-e)+qm(a?i:+i[0],a?0:+i[1],+i[2]||1e-5),e=o+1;return s+t.substr(e,t.length-e)},Jm=function(t,e,s,n,i){var o=e-t,a=n-s;return Gn(i,function(l){return s+((l-t)/o*a||0)})},S1=function r(t,e,s,n){var i=isNaN(t+e)?0:function(d){return(1-d)*t+d*e};if(!i){var o=re(t),a={},l,c,h,u,f;if(s===!0&&(n=1)&&(s=null),o)t={p:t},e={p:e};else if(_e(t)&&!_e(e)){for(h=[],u=t.length,f=u-2,c=1;c<u;c++)h.push(r(t[c-1],t[c]));u--,i=function(p){p*=u;var g=Math.min(f,~~p);return h[g](p-g)},s=e}else n||(t=oi(_e(t)?[]:{},t));if(!h){for(l in e)Qh.call(a,t,l,"get",e[l]);i=function(p){return nu(p,a)||(o?t.p:t)}}}return Gn(s,i)},qf=function(t,e,s){var n=t.labels,i=Us,o,a,l;for(o in n)a=n[o]-e,a<0==!!s&&a&&i>(a=Math.abs(a))&&(l=o,i=a);return l},Je=function(t,e,s){var n=t.vars,i=n[e],o=Lt,a=t._ctx,l,c,h;if(i)return l=n[e+"Params"],c=n.callbackScope||t,s&&Rn.length&&La(),a&&(Lt=a),h=l?i.apply(c,l):i.call(c),Lt=o,h},ki=function(t){return Hn(t),t.scrollTrigger&&t.scrollTrigger.kill(!!le),t.progress()<1&&Je(t,"onInterrupt"),t},jr,Zm=[],Qm=function(t){if(t)if(t=!t.name&&t.default||t,Gh()||t.headless){var e=t.name,s=Ut(t),n=e&&!s&&t.init?function(){this._props=[]}:t,i={init:lo,render:nu,add:Qh,kill:H1,modifier:N1,rawVars:0},o={targetTest:0,get:0,getSetter:su,aliases:{},register:0};if(ci(),t!==n){if(Ge[e])return;rs(n,rs(ja(t,i),o)),oi(n.prototype,oi(i,ja(t,o))),Ge[n.prop=e]=n,t.targetTest&&(aa.push(n),Kh[e]=1),e=(e==="css"?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}Lm(e,n),t.register&&t.register(He,n,Be)}else Zm.push(t)},Mt=255,Mi={aqua:[0,Mt,Mt],lime:[0,Mt,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Mt],navy:[0,0,128],white:[Mt,Mt,Mt],olive:[128,128,0],yellow:[Mt,Mt,0],orange:[Mt,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Mt,0,0],pink:[Mt,192,203],cyan:[0,Mt,Mt],transparent:[Mt,Mt,Mt,0]},ec=function(t,e,s){return t+=t<0?1:t>1?-1:0,(t*6<1?e+(s-e)*t*6:t<.5?s:t*3<2?e+(s-e)*(2/3-t)*6:e)*Mt+.5|0},t0=function(t,e,s){var n=t?dn(t)?[t>>16,t>>8&Mt,t&Mt]:0:Mi.black,i,o,a,l,c,h,u,f,d,p;if(!n){if(t.substr(-1)===","&&(t=t.substr(0,t.length-1)),Mi[t])n=Mi[t];else if(t.charAt(0)==="#"){if(t.length<6&&(i=t.charAt(1),o=t.charAt(2),a=t.charAt(3),t="#"+i+i+o+o+a+a+(t.length===5?t.charAt(4)+t.charAt(4):"")),t.length===9)return n=parseInt(t.substr(1,6),16),[n>>16,n>>8&Mt,n&Mt,parseInt(t.substr(7),16)/255];t=parseInt(t.substr(1),16),n=[t>>16,t>>8&Mt,t&Mt]}else if(t.substr(0,3)==="hsl"){if(n=p=t.match(Xc),!e)l=+n[0]%360/360,c=+n[1]/100,h=+n[2]/100,o=h<=.5?h*(c+1):h+c-h*c,i=h*2-o,n.length>3&&(n[3]*=1),n[0]=ec(l+1/3,i,o),n[1]=ec(l,i,o),n[2]=ec(l-1/3,i,o);else if(~t.indexOf("="))return n=t.match(Am),s&&n.length<4&&(n[3]=1),n}else n=t.match(Xc)||Mi.transparent;n=n.map(Number)}return e&&!p&&(i=n[0]/Mt,o=n[1]/Mt,a=n[2]/Mt,u=Math.max(i,o,a),f=Math.min(i,o,a),h=(u+f)/2,u===f?l=c=0:(d=u-f,c=h>.5?d/(2-u-f):d/(u+f),l=u===i?(o-a)/d+(o<a?6:0):u===o?(a-i)/d+2:(i-o)/d+4,l*=60),n[0]=~~(l+.5),n[1]=~~(c*100+.5),n[2]=~~(h*100+.5)),s&&n.length<4&&(n[3]=1),n},e0=function(t){var e=[],s=[],n=-1;return t.split(Ln).forEach(function(i){var o=i.match(Lr)||[];e.push.apply(e,o),s.push(n+=o.length+1)}),e.c=s,e},Kf=function(t,e,s){var n="",i=(t+n).match(Ln),o=e?"hsla(":"rgba(",a=0,l,c,h,u;if(!i)return t;if(i=i.map(function(f){return(f=t0(f,e,1))&&o+(e?f[0]+","+f[1]+"%,"+f[2]+"%,"+f[3]:f.join(","))+")"}),s&&(h=e0(t),l=s.c,l.join(n)!==h.c.join(n)))for(c=t.replace(Ln,"1").split(Lr),u=c.length-1;a<u;a++)n+=c[a]+(~l.indexOf(a)?i.shift()||o+"0,0,0,0)":(h.length?h:i.length?i:s).shift());if(!c)for(c=t.split(Ln),u=c.length-1;a<u;a++)n+=c[a]+i[a];return n+c[u]},Ln=function(){var r="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",t;for(t in Mi)r+="|"+t+"\\b";return new RegExp(r+")","gi")}(),T1=/hsl[a]?\(/,s0=function(t){var e=t.join(" "),s;if(Ln.lastIndex=0,Ln.test(e))return s=T1.test(e),t[1]=Kf(t[1],s),t[0]=Kf(t[0],s,e0(t[1])),!0},ho,qe=function(){var r=Date.now,t=500,e=33,s=r(),n=s,i=1e3/240,o=i,a=[],l,c,h,u,f,d,p=function g(m){var v=r()-n,_=m===!0,y,b,w,A;if((v>t||v<0)&&(s+=v-e),n+=v,w=n-s,y=w-o,(y>0||_)&&(A=++u.frame,f=w-u.time*1e3,u.time=w=w/1e3,o+=y+(y>=i?4:i-y),b=1),_||(l=c(g)),b)for(d=0;d<a.length;d++)a[d](w,f,A,m)};return u={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(m){return f/(1e3/(m||60))},wake:function(){Dm&&(!Vc&&Gh()&&(Rs=Vc=window,$h=Rs.document||{},ns.gsap=He,(Rs.gsapVersions||(Rs.gsapVersions=[])).push(He.version),Rm(Ra||Rs.GreenSockGlobals||!Rs.gsap&&Rs||{}),Zm.forEach(Qm)),h=typeof requestAnimationFrame<"u"&&requestAnimationFrame,l&&u.sleep(),c=h||function(m){return setTimeout(m,o-u.time*1e3+1|0)},ho=1,p(2))},sleep:function(){(h?cancelAnimationFrame:clearTimeout)(l),ho=0,c=lo},lagSmoothing:function(m,v){t=m||1/0,e=Math.min(v||33,t)},fps:function(m){i=1e3/(m||240),o=u.time*1e3+i},add:function(m,v,_){var y=v?function(b,w,A,O){m(b,w,A,O),u.remove(y)}:m;return u.remove(m),a[_?"unshift":"push"](y),ci(),y},remove:function(m,v){~(v=a.indexOf(m))&&a.splice(v,1)&&d>=v&&d--},_listeners:a},u}(),ci=function(){return!ho&&qe.wake()},mt={},O1=/^[\d.\-M][\d.\-,\s]/,k1=/["']/g,M1=function(t){for(var e={},s=t.substr(1,t.length-3).split(":"),n=s[0],i=1,o=s.length,a,l,c;i<o;i++)l=s[i],a=i!==o-1?l.lastIndexOf(","):l.length,c=l.substr(0,a),e[n]=isNaN(c)?c.replace(k1,"").trim():+c,n=l.substr(a+1).trim();return e},E1=function(t){var e=t.indexOf("(")+1,s=t.indexOf(")"),n=t.indexOf("(",e);return t.substring(e,~n&&n<s?t.indexOf(")",s+1):s)},A1=function(t){var e=(t+"").split("("),s=mt[e[0]];return s&&e.length>1&&s.config?s.config.apply(null,~t.indexOf("{")?[M1(e[1])]:E1(t).split(",").map(Nm)):mt._CE&&O1.test(t)?mt._CE("",t):s},n0=function(t){return function(e){return 1-t(1-e)}},r0=function r(t,e){for(var s=t._first,n;s;)s instanceof Oe?r(s,e):s.vars.yoyoEase&&(!s._yoyo||!s._repeat)&&s._yoyo!==e&&(s.timeline?r(s.timeline,e):(n=s._ease,s._ease=s._yEase,s._yEase=n,s._yoyo=e)),s=s._next},fr=function(t,e){return t&&(Ut(t)?t:mt[t]||A1(t))||e},Tr=function(t,e,s,n){s===void 0&&(s=function(l){return 1-e(1-l)}),n===void 0&&(n=function(l){return l<.5?e(l*2)/2:1-e((1-l)*2)/2});var i={easeIn:e,easeOut:s,easeInOut:n},o;return Ie(t,function(a){mt[a]=ns[a]=i,mt[o=a.toLowerCase()]=s;for(var l in i)mt[o+(l==="easeIn"?".in":l==="easeOut"?".out":".inOut")]=mt[a+"."+l]=i[l]}),i},i0=function(t){return function(e){return e<.5?(1-t(1-e*2))/2:.5+t((e-.5)*2)/2}},sc=function r(t,e,s){var n=e>=1?e:1,i=(s||(t?.3:.45))/(e<1?e:1),o=i/zc*(Math.asin(1/n)||0),a=function(h){return h===1?1:n*Math.pow(2,-10*h)*r1((h-o)*i)+1},l=t==="out"?a:t==="in"?function(c){return 1-a(1-c)}:i0(a);return i=zc/i,l.config=function(c,h){return r(t,c,h)},l},nc=function r(t,e){e===void 0&&(e=1.70158);var s=function(o){return o?--o*o*((e+1)*o+e)+1:0},n=t==="out"?s:t==="in"?function(i){return 1-s(1-i)}:i0(s);return n.config=function(i){return r(t,i)},n};Ie("Linear,Quad,Cubic,Quart,Quint,Strong",function(r,t){var e=t<5?t+1:t;Tr(r+",Power"+(e-1),t?function(s){return Math.pow(s,e)}:function(s){return s},function(s){return 1-Math.pow(1-s,e)},function(s){return s<.5?Math.pow(s*2,e)/2:1-Math.pow((1-s)*2,e)/2})});mt.Linear.easeNone=mt.none=mt.Linear.easeIn;Tr("Elastic",sc("in"),sc("out"),sc());(function(r,t){var e=1/t,s=2*e,n=2.5*e,i=function(a){return a<e?r*a*a:a<s?r*Math.pow(a-1.5/t,2)+.75:a<n?r*(a-=2.25/t)*a+.9375:r*Math.pow(a-2.625/t,2)+.984375};Tr("Bounce",function(o){return 1-i(1-o)},i)})(7.5625,2.75);Tr("Expo",function(r){return Math.pow(2,10*(r-1))*r+r*r*r*r*r*r*(1-r)});Tr("Circ",function(r){return-(Mm(1-r*r)-1)});Tr("Sine",function(r){return r===1?1:-n1(r*e1)+1});Tr("Back",nc("in"),nc("out"),nc());mt.SteppedEase=mt.steps=ns.SteppedEase={config:function(t,e){t===void 0&&(t=1);var s=1/t,n=t+(e?0:1),i=e?1:0,o=1-me;return function(a){return((n*Co(0,o,a)|0)+i)*s}}};ii.ease=mt["quad.out"];Ie("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(r){return Jh+=r+","+r+"Params,"});var o0=function(t,e){this.id=s1++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:Im,this.set=e?e.getSetter:su},uo=function(){function r(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,li(this,+e.duration,1,1),this.data=e.data,Lt&&(this._ctx=Lt,Lt.data.push(this)),ho||qe.wake()}var t=r.prototype;return t.delay=function(s){return s||s===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+s-this._delay),this._delay=s,this):this._delay},t.duration=function(s){return arguments.length?this.totalDuration(this._repeat>0?s+(s+this._rDelay)*this._repeat:s):this.totalDuration()&&this._dur},t.totalDuration=function(s){return arguments.length?(this._dirty=0,li(this,this._repeat<0?s:(s-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(s,n){if(ci(),!arguments.length)return this._tTime;var i=this._dp;if(i&&i.smoothChildTiming&&this._ts){for(wl(this,s),!i._dp||i.parent||zm(i,this);i&&i.parent;)i.parent._time!==i._start+(i._ts>=0?i._tTime/i._ts:(i.totalDuration()-i._tTime)/-i._ts)&&i.totalTime(i._tTime,!0),i=i.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&s<this._tDur||this._ts<0&&s>0||!this._tDur&&!s)&&Bs(this._dp,this,this._start-this._delay)}return(this._tTime!==s||!this._dur&&!n||this._initted&&Math.abs(this._zTime)===me||!s&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=s),Bm(this,s,n)),this},t.time=function(s,n){return arguments.length?this.totalTime(Math.min(this.totalDuration(),s+Gf(this))%(this._dur+this._rDelay)||(s?this._dur:0),n):this._time},t.totalProgress=function(s,n){return arguments.length?this.totalTime(this.totalDuration()*s,n):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},t.progress=function(s,n){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-s:s)+Gf(this),n):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},t.iteration=function(s,n){var i=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(s-1)*i,n):this._repeat?ai(this._tTime,i)+1:1},t.timeScale=function(s,n){if(!arguments.length)return this._rts===-1e-8?0:this._rts;if(this._rts===s)return this;var i=this.parent&&this._ts?Ia(this.parent._time,this):this._tTime;return this._rts=+s||0,this._ts=this._ps||s===-1e-8?0:this._rts,this.totalTime(Co(-Math.abs(this._delay),this._tDur,i),n!==!1),Cl(this),u1(this)},t.paused=function(s){return arguments.length?(this._ps!==s&&(this._ps=s,s?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(ci(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==me&&(this._tTime-=me)))),this):this._ps},t.startTime=function(s){if(arguments.length){this._start=s;var n=this.parent||this._dp;return n&&(n._sort||!this.parent)&&Bs(n,this,s-this._delay),this}return this._start},t.endTime=function(s){return this._start+(je(s)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(s){var n=this.parent||this._dp;return n?s&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Ia(n.rawTime(s),this):this._tTime:this._tTime},t.revert=function(s){s===void 0&&(s=a1);var n=le;return le=s,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(s),this.totalTime(-.01,s.suppressEvents)),this.data!=="nested"&&s.kill!==!1&&this.kill(),le=n,this},t.globalTime=function(s){for(var n=this,i=arguments.length?s:n.rawTime();n;)i=n._start+i/(Math.abs(n._ts)||1),n=n._dp;return!this.parent&&this._sat?this._sat.globalTime(s):i},t.repeat=function(s){return arguments.length?(this._repeat=s===1/0?-2:s,$f(this)):this._repeat===-2?1/0:this._repeat},t.repeatDelay=function(s){if(arguments.length){var n=this._time;return this._rDelay=s,$f(this),n?this.time(n):this}return this._rDelay},t.yoyo=function(s){return arguments.length?(this._yoyo=s,this):this._yoyo},t.seek=function(s,n){return this.totalTime(os(this,s),je(n))},t.restart=function(s,n){return this.play().totalTime(s?-this._delay:0,je(n)),this._dur||(this._zTime=-1e-8),this},t.play=function(s,n){return s!=null&&this.seek(s,n),this.reversed(!1).paused(!1)},t.reverse=function(s,n){return s!=null&&this.seek(s||this.totalDuration(),n),this.reversed(!0).paused(!1)},t.pause=function(s,n){return s!=null&&this.seek(s,n),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(s){return arguments.length?(!!s!==this.reversed()&&this.timeScale(-this._rts||(s?-1e-8:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},t.isActive=function(){var s=this.parent||this._dp,n=this._start,i;return!!(!s||this._ts&&this._initted&&s.isActive()&&(i=s.rawTime(!0))>=n&&i<this.endTime(!0)-me)},t.eventCallback=function(s,n,i){var o=this.vars;return arguments.length>1?(n?(o[s]=n,i&&(o[s+"Params"]=i),s==="onUpdate"&&(this._onUpdate=n)):delete o[s],this):o[s]},t.then=function(s){var n=this;return new Promise(function(i){var o=Ut(s)?s:Hm,a=function(){var c=n.then;n.then=null,Ut(o)&&(o=o(n))&&(o.then||o===n)&&(n.then=c),i(o),n.then=c};n._initted&&n.totalProgress()===1&&n._ts>=0||!n._tTime&&n._ts<0?a():n._prom=a})},t.kill=function(){ki(this)},r}();rs(uo.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var Oe=function(r){km(t,r);function t(s,n){var i;return s===void 0&&(s={}),i=r.call(this,s)||this,i.labels={},i.smoothChildTiming=!!s.smoothChildTiming,i.autoRemoveChildren=!!s.autoRemoveChildren,i._sort=je(s.sortChildren),Nt&&Bs(s.parent||Nt,sn(i),n),s.reversed&&i.reverse(),s.paused&&i.paused(!0),s.scrollTrigger&&Xm(sn(i),s.scrollTrigger),i}var e=t.prototype;return e.to=function(n,i,o){return Wi(0,arguments,this),this},e.from=function(n,i,o){return Wi(1,arguments,this),this},e.fromTo=function(n,i,o,a){return Wi(2,arguments,this),this},e.set=function(n,i,o){return i.duration=0,i.parent=this,Vi(i).repeatDelay||(i.repeat=0),i.immediateRender=!!i.immediateRender,new Kt(n,i,os(this,o),1),this},e.call=function(n,i,o){return Bs(this,Kt.delayedCall(0,n,i),o)},e.staggerTo=function(n,i,o,a,l,c,h){return o.duration=i,o.stagger=o.stagger||a,o.onComplete=c,o.onCompleteParams=h,o.parent=this,new Kt(n,o,os(this,l)),this},e.staggerFrom=function(n,i,o,a,l,c,h){return o.runBackwards=1,Vi(o).immediateRender=je(o.immediateRender),this.staggerTo(n,i,o,a,l,c,h)},e.staggerFromTo=function(n,i,o,a,l,c,h,u){return a.startAt=o,Vi(a).immediateRender=je(a.immediateRender),this.staggerTo(n,i,a,l,c,h,u)},e.render=function(n,i,o){var a=this._time,l=this._dirty?this.totalDuration():this._tDur,c=this._dur,h=n<=0?0:Jt(n),u=this._zTime<0!=n<0&&(this._initted||!c),f,d,p,g,m,v,_,y,b,w,A,O;if(this!==Nt&&h>l&&n>=0&&(h=l),h!==this._tTime||o||u){if(a!==this._time&&c&&(h+=this._time-a,n+=this._time-a),f=h,b=this._start,y=this._ts,v=!y,u&&(c||(a=this._zTime),(n||!i)&&(this._zTime=n)),this._repeat){if(A=this._yoyo,m=c+this._rDelay,this._repeat<-1&&n<0)return this.totalTime(m*100+n,i,o);if(f=Jt(h%m),h===l?(g=this._repeat,f=c):(w=Jt(h/m),g=~~w,g&&g===w&&(f=c,g--),f>c&&(f=c)),w=ai(this._tTime,m),!a&&this._tTime&&w!==g&&this._tTime-w*m-this._dur<=0&&(w=g),A&&g&1&&(f=c-f,O=1),g!==w&&!this._lock){var E=A&&w&1,D=E===(A&&g&1);if(g<w&&(E=!E),a=E?0:h%c?c:h,this._lock=1,this.render(a||(O?0:Jt(g*m)),i,!c)._lock=0,this._tTime=h,!i&&this.parent&&Je(this,"onRepeat"),this.vars.repeatRefresh&&!O&&(this.invalidate()._lock=1),a&&a!==this._time||v!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(c=this._dur,l=this._tDur,D&&(this._lock=2,a=E?c:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!O&&this.invalidate()),this._lock=0,!this._ts&&!v)return this;r0(this,O)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(_=p1(this,Jt(a),Jt(f)),_&&(h-=f-(f=_._start))),this._tTime=h,this._time=f,this._act=!y,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=n,a=0),!a&&f&&!i&&!g&&(Je(this,"onStart"),this._tTime!==h))return this;if(f>=a&&n>=0)for(d=this._first;d;){if(p=d._next,(d._act||f>=d._start)&&d._ts&&_!==d){if(d.parent!==this)return this.render(n,i,o);if(d.render(d._ts>0?(f-d._start)*d._ts:(d._dirty?d.totalDuration():d._tDur)+(f-d._start)*d._ts,i,o),f!==this._time||!this._ts&&!v){_=0,p&&(h+=this._zTime=-1e-8);break}}d=p}else{d=this._last;for(var Y=n<0?n:f;d;){if(p=d._prev,(d._act||Y<=d._end)&&d._ts&&_!==d){if(d.parent!==this)return this.render(n,i,o);if(d.render(d._ts>0?(Y-d._start)*d._ts:(d._dirty?d.totalDuration():d._tDur)+(Y-d._start)*d._ts,i,o||le&&(d._initted||d._startAt)),f!==this._time||!this._ts&&!v){_=0,p&&(h+=this._zTime=Y?-1e-8:me);break}}d=p}}if(_&&!i&&(this.pause(),_.render(f>=a?0:-1e-8)._zTime=f>=a?1:-1,this._ts))return this._start=b,Cl(this),this.render(n,i,o);this._onUpdate&&!i&&Je(this,"onUpdate",!0),(h===l&&this._tTime>=this.totalDuration()||!h&&a)&&(b===this._start||Math.abs(y)!==Math.abs(this._ts))&&(this._lock||((n||!c)&&(h===l&&this._ts>0||!h&&this._ts<0)&&Hn(this,1),!i&&!(n<0&&!a)&&(h||a||!l)&&(Je(this,h===l&&n>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(h<l&&this.timeScale()>0)&&this._prom())))}return this},e.add=function(n,i){var o=this;if(dn(i)||(i=os(this,i,n)),!(n instanceof uo)){if(_e(n))return n.forEach(function(a){return o.add(a,i)}),this;if(re(n))return this.addLabel(n,i);if(Ut(n))n=Kt.delayedCall(0,n);else return this}return this!==n?Bs(this,n,i):this},e.getChildren=function(n,i,o,a){n===void 0&&(n=!0),i===void 0&&(i=!0),o===void 0&&(o=!0),a===void 0&&(a=-1e8);for(var l=[],c=this._first;c;)c._start>=a&&(c instanceof Kt?i&&l.push(c):(o&&l.push(c),n&&l.push.apply(l,c.getChildren(!0,i,o)))),c=c._next;return l},e.getById=function(n){for(var i=this.getChildren(1,1,1),o=i.length;o--;)if(i[o].vars.id===n)return i[o]},e.remove=function(n){return re(n)?this.removeLabel(n):Ut(n)?this.killTweensOf(n):(n.parent===this&&xl(this,n),n===this._recent&&(this._recent=this._last),ur(this))},e.totalTime=function(n,i){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Jt(qe.time-(this._ts>0?n/this._ts:(this.totalDuration()-n)/-this._ts))),r.prototype.totalTime.call(this,n,i),this._forcing=0,this):this._tTime},e.addLabel=function(n,i){return this.labels[n]=os(this,i),this},e.removeLabel=function(n){return delete this.labels[n],this},e.addPause=function(n,i,o){var a=Kt.delayedCall(0,i||lo,o);return a.data="isPause",this._hasPause=1,Bs(this,a,os(this,n))},e.removePause=function(n){var i=this._first;for(n=os(this,n);i;)i._start===n&&i.data==="isPause"&&Hn(i),i=i._next},e.killTweensOf=function(n,i,o){for(var a=this.getTweensOf(n,o),l=a.length;l--;)En!==a[l]&&a[l].kill(n,i);return this},e.getTweensOf=function(n,i){for(var o=[],a=us(n),l=this._first,c=dn(i),h;l;)l instanceof Kt?l1(l._targets,a)&&(c?(!En||l._initted&&l._ts)&&l.globalTime(0)<=i&&l.globalTime(l.totalDuration())>i:!i||l.isActive())&&o.push(l):(h=l.getTweensOf(a,i)).length&&o.push.apply(o,h),l=l._next;return o},e.tweenTo=function(n,i){i=i||{};var o=this,a=os(o,n),l=i,c=l.startAt,h=l.onStart,u=l.onStartParams,f=l.immediateRender,d,p=Kt.to(o,rs({ease:i.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:i.duration||Math.abs((a-(c&&"time"in c?c.time:o._time))/o.timeScale())||me,onStart:function(){if(o.pause(),!d){var m=i.duration||Math.abs((a-(c&&"time"in c?c.time:o._time))/o.timeScale());p._dur!==m&&li(p,m,0,1).render(p._time,!0,!0),d=1}h&&h.apply(p,u||[])}},i));return f?p.render(0):p},e.tweenFromTo=function(n,i,o){return this.tweenTo(i,rs({startAt:{time:os(this,n)}},o))},e.recent=function(){return this._recent},e.nextLabel=function(n){return n===void 0&&(n=this._time),qf(this,os(this,n))},e.previousLabel=function(n){return n===void 0&&(n=this._time),qf(this,os(this,n),1)},e.currentLabel=function(n){return arguments.length?this.seek(n,!0):this.previousLabel(this._time+me)},e.shiftChildren=function(n,i,o){o===void 0&&(o=0);for(var a=this._first,l=this.labels,c;a;)a._start>=o&&(a._start+=n,a._end+=n),a=a._next;if(i)for(c in l)l[c]>=o&&(l[c]+=n);return ur(this)},e.invalidate=function(n){var i=this._first;for(this._lock=0;i;)i.invalidate(n),i=i._next;return r.prototype.invalidate.call(this,n)},e.clear=function(n){n===void 0&&(n=!0);for(var i=this._first,o;i;)o=i._next,this.remove(i),i=o;return this._dp&&(this._time=this._tTime=this._pTime=0),n&&(this.labels={}),ur(this)},e.totalDuration=function(n){var i=0,o=this,a=o._last,l=Us,c,h,u;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-n:n));if(o._dirty){for(u=o.parent;a;)c=a._prev,a._dirty&&a.totalDuration(),h=a._start,h>l&&o._sort&&a._ts&&!o._lock?(o._lock=1,Bs(o,a,h-a._delay,1)._lock=0):l=h,h<0&&a._ts&&(i-=h,(!u&&!o._dp||u&&u.smoothChildTiming)&&(o._start+=h/o._ts,o._time-=h,o._tTime-=h),o.shiftChildren(-h,!1,-1/0),l=0),a._end>i&&a._ts&&(i=a._end),a=c;li(o,o===Nt&&o._time>i?o._time:i,1,1),o._dirty=0}return o._tDur},t.updateRoot=function(n){if(Nt._ts&&(Bm(Nt,Ia(n,Nt)),jm=qe.frame),qe.frame>=Wf){Wf+=ts.autoSleep||120;var i=Nt._first;if((!i||!i._ts)&&ts.autoSleep&&qe._listeners.length<2){for(;i&&!i._ts;)i=i._next;i||qe.sleep()}}},t}(uo);rs(Oe.prototype,{_lock:0,_hasPause:0,_forcing:0});var P1=function(t,e,s,n,i,o,a){var l=new Be(this._pt,t,e,0,1,f0,null,i),c=0,h=0,u,f,d,p,g,m,v,_;for(l.b=s,l.e=n,s+="",n+="",(v=~n.indexOf("random("))&&(n=co(n)),o&&(_=[s,n],o(_,t,e),s=_[0],n=_[1]),f=s.match(Ql)||[];u=Ql.exec(n);)p=u[0],g=n.substring(c,u.index),d?d=(d+1)%5:g.substr(-5)==="rgba("&&(d=1),p!==f[h++]&&(m=parseFloat(f[h-1])||0,l._pt={_next:l._pt,p:g||h===1?g:",",s:m,c:p.charAt(1)==="="?Gr(m,p)-m:parseFloat(p)-m,m:d&&d<4?Math.round:0},c=Ql.lastIndex);return l.c=c<n.length?n.substring(c,n.length):"",l.fp=a,(Pm.test(n)||v)&&(l.e=0),this._pt=l,l},Qh=function(t,e,s,n,i,o,a,l,c,h){Ut(n)&&(n=n(i||0,t,o));var u=t[e],f=s!=="get"?s:Ut(u)?c?t[e.indexOf("set")||!Ut(t["get"+e.substr(3)])?e:"get"+e.substr(3)](c):t[e]():u,d=Ut(u)?c?j1:h0:eu,p;if(re(n)&&(~n.indexOf("random(")&&(n=co(n)),n.charAt(1)==="="&&(p=Gr(f,n)+(ge(f)||0),(p||p===0)&&(n=p))),!h||f!==n||Jc)return!isNaN(f*n)&&n!==""?(p=new Be(this._pt,t,e,+f||0,n-(f||0),typeof u=="boolean"?B1:u0,0,d),c&&(p.fp=c),a&&p.modifier(a,this,t),this._pt=p):(!u&&!(e in t)&&qh(e,n),P1.call(this,t,e,f,n,d,l||ts.stringFilter,c))},F1=function(t,e,s,n,i){if(Ut(t)&&(t=Ui(t,i,e,s,n)),!Js(t)||t.style&&t.nodeType||_e(t)||Em(t))return re(t)?Ui(t,i,e,s,n):t;var o={},a;for(a in t)o[a]=Ui(t[a],i,e,s,n);return o},a0=function(t,e,s,n,i,o){var a,l,c,h;if(Ge[t]&&(a=new Ge[t]).init(i,a.rawVars?e[t]:F1(e[t],n,i,o,s),s,n,o)!==!1&&(s._pt=l=new Be(s._pt,i,t,0,1,a.render,a,0,a.priority),s!==jr))for(c=s._ptLookup[s._targets.indexOf(i)],h=a._props.length;h--;)c[a._props[h]]=l;return a},En,Jc,tu=function r(t,e,s){var n=t.vars,i=n.ease,o=n.startAt,a=n.immediateRender,l=n.lazy,c=n.onUpdate,h=n.runBackwards,u=n.yoyoEase,f=n.keyframes,d=n.autoRevert,p=t._dur,g=t._startAt,m=t._targets,v=t.parent,_=v&&v.data==="nested"?v.vars.targets:m,y=t._overwrite==="auto"&&!Wh,b=t.timeline,w,A,O,E,D,Y,K,st,G,rt,ct,et,J;if(b&&(!f||!i)&&(i="none"),t._ease=fr(i,ii.ease),t._yEase=u?n0(fr(u===!0?i:u,ii.ease)):0,u&&t._yoyo&&!t._repeat&&(u=t._yEase,t._yEase=t._ease,t._ease=u),t._from=!b&&!!n.runBackwards,!b||f&&!n.stagger){if(st=m[0]?hr(m[0]).harness:0,et=st&&n[st.prop],w=ja(n,Kh),g&&(g._zTime<0&&g.progress(1),e<0&&h&&a&&!d?g.render(-1,!0):g.revert(h&&p?oa:o1),g._lazy=0),o){if(Hn(t._startAt=Kt.set(m,rs({data:"isStart",overwrite:!1,parent:v,immediateRender:!0,lazy:!g&&je(l),startAt:null,delay:0,onUpdate:c&&function(){return Je(t,"onUpdate")},stagger:0},o))),t._startAt._dp=0,t._startAt._sat=t,e<0&&(le||!a&&!d)&&t._startAt.revert(oa),a&&p&&e<=0&&s<=0){e&&(t._zTime=e);return}}else if(h&&p&&!g){if(e&&(a=!1),O=rs({overwrite:!1,data:"isFromStart",lazy:a&&!g&&je(l),immediateRender:a,stagger:0,parent:v},w),et&&(O[st.prop]=et),Hn(t._startAt=Kt.set(m,O)),t._startAt._dp=0,t._startAt._sat=t,e<0&&(le?t._startAt.revert(oa):t._startAt.render(-1,!0)),t._zTime=e,!a)r(t._startAt,me,me);else if(!e)return}for(t._pt=t._ptCache=0,l=p&&je(l)||l&&!p,A=0;A<m.length;A++){if(D=m[A],K=D._gsap||Zh(m)[A]._gsap,t._ptLookup[A]=rt={},Wc[K.id]&&Rn.length&&La(),ct=_===m?A:_.indexOf(D),st&&(G=new st).init(D,et||w,t,ct,_)!==!1&&(t._pt=E=new Be(t._pt,D,G.name,0,1,G.render,G,0,G.priority),G._props.forEach(function(V){rt[V]=E}),G.priority&&(Y=1)),!st||et)for(O in w)Ge[O]&&(G=a0(O,w,t,ct,D,_))?G.priority&&(Y=1):rt[O]=E=Qh.call(t,D,O,"get",w[O],ct,_,0,n.stringFilter);t._op&&t._op[A]&&t.kill(D,t._op[A]),y&&t._pt&&(En=t,Nt.killTweensOf(D,rt,t.globalTime(e)),J=!t.parent,En=0),t._pt&&l&&(Wc[K.id]=1)}Y&&d0(t),t._onInit&&t._onInit(t)}t._onUpdate=c,t._initted=(!t._op||t._pt)&&!J,f&&e<=0&&b.render(Us,!0,!0)},D1=function(t,e,s,n,i,o,a,l){var c=(t._pt&&t._ptCache||(t._ptCache={}))[e],h,u,f,d;if(!c)for(c=t._ptCache[e]=[],f=t._ptLookup,d=t._targets.length;d--;){if(h=f[d][e],h&&h.d&&h.d._pt)for(h=h.d._pt;h&&h.p!==e&&h.fp!==e;)h=h._next;if(!h)return Jc=1,t.vars[e]="+=0",tu(t,a),Jc=0,l?ao(e+" not eligible for reset"):1;c.push(h)}for(d=c.length;d--;)u=c[d],h=u._pt||u,h.s=(n||n===0)&&!i?n:h.s+(n||0)+o*h.c,h.c=s-h.s,u.e&&(u.e=Gt(s)+ge(u.e)),u.b&&(u.b=h.s+ge(u.b))},R1=function(t,e){var s=t[0]?hr(t[0]).harness:0,n=s&&s.aliases,i,o,a,l;if(!n)return e;i=oi({},e);for(o in n)if(o in i)for(l=n[o].split(","),a=l.length;a--;)i[l[a]]=i[o];return i},L1=function(t,e,s,n){var i=e.ease||n||"power1.inOut",o,a;if(_e(e))a=s[t]||(s[t]=[]),e.forEach(function(l,c){return a.push({t:c/(e.length-1)*100,v:l,e:i})});else for(o in e)a=s[o]||(s[o]=[]),o==="ease"||a.push({t:parseFloat(t),v:e[o],e:i})},Ui=function(t,e,s,n,i){return Ut(t)?t.call(e,s,n,i):re(t)&&~t.indexOf("random(")?co(t):t},l0=Jh+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",c0={};Ie(l0+",id,stagger,delay,duration,paused,scrollTrigger",function(r){return c0[r]=1});var Kt=function(r){km(t,r);function t(s,n,i,o){var a;typeof n=="number"&&(i.duration=n,n=i,i=null),a=r.call(this,o?n:Vi(n))||this;var l=a.vars,c=l.duration,h=l.delay,u=l.immediateRender,f=l.stagger,d=l.overwrite,p=l.keyframes,g=l.defaults,m=l.scrollTrigger,v=l.yoyoEase,_=n.parent||Nt,y=(_e(s)||Em(s)?dn(s[0]):"length"in n)?[s]:us(s),b,w,A,O,E,D,Y,K;if(a._targets=y.length?Zh(y):ao("GSAP target "+s+" not found. https://gsap.com",!ts.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=d,p||f||Jo(c)||Jo(h)){if(n=a.vars,b=a.timeline=new Oe({data:"nested",defaults:g||{},targets:_&&_.data==="nested"?_.vars.targets:y}),b.kill(),b.parent=b._dp=sn(a),b._start=0,f||Jo(c)||Jo(h)){if(O=y.length,Y=f&&Gm(f),Js(f))for(E in f)~l0.indexOf(E)&&(K||(K={}),K[E]=f[E]);for(w=0;w<O;w++)A=ja(n,c0),A.stagger=0,v&&(A.yoyoEase=v),K&&oi(A,K),D=y[w],A.duration=+Ui(c,sn(a),w,D,y),A.delay=(+Ui(h,sn(a),w,D,y)||0)-a._delay,!f&&O===1&&A.delay&&(a._delay=h=A.delay,a._start+=h,A.delay=0),b.to(D,A,Y?Y(w,D,y):0),b._ease=mt.none;b.duration()?c=h=0:a.timeline=0}else if(p){Vi(rs(b.vars.defaults,{ease:"none"})),b._ease=fr(p.ease||n.ease||"none");var st=0,G,rt,ct;if(_e(p))p.forEach(function(et){return b.to(y,et,">")}),b.duration();else{A={};for(E in p)E==="ease"||E==="easeEach"||L1(E,p[E],A,p.easeEach);for(E in A)for(G=A[E].sort(function(et,J){return et.t-J.t}),st=0,w=0;w<G.length;w++)rt=G[w],ct={ease:rt.e,duration:(rt.t-(w?G[w-1].t:0))/100*c},ct[E]=rt.v,b.to(y,ct,st),st+=ct.duration;b.duration()<c&&b.to({},{duration:c-b.duration()})}}c||a.duration(c=b.duration())}else a.timeline=0;return d===!0&&!Wh&&(En=sn(a),Nt.killTweensOf(y),En=0),Bs(_,sn(a),i),n.reversed&&a.reverse(),n.paused&&a.paused(!0),(u||!c&&!p&&a._start===Jt(_._time)&&je(u)&&f1(sn(a))&&_.data!=="nested")&&(a._tTime=-1e-8,a.render(Math.max(0,-h)||0)),m&&Xm(sn(a),m),a}var e=t.prototype;return e.render=function(n,i,o){var a=this._time,l=this._tDur,c=this._dur,h=n<0,u=n>l-me&&!h?l:n<me?0:n,f,d,p,g,m,v,_,y,b;if(!c)g1(this,n,i,o);else if(u!==this._tTime||!n||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==h||this._lazy){if(f=u,y=this.timeline,this._repeat){if(g=c+this._rDelay,this._repeat<-1&&h)return this.totalTime(g*100+n,i,o);if(f=Jt(u%g),u===l?(p=this._repeat,f=c):(m=Jt(u/g),p=~~m,p&&p===m?(f=c,p--):f>c&&(f=c)),v=this._yoyo&&p&1,v&&(b=this._yEase,f=c-f),m=ai(this._tTime,g),f===a&&!o&&this._initted&&p===m)return this._tTime=u,this;p!==m&&(y&&this._yEase&&r0(y,v),this.vars.repeatRefresh&&!v&&!this._lock&&f!==g&&this._initted&&(this._lock=o=1,this.render(Jt(g*p),!0).invalidate()._lock=0))}if(!this._initted){if(Vm(this,h?n:f,o,i,u))return this._tTime=0,this;if(a!==this._time&&!(o&&this.vars.repeatRefresh&&p!==m))return this;if(c!==this._dur)return this.render(n,i,o)}if(this._tTime=u,this._time=f,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=_=(b||this._ease)(f/c),this._from&&(this.ratio=_=1-_),f&&!a&&!i&&!p&&(Je(this,"onStart"),this._tTime!==u))return this;for(d=this._pt;d;)d.r(_,d.d),d=d._next;y&&y.render(n<0?n:y._dur*y._ease(f/this._dur),i,o)||this._startAt&&(this._zTime=n),this._onUpdate&&!i&&(h&&Uc(this,n,i,o),Je(this,"onUpdate")),this._repeat&&p!==m&&this.vars.onRepeat&&!i&&this.parent&&Je(this,"onRepeat"),(u===this._tDur||!u)&&this._tTime===u&&(h&&!this._onUpdate&&Uc(this,n,!0,!0),(n||!c)&&(u===this._tDur&&this._ts>0||!u&&this._ts<0)&&Hn(this,1),!i&&!(h&&!a)&&(u||a||v)&&(Je(this,u===l?"onComplete":"onReverseComplete",!0),this._prom&&!(u<l&&this.timeScale()>0)&&this._prom()))}return this},e.targets=function(){return this._targets},e.invalidate=function(n){return(!n||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(n),r.prototype.invalidate.call(this,n)},e.resetTo=function(n,i,o,a,l){ho||qe.wake(),this._ts||this.play();var c=Math.min(this._dur,(this._dp._time-this._start)*this._ts),h;return this._initted||tu(this,c),h=this._ease(c/this._dur),D1(this,n,i,o,a,h,c,l)?this.resetTo(n,i,o,a,1):(wl(this,0),this.parent||Ym(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},e.kill=function(n,i){if(i===void 0&&(i="all"),!n&&(!i||i==="all"))return this._lazy=this._pt=0,this.parent?ki(this):this.scrollTrigger&&this.scrollTrigger.kill(!!le),this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(n,i,En&&En.vars.overwrite!==!0)._first||ki(this),this.parent&&o!==this.timeline.totalDuration()&&li(this,this._dur*this.timeline._tDur/o,0,1),this}var a=this._targets,l=n?us(n):a,c=this._ptLookup,h=this._pt,u,f,d,p,g,m,v;if((!i||i==="all")&&h1(a,l))return i==="all"&&(this._pt=0),ki(this);for(u=this._op=this._op||[],i!=="all"&&(re(i)&&(g={},Ie(i,function(_){return g[_]=1}),i=g),i=R1(a,i)),v=a.length;v--;)if(~l.indexOf(a[v])){f=c[v],i==="all"?(u[v]=i,p=f,d={}):(d=u[v]=u[v]||{},p=i);for(g in p)m=f&&f[g],m&&((!("kill"in m.d)||m.d.kill(g)===!0)&&xl(this,m,"_pt"),delete f[g]),d!=="all"&&(d[g]=1)}return this._initted&&!this._pt&&h&&ki(this),this},t.to=function(n,i){return new t(n,i,arguments[2])},t.from=function(n,i){return Wi(1,arguments)},t.delayedCall=function(n,i,o,a){return new t(i,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:n,onComplete:i,onReverseComplete:i,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},t.fromTo=function(n,i,o){return Wi(2,arguments)},t.set=function(n,i){return i.duration=0,i.repeatDelay||(i.repeat=0),new t(n,i)},t.killTweensOf=function(n,i,o){return Nt.killTweensOf(n,i,o)},t}(uo);rs(Kt.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});Ie("staggerTo,staggerFrom,staggerFromTo",function(r){Kt[r]=function(){var t=new Oe,e=$c.call(arguments,0);return e.splice(r==="staggerFromTo"?5:4,0,0),t[r].apply(t,e)}});var eu=function(t,e,s){return t[e]=s},h0=function(t,e,s){return t[e](s)},j1=function(t,e,s,n){return t[e](n.fp,s)},I1=function(t,e,s){return t.setAttribute(e,s)},su=function(t,e){return Ut(t[e])?h0:Uh(t[e])&&t.setAttribute?I1:eu},u0=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e6)/1e6,e)},B1=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},f0=function(t,e){var s=e._pt,n="";if(!t&&e.b)n=e.b;else if(t===1&&e.e)n=e.e;else{for(;s;)n=s.p+(s.m?s.m(s.s+s.c*t):Math.round((s.s+s.c*t)*1e4)/1e4)+n,s=s._next;n+=e.c}e.set(e.t,e.p,n,e)},nu=function(t,e){for(var s=e._pt;s;)s.r(t,s.d),s=s._next},N1=function(t,e,s,n){for(var i=this._pt,o;i;)o=i._next,i.p===n&&i.modifier(t,e,s),i=o},H1=function(t){for(var e=this._pt,s,n;e;)n=e._next,e.p===t&&!e.op||e.op===t?xl(this,e,"_pt"):e.dep||(s=1),e=n;return!s},Y1=function(t,e,s,n){n.mSet(t,e,n.m.call(n.tween,s,n.mt),n)},d0=function(t){for(var e=t._pt,s,n,i,o;e;){for(s=e._next,n=i;n&&n.pr>e.pr;)n=n._next;(e._prev=n?n._prev:o)?e._prev._next=e:i=e,(e._next=n)?n._prev=e:o=e,e=s}t._pt=i},Be=function(){function r(e,s,n,i,o,a,l,c,h){this.t=s,this.s=i,this.c=o,this.p=n,this.r=a||u0,this.d=l||this,this.set=c||eu,this.pr=h||0,this._next=e,e&&(e._prev=this)}var t=r.prototype;return t.modifier=function(s,n,i){this.mSet=this.mSet||this.set,this.set=Y1,this.m=s,this.mt=i,this.tween=n},r}();Ie(Jh+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(r){return Kh[r]=1});ns.TweenMax=ns.TweenLite=Kt;ns.TimelineLite=ns.TimelineMax=Oe;Nt=new Oe({sortChildren:!1,defaults:ii,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});ts.stringFilter=s0;var dr=[],la={},z1=[],Jf=0,X1=0,rc=function(t){return(la[t]||z1).map(function(e){return e()})},Zc=function(){var t=Date.now(),e=[];t-Jf>2&&(rc("matchMediaInit"),dr.forEach(function(s){var n=s.queries,i=s.conditions,o,a,l,c;for(a in n)o=Rs.matchMedia(n[a]).matches,o&&(l=1),o!==i[a]&&(i[a]=o,c=1);c&&(s.revert(),l&&e.push(s))}),rc("matchMediaRevert"),e.forEach(function(s){return s.onMatch(s,function(n){return s.add(null,n)})}),Jf=t,rc("matchMedia"))},g0=function(){function r(e,s){this.selector=s&&qc(s),this.data=[],this._r=[],this.isReverted=!1,this.id=X1++,e&&this.add(e)}var t=r.prototype;return t.add=function(s,n,i){Ut(s)&&(i=n,n=s,s=Ut);var o=this,a=function(){var c=Lt,h=o.selector,u;return c&&c!==o&&c.data.push(o),i&&(o.selector=qc(i)),Lt=o,u=n.apply(o,arguments),Ut(u)&&o._r.push(u),Lt=c,o.selector=h,o.isReverted=!1,u};return o.last=a,s===Ut?a(o,function(l){return o.add(null,l)}):s?o[s]=a:a},t.ignore=function(s){var n=Lt;Lt=null,s(this),Lt=n},t.getTweens=function(){var s=[];return this.data.forEach(function(n){return n instanceof r?s.push.apply(s,n.getTweens()):n instanceof Kt&&!(n.parent&&n.parent.data==="nested")&&s.push(n)}),s},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(s,n){var i=this;if(s?function(){for(var a=i.getTweens(),l=i.data.length,c;l--;)c=i.data[l],c.data==="isFlip"&&(c.revert(),c.getChildren(!0,!0,!1).forEach(function(h){return a.splice(a.indexOf(h),1)}));for(a.map(function(h){return{g:h._dur||h._delay||h._sat&&!h._sat.vars.immediateRender?h.globalTime(0):-1/0,t:h}}).sort(function(h,u){return u.g-h.g||-1/0}).forEach(function(h){return h.t.revert(s)}),l=i.data.length;l--;)c=i.data[l],c instanceof Oe?c.data!=="nested"&&(c.scrollTrigger&&c.scrollTrigger.revert(),c.kill()):!(c instanceof Kt)&&c.revert&&c.revert(s);i._r.forEach(function(h){return h(s,i)}),i.isReverted=!0}():this.data.forEach(function(a){return a.kill&&a.kill()}),this.clear(),n)for(var o=dr.length;o--;)dr[o].id===this.id&&dr.splice(o,1)},t.revert=function(s){this.kill(s||{})},r}(),V1=function(){function r(e){this.contexts=[],this.scope=e,Lt&&Lt.data.push(this)}var t=r.prototype;return t.add=function(s,n,i){Js(s)||(s={matches:s});var o=new g0(0,i||this.scope),a=o.conditions={},l,c,h;Lt&&!o.selector&&(o.selector=Lt.selector),this.contexts.push(o),n=o.add("onMatch",n),o.queries=s;for(c in s)c==="all"?h=1:(l=Rs.matchMedia(s[c]),l&&(dr.indexOf(o)<0&&dr.push(o),(a[c]=l.matches)&&(h=1),l.addListener?l.addListener(Zc):l.addEventListener("change",Zc)));return h&&n(o,function(u){return o.add(null,u)}),this},t.revert=function(s){this.kill(s||{})},t.kill=function(s){this.contexts.forEach(function(n){return n.kill(s,!0)})},r}(),Ba={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];e.forEach(function(n){return Qm(n)})},timeline:function(t){return new Oe(t)},getTweensOf:function(t,e){return Nt.getTweensOf(t,e)},getProperty:function(t,e,s,n){re(t)&&(t=us(t)[0]);var i=hr(t||{}).get,o=s?Hm:Nm;return s==="native"&&(s=""),t&&(e?o((Ge[e]&&Ge[e].get||i)(t,e,s,n)):function(a,l,c){return o((Ge[a]&&Ge[a].get||i)(t,a,l,c))})},quickSetter:function(t,e,s){if(t=us(t),t.length>1){var n=t.map(function(h){return He.quickSetter(h,e,s)}),i=n.length;return function(h){for(var u=i;u--;)n[u](h)}}t=t[0]||{};var o=Ge[e],a=hr(t),l=a.harness&&(a.harness.aliases||{})[e]||e,c=o?function(h){var u=new o;jr._pt=0,u.init(t,s?h+s:h,jr,0,[t]),u.render(1,u),jr._pt&&nu(1,jr)}:a.set(t,l);return o?c:function(h){return c(t,l,s?h+s:h,a,1)}},quickTo:function(t,e,s){var n,i=He.to(t,rs((n={},n[e]="+=0.1",n.paused=!0,n.stagger=0,n),s||{})),o=function(l,c,h){return i.resetTo(e,l,c,h)};return o.tween=i,o},isTweening:function(t){return Nt.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=fr(t.ease,ii.ease)),Uf(ii,t||{})},config:function(t){return Uf(ts,t||{})},registerEffect:function(t){var e=t.name,s=t.effect,n=t.plugins,i=t.defaults,o=t.extendTimeline;(n||"").split(",").forEach(function(a){return a&&!Ge[a]&&!ns[a]&&ao(e+" effect requires "+a+" plugin.")}),tc[e]=function(a,l,c){return s(us(a),rs(l||{},i),c)},o&&(Oe.prototype[e]=function(a,l,c){return this.add(tc[e](a,Js(l)?l:(c=l)&&{},this),c)})},registerEase:function(t,e){mt[t]=fr(e)},parseEase:function(t,e){return arguments.length?fr(t,e):mt},getById:function(t){return Nt.getById(t)},exportRoot:function(t,e){t===void 0&&(t={});var s=new Oe(t),n,i;for(s.smoothChildTiming=je(t.smoothChildTiming),Nt.remove(s),s._dp=0,s._time=s._tTime=Nt._time,n=Nt._first;n;)i=n._next,(e||!(!n._dur&&n instanceof Kt&&n.vars.onComplete===n._targets[0]))&&Bs(s,n,n._start-n._delay),n=i;return Bs(Nt,s,0),s},context:function(t,e){return t?new g0(t,e):Lt},matchMedia:function(t){return new V1(t)},matchMediaRefresh:function(){return dr.forEach(function(t){var e=t.conditions,s,n;for(n in e)e[n]&&(e[n]=!1,s=1);s&&t.revert()})||Zc()},addEventListener:function(t,e){var s=la[t]||(la[t]=[]);~s.indexOf(e)||s.push(e)},removeEventListener:function(t,e){var s=la[t],n=s&&s.indexOf(e);n>=0&&s.splice(n,1)},utils:{wrap:C1,wrapYoyo:w1,distribute:Gm,random:qm,snap:$m,normalize:x1,getUnit:ge,clamp:v1,splitColor:t0,toArray:us,selector:qc,mapRange:Jm,pipe:y1,unitize:b1,interpolate:S1,shuffle:Um},install:Rm,effects:tc,ticker:qe,updateRoot:Oe.updateRoot,plugins:Ge,globalTimeline:Nt,core:{PropTween:Be,globals:Lm,Tween:Kt,Timeline:Oe,Animation:uo,getCache:hr,_removeLinkedListItem:xl,reverting:function(){return le},context:function(t){return t&&Lt&&(Lt.data.push(t),t._ctx=Lt),Lt},suppressOverwrites:function(t){return Wh=t}}};Ie("to,from,fromTo,delayedCall,set,killTweensOf",function(r){return Ba[r]=Kt[r]});qe.add(Oe.updateRoot);jr=Ba.to({},{duration:0});var W1=function(t,e){for(var s=t._pt;s&&s.p!==e&&s.op!==e&&s.fp!==e;)s=s._next;return s},U1=function(t,e){var s=t._targets,n,i,o;for(n in e)for(i=s.length;i--;)o=t._ptLookup[i][n],o&&(o=o.d)&&(o._pt&&(o=W1(o,n)),o&&o.modifier&&o.modifier(e[n],t,s[i],n))},ic=function(t,e){return{name:t,rawVars:1,init:function(n,i,o){o._onInit=function(a){var l,c;if(re(i)&&(l={},Ie(i,function(h){return l[h]=1}),i=l),e){l={};for(c in i)l[c]=e(i[c]);i=l}U1(a,i)}}}},He=Ba.registerPlugin({name:"attr",init:function(t,e,s,n,i){var o,a,l;this.tween=s;for(o in e)l=t.getAttribute(o)||"",a=this.add(t,"setAttribute",(l||0)+"",e[o],n,i,0,0,o),a.op=o,a.b=l,this._props.push(o)},render:function(t,e){for(var s=e._pt;s;)le?s.set(s.t,s.p,s.b,s):s.r(t,s.d),s=s._next}},{name:"endArray",init:function(t,e){for(var s=e.length;s--;)this.add(t,s,t[s]||0,e[s],0,0,0,0,0,1)}},ic("roundProps",Kc),ic("modifiers"),ic("snap",$m))||Ba;Kt.version=Oe.version=He.version="3.12.7";Dm=1;Gh()&&ci();mt.Power0;mt.Power1;mt.Power2;mt.Power3;mt.Power4;mt.Linear;mt.Quad;mt.Cubic;mt.Quart;mt.Quint;mt.Strong;mt.Elastic;mt.Back;mt.SteppedEase;mt.Bounce;mt.Sine;mt.Expo;mt.Circ;/*!
 * CSSPlugin 3.12.7
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Zf,An,$r,ru,or,Qf,iu,G1=function(){return typeof window<"u"},gn={},Qn=180/Math.PI,qr=Math.PI/180,Er=Math.atan2,td=1e8,ou=/([A-Z])/g,$1=/(left|right|width|margin|padding|x)/i,q1=/[\s,\(]\S/,zs={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Qc=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},K1=function(t,e){return e.set(e.t,e.p,t===1?e.e:Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},J1=function(t,e){return e.set(e.t,e.p,t?Math.round((e.s+e.c*t)*1e4)/1e4+e.u:e.b,e)},Z1=function(t,e){var s=e.s+e.c*t;e.set(e.t,e.p,~~(s+(s<0?-.5:.5))+e.u,e)},p0=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},m0=function(t,e){return e.set(e.t,e.p,t!==1?e.b:e.e,e)},Q1=function(t,e,s){return t.style[e]=s},tw=function(t,e,s){return t.style.setProperty(e,s)},ew=function(t,e,s){return t._gsap[e]=s},sw=function(t,e,s){return t._gsap.scaleX=t._gsap.scaleY=s},nw=function(t,e,s,n,i){var o=t._gsap;o.scaleX=o.scaleY=s,o.renderTransform(i,o)},rw=function(t,e,s,n,i){var o=t._gsap;o[e]=s,o.renderTransform(i,o)},Yt="transform",Ne=Yt+"Origin",iw=function r(t,e){var s=this,n=this.target,i=n.style,o=n._gsap;if(t in gn&&i){if(this.tfm=this.tfm||{},t!=="transform")t=zs[t]||t,~t.indexOf(",")?t.split(",").forEach(function(a){return s.tfm[a]=rn(n,a)}):this.tfm[t]=o.x?o[t]:rn(n,t),t===Ne&&(this.tfm.zOrigin=o.zOrigin);else return zs.transform.split(",").forEach(function(a){return r.call(s,a,e)});if(this.props.indexOf(Yt)>=0)return;o.svg&&(this.svgo=n.getAttribute("data-svg-origin"),this.props.push(Ne,e,"")),t=Yt}(i||e)&&this.props.push(t,e,i[t])},v0=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},ow=function(){var t=this.props,e=this.target,s=e.style,n=e._gsap,i,o;for(i=0;i<t.length;i+=3)t[i+1]?t[i+1]===2?e[t[i]](t[i+2]):e[t[i]]=t[i+2]:t[i+2]?s[t[i]]=t[i+2]:s.removeProperty(t[i].substr(0,2)==="--"?t[i]:t[i].replace(ou,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)n[o]=this.tfm[o];n.svg&&(n.renderTransform(),e.setAttribute("data-svg-origin",this.svgo||"")),i=iu(),(!i||!i.isStart)&&!s[Yt]&&(v0(s),n.zOrigin&&s[Ne]&&(s[Ne]+=" "+n.zOrigin+"px",n.zOrigin=0,n.renderTransform()),n.uncache=1)}},_0=function(t,e){var s={target:t,props:[],revert:ow,save:iw};return t._gsap||He.core.getCache(t),e&&t.style&&t.nodeType&&e.split(",").forEach(function(n){return s.save(n)}),s},y0,th=function(t,e){var s=An.createElementNS?An.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):An.createElement(t);return s&&s.style?s:An.createElement(t)},Gs=function r(t,e,s){var n=getComputedStyle(t);return n[e]||n.getPropertyValue(e.replace(ou,"-$1").toLowerCase())||n.getPropertyValue(e)||!s&&r(t,hi(e)||e,1)||""},ed="O,Moz,ms,Ms,Webkit".split(","),hi=function(t,e,s){var n=e||or,i=n.style,o=5;if(t in i&&!s)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);o--&&!(ed[o]+t in i););return o<0?null:(o===3?"ms":o>=0?ed[o]:"")+t},eh=function(){G1()&&window.document&&(Zf=window,An=Zf.document,$r=An.documentElement,or=th("div")||{style:{}},th("div"),Yt=hi(Yt),Ne=Yt+"Origin",or.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",y0=!!hi("perspective"),iu=He.core.reverting,ru=1)},sd=function(t){var e=t.ownerSVGElement,s=th("svg",e&&e.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),n=t.cloneNode(!0),i;n.style.display="block",s.appendChild(n),$r.appendChild(s);try{i=n.getBBox()}catch{}return s.removeChild(n),$r.removeChild(s),i},nd=function(t,e){for(var s=e.length;s--;)if(t.hasAttribute(e[s]))return t.getAttribute(e[s])},b0=function(t){var e,s;try{e=t.getBBox()}catch{e=sd(t),s=1}return e&&(e.width||e.height)||s||(e=sd(t)),e&&!e.width&&!e.x&&!e.y?{x:+nd(t,["x","cx","x1"])||0,y:+nd(t,["y","cy","y1"])||0,width:0,height:0}:e},x0=function(t){return!!(t.getCTM&&(!t.parentNode||t.ownerSVGElement)&&b0(t))},br=function(t,e){if(e){var s=t.style,n;e in gn&&e!==Ne&&(e=Yt),s.removeProperty?(n=e.substr(0,2),(n==="ms"||e.substr(0,6)==="webkit")&&(e="-"+e),s.removeProperty(n==="--"?e:e.replace(ou,"-$1").toLowerCase())):s.removeAttribute(e)}},Pn=function(t,e,s,n,i,o){var a=new Be(t._pt,e,s,0,1,o?m0:p0);return t._pt=a,a.b=n,a.e=i,t._props.push(s),a},rd={deg:1,rad:1,turn:1},aw={grid:1,flex:1},Yn=function r(t,e,s,n){var i=parseFloat(s)||0,o=(s+"").trim().substr((i+"").length)||"px",a=or.style,l=$1.test(e),c=t.tagName.toLowerCase()==="svg",h=(c?"client":"offset")+(l?"Width":"Height"),u=100,f=n==="px",d=n==="%",p,g,m,v;if(n===o||!i||rd[n]||rd[o])return i;if(o!=="px"&&!f&&(i=r(t,e,s,"px")),v=t.getCTM&&x0(t),(d||o==="%")&&(gn[e]||~e.indexOf("adius")))return p=v?t.getBBox()[l?"width":"height"]:t[h],Gt(d?i/p*u:i/100*p);if(a[l?"width":"height"]=u+(f?o:n),g=n!=="rem"&&~e.indexOf("adius")||n==="em"&&t.appendChild&&!c?t:t.parentNode,v&&(g=(t.ownerSVGElement||{}).parentNode),(!g||g===An||!g.appendChild)&&(g=An.body),m=g._gsap,m&&d&&m.width&&l&&m.time===qe.time&&!m.uncache)return Gt(i/m.width*u);if(d&&(e==="height"||e==="width")){var _=t.style[e];t.style[e]=u+n,p=t[h],_?t.style[e]=_:br(t,e)}else(d||o==="%")&&!aw[Gs(g,"display")]&&(a.position=Gs(t,"position")),g===t&&(a.position="static"),g.appendChild(or),p=or[h],g.removeChild(or),a.position="absolute";return l&&d&&(m=hr(g),m.time=qe.time,m.width=g[h]),Gt(f?p*i/u:p&&i?u/p*i:0)},rn=function(t,e,s,n){var i;return ru||eh(),e in zs&&e!=="transform"&&(e=zs[e],~e.indexOf(",")&&(e=e.split(",")[0])),gn[e]&&e!=="transform"?(i=go(t,n),i=e!=="transformOrigin"?i[e]:i.svg?i.origin:Ha(Gs(t,Ne))+" "+i.zOrigin+"px"):(i=t.style[e],(!i||i==="auto"||n||~(i+"").indexOf("calc("))&&(i=Na[e]&&Na[e](t,e,s)||Gs(t,e)||Im(t,e)||(e==="opacity"?1:0))),s&&!~(i+"").trim().indexOf(" ")?Yn(t,e,i,s)+s:i},lw=function(t,e,s,n){if(!s||s==="none"){var i=hi(e,t,1),o=i&&Gs(t,i,1);o&&o!==s?(e=i,s=o):e==="borderColor"&&(s=Gs(t,"borderTopColor"))}var a=new Be(this._pt,t.style,e,0,1,f0),l=0,c=0,h,u,f,d,p,g,m,v,_,y,b,w;if(a.b=s,a.e=n,s+="",n+="",n==="auto"&&(g=t.style[e],t.style[e]=n,n=Gs(t,e)||n,g?t.style[e]=g:br(t,e)),h=[s,n],s0(h),s=h[0],n=h[1],f=s.match(Lr)||[],w=n.match(Lr)||[],w.length){for(;u=Lr.exec(n);)m=u[0],_=n.substring(l,u.index),p?p=(p+1)%5:(_.substr(-5)==="rgba("||_.substr(-5)==="hsla(")&&(p=1),m!==(g=f[c++]||"")&&(d=parseFloat(g)||0,b=g.substr((d+"").length),m.charAt(1)==="="&&(m=Gr(d,m)+b),v=parseFloat(m),y=m.substr((v+"").length),l=Lr.lastIndex-y.length,y||(y=y||ts.units[e]||b,l===n.length&&(n+=y,a.e+=y)),b!==y&&(d=Yn(t,e,g,y)||0),a._pt={_next:a._pt,p:_||c===1?_:",",s:d,c:v-d,m:p&&p<4||e==="zIndex"?Math.round:0});a.c=l<n.length?n.substring(l,n.length):""}else a.r=e==="display"&&n==="none"?m0:p0;return Pm.test(n)&&(a.e=0),this._pt=a,a},id={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},cw=function(t){var e=t.split(" "),s=e[0],n=e[1]||"50%";return(s==="top"||s==="bottom"||n==="left"||n==="right")&&(t=s,s=n,n=t),e[0]=id[s]||s,e[1]=id[n]||n,e.join(" ")},hw=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var s=e.t,n=s.style,i=e.u,o=s._gsap,a,l,c;if(i==="all"||i===!0)n.cssText="",l=1;else for(i=i.split(","),c=i.length;--c>-1;)a=i[c],gn[a]&&(l=1,a=a==="transformOrigin"?Ne:Yt),br(s,a);l&&(br(s,Yt),o&&(o.svg&&s.removeAttribute("transform"),n.scale=n.rotate=n.translate="none",go(s,1),o.uncache=1,v0(n)))}},Na={clearProps:function(t,e,s,n,i){if(i.data!=="isFromStart"){var o=t._pt=new Be(t._pt,e,s,0,0,hw);return o.u=n,o.pr=-10,o.tween=i,t._props.push(s),1}}},fo=[1,0,0,1,0,0],C0={},w0=function(t){return t==="matrix(1, 0, 0, 1, 0, 0)"||t==="none"||!t},od=function(t){var e=Gs(t,Yt);return w0(e)?fo:e.substr(7).match(Am).map(Gt)},au=function(t,e){var s=t._gsap||hr(t),n=t.style,i=od(t),o,a,l,c;return s.svg&&t.getAttribute("transform")?(l=t.transform.baseVal.consolidate().matrix,i=[l.a,l.b,l.c,l.d,l.e,l.f],i.join(",")==="1,0,0,1,0,0"?fo:i):(i===fo&&!t.offsetParent&&t!==$r&&!s.svg&&(l=n.display,n.display="block",o=t.parentNode,(!o||!t.offsetParent&&!t.getBoundingClientRect().width)&&(c=1,a=t.nextElementSibling,$r.appendChild(t)),i=od(t),l?n.display=l:br(t,"display"),c&&(a?o.insertBefore(t,a):o?o.appendChild(t):$r.removeChild(t))),e&&i.length>6?[i[0],i[1],i[4],i[5],i[12],i[13]]:i)},sh=function(t,e,s,n,i,o){var a=t._gsap,l=i||au(t,!0),c=a.xOrigin||0,h=a.yOrigin||0,u=a.xOffset||0,f=a.yOffset||0,d=l[0],p=l[1],g=l[2],m=l[3],v=l[4],_=l[5],y=e.split(" "),b=parseFloat(y[0])||0,w=parseFloat(y[1])||0,A,O,E,D;s?l!==fo&&(O=d*m-p*g)&&(E=b*(m/O)+w*(-g/O)+(g*_-m*v)/O,D=b*(-p/O)+w*(d/O)-(d*_-p*v)/O,b=E,w=D):(A=b0(t),b=A.x+(~y[0].indexOf("%")?b/100*A.width:b),w=A.y+(~(y[1]||y[0]).indexOf("%")?w/100*A.height:w)),n||n!==!1&&a.smooth?(v=b-c,_=w-h,a.xOffset=u+(v*d+_*g)-v,a.yOffset=f+(v*p+_*m)-_):a.xOffset=a.yOffset=0,a.xOrigin=b,a.yOrigin=w,a.smooth=!!n,a.origin=e,a.originIsAbsolute=!!s,t.style[Ne]="0px 0px",o&&(Pn(o,a,"xOrigin",c,b),Pn(o,a,"yOrigin",h,w),Pn(o,a,"xOffset",u,a.xOffset),Pn(o,a,"yOffset",f,a.yOffset)),t.setAttribute("data-svg-origin",b+" "+w)},go=function(t,e){var s=t._gsap||new o0(t);if("x"in s&&!e&&!s.uncache)return s;var n=t.style,i=s.scaleX<0,o="px",a="deg",l=getComputedStyle(t),c=Gs(t,Ne)||"0",h,u,f,d,p,g,m,v,_,y,b,w,A,O,E,D,Y,K,st,G,rt,ct,et,J,V,pt,Tt,At,B,N,W,Xt;return h=u=f=g=m=v=_=y=b=0,d=p=1,s.svg=!!(t.getCTM&&x0(t)),l.translate&&((l.translate!=="none"||l.scale!=="none"||l.rotate!=="none")&&(n[Yt]=(l.translate!=="none"?"translate3d("+(l.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(l.rotate!=="none"?"rotate("+l.rotate+") ":"")+(l.scale!=="none"?"scale("+l.scale.split(" ").join(",")+") ":"")+(l[Yt]!=="none"?l[Yt]:"")),n.scale=n.rotate=n.translate="none"),O=au(t,s.svg),s.svg&&(s.uncache?(V=t.getBBox(),c=s.xOrigin-V.x+"px "+(s.yOrigin-V.y)+"px",J=""):J=!e&&t.getAttribute("data-svg-origin"),sh(t,J||c,!!J||s.originIsAbsolute,s.smooth!==!1,O)),w=s.xOrigin||0,A=s.yOrigin||0,O!==fo&&(K=O[0],st=O[1],G=O[2],rt=O[3],h=ct=O[4],u=et=O[5],O.length===6?(d=Math.sqrt(K*K+st*st),p=Math.sqrt(rt*rt+G*G),g=K||st?Er(st,K)*Qn:0,_=G||rt?Er(G,rt)*Qn+g:0,_&&(p*=Math.abs(Math.cos(_*qr))),s.svg&&(h-=w-(w*K+A*G),u-=A-(w*st+A*rt))):(Xt=O[6],N=O[7],Tt=O[8],At=O[9],B=O[10],W=O[11],h=O[12],u=O[13],f=O[14],E=Er(Xt,B),m=E*Qn,E&&(D=Math.cos(-E),Y=Math.sin(-E),J=ct*D+Tt*Y,V=et*D+At*Y,pt=Xt*D+B*Y,Tt=ct*-Y+Tt*D,At=et*-Y+At*D,B=Xt*-Y+B*D,W=N*-Y+W*D,ct=J,et=V,Xt=pt),E=Er(-G,B),v=E*Qn,E&&(D=Math.cos(-E),Y=Math.sin(-E),J=K*D-Tt*Y,V=st*D-At*Y,pt=G*D-B*Y,W=rt*Y+W*D,K=J,st=V,G=pt),E=Er(st,K),g=E*Qn,E&&(D=Math.cos(E),Y=Math.sin(E),J=K*D+st*Y,V=ct*D+et*Y,st=st*D-K*Y,et=et*D-ct*Y,K=J,ct=V),m&&Math.abs(m)+Math.abs(g)>359.9&&(m=g=0,v=180-v),d=Gt(Math.sqrt(K*K+st*st+G*G)),p=Gt(Math.sqrt(et*et+Xt*Xt)),E=Er(ct,et),_=Math.abs(E)>2e-4?E*Qn:0,b=W?1/(W<0?-W:W):0),s.svg&&(J=t.getAttribute("transform"),s.forceCSS=t.setAttribute("transform","")||!w0(Gs(t,Yt)),J&&t.setAttribute("transform",J))),Math.abs(_)>90&&Math.abs(_)<270&&(i?(d*=-1,_+=g<=0?180:-180,g+=g<=0?180:-180):(p*=-1,_+=_<=0?180:-180)),e=e||s.uncache,s.x=h-((s.xPercent=h&&(!e&&s.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-h)?-50:0)))?t.offsetWidth*s.xPercent/100:0)+o,s.y=u-((s.yPercent=u&&(!e&&s.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-u)?-50:0)))?t.offsetHeight*s.yPercent/100:0)+o,s.z=f+o,s.scaleX=Gt(d),s.scaleY=Gt(p),s.rotation=Gt(g)+a,s.rotationX=Gt(m)+a,s.rotationY=Gt(v)+a,s.skewX=_+a,s.skewY=y+a,s.transformPerspective=b+o,(s.zOrigin=parseFloat(c.split(" ")[2])||!e&&s.zOrigin||0)&&(n[Ne]=Ha(c)),s.xOffset=s.yOffset=0,s.force3D=ts.force3D,s.renderTransform=s.svg?fw:y0?S0:uw,s.uncache=0,s},Ha=function(t){return(t=t.split(" "))[0]+" "+t[1]},oc=function(t,e,s){var n=ge(e);return Gt(parseFloat(e)+parseFloat(Yn(t,"x",s+"px",n)))+n},uw=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,S0(t,e)},Kn="0deg",wi="0px",Jn=") ",S0=function(t,e){var s=e||this,n=s.xPercent,i=s.yPercent,o=s.x,a=s.y,l=s.z,c=s.rotation,h=s.rotationY,u=s.rotationX,f=s.skewX,d=s.skewY,p=s.scaleX,g=s.scaleY,m=s.transformPerspective,v=s.force3D,_=s.target,y=s.zOrigin,b="",w=v==="auto"&&t&&t!==1||v===!0;if(y&&(u!==Kn||h!==Kn)){var A=parseFloat(h)*qr,O=Math.sin(A),E=Math.cos(A),D;A=parseFloat(u)*qr,D=Math.cos(A),o=oc(_,o,O*D*-y),a=oc(_,a,-Math.sin(A)*-y),l=oc(_,l,E*D*-y+y)}m!==wi&&(b+="perspective("+m+Jn),(n||i)&&(b+="translate("+n+"%, "+i+"%) "),(w||o!==wi||a!==wi||l!==wi)&&(b+=l!==wi||w?"translate3d("+o+", "+a+", "+l+") ":"translate("+o+", "+a+Jn),c!==Kn&&(b+="rotate("+c+Jn),h!==Kn&&(b+="rotateY("+h+Jn),u!==Kn&&(b+="rotateX("+u+Jn),(f!==Kn||d!==Kn)&&(b+="skew("+f+", "+d+Jn),(p!==1||g!==1)&&(b+="scale("+p+", "+g+Jn),_.style[Yt]=b||"translate(0, 0)"},fw=function(t,e){var s=e||this,n=s.xPercent,i=s.yPercent,o=s.x,a=s.y,l=s.rotation,c=s.skewX,h=s.skewY,u=s.scaleX,f=s.scaleY,d=s.target,p=s.xOrigin,g=s.yOrigin,m=s.xOffset,v=s.yOffset,_=s.forceCSS,y=parseFloat(o),b=parseFloat(a),w,A,O,E,D;l=parseFloat(l),c=parseFloat(c),h=parseFloat(h),h&&(h=parseFloat(h),c+=h,l+=h),l||c?(l*=qr,c*=qr,w=Math.cos(l)*u,A=Math.sin(l)*u,O=Math.sin(l-c)*-f,E=Math.cos(l-c)*f,c&&(h*=qr,D=Math.tan(c-h),D=Math.sqrt(1+D*D),O*=D,E*=D,h&&(D=Math.tan(h),D=Math.sqrt(1+D*D),w*=D,A*=D)),w=Gt(w),A=Gt(A),O=Gt(O),E=Gt(E)):(w=u,E=f,A=O=0),(y&&!~(o+"").indexOf("px")||b&&!~(a+"").indexOf("px"))&&(y=Yn(d,"x",o,"px"),b=Yn(d,"y",a,"px")),(p||g||m||v)&&(y=Gt(y+p-(p*w+g*O)+m),b=Gt(b+g-(p*A+g*E)+v)),(n||i)&&(D=d.getBBox(),y=Gt(y+n/100*D.width),b=Gt(b+i/100*D.height)),D="matrix("+w+","+A+","+O+","+E+","+y+","+b+")",d.setAttribute("transform",D),_&&(d.style[Yt]=D)},dw=function(t,e,s,n,i){var o=360,a=re(i),l=parseFloat(i)*(a&&~i.indexOf("rad")?Qn:1),c=l-n,h=n+c+"deg",u,f;return a&&(u=i.split("_")[1],u==="short"&&(c%=o,c!==c%(o/2)&&(c+=c<0?o:-360)),u==="cw"&&c<0?c=(c+o*td)%o-~~(c/o)*o:u==="ccw"&&c>0&&(c=(c-o*td)%o-~~(c/o)*o)),t._pt=f=new Be(t._pt,e,s,n,c,K1),f.e=h,f.u="deg",t._props.push(s),f},ad=function(t,e){for(var s in e)t[s]=e[s];return t},gw=function(t,e,s){var n=ad({},s._gsap),i="perspective,force3D,transformOrigin,svgOrigin",o=s.style,a,l,c,h,u,f,d,p;n.svg?(c=s.getAttribute("transform"),s.setAttribute("transform",""),o[Yt]=e,a=go(s,1),br(s,Yt),s.setAttribute("transform",c)):(c=getComputedStyle(s)[Yt],o[Yt]=e,a=go(s,1),o[Yt]=c);for(l in gn)c=n[l],h=a[l],c!==h&&i.indexOf(l)<0&&(d=ge(c),p=ge(h),u=d!==p?Yn(s,l,c,p):parseFloat(c),f=parseFloat(h),t._pt=new Be(t._pt,a,l,u,f-u,Qc),t._pt.u=p||0,t._props.push(l));ad(a,n)};Ie("padding,margin,Width,Radius",function(r,t){var e="Top",s="Right",n="Bottom",i="Left",o=(t<3?[e,s,n,i]:[e+i,e+s,n+s,n+i]).map(function(a){return t<2?r+a:"border"+a+r});Na[t>1?"border"+r:r]=function(a,l,c,h,u){var f,d;if(arguments.length<4)return f=o.map(function(p){return rn(a,p,c)}),d=f.join(" "),d.split(f[0]).length===5?f[0]:d;f=(h+"").split(" "),d={},o.forEach(function(p,g){return d[p]=f[g]=f[g]||f[(g-1)/2|0]}),a.init(l,d,u)}});var T0={name:"css",register:eh,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,s,n,i){var o=this._props,a=t.style,l=s.vars.startAt,c,h,u,f,d,p,g,m,v,_,y,b,w,A,O,E;ru||eh(),this.styles=this.styles||_0(t),E=this.styles.props,this.tween=s;for(g in e)if(g!=="autoRound"&&(h=e[g],!(Ge[g]&&a0(g,e,s,n,t,i)))){if(d=typeof h,p=Na[g],d==="function"&&(h=h.call(s,n,t,i),d=typeof h),d==="string"&&~h.indexOf("random(")&&(h=co(h)),p)p(this,t,g,h,s)&&(O=1);else if(g.substr(0,2)==="--")c=(getComputedStyle(t).getPropertyValue(g)+"").trim(),h+="",Ln.lastIndex=0,Ln.test(c)||(m=ge(c),v=ge(h)),v?m!==v&&(c=Yn(t,g,c,v)+v):m&&(h+=m),this.add(a,"setProperty",c,h,n,i,0,0,g),o.push(g),E.push(g,0,a[g]);else if(d!=="undefined"){if(l&&g in l?(c=typeof l[g]=="function"?l[g].call(s,n,t,i):l[g],re(c)&&~c.indexOf("random(")&&(c=co(c)),ge(c+"")||c==="auto"||(c+=ts.units[g]||ge(rn(t,g))||""),(c+"").charAt(1)==="="&&(c=rn(t,g))):c=rn(t,g),f=parseFloat(c),_=d==="string"&&h.charAt(1)==="="&&h.substr(0,2),_&&(h=h.substr(2)),u=parseFloat(h),g in zs&&(g==="autoAlpha"&&(f===1&&rn(t,"visibility")==="hidden"&&u&&(f=0),E.push("visibility",0,a.visibility),Pn(this,a,"visibility",f?"inherit":"hidden",u?"inherit":"hidden",!u)),g!=="scale"&&g!=="transform"&&(g=zs[g],~g.indexOf(",")&&(g=g.split(",")[0]))),y=g in gn,y){if(this.styles.save(g),b||(w=t._gsap,w.renderTransform&&!e.parseTransform||go(t,e.parseTransform),A=e.smoothOrigin!==!1&&w.smooth,b=this._pt=new Be(this._pt,a,Yt,0,1,w.renderTransform,w,0,-1),b.dep=1),g==="scale")this._pt=new Be(this._pt,w,"scaleY",w.scaleY,(_?Gr(w.scaleY,_+u):u)-w.scaleY||0,Qc),this._pt.u=0,o.push("scaleY",g),g+="X";else if(g==="transformOrigin"){E.push(Ne,0,a[Ne]),h=cw(h),w.svg?sh(t,h,0,A,0,this):(v=parseFloat(h.split(" ")[2])||0,v!==w.zOrigin&&Pn(this,w,"zOrigin",w.zOrigin,v),Pn(this,a,g,Ha(c),Ha(h)));continue}else if(g==="svgOrigin"){sh(t,h,1,A,0,this);continue}else if(g in C0){dw(this,w,g,f,_?Gr(f,_+h):h);continue}else if(g==="smoothOrigin"){Pn(this,w,"smooth",w.smooth,h);continue}else if(g==="force3D"){w[g]=h;continue}else if(g==="transform"){gw(this,h,t);continue}}else g in a||(g=hi(g)||g);if(y||(u||u===0)&&(f||f===0)&&!q1.test(h)&&g in a)m=(c+"").substr((f+"").length),u||(u=0),v=ge(h)||(g in ts.units?ts.units[g]:m),m!==v&&(f=Yn(t,g,c,v)),this._pt=new Be(this._pt,y?w:a,g,f,(_?Gr(f,_+u):u)-f,!y&&(v==="px"||g==="zIndex")&&e.autoRound!==!1?Z1:Qc),this._pt.u=v||0,m!==v&&v!=="%"&&(this._pt.b=c,this._pt.r=J1);else if(g in a)lw.call(this,t,g,c,_?_+h:h);else if(g in t)this.add(t,g,c||t[g],_?_+h:h,n,i);else if(g!=="parseTransform"){qh(g,h);continue}y||(g in a?E.push(g,0,a[g]):typeof t[g]=="function"?E.push(g,2,t[g]()):E.push(g,1,c||t[g])),o.push(g)}}O&&d0(this)},render:function(t,e){if(e.tween._time||!iu())for(var s=e._pt;s;)s.r(t,s.d),s=s._next;else e.styles.revert()},get:rn,aliases:zs,getSetter:function(t,e,s){var n=zs[e];return n&&n.indexOf(",")<0&&(e=n),e in gn&&e!==Ne&&(t._gsap.x||rn(t,"x"))?s&&Qf===s?e==="scale"?sw:ew:(Qf=s||{})&&(e==="scale"?nw:rw):t.style&&!Uh(t.style[e])?Q1:~e.indexOf("-")?tw:su(t,e)},core:{_removeProperty:br,_getMatrix:au}};He.utils.checkPrefix=hi;He.core.getStyleSaver=_0;(function(r,t,e,s){var n=Ie(r+","+t+","+e,function(i){gn[i]=1});Ie(t,function(i){ts.units[i]="deg",C0[i]=1}),zs[n[13]]=r+","+t,Ie(s,function(i){var o=i.split(":");zs[o[1]]=n[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");Ie("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(r){ts.units[r]="px"});He.registerPlugin(T0);var Ei=He.registerPlugin(T0)||He;Ei.core.Tween;function pw(){return{zoomToFrame:(n,i={})=>{const{duration:o=2.5,viewportTransform:a,onComplete:l,ease:c="power3.inOut",exitEffect:h=!0,exitScale:u=.9,transitionType:f="zoom-pan"}=i;if(f==="initial"){n.setViewportTransform(a),n.requestRenderAll(),l&&l();return}const d=[...n.viewportTransform];console.log("动画开始 - 当前视口:",d),console.log("动画开始 - 目标视口:",a);const p=d[0],g=d[4],m=d[5],v=a[0],_=a[4],y=a[5],b={scale:p,translateX:g,translateY:m,progress:0,opacity:1},w=Ei.timeline({onComplete:()=>{console.log("动画完成 - 最终视口:",n.viewportTransform),l&&l()}}),A=window.screen.width*window.devicePixelRatio,O=window.screen.height*window.devicePixelRatio,E=A/2,D=O/2,Y=(E-g)/p,K=(D-m)/p,st=(E-_)/v,G=(D-y)/v;f==="zoom-in"?w.to(b,{duration:o,scale:v,translateX:_,translateY:y,ease:c,onUpdate:rt}):f==="pan"?w.to(b,{duration:o,translateX:_,translateY:y,ease:c,onUpdate:rt}):(h&&w.to(b,{duration:o*.3,scale:p*u,opacity:.95,ease:"power2.in",onUpdate:function(){const J=this.progress(),V=Y+(st-Y)*J*.3,pt=K+(G-K)*J*.3,Tt=E-V*b.scale,At=D-pt*b.scale,B=[b.scale,0,0,b.scale,Tt,At];n.setViewportTransform(B),b.translateX=Tt,b.translateY=At,ct(n,b.opacity),n.requestRenderAll()}}),w.to(b,{duration:o*(h?.7:1),scale:v,translateX:_,translateY:y,progress:1,opacity:1,ease:c,onUpdate:rt}));function rt(){const J=[b.scale,0,0,b.scale,b.translateX,b.translateY];n.setViewportTransform(J),b.opacity<1?ct(n,b.opacity):et(n),n.requestRenderAll()}function ct(J,V){J.getObjects().forEach(pt=>{pt._originalOpacity===void 0&&(pt._originalOpacity=pt.opacity),pt.set("opacity",pt._originalOpacity*V)})}function et(J){J.getObjects().forEach(V=>{V._originalOpacity!==void 0&&(V.set("opacity",V._originalOpacity),delete V._originalOpacity)})}return w},fadeIn:(n,i=.5)=>{const o=n.opacity||1,a=n.scaleX||1;return n.set({opacity:0,scaleX:a*.9,scaleY:a*.9}),Ei.to(n,{duration:i,opacity:o,scaleX:a,scaleY:a,ease:"power2.out"})},fadeOut:(n,i=.5)=>Ei.to(n,{duration:i,opacity:0,scaleX:n.scaleX*.9,scaleY:n.scaleY*.9,ease:"power2.in"}),rotateZoom:(n,i={})=>{const{duration:o=1.5,viewportTransform:a,rotation:l=0,onComplete:c,ease:h="power3.inOut"}=i,u=[...n.viewportTransform],f=u[0],d=u[4],p=u[5],g=a[0],m=a[4],v=a[5],_={scale:f,translateX:d,translateY:p,rotation:0};return Ei.to(_,{duration:o,scale:g,translateX:m,translateY:v,rotation:l,ease:h,onUpdate:function(){const y=_.rotation*Math.PI/180,b=Math.cos(y),w=Math.sin(y),A=[_.scale*b,_.scale*w,-_.scale*w,_.scale*b,_.translateX,_.translateY];n.setViewportTransform(A),n.requestRenderAll()},onComplete:c})}}}class mw{constructor(t){F(this,"canvas");F(this,"actions",[]);F(this,"currentActionIndex",nt(-1));F(this,"animation",pw());this.canvas=t,this.initializeEventHandlers()}initializeEventHandlers(){window.addEventListener("keydown",this.handleKeyDown.bind(this))}play(t){console.log("PresentPlayManager play actions:",t),this.actions=t,this.currentActionIndex.value=0,this.showInitialView()}showInitialView(){if(this.actions.length===0)return;const t=this.actions[0];if(t.type!=="pageframe")return;const e=rr(this.canvas,t.target),{zoomToFrame:s}=this.animation;s(this.canvas,{viewportTransform:e.transform,duration:1})}handleKeyDown(t){switch(console.log("handleKeyDown:",t.key),t.key){case"ArrowDown":case"ArrowRight":case" ":this.nextFrame();break;case"ArrowUp":case"ArrowLeft":this.previousFrame();break}}determineTransitionType(t,e){if(!t)return"initial";const s=rr(this.canvas,t.target),n=rr(this.canvas,e.target),i=n.left>=s.left&&n.top>=s.top&&n.right<=s.right&&n.bottom<=s.bottom,o=Math.abs(n.width-s.width)/s.width<.02&&Math.abs(n.height-s.height)/s.height<.02;return i?"zoom-in":o?"pan":"zoom-pan"}navigateToFrame(t){const e=this.currentActionIndex.value,s=e>=0?this.actions[e]:null,n=rr(this.canvas,t.target),{zoomToFrame:i}=this.animation,o=this.determineTransitionType(s,t);console.log("过渡类型:",o);let a=2,l=.9;if(s){const h=rr(this.canvas,s.target);this.canvas.setViewportTransform(n.currentTransform);const u=this.canvas.viewportTransform,f=h.centerX*u[0]+u[4],d=h.centerY*u[3]+u[5],p=n.centerX,g=n.centerY,m=Math.sqrt(Math.pow(f-p,2)+Math.pow(d-g,2)),v=5e3,_=1;a=_+(3-_)*Math.min(m/v,1),console.log("页面中心点距离:",m,"计算的动画时长:",a),o==="zoom-pan"&&(l=.8-(.8-.4)*Math.min(m/v,1),console.log("计算的退出缩放比例:",l))}const c={viewportTransform:n.transform,duration:o==="initial"?0:a,exitEffect:o!=="pan",exitScale:l,ease:"power3.inOut",transitionType:o,onComplete:()=>{console.log("Frame切换完成")}};i(this.canvas,c)}nextFrame(){this.currentActionIndex.value>=this.actions.length-1||(this.currentActionIndex.value++,this.navigateToFrame(this.actions[this.currentActionIndex.value]))}previousFrame(){if(this.currentActionIndex.value<=0){this.currentActionIndex.value=0,this.showInitialView();return}this.currentActionIndex.value--,this.navigateToFrame(this.actions[this.currentActionIndex.value])}destroy(){window.removeEventListener("keydown",this.handleKeyDown.bind(this)),this.actions=[],this.currentActionIndex.value=-1}}class vw{constructor(t,e){F(this,"currentMode",nt("edit"));F(this,"canvas");F(this,"presentationCanvas");F(this,"presentPlayManager",null);F(this,"lastPosX",0);F(this,"lastPosY",0);F(this,"isDragging",!1);this.canvas=t,this.presentationCanvas=e,this.initPresentationMode(),this.initPresentationEvents(),document.addEventListener("fullscreenchange",this.handleFullscreenChange.bind(this)),window.addEventListener("keydown",this.handleKeyDown.bind(this)),window.addEventListener("resize",this.handleResize.bind(this))}initPresentationMode(){}handleFullscreenChange(){!document.fullscreenElement&&this.currentMode.value==="present"&&this.exitPresentMode()}initPresentationEvents(){this.presentationCanvas.on("mouse:down",t=>{this.isDragging=!0,this.lastPosX=t.e.clientX,this.lastPosY=t.e.clientY,this.presentationCanvas.defaultCursor="grabbing"}),this.presentationCanvas.on("mouse:move",t=>{if(this.isDragging){const e=t.e.clientX-this.lastPosX,s=t.e.clientY-this.lastPosY,n=this.presentationCanvas.viewportTransform;n[4]+=e,n[5]+=s,this.presentationCanvas.setViewportTransform(n),this.lastPosX=t.e.clientX,this.lastPosY=t.e.clientY}}),this.presentationCanvas.on("mouse:up",()=>{this.isDragging=!1,this.presentationCanvas.defaultCursor="default"}),this.presentationCanvas.on("mouse:wheel",t=>{const e=t.e.deltaY;let s=this.presentationCanvas.getZoom();s*=.999**e,s=Math.min(Math.max(.1,s),20);const n={x:t.e.offsetX,y:t.e.offsetY};this.presentationCanvas.zoomToPoint(new M(n.x,n.y),s),t.e.preventDefault(),t.e.stopPropagation()})}async enterPresentMode(){this.currentMode.value="present",this.showPresentationCanvas(),this.presentPlayManager=new mw(this.presentationCanvas);const t=[];this.presentationCanvas.forEachObject(n=>{n.selectable=!0,n.lockMovementX=!0,n.lockMovementY=!0,n.lockRotation=!0,n.lockScalingX=!0,n.lockScalingY=!0,n.hasControls=!1,n.hasBorders=!0}),console.log("enterPresentMode:",this.presentationCanvas.getObjects());const e=this.presentationCanvas.getObjects().find(n=>n.type===ce.type);e&&t.push({type:"pageframe",target:e});const s=this.presentationCanvas.getObjects().filter(n=>n.type===zt.type);s.sort((n,i)=>(n.order||0)-(i.order||0)),s.forEach(n=>{t.push({type:"frame",target:n})}),console.log("playActions:",t),this.presentPlayManager.play(t)}exitPresentMode(){this.currentMode.value="edit",this.presentPlayManager&&(this.presentPlayManager.destroy(),this.presentPlayManager=null),this.hidePresentationCanvas()}async cloneCanvasContent(){console.log("开始克隆内容到演示画布"),this.presentationCanvas.clear(),this.presentationCanvas.setViewportTransform([1,0,0,1,0,0]);const t=this.canvas.getObjects();for(const e of t){console.log(`正在克隆对象: ${e.type}, id: ${e.id}`);try{await e.clone("type","name").then(s=>{(e.type==="pageframe"||e.type==="frame")&&s.set({stroke:"transparent",shadow:null,strokeWidth:0}),s.set({left:e.left,top:e.top,scaleX:e.scaleX,scaleY:e.scaleY,angle:e.angle,selectable:!0,lockMovementX:!0,lockMovementY:!0,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,hasControls:!0,hasBorders:!0}),console.log(`添加克隆对象到演示画布: ${e.type}, id: ${e.id}`),this.presentationCanvas.add(s)})}catch(s){console.error(`克隆对象失败: ${e.type}, id: ${e.id}`,s)}}console.log(`演示画布现在有 ${this.presentationCanvas.getObjects().length} 个对象`),this.presentationCanvas.requestRenderAll()}showPresentationCanvas(){if(this.canvas.wrapperEl&&(this.canvas.wrapperEl.style.display="none"),this.presentationCanvas.wrapperEl){const t=this.presentationCanvas.wrapperEl;Object.assign(t.style,{display:"block",position:"fixed",top:"0",left:"0",width:"100vw",height:"100vh",zIndex:"9999",backgroundColor:"#fff"}),this.ensureCanvasLayersVisible()}this.enterFullscreen(),this.adjustPresentationSize(),this.presentationCanvas.requestRenderAll()}ensureCanvasLayersVisible(){const t=this.presentationCanvas.lowerCanvasEl;t&&(t.style.display="block",t.style.visibility="visible");const e=this.presentationCanvas.upperCanvasEl;e&&(e.style.display="block",e.style.visibility="visible");const s=this.presentationCanvas.cacheCanvasEl;s&&(s.style.display="block",s.style.visibility="visible")}hidePresentationCanvas(){this.exitFullscreen(),this.presentationCanvas.wrapperEl&&(this.presentationCanvas.wrapperEl.style.display="none"),this.canvas.wrapperEl&&(this.canvas.wrapperEl.style.display="block")}handleKeyDown(t){if(this.currentMode.value==="present")switch(t.key){case"Escape":this.exitPresentMode();break}}handleResize(){this.currentMode.value==="present"&&this.adjustPresentationSize()}adjustPresentationSize(){const t=window.innerWidth,e=window.innerHeight;console.log(`调整演示画布尺寸: ${t}x${e}`),this.presentationCanvas.setDimensions({width:t,height:e}),this.presentationCanvas.requestRenderAll(),this.ensureCanvasLayersVisible(),console.log("演示画布状态:",{对象数量:this.presentationCanvas.getObjects().length,背景色:this.presentationCanvas.backgroundColor,尺寸:{width:this.presentationCanvas.width,height:this.presentationCanvas.height},视口变换:this.presentationCanvas.viewportTransform})}async enterFullscreen(){try{this.presentationCanvas.wrapperEl&&this.presentationCanvas.wrapperEl.requestFullscreen&&await this.presentationCanvas.wrapperEl.requestFullscreen()}catch(t){console.error("Failed to enter fullscreen:",t)}}async exitFullscreen(){try{document.fullscreenElement&&await document.exitFullscreen()}catch(t){console.error("Failed to exit fullscreen:",t)}}}class _w{constructor(t,e){F(this,"canvas");F(this,"canvasManager");F(this,"isSpaceDragging",!1);F(this,"clipboardObject",null);this.canvas=t,this.canvasManager=e,this.initSpaceDragMode(),this.initCopyPasteHandlers()}initSpaceDragMode(){window.addEventListener("keydown",this.handleKeyDown.bind(this)),window.addEventListener("keyup",this.handleKeyUp.bind(this))}initCopyPasteHandlers(){window.addEventListener("keydown",this.handleCopyPaste.bind(this))}handleKeyDown(t){t.code==="Space"&&!this.isSpaceDragging&&(this.isSpaceDragging=!0,this.canvas.defaultCursor="grab",this.canvas.selection=!1,this.canvas.forEachObject(e=>{e.selectable=!1,e.evented=!1}))}handleKeyUp(t){t.code==="Space"&&(this.isSpaceDragging=!1,this.canvas.defaultCursor="default",this.canvas.selection=!0,this.canvas.forEachObject(e=>{e.selectable=!0,e.evented=!0}))}pasteImageFromUrl(t){console.log("从URL粘贴图片到画布",t);let e=this.canvas.getVpCenter();const s=this.canvasManager.getControlsManager();if(!s){console.error("ControlsManager 不可用");return}s.addImage(t,{left:e.x,top:e.y,originX:"center",originY:"center"}).then(n=>{n&&console.log("已粘贴剪贴板图片",n)}).catch(n=>{console.error("粘贴剪贴板图片失败:",n),URL.revokeObjectURL(t)})}handleCopyPaste(t){if(t.ctrlKey){const e=this.canvas.getActiveObject();if(e&&"isEditing"in e&&e.isEditing)return;t.code==="KeyC"?(t.preventDefault(),t.stopPropagation(),this.handleCopy()):t.code==="KeyV"&&(t.preventDefault(),t.stopPropagation(),this.checkClipboardAndPaste())}}handleCopy(){const t=this.canvas.getActiveObject();t&&!(t instanceof Qt)&&t.clone().then(e=>{this.clipboardObject=e;const s=document.createElement("textarea");s.value="next-slide-object",s.style.position="fixed",s.style.left="-999999px",s.style.top="-999999px",document.body.appendChild(s),s.focus(),s.select();const n=document.execCommand("copy");document.body.removeChild(s),n?console.log("成功使用 execCommand 复制到剪贴板"):console.warn("execCommand 复制失败"),console.log("已复制对象",e)}).catch(e=>{console.error("复制对象失败:",e)})}async checkClipboardAndPaste(){try{const t=await navigator.clipboard.read();let e=!1;for(const s of t)if(s.types.includes("image/png")||s.types.includes("image/jpeg")||s.types.includes("image/gif")){const n=await s.getType(s.types.find(o=>o.startsWith("image/"))||"image/png"),i=URL.createObjectURL(n);this.pasteImageFromUrl(i),e=!0;break}!e&&this.clipboardObject&&this.handleInternalPaste()}catch(t){console.warn("无法读取系统剪贴板:",t),this.clipboardObject&&this.handleInternalPaste()}}async handleInternalPaste(){if(console.log("handleInternalPaste 粘贴事件触发"),!this.clipboardObject){console.log("剪贴板为空，没有可粘贴的对象");return}const t=this.canvas.getActiveObject();let e={x:this.canvas.width/2,y:this.canvas.height/2};if(t){const n=t.getCenterPoint();e={x:n.x,y:n.y}}const s=this.canvasManager.getControlsManager();if(!s){console.error("ControlsManager 不可用");return}try{const n=await s.addClonedObject(this.clipboardObject,{left:e.x,top:e.y,originX:"center",originY:"center"});n?(this.canvas.setActiveObject(n),this.canvas.requestRenderAll(),console.log("已粘贴对象",n)):console.error("粘贴对象失败: 无法创建克隆对象")}catch(n){console.error("粘贴对象失败:",n)}}isInSpaceDragMode(){return this.isSpaceDragging}destroy(){window.removeEventListener("keydown",this.handleKeyDown.bind(this)),window.removeEventListener("keyup",this.handleKeyUp.bind(this)),window.removeEventListener("keydown",this.handleCopyPaste.bind(this))}}class yw{constructor(t,e,s){F(this,"canvas");F(this,"canvasManager");F(this,"eventManager");F(this,"isDragging",!1);F(this,"lastPosX",0);F(this,"lastPosY",0);F(this,"currentHoverObject",null);this.canvas=t,this.canvasManager=e,this.eventManager=s,this.setupEventOverrides(),this.initMouseEvents()}initMouseEvents(){this.setupMouseDownEvents(),this.setupMouseMoveEvents(),this.setupMouseUpEvents(),this.setupMouseWheelEvents()}setupEventOverrides(){const t=this.canvas,e=this.canvas.findTarget;this.canvas.findTarget=function(s){const n=this.getPointer(s,!0),i=new M(n.x,n.y),{target:o}=Jl(t,i);return o||e.call(this,s)}}setupMouseDownEvents(){this.canvas.on("mouse:down",t=>{if(this.eventManager.getKeyboardHandler().isInSpaceDragMode())this.isDragging=!0,this.canvas.selection=!1,this.canvas.defaultCursor="grabbing";else{this.isDragging=!1,this.canvas.selection=!0;const e=this.canvas.getViewportPoint(t);console.log("[MouseEventHandler] mouse:down：",e);const s=new M(e.x,e.y),{target:n}=Jl(this.canvas,s);if(n){this.canvas.setActiveObject(n),this.canvas.requestRenderAll(),t.target=n;return}}this.lastPosX=t.e.clientX,this.lastPosY=t.e.clientY})}setupMouseMoveEvents(){let t=null;this.canvas.on("mouse:move",e=>{if(this.isDragging){if(t)return;t=requestAnimationFrame(()=>{const n=e.e.clientX-this.lastPosX,i=e.e.clientY-this.lastPosY,o=this.canvas.viewportTransform;o[4]+=n,o[5]+=i,this.canvas.setViewportTransform(o),this.lastPosX=e.e.clientX,this.lastPosY=e.e.clientY,t=null});return}const s=this.canvas.getViewportPoint(e);this.eventManager.getKeyboardHandler().isInSpaceDragMode()||this.canvas.isDraggingObject||this.handleObjectHover(s)})}handleObjectHover(t){this.canvas.defaultCursor="default";const e=new M(t.x,t.y),{target:s}=Jl(this.canvas,e);this.currentHoverObject!==s&&(this.currentHoverObject&&(this.canvas.getActiveObjects().includes(this.currentHoverObject)||this.handleHoverOut(this.currentHoverObject)),s&&(this.canvas.getActiveObjects().includes(s)||this.handleHoverIn(s)),this.currentHoverObject=s,this.canvas.requestRenderAll())}setupMouseUpEvents(){this.canvas.on("mouse:up",()=>{this.isDragging=!1,this.eventManager.getKeyboardHandler().isInSpaceDragMode()?this.canvas.defaultCursor="grab":this.canvas.selection=!0})}setupMouseWheelEvents(){this.canvas.on("mouse:wheel",t=>{const e=t.e.deltaY;let s=this.canvas.getZoom();s*=.999**e,s=Math.min(Math.max(Ys.MIN_ZOOM,s),Ys.MAX_ZOOM);const n={x:t.e.offsetX,y:t.e.offsetY};this.canvas.zoomToPoint(new M(n.x,n.y),s),t.e.preventDefault(),t.e.stopPropagation()})}handleHoverIn(t){if(t.type==="text"&&typeof t.showBorder=="function"){t.showBorder(!0);return}t._originalCustomBorderColor||this.saveOriginalState(t),t._originalHoverCursor||(t._originalHoverCursor=t.hoverCursor,t.hoverCursor="default");const e=this.canvas.getZoom(),s={borderColor:Me.BORDER.HOVER,strokeWidth:Ys.STROKE_WIDTH/e,borderScaleFactor:Ys.BORDER_SCALE_FACTOR};t.type!=="text"&&t.type!=="textbox"&&(s.customBorderColor=Me.BORDER.HOVER),t.set(s)}handleHoverOut(t){if(t.type==="text"&&typeof t.showBorder=="function"){t.showBorder(!1);return}t._originalHoverCursor!==void 0&&(t.hoverCursor=t._originalHoverCursor,delete t._originalHoverCursor),this.restoreOriginalState(t)}saveOriginalState(t){t._originalBorderColor=t.borderColor,t._originalStroke=t.stroke,t._originalCustomBorderColor=t.customBorderColor,t._originalStrokeWidth=t.strokeWidth,t._originalBorderScaleFactor=t.borderScaleFactor,t._originalHoverCursor=t.hoverCursor}restoreOriginalState(t){if(t._originalCustomBorderColor!==void 0){const e={borderColor:t._originalBorderColor,strokeWidth:t._originalStrokeWidth,borderScaleFactor:t._originalBorderScaleFactor};t.type!=="text"&&t.type!=="textbox"&&(e.customBorderColor=t._originalCustomBorderColor),t.set(e),delete t._originalBorderColor,delete t._originalStroke,delete t._originalStrokeWidth,delete t._originalBorderScaleFactor,delete t._originalCustomBorderColor,t._originalHoverCursor!==void 0&&(t.hoverCursor=t._originalHoverCursor,delete t._originalHoverCursor),this.canvas.requestRenderAll()}}destroy(){this.canvas.off("mouse:down"),this.canvas.off("mouse:move"),this.canvas.off("mouse:up"),this.canvas.off("mouse:wheel")}}class bw{constructor(t,e){F(this,"canvas");F(this,"canvasManager");this.canvas=t,this.canvasManager=e,this.setupObjectEvents()}setupObjectEvents(){this.canvas.on("object:added",t=>{const e=t.target;e&&yt.emit(ft.CANVAS.CANVAS_UPDATE,{type:ft.CANVAS.CANVAS_UPDATE,target:e})}),this.canvas.on("object:moving",t=>{t.target,this.canvas.isDraggingObject=!0}),this.canvas.on("object:scaling",t=>{t.target}),this.canvas.on("object:rotating",t=>{t.target}),this.canvas.on("object:modified",t=>{this.canvas.isDraggingObject=!1;const e=t.target;e&&yt.emit(ft.CANVAS.CANVAS_UPDATE,{type:ft.CANVAS.CANVAS_UPDATE,target:e})}),this.canvas.on("object:removed",t=>{console.log("object:removed",t);const e=t.target;e&&yt.emit(ft.CANVAS.CANVAS_UPDATE,{type:ft.CANVAS.CANVAS_UPDATE,target:e})})}destroy(){this.canvas.off("object:added"),this.canvas.off("object:modified"),this.canvas.off("object:removed"),this.canvas.off("object:moving"),this.canvas.off("object:scaling"),this.canvas.off("object:rotating")}}class xw{constructor(t,e){F(this,"canvas");F(this,"canvasManager");this.canvas=t,this.canvasManager=e,this.setupSelectionEvents()}setupSelectionEvents(){this.canvas.on("selection:created",this.handleSelection.bind(this)),this.canvas.on("selection:updated",this.handleSelection.bind(this)),this.canvas.on("selection:cleared",this.handleSelectionCleared.bind(this))}handleSelection(t){var s;const e=(s=t.selected)==null?void 0:s[0];e&&(this.handleSelectionEventBorderStatus(t),e.type==="text"||e.type==="textbox"?this.showTextSettingToolbar(e):this.hideTextSettingToolbar(),e.type===zt.type?this.canvasManager.getFrameManager().setCurrentFrame(e):e.type===ce.type&&this.canvasManager.getFrameManager().setCurrentFrame(null),this.toggleFrameNumberControls(e))}handleSelectionCleared(t){this.canvasManager.getFrameManager().setCurrentFrame(null),this.handleSelectionEventBorderStatus(t),this.toggleFrameNumberControls(null),this.hideTextSettingToolbar()}handleSelectionEventBorderStatus(t){const e=t.deselected;if((e==null?void 0:e.length)>0)e.forEach(s=>{if(s.type==="text"&&typeof s.showBorder=="function"){s.showBorder(!1);return}this.restoreOriginalState(s)});else{const s=t.selected;(s==null?void 0:s.length)>0&&s.forEach(n=>{if(n.type==="frame"){n._originalCustomBorderColor===void 0&&(n._originalBorderColor=n.borderColor,n._originalCustomBorderColor=n.customBorderColor,n._originalStrokeWidth=n.strokeWidth,n._originalBorderScaleFactor=n.borderScaleFactor,n.set({borderColor:Me.BORDER.HOVER,customBorderColor:Me.BORDER.HOVER,strokeWidth:Ys.STROKE_WIDTH}),this.canvas.requestRenderAll());return}})}}restoreOriginalState(t){if(t._originalCustomBorderColor!==void 0){const e={borderColor:t._originalBorderColor};t.type!=="text"&&t.type!=="textbox"&&(e.customBorderColor=t._originalCustomBorderColor),t.set(e),delete t._originalBorderColor,delete t._originalStroke,delete t._originalStrokeWidth,delete t._originalBorderScaleFactor,delete t._originalCustomBorderColor,this.canvas.requestRenderAll()}}toggleFrameNumberControls(t){if(!t){console.log("隐藏所有Frame的控件"),this.hideAllFrameNumberControls();return}this.canvas.getActiveObjects().length>0&&this.hasFrameSelected()?this.showAllFrameNumberControls(t):this.hideAllFrameNumberControls()}hasFrameSelected(){return this.canvas.getActiveObjects().some(e=>e instanceof zt)}showAllFrameNumberControls(t){this.canvas.getObjects().forEach(s=>{s instanceof zt&&(s.setNumberControlVisibility(!0),s.isCurrentSelected=s===t)}),this.canvas.requestRenderAll()}hideAllFrameNumberControls(){this.canvas.getObjects().forEach(e=>{e instanceof zt&&(e.setNumberControlVisibility(!1),e.isCurrentSelected=!1)}),this.canvas.requestRenderAll()}showTextSettingToolbar(t){!t||t.type!=="text"&&t.type!=="textbox"||yt.emit(ft.CONTROL_PANEL.SHOW_TEXT_SETTING_TOOLBAR,{target:t,canvas:this.canvas,canvasManager:this.canvasManager})}hideTextSettingToolbar(){yt.emit(ft.CONTROL_PANEL.HIDE_TEXT_SETTING_TOOLBAR)}destroy(){this.canvas.off("selection:created"),this.canvas.off("selection:updated"),this.canvas.off("selection:cleared")}}class Cw{constructor(t,e){F(this,"keyboardHandler");F(this,"mouseHandler");F(this,"objectEventHandler");F(this,"selectionEventHandler");this.keyboardHandler=new _w(t,e),this.mouseHandler=new yw(t,e,this),this.objectEventHandler=new bw(t,e),this.selectionEventHandler=new xw(t,e)}getKeyboardHandler(){return this.keyboardHandler}getMouseHandler(){return this.mouseHandler}destroy(){this.keyboardHandler.destroy(),this.mouseHandler.destroy()}}class ww{constructor(t,e){F(this,"syncEnabled",!0);F(this,"syncDebounceTimer",null);F(this,"syncInProgress",!1);F(this,"pendingSync",!1);F(this,"backgroundColorListener",null);F(this,"backgroundImageListener",null);this.sourceCanvas=t,this.targetCanvas=e,this.initCanvasSyncEvents()}initCanvasSyncEvents(){this.sourceCanvas.on("object:added",()=>this.debounceSyncCanvases()),this.sourceCanvas.on("object:removed",()=>this.debounceSyncCanvases()),this.sourceCanvas.on("object:modified",()=>this.debounceSyncCanvases()),this.sourceCanvas.on("after:render",()=>{this.pendingSync&&!this.syncInProgress&&this.syncCanvases()}),this.backgroundColorListener=t=>{console.log("背景颜色变化:",t,t.canvas,this.sourceCanvas,t.canvas===this.sourceCanvas),t&&(console.log("同步背景色:",this.sourceCanvas),this.debounceSyncCanvases())},yt.on(ft.CANVAS.BACKGROUND_COLOR_CHANGE,this.backgroundColorListener),this.backgroundImageListener=t=>{t&&this.debounceSyncCanvases()},yt.on(ft.CANVAS.BACKGROUND_IMAGE_CHANGE,this.backgroundImageListener)}debounceSyncCanvases(t=500){if(this.syncEnabled){if(this.syncInProgress){this.pendingSync=!0;return}this.syncDebounceTimer!==null&&window.clearTimeout(this.syncDebounceTimer),this.syncDebounceTimer=window.setTimeout(()=>{this.syncCanvases()},t)}}async syncCanvases(){if(!(!this.syncEnabled||this.syncInProgress)){this.syncInProgress=!0,this.pendingSync=!1;try{if(this.targetCanvas.clear(),this.sourceCanvas.backgroundColor&&(this.targetCanvas.backgroundColor=this.sourceCanvas.backgroundColor),this.sourceCanvas.backgroundImage)try{const n=this.sourceCanvas.backgroundImage;if(typeof n.getSrc=="function"){const i=n.getSrc();i&&we.fromURL(i,{crossOrigin:"anonymous"}).then(o=>{o&&(o.scaleX=n.scaleX||1,o.scaleY=n.scaleY||1,o.left=n.left||0,o.top=n.top||0,o.originX=n.originX||"left",o.originY=n.originY||"top",o.width=n.width,o.height=n.height,this.targetCanvas.backgroundImage=o,this.targetCanvas.requestRenderAll())})}else try{const i=await n.clone();this.targetCanvas.backgroundImage=i,this.targetCanvas.requestRenderAll()}catch(i){console.error("背景图片克隆失败，尝试备选方法:",i);const o=n.toJSON(),a=await Dn.enlivenObjects([o]);a&&a[0]&&(this.targetCanvas.backgroundImage=a[0],this.targetCanvas.requestRenderAll())}}catch(n){console.error("背景图片同步失败:",n)}const e=this.sourceCanvas.getObjects().map(n=>new Promise(async i=>{try{const o=await n.clone();i(o)}catch(o){console.error(`克隆对象失败: ${n.type}`,o);const a=new ne;i(a)}}));(await Promise.all(e)).forEach(n=>{if(!n)return;n.hasOwnProperty("controls")&&(n.controls={});const i=n.type;(i===zt.type||i===ce.type||i===Qt.type)&&(n.customBorderColor="transparent",n.fill="transparent",n.backgroundColor="transparent",n.stroke="transparent",i===zt.type&&typeof n.setNumberControlVisibility=="function"&&n.setNumberControlVisibility(!1),n.selectable=!1,n.hoverCursor="default"),this.targetCanvas.add(n)}),this.targetCanvas.requestRenderAll(),this.syncInProgress=!1,this.pendingSync&&requestAnimationFrame(()=>this.syncCanvases())}catch(t){console.error("同步画布失败:",t),this.syncInProgress=!1}}}enableSync(t=!0){this.syncEnabled=t,t&&!this.syncInProgress&&this.syncCanvases()}forceSyncCanvases(){this.syncDebounceTimer!==null&&(window.clearTimeout(this.syncDebounceTimer),this.syncDebounceTimer=null),this.syncCanvases()}destroy(){this.syncDebounceTimer!==null&&(window.clearTimeout(this.syncDebounceTimer),this.syncDebounceTimer=null),this.sourceCanvas.off("object:added"),this.sourceCanvas.off("object:removed"),this.sourceCanvas.off("object:modified"),this.sourceCanvas.off("after:render"),this.backgroundColorListener&&(yt.off(ft.CANVAS.BACKGROUND_COLOR_CHANGE,this.backgroundColorListener),this.backgroundColorListener=null),this.backgroundImageListener&&(yt.off(ft.CANVAS.BACKGROUND_IMAGE_CHANGE,this.backgroundImageListener),this.backgroundImageListener=null)}}const Sw="6.6.1",Tw=JSON.parse('[{"cropX":0,"cropY":0,"type":"Image","version":"6.6.1","originX":"center","originY":"center","left":828.5197,"top":295.9689,"width":30,"height":40,"fill":"rgb(0,0,0)","stroke":null,"strokeWidth":0.7407,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":false,"strokeMiterLimit":4,"scaleX":2.2044,"scaleY":2.1987,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0,"src":"data:image/svg+xml,%3c?xml%20version=%271.0%27?%3e%3csvg%20width=%2730%27%20height=%2740%27%20xmlns=%27http://www.w3.org/2000/svg%27%20xmlns:svg=%27http://www.w3.org/2000/svg%27%3e%3cg%20class=%27layer%27%3e%3ctitle%20_mstHash=%271%27%20_mstTextHash=%275637814%27%3e%E7%AC%AC%201%20%E5%B1%82%3c/title%3e%3cg%20fill=%27%23333333%27%20id=%27svg_1%27%20stroke=%27%23333333%27%20stroke-width=%272%27%20transform=%27rotate(-90%2015%2019.7952)%27%3e%3c!--%20%E7%AC%AC%E4%B8%80%E4%B8%AA%E7%AE%AD%E5%A4%B4%20--%3e%3cpolygon%20id=%27svg_2%27%20points=%277.75571882724762,9.741044044494629%2016.73842203617096,19.741044998168945%207.75571882724762,29.741044998168945%2013.369908332824707,29.741044998168945%2022.352611541748047,19.741044998168945%2013.369908332824707,9.741044044494629%20%27%20transform=%27rotate(90%2015%2019.741)%27/%3e%3c/g%3e%3c/g%3e%3c/svg%3e","crossOrigin":"anonymous","filters":[]},{"cropX":0,"cropY":0,"type":"Image","version":"6.6.1","originX":"center","originY":"center","left":866.5317,"top":295.968,"width":30,"height":40,"fill":"rgb(0,0,0)","stroke":null,"strokeWidth":0.2317,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":false,"strokeMiterLimit":4,"scaleX":2.2044,"scaleY":2.1987,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0,"src":"data:image/svg+xml,%3c?xml%20version=%271.0%27?%3e%3csvg%20width=%2730%27%20height=%2740%27%20xmlns=%27http://www.w3.org/2000/svg%27%20xmlns:svg=%27http://www.w3.org/2000/svg%27%3e%3cg%20class=%27layer%27%3e%3ctitle%20_mstHash=%271%27%20_mstTextHash=%275637814%27%3e%E7%AC%AC%201%20%E5%B1%82%3c/title%3e%3cg%20fill=%27%23333333%27%20id=%27svg_1%27%20stroke=%27%23333333%27%20stroke-width=%272%27%20transform=%27rotate(-90%2015%2019.7952)%27%3e%3c!--%20%E7%AC%AC%E4%B8%80%E4%B8%AA%E7%AE%AD%E5%A4%B4%20--%3e%3cpolygon%20id=%27svg_2%27%20points=%277.75571882724762,9.741044044494629%2016.73842203617096,19.741044998168945%207.75571882724762,29.741044998168945%2013.369908332824707,29.741044998168945%2022.352611541748047,19.741044998168945%2013.369908332824707,9.741044044494629%20%27%20transform=%27rotate(90%2015%2019.741)%27/%3e%3c/g%3e%3c/g%3e%3c/svg%3e","crossOrigin":"anonymous","filters":[]},{"cropX":0,"cropY":0,"type":"Image","version":"6.6.1","originX":"center","originY":"center","left":902.5522,"top":295.968,"width":30,"height":40,"fill":"rgb(0,0,0)","stroke":null,"strokeWidth":0.2317,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":false,"strokeMiterLimit":4,"scaleX":2.2044,"scaleY":2.1987,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0,"src":"data:image/svg+xml,%3c?xml%20version=%271.0%27?%3e%3csvg%20width=%2730%27%20height=%2740%27%20xmlns=%27http://www.w3.org/2000/svg%27%20xmlns:svg=%27http://www.w3.org/2000/svg%27%3e%3cg%20class=%27layer%27%3e%3ctitle%20_mstHash=%271%27%20_mstTextHash=%275637814%27%3e%E7%AC%AC%201%20%E5%B1%82%3c/title%3e%3cg%20fill=%27%23333333%27%20id=%27svg_1%27%20stroke=%27%23333333%27%20stroke-width=%272%27%20transform=%27rotate(-90%2015%2019.7952)%27%3e%3c!--%20%E7%AC%AC%E4%B8%80%E4%B8%AA%E7%AE%AD%E5%A4%B4%20--%3e%3cpolygon%20id=%27svg_2%27%20points=%277.75571882724762,9.741044044494629%2016.73842203617096,19.741044998168945%207.75571882724762,29.741044998168945%2013.369908332824707,29.741044998168945%2022.352611541748047,19.741044998168945%2013.369908332824707,9.741044044494629%20%27%20transform=%27rotate(90%2015%2019.741)%27/%3e%3c/g%3e%3c/g%3e%3c/svg%3e","crossOrigin":"anonymous","filters":[]},{"fontSize":20,"fontWeight":"normal","fontFamily":"Cambria","fontStyle":"normal","lineHeight":1.16,"text":"欢迎使用Next-Slides","charSpacing":0,"textAlign":"center","styles":[],"pathStartOffset":0,"pathSide":"left","pathAlign":"baseline","underline":false,"overline":false,"linethrough":false,"textBackgroundColor":"","direction":"ltr","type":"Text","version":"6.6.1","originX":"left","originY":"top","left":463.3264,"top":262.4178,"width":175.9766,"height":22.6,"fill":"#333333","stroke":null,"strokeWidth":0.3707,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":false,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0},{"fontSize":10,"fontWeight":"normal","fontFamily":"Times New Roman","fontStyle":"normal","lineHeight":1.16,"text":"下一代演示系统","charSpacing":0,"textAlign":"center","styles":[],"pathStartOffset":0,"pathSide":"left","pathAlign":"baseline","underline":false,"overline":false,"linethrough":false,"textBackgroundColor":"","direction":"ltr","type":"Text","version":"6.6.1","originX":"left","originY":"top","left":517.5772,"top":317.8306,"width":70,"height":11.3,"fill":"#333333","stroke":null,"strokeWidth":0.3707,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":false,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0},{"fontSize":10,"fontWeight":"normal","fontFamily":"Times New Roman","fontStyle":"normal","lineHeight":1.16,"text":"将你的奇思妙想变成精彩的演示","charSpacing":0,"textAlign":"center","styles":[],"pathStartOffset":0,"pathSide":"left","pathAlign":"baseline","underline":false,"overline":false,"linethrough":false,"textBackgroundColor":"","direction":"ltr","type":"Text","version":"6.6.1","originX":"left","originY":"top","left":994.707,"top":232.0068,"width":140,"height":11.3,"fill":"#333333","stroke":null,"strokeWidth":0.2317,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":false,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0},{"fontSize":5,"fontWeight":"normal","fontFamily":"Times New Roman","fontStyle":"normal","lineHeight":1.16,"text":"在画布上自由创作\\n\\n不受线性幻灯片限制，让你自由轻松创建炫酷演示文稿","charSpacing":0,"textAlign":"center","styles":[],"pathStartOffset":0,"pathSide":"left","pathAlign":"baseline","underline":false,"overline":false,"linethrough":false,"textBackgroundColor":"","direction":"ltr","type":"Text","version":"6.6.1","originX":"left","originY":"top","left":1004.707,"top":274.1714,"width":120,"height":18.758,"fill":"#333333","stroke":null,"strokeWidth":0.2317,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":false,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0},{"fontSize":8,"fontWeight":"normal","fontFamily":"Times New Roman","fontStyle":"normal","lineHeight":1.16,"text":"让你的想法脱颖而出","charSpacing":0,"textAlign":"center","styles":[],"pathStartOffset":0,"pathSide":"left","pathAlign":"baseline","underline":false,"overline":false,"linethrough":false,"textBackgroundColor":"","direction":"ltr","type":"Text","version":"6.6.1","originX":"left","originY":"top","left":1049.5254,"top":445.4169,"width":72,"height":9.04,"fill":"#333333","stroke":null,"strokeWidth":0.8174,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":false,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0},{"fontSize":5,"fontWeight":"normal","fontFamily":"Times New Roman","fontStyle":"normal","lineHeight":1.16,"text":"告别枯燥的幻灯片\\n使用Next-Slides让你的演示炫酷起来","charSpacing":0,"textAlign":"center","styles":[],"pathStartOffset":0,"pathSide":"left","pathAlign":"baseline","underline":false,"overline":false,"linethrough":false,"textBackgroundColor":"","direction":"ltr","type":"Text","version":"6.6.1","originX":"left","originY":"top","left":1046.2212,"top":477.2295,"width":78.6084,"height":12.204,"fill":"#fda085","stroke":null,"strokeWidth":0.1908,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":false,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0},{"fontSize":19.994,"fontWeight":"normal","fontFamily":"Times New Roman","fontStyle":"normal","lineHeight":1.16,"text":"就这些吗？","charSpacing":0,"textAlign":"center","styles":[],"pathStartOffset":0,"pathSide":"left","pathAlign":"baseline","underline":false,"overline":false,"linethrough":false,"textBackgroundColor":"","direction":"ltr","type":"Text","version":"6.6.1","originX":"left","originY":"top","left":1260.1936,"top":709.6608,"width":99.97,"height":22.5932,"fill":"#FFFFFF","stroke":null,"strokeWidth":0.2689,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":false,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"transparent","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0},{"fontSize":24,"fontWeight":"normal","fontFamily":"Times New Roman","fontStyle":"normal","lineHeight":1.16,"text":"当然不是！","charSpacing":0,"textAlign":"left","styles":[],"pathStartOffset":0,"pathSide":"left","pathAlign":"baseline","underline":false,"overline":false,"linethrough":false,"textBackgroundColor":"","direction":"ltr","type":"Text","version":"6.6.1","originX":"left","originY":"top","left":550.3146,"top":674.289,"width":120,"height":27.12,"fill":"#FFFFFF","stroke":null,"strokeWidth":0.3707,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":false,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0},{"rx":3,"ry":3,"type":"pageframe","id":"5090c548-5b77-4a91-b265-686e774deadc","customBorderColor":"rgba(0, 0, 0, 0.4)","customControls":[],"controlsVisibilityMap":{},"version":"6.6.1","originX":"left","originY":"top","left":239.5,"top":109.5,"width":1280,"height":720,"fill":"rgba(255, 255, 255, 0)","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":0.8,"shadow":{"color":"rgba(0, 0, 0, 0.1)","blur":15,"offsetX":0,"offsetY":0,"affectStroke":false,"nonScaling":false,"type":"shadow"},"visible":true,"backgroundColor":"rgba(255, 255, 255, 0)","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0},{"rx":3,"ry":3,"parentPage":{"rx":3,"ry":3,"type":"slides","id":"5090c548-5b77-4a91-b265-686e774deadc","customBorderColor":"rgba(0, 0, 0, 0.4)","customControls":[],"controlsVisibilityMap":{},"version":"6.6.1","originX":"left","originY":"top","left":239.5,"top":109.5,"width":1280,"height":720,"fill":"rgba(255, 255, 255, 0)","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":0.8,"shadow":{"color":"rgba(0, 0, 0, 0.1)","blur":15,"offsetX":0,"offsetY":0,"affectStroke":false,"nonScaling":false,"type":"shadow"},"visible":true,"backgroundColor":"rgba(255, 255, 255, 0)","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0},"contents":{},"order":5,"isCurrentSelected":true,"type":"frame","id":"b73fd9a2-49b1-40f9-bfb0-343f7e9ff8c6","customBorderColor":"rgba(0, 0, 0, 0.4)","customControls":["frameNumberCorner"],"controlsVisibilityMap":{"frameNumberCorner":true},"version":"6.6.1","originX":"left","originY":"top","left":320.5,"top":571,"width":579,"height":326,"fill":"rgba(255, 255, 255, 0)","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":0.8,"shadow":{"color":"rgba(0, 0, 0, 0.1)","blur":15,"offsetX":0,"offsetY":0,"affectStroke":false,"nonScaling":false,"type":"shadow"},"visible":true,"backgroundColor":"rgba(255, 255, 255, 0)","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0},{"rx":3,"ry":3,"parentPage":{"rx":3,"ry":3,"type":"slides","id":"5090c548-5b77-4a91-b265-686e774deadc","customBorderColor":"rgba(0, 0, 0, 0.4)","customControls":[],"controlsVisibilityMap":{},"version":"6.6.1","originX":"left","originY":"top","left":239.5,"top":109.5,"width":1280,"height":720,"fill":"rgba(255, 255, 255, 0)","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":0.8,"shadow":{"color":"rgba(0, 0, 0, 0.1)","blur":15,"offsetX":0,"offsetY":0,"affectStroke":false,"nonScaling":false,"type":"shadow"},"visible":true,"backgroundColor":"rgba(255, 255, 255, 0)","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0},"contents":{},"order":4,"isCurrentSelected":false,"type":"frame","id":"e4fb2db4-3264-45d3-9e29-fffbfb3d1850","customBorderColor":"rgba(0, 0, 0, 0.4)","customControls":["frameNumberCorner"],"controlsVisibilityMap":{"frameNumberCorner":true},"version":"6.6.1","originX":"left","originY":"top","left":1100.0992,"top":615.9303,"width":579,"height":326,"fill":"rgba(255, 255, 255, 0)","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":0.7244,"scaleY":0.7244,"angle":0,"flipX":false,"flipY":false,"opacity":0.8,"shadow":{"color":"rgba(0, 0, 0, 0.1)","blur":15,"offsetX":0,"offsetY":0,"affectStroke":false,"nonScaling":false,"type":"shadow"},"visible":true,"backgroundColor":"rgba(255, 255, 255, 0)","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0},{"rx":3,"ry":3,"parentPage":{"rx":3,"ry":3,"type":"slides","id":"5090c548-5b77-4a91-b265-686e774deadc","customBorderColor":"rgba(0, 0, 0, 0.4)","customControls":[],"controlsVisibilityMap":{},"version":"6.6.1","originX":"left","originY":"top","left":239.5,"top":109.5,"width":1280,"height":720,"fill":"rgba(255, 255, 255, 0)","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":0.8,"shadow":{"color":"rgba(0, 0, 0, 0.1)","blur":15,"offsetX":0,"offsetY":0,"affectStroke":false,"nonScaling":false,"type":"shadow"},"visible":true,"backgroundColor":"rgba(255, 255, 255, 0)","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0},"contents":{},"order":3,"isCurrentSelected":false,"type":"frame","id":"0c9accec-c402-4da5-b115-0006a8df5d24","customBorderColor":"rgba(0, 0, 0, 0.4)","customControls":["frameNumberCorner"],"controlsVisibilityMap":{"frameNumberCorner":true},"version":"6.6.1","originX":"left","originY":"top","left":936.5205,"top":402.6592,"width":579,"height":326,"fill":"rgba(255, 255, 255, 0)","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":0.5133,"scaleY":0.5133,"angle":0,"flipX":false,"flipY":false,"opacity":0.8,"shadow":{"color":"rgba(0, 0, 0, 0.1)","blur":15,"offsetX":0,"offsetY":0,"affectStroke":false,"nonScaling":false,"type":"shadow"},"visible":true,"backgroundColor":"rgba(255, 255, 255, 0)","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0},{"rx":3,"ry":3,"parentPage":{"rx":3,"ry":3,"type":"slides","id":"5090c548-5b77-4a91-b265-686e774deadc","customBorderColor":"rgba(0, 0, 0, 0.4)","customControls":[],"controlsVisibilityMap":{},"version":"6.6.1","originX":"left","originY":"top","left":239.5,"top":109.5,"width":1280,"height":720,"fill":"rgba(255, 255, 255, 0)","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":0.8,"shadow":{"color":"rgba(0, 0, 0, 0.1)","blur":15,"offsetX":0,"offsetY":0,"affectStroke":false,"nonScaling":false,"type":"shadow"},"visible":true,"backgroundColor":"rgba(255, 255, 255, 0)","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0},"contents":{},"order":2,"isCurrentSelected":false,"type":"frame","id":"8bc0c160-4ce9-41d2-acdc-9bc1cbad89ba","customBorderColor":"rgba(0, 0, 0, 0.4)","customControls":["frameNumberCorner"],"controlsVisibilityMap":{"frameNumberCorner":true},"version":"6.6.1","originX":"left","originY":"top","left":886.3896,"top":186.3568,"width":579,"height":326,"fill":"rgba(255, 255, 255, 0)","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":0.6238,"scaleY":0.6238,"angle":0,"flipX":false,"flipY":false,"opacity":0.8,"shadow":{"color":"rgba(0, 0, 0, 0.1)","blur":15,"offsetX":0,"offsetY":0,"affectStroke":false,"nonScaling":false,"type":"shadow"},"visible":true,"backgroundColor":"rgba(255, 255, 255, 0)","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0},{"rx":3,"ry":3,"parentPage":{"rx":3,"ry":3,"type":"slides","id":"5090c548-5b77-4a91-b265-686e774deadc","customBorderColor":"rgba(0, 0, 0, 0.4)","customControls":[],"controlsVisibilityMap":{},"version":"6.6.1","originX":"left","originY":"top","left":239.5,"top":109.5,"width":1280,"height":720,"fill":"rgba(255, 255, 255, 0)","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":0.8,"shadow":{"color":"rgba(0, 0, 0, 0.1)","blur":15,"offsetX":0,"offsetY":0,"affectStroke":false,"nonScaling":false,"type":"shadow"},"visible":true,"backgroundColor":"rgba(255, 255, 255, 0)","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0},"contents":{},"order":1,"isCurrentSelected":false,"type":"frame","id":"592b582c-f3ec-44fe-a250-e082191802da","customBorderColor":"rgba(0, 0, 0, 0.4)","customControls":["frameNumberCorner"],"controlsVisibilityMap":{"frameNumberCorner":true},"version":"6.6.1","originX":"left","originY":"top","left":261.5,"top":186.3568,"width":579,"height":326,"fill":"rgba(255, 255, 255, 0)","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":0.8,"shadow":{"color":"rgba(0, 0, 0, 0.1)","blur":15,"offsetX":0,"offsetY":0,"affectStroke":false,"nonScaling":false,"type":"shadow"},"visible":true,"backgroundColor":"rgba(255, 255, 255, 0)","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0}]'),Ow="#E1F5FE",kw={cropX:0,cropY:0,type:"Image",version:"6.6.1",originX:"center",originY:"center",left:880,top:470,width:2133,height:1200,fill:"rgb(0,0,0)",stroke:null,strokeWidth:0,strokeDashArray:null,strokeLineCap:"butt",strokeDashOffset:0,strokeLineJoin:"miter",strokeUniform:!1,strokeMiterLimit:4,scaleX:.8251,scaleY:.8251,angle:0,flipX:!1,flipY:!1,opacity:1,shadow:null,visible:!0,backgroundColor:"",fillRule:"nonzero",paintFirst:"fill",globalCompositeOperation:"source-over",skewX:0,skewY:0,src:"https://picsum.photos/id/16/2133/1200",crossOrigin:"anonymous",filters:[]},Mw={version:Sw,objects:Tw,background:Ow,backgroundImage:kw};class Ew{constructor(t,e,s,n={}){F(this,"controlsManager");F(this,"canvas");F(this,"presentationCanvas");F(this,"canvasSyncManager");F(this,"pageFrameManager");F(this,"frameManager");F(this,"modeManager");F(this,"eventManager");F(this,"isDragging",!1);F(this,"lastPosX",0);F(this,"lastPosY",0);F(this,"contextMenuManager");F(this,"isSpaceDragging",!1);const i={width:s.clientWidth,height:s.clientHeight,backgroundColor:"#00000000",selection:!0,preserveObjectStacking:!0,allowTouchScrolling:!1,stopContextMenu:!0,skipOffscreen:!0,fireRightClick:!1,fireMiddleClick:!1,enableRetinaScaling:!0,renderOnAddRemove:!0,stateful:!1,...n};this.canvas=new Ur(t,i),this.canvas.viewportTransform=[1,0,0,1,0,0],this.presentationCanvas=new io(e,{...i,selection:!1}),this.presentationCanvas.viewportTransform=[1,0,0,1,0,0],this.canvasSyncManager=new ww(this.canvas,this.presentationCanvas),this.canvas.wrapperEl.style.transform="translateZ(0)",this.canvas.wrapperEl.style.backfaceVisibility="hidden",this.canvas.wrapperEl.style.perspective="1000px",this.canvas.wrapperEl.style.willChange="transform",this.presentationCanvas.wrapperEl.style.transform="translateZ(0)",this.presentationCanvas.wrapperEl.style.backfaceVisibility="hidden",this.presentationCanvas.wrapperEl.style.perspective="1000px",this.presentationCanvas.wrapperEl.style.willChange="transform",this.canvas.selection=!0,this.canvas.skipTargetFind=!1,this.canvas.perPixelTargetFind=!1,this.canvas.targetFindTolerance=4,this.canvas.selection=!0,this.canvas.skipTargetFind=!1,this.canvas.perPixelTargetFind=!1,Fn.createControls=function(){const o=Wr.createObjectDefaultControls();return delete o.mtr,{controls:o}},Fn.ownDefaults={...Fn.ownDefaults,cornerColor:Mn.CORNER.COLOR,cornerStyle:Mn.CORNER.STYLE,padding:Ys.PADDING_0,cornerSize:Mn.CORNER.SIZE,transparentCorners:Mn.CORNER.TRANSPARENT,lockRotation:!1},this.initAligningGuidelines(),this.pageFrameManager=new PC(this.canvas),this.frameManager=this.pageFrameManager.getFrameManager(),this.controlsManager=new FC(this.canvas,this),this.modeManager=new vw(this.canvas,this.presentationCanvas),this.eventManager=new Cw(this.canvas,this),this.contextMenuManager=new HC(this.canvas,this),this.initPageFramge(),this.initResizeListener(),wC(this),this.importCanvasFromJSON(Mw)}initAligningGuidelines(){const t={margin:4,width:1,color:"rgb(255,0,0,0.9)"};t1(this.canvas,t)}initPageFramge(){const t=this.createPageFrame();this.canvas.add(t),this.canvas.centerObject(t),this.canvas.bringObjectToFront(t)}initResizeListener(){window.addEventListener("resize",()=>{var e;const t=(e=this.canvas.wrapperEl)==null?void 0:e.parentElement;t&&(this.canvas.setDimensions({width:t.clientWidth,height:t.clientHeight}),this.canvas.requestRenderAll())}),window.dispatchEvent(new Event("resize"))}getControlsManager(){return this.controlsManager}getModeManager(){return this.modeManager}createPageFrame(){return this.pageFrameManager.createDefaultPage()}getPageFrame(){return this.pageFrameManager.getPageFrame()}addNewFrame(){return this.pageFrameManager.addNewFrame()}getCurrentFrame(){return this.frameManager.getCurrentFrame()}getAllFrames(){return this.frameManager.getAllFrames()}getAllSlides(){const t=this.getPageFrame(),e=this.frameManager.getAllFrames();return t?[t,...e]:e}deleteFrame(t){this.pageFrameManager.deleteFrame(t)}moveFrameUp(t){this.frameManager.moveFrameUp(t)}moveFrameDown(t){this.frameManager.moveFrameDown(t)}handleResize(t,e){this.canvas.setDimensions({width:t,height:e}),this.presentationCanvas.setDimensions({width:t,height:e})}destroy(){this.canvas.dispose(),this.presentationCanvas.dispose(),this.canvasSyncManager.destroy(),this.canvasSyncManager&&this.canvasSyncManager.destroy()}navigateToFrame(t){const e=this.getMainCanvas(),s=rr(e,t);e.setViewportTransform(s.transform)}setZoom(t){this.canvas.setZoom(t)}getZoom(){return this.canvas.getZoom()}setBackgroundColor(t){this.canvas.backgroundColor=t,this.canvas.requestRenderAll()}getPageFrameManager(){return this.pageFrameManager}getFrameManager(){return this.frameManager}getAllObjects(){return this.canvas.getObjects()}getMainCanvas(){return this.canvas}getPresentationCanvas(){return this.presentationCanvas}clear(){this.pageFrameManager.clear(),this.canvas.clear()}removeObject(t){const e=this.getFrameManager().findParentFrame(t);e&&e.removeContent(t),this.canvas.remove(t)}exportCanvasToJSON(){try{const t=[...this.canvas.viewportTransform];this.canvas.setViewportTransform([1,0,0,1,0,0]);const e=this.canvas.toJSON();this.canvas.setViewportTransform(t);const s=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),n=URL.createObjectURL(s),i=document.createElement("a");i.href=n;const o=new Date,a=`NextSlide_Export_${o.getFullYear()}${(o.getMonth()+1).toString().padStart(2,"0")}${o.getDate().toString().padStart(2,"0")}_${o.getHours().toString().padStart(2,"0")}${o.getMinutes().toString().padStart(2,"0")}.json`;i.download=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n),console.log("画布导出成功")}catch(t){console.error("导出画布失败:",t)}}importCanvasFromJSON(t){console.log("importCanvasFromJSON",t);try{this.clear();const e=typeof t=="string"?JSON.parse(t):t;this.canvas.loadFromJSON(e).then(()=>{console.log("画布导入成功"),this.canvas.requestRenderAll(),this.pageFrameManager.updateReferences()})}catch(e){console.error("导入画布失败:",e)}}}class Aw{constructor(t,e,s,n,i){F(this,"thumbnailCanvases",new Map);F(this,"framesRef");F(this,"canvasManager");F(this,"updateFramesCallback");F(this,"updateTimer",null);F(this,"defaultWidth",224);F(this,"defaultHeight",126);F(this,"eventListenersSet",!1);this.onUpdateStart=s,this.onUpdateComplete=n,console.log("[缩略图管理器] 初始化",t,e),this.canvasManager=t,this.updateFramesCallback=i,this.framesRef=e,this.setupEventListeners(),this.checkCanvasManagerAndUpdate()}async checkCanvasManagerAndUpdate(){var t;for(let e=0;e<5;e++){if(this.canvasManager&&typeof this.canvasManager.getAllSlides=="function"){console.log("[缩略图管理器] canvasManager可用，执行更新帧列表回调"),(t=this.updateFramesCallback)==null||t.call(this);return}console.log(`[缩略图管理器] canvasManager尚未可用，等待重试 (${e+1}/5)`),await new Promise(s=>setTimeout(s,100))}console.warn("[缩略图管理器] canvasManager在多次尝试后仍不可用")}setCanvasManager(t){this.canvasManager=t}setUpdateFramesCallback(t){this.updateFramesCallback=t}getPageOverview(){var t;return(t=this.canvasManager)==null?void 0:t.getPageFrame()}initThumbnailCanvas(t,e,s,n=this.defaultWidth,i=this.defaultHeight){console.log(`[缩略图管理器] 初始化缩略图Canvas:type: ${t}  id: ${e}`,s);const o=document.createElement("canvas");return o.width=n,o.height=i,o.style.width="100%",o.style.height="100%",o.style.objectFit="contain",this.mountCanvasToContainer(s,o),this.thumbnailCanvases.set(e,{canvas:o,container:s}),t===ce.type&&this.updateFrameThumbnails(),o}mountCanvasToContainer(t,e){if(!t){console.warn("[缩略图管理器] 挂载Canvas失败：容器为空");return}if(!(t instanceof HTMLElement)||typeof t.appendChild!="function"){console.error("[缩略图管理器] 挂载Canvas失败：容器不是有效的DOM元素",t);return}console.log("[缩略图管理器] 挂载Canvas到容器",t),t.innerHTML="",t.appendChild(e)}hasThumbnailCanvas(t){return console.log(`[缩略图管理器] 检查是否存在缩略图Canvas: ${t}`,"全部画布缓存：",this.thumbnailCanvases),this.thumbnailCanvases.has(t)}getThumbnailCanvas(t){var e;return(e=this.thumbnailCanvases.get(t))==null?void 0:e.canvas}getPageOverviewCanvas(){return this.getThumbnailCanvas("overview")}getFrameThumbnailCanvas(t){return this.getThumbnailCanvas(t)}getAllThumbnailCanvases(){return this.thumbnailCanvases}setupEventListeners(){this.eventListenersSet||(yt.on(ft.CANVAS.CANVAS_UPDATE,t=>{console.log("[缩略图管理器] 接收到画布更新事件",t),this.updateFramesCallback&&this.updateFramesCallback(),this.updateAllThumbnails()}),this.eventListenersSet=!0,console.log("[缩略图管理器] 事件监听器已设置"))}removeEventListeners(){this.eventListenersSet&&(yt.off(ft.CANVAS.CANVAS_UPDATE),this.eventListenersSet=!1,console.log("[缩略图管理器] 事件监听器已移除"))}updateAllThumbnails(t=100){var e;(e=this.onUpdateStart)==null||e.call(this),console.log("[缩略图] 开始更新所有缩略图"),this.updateTimer&&clearTimeout(this.updateTimer),this.updateTimer=window.setTimeout(async()=>{var s;try{await this.updateFrameThumbnails(),(s=this.onUpdateComplete)==null||s.call(this),console.log("[缩略图] 所有缩略图更新完成")}catch(n){console.error("[缩略图] 更新缩略图时发生错误:",n)}},t)}async updatePageOverviewThumbnail(t){const e=this.thumbnailCanvases.get(t);if(!e){console.warn("[缩略图] 页面概览缩略图未初始化");return}const{canvas:s}=e,n=this.getPageOverview();if(!n){console.warn("[缩略图] 页面概览对象不存在");return}try{console.log("[缩略图] 开始更新页面概览缩略图");const i=await n.thumbnail(s,"PageOverview "+new Date().getTime());i?console.log("[缩略图] 页面概览缩略图更新成功，时间戳:",i.timestamp):console.warn("[缩略图] 页面概览缩略图获取结果为空")}catch(i){console.error("[缩略图] 更新页面概览缩略图失败:",i)}}async updateFrameThumbnails(){let t=[];this.framesRef instanceof Array?t=this.framesRef:t=this.framesRef.value;for(const e of t)try{if(!e.id){console.warn("[缩略图] Frame ID不存在，跳过更新");continue}console.log(`[缩略图] 开始更新Frame ${e.id} 的缩略图`);const s=this.thumbnailCanvases.get(e.id);if(!s){console.warn(`[缩略图] Frame ${e.id} 的缩略图Canvas未初始化，跳过更新`);continue}const{canvas:n}=s,i=await e.thumbnail(n);i?console.log(`[缩略图] Frame ${e.id} 缩略图更新成功，时间戳: ${i.timestamp}`):console.warn(`[缩略图] Frame ${e.id} 缩略图获取结果为空`)}catch(s){console.error("[缩略图] 更新Frame缩略图失败:",s)}}dispose(){this.removeEventListeners(),this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null),this.thumbnailCanvases.clear()}}const Pw={class:"sidebar-content"},Fw={class:"sidebar-body"},Dw={class:"operation-group"},Rw={class:"add-frame-container"},Lw={key:0,class:"dropdown-menu"},jw={class:"frames-list-container"},Iw={class:"frames-list"},Bw={key:0,class:"frame-number"},Nw={class:"frame-thumbnail"},Hw=["data-frame-id"],Yw={class:"frame-title"},zw={class:"arrow"},Xw=Ye({__name:"Sidebar",props:{collapsed:{type:Boolean},canvasManager:{}},emits:["update:collapsed"],setup(r,{emit:t}){S_(O=>({"71bd2c56":Ze(Me).PRIMARY}));const e=r,s=t,n=nt(!1),i=nt([]),o=nt(!1),a=nt(null),l=nt({}),c=nt(null),h=()=>{if(!e.canvasManager){i.value=[];return}const O=e.canvasManager.getAllSlides()||[];i.value=O},u=()=>{e.canvasManager&&(console.log("[Sidebar] 初始化缩略图管理器"),c.value=new Aw(e.canvasManager,i,()=>{},()=>{},()=>{console.log("[Sidebar] Frame列表已初始化完成，回调函数返回"),h()}))},f=()=>{s("update:collapsed",!e.collapsed)},d=te(()=>{var O;return(O=e.canvasManager)==null?void 0:O.getPageFrame()}),p=te(()=>d.value!=null),g=()=>{var O;(O=e.canvasManager)==null||O.addNewFrame(),o.value=!1},m=()=>{var O;(O=e.canvasManager)==null||O.addNewFrame(),o.value=!1},v=O=>{e.canvasManager&&e.canvasManager.navigateToFrame(O)},_=()=>{o.value=!1},y=(O,E)=>{var D;a.value=O,(D=c.value)!=null&&D.initThumbnailCanvas(ce.type,E,O)},b=(O,E)=>{var D;l.value[E]=O,(D=c.value)!=null&&D.initThumbnailCanvas(zt.type,E,O)},w=O=>{v(O)},A=O=>{v(O)};return ds(()=>e.canvasManager,O=>{console.log("[Sidebar] canvasManager 变化:",O),c.value?c.value.setCanvasManager(O):u()},{immediate:!0}),es(()=>{h(),document.addEventListener("click",_)}),mn(()=>{var O;(O=c.value)!=null&&O.dispose(),document.removeEventListener("click",_)}),(O,E)=>{const D=qd("el-button");return ot(),ut("div",{class:$e(["sidebar",{"sidebar-collapsed":O.collapsed}]),onMouseenter:E[2]||(E[2]=Y=>n.value=!0),onMouseleave:E[3]||(E[3]=Y=>n.value=!1)},[P("div",Pw,[P("div",Fw,[P("div",Dw,[P("div",Rw,[ae(D,{type:"primary",onClick:g,disabled:!p.value,style:hs({backgroundColor:Ze(Me).PRIMARY}),class:"add-frame-button"},{default:mh(()=>E[4]||(E[4]=[P("div",{class:"button-content"},[P("span",null,[P("svg",{class:"plus-icon",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[P("path",{d:"M12 4V20M4 12H20",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"})]),vc("Add frame")])],-1)])),_:1},8,["disabled","style"])]),o.value?(ot(),ut("div",Lw,[P("div",{class:"dropdown-item",onClick:m},E[5]||(E[5]=[P("svg",{class:"draw-icon",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[P("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM21.41 6.34l-3.75-3.75-2.53 2.54 3.75 3.75 2.53-2.54z",fill:"currentColor"})],-1),vc(" 绘制Frame ")]))])):pe("",!0)]),E[6]||(E[6]=P("div",{class:"divider"},null,-1)),P("div",jw,[P("div",Iw,[(ot(!0),ut(Ht,null,Qe(i.value,(Y,K,st,G)=>{const rt=[Y.id];if(G&&G.key===Y.id&&v_(G,rt))return G;const ct=(ot(),ut("div",{key:Y.id,class:$e(["frame-item",{overview:K===0}]),onClick:et=>K===0?w(Y):A(Y)},[K>0?(ot(),ut("div",Bw,Cs(K),1)):pe("",!0),P("div",Nw,[P("div",{ref_for:!0,ref:et=>K===0?y(et,Y.id):b(et,Y.id),class:"canvas-container","data-frame-id":Y.id},null,8,Hw)]),P("div",Yw,Cs(K===0?"概览":`页面 ${K}`),1)],10,["onClick"]));return ct.memo=rt,ct},E,0),128))])])])]),P("div",{class:$e(["collapse-button",{show:n.value||O.collapsed}]),onClick:f},[P("span",zw,Cs(O.collapsed?"›":"‹"),1)],2)],34)}}}),Vw=vs(Xw,[["__scopeId","data-v-e3521e96"]]),Ww={class:"canvas-container",ref:"containerRef"},Uw=Ye({__name:"BaseCanvas",emits:["canvas-ready"],setup(r,{expose:t,emit:e}){const s=e,n=nt(null),i=nt(null);let o=null;return es(async()=>{await pr(),n.value&&i.value&&n.value.parentElement?(o=new Ew(n.value,i.value,n.value.parentElement),await pr(),s("canvas-ready"),console.log("Canvas 已准备就绪，canvasManager 已初始化")):console.warn("Canvas 元素未完全挂载，无法初始化 canvasManager")}),mn(()=>{o==null||o.destroy(),o=null}),t({canvasManager:te(()=>o)}),(a,l)=>(ot(),ut("div",Ww,[P("canvas",{ref_key:"canvasRef",ref:n},null,512),P("canvas",{ref_key:"presentationCanvasRef",ref:i,class:"presentation-canvas"},null,512)],512))}}),Gw=vs(Uw,[["__scopeId","data-v-090fcc12"]]),$w={class:"background-image-selector"},qw={class:"image-list-container"},Kw={class:"image-grid"},Jw=["onClick"],Zw=["src","alt"],Qw={key:0,class:"load-more-container"},tS={key:1,class:"loading-indicator"},eS=50,sS=1200,nS=2133,ld=300,rS=Ye({__name:"BackgroundImageSelector",props:{canvas:{},target:{},position:{}},emits:["select-image"],setup(r){const t=r,e=nt(null),s=nt([]),n=nt(1),i=nt(!1),o=()=>{e.value&&e.value.click()},a=u=>{const f=u.target;if(f.files&&f.files[0]){const d=f.files[0],p=URL.createObjectURL(d),g=t.canvas;if(!g){URL.revokeObjectURL(p);return}console.log("文件选择器选择的内容为：",p),zf(g,p),f.value=""}},l=async()=>{if(!i.value){i.value=!0;try{const u=await fetch(`https://picsum.photos/v2/list?page=${n.value}&limit=${eS}`);if(!u.ok)throw new Error(`HTTP error! status: ${u.status}`);const d=(await u.json()).map(p=>{const g=p.id,m=`https://picsum.photos/id/${g}/${nS}/${sS}`,v=`https://picsum.photos/id/${g}/${ld}/${ld}`;return{url:m,thumbnail:v,author:p.author||"未知作者"}});s.value=[...s.value,...d],n.value++}catch(u){console.error("加载图片失败:",u)}finally{i.value=!1}}},c=()=>{l()},h=u=>{t.canvas&&zf(t.canvas,u)};return es(()=>{l()}),(u,f)=>(ot(),ut("div",$w,[f[2]||(f[2]=P("div",{class:"info-text"},[P("p",null,"请选择一张图片作为背景"),P("p",{class:"hint"},"支持 JPG、PNG、SVG 等常见图片格式")],-1)),P("button",{class:"select-button",onClick:o}," 选择图片 "),P("input",{type:"file",ref_key:"fileInput",ref:e,accept:"image/*",style:{display:"none"},onChange:a},null,544),P("div",qw,[f[1]||(f[1]=P("h3",{class:"section-title"},"在线图片",-1)),P("div",Kw,[(ot(!0),ut(Ht,null,Qe(s.value,(d,p)=>(ot(),ut("div",{key:p,class:"image-item",onClick:g=>h(d.url)},[P("img",{src:d.thumbnail,alt:`图片 ${p+1}`,class:"thumbnail"},null,8,Zw)],8,Jw))),128))]),i.value?pe("",!0):(ot(),ut("div",Qw,[P("button",{class:"load-more-button",onClick:c},"加载更多")])),i.value?(ot(),ut("div",tS,f[0]||(f[0]=[P("span",null,"加载中...",-1)]))):pe("",!0)])]))}}),iS=vs(rS,[["__scopeId","data-v-a8564d03"]]),oS={class:"background-color-selector"},aS={class:"color-picker"},lS={class:"color-input-wrapper"},cS={class:"color-presets"},hS={class:"preset-grid"},uS=["onClick"],fS=Ye({__name:"BackgroundColorSelector",props:{canvas:{},target:{},position:{}},setup(r){const t=r,e=nt("#FFFFFF"),s=["#FFFFFF","#F5F5F5","#EEEEEE","#E0E0E0","#FFEBEE","#FCE4EC","#F3E5F5","#EDE7F6","#E8EAF6","#E3F2FD","#E1F5FE","#E0F7FA","#E0F2F1","#E8F5E9","#F1F8E9","#F9FBE7","#FFFDE7","#FFF8E1","#FFF3E0","#FBE9E7"],n=()=>{t.canvas&&SC(t.canvas,e.value)},i=o=>{e.value=o,n()};return(o,a)=>(ot(),ut("div",oS,[P("div",aS,[a[2]||(a[2]=P("label",{for:"color-input"},"选择背景颜色:",-1)),P("div",lS,[mr(P("input",{type:"color",id:"color-input","onUpdate:modelValue":a[0]||(a[0]=l=>e.value=l),onChange:n},null,544),[[xc,e.value]]),mr(P("input",{type:"text","onUpdate:modelValue":a[1]||(a[1]=l=>e.value=l),onChange:n,placeholder:"#FFFFFF"},null,544),[[xc,e.value]])])]),P("div",cS,[a[3]||(a[3]=P("h4",null,"预设颜色:",-1)),P("div",hS,[(ot(),ut(Ht,null,Qe(s,l=>P("div",{key:l,class:"color-preset",style:hs({backgroundColor:l}),onClick:c=>i(l)},null,12,uS)),64))])])]))}}),dS=vs(fS,[["__scopeId","data-v-aab8b53b"]]),gS="data:image/svg+xml,%3c?xml%20version='1.0'?%3e%3csvg%20width='30'%20height='40'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cg%20class='layer'%3e%3ctitle%20_mstHash='1'%20_mstTextHash='5637814'%3e第%201%20层%3c/title%3e%3cg%20fill='%23333333'%20id='svg_1'%20stroke='%23333333'%20stroke-width='2'%20transform='rotate(180%2015%2019.7952)'%3e%3c!--%20第一个箭头%20--%3e%3cpolygon%20id='svg_2'%20points='7.75571882724762,9.741044044494629%2016.73842203617096,19.741044998168945%207.75571882724762,29.741044998168945%2013.369908332824707,29.741044998168945%2022.352611541748047,19.741044998168945%2013.369908332824707,9.741044044494629%20'%20transform='rotate(90%2015%2019.741)'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",pS=Object.freeze(Object.defineProperty({__proto__:null,default:gS},Symbol.toStringTag,{value:"Module"})),mS="data:image/svg+xml,%3c?xml%20version='1.0'?%3e%3csvg%20width='30'%20height='40'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cg%20class='layer'%3e%3ctitle%20_mstHash='1'%20_mstTextHash='5637814'%3e第%201%20层%3c/title%3e%3cg%20fill='%23333333'%20id='svg_1'%20stroke='%23333333'%20stroke-width='2'%3e%3c!--%20第一个箭头%20--%3e%3cpolygon%20id='svg_2'%20points='7.75571882724762,9.741044044494629%2016.73842203617096,19.741044998168945%207.75571882724762,29.741044998168945%2013.369908332824707,29.741044998168945%2022.352611541748047,19.741044998168945%2013.369908332824707,9.741044044494629%20'%20transform='rotate(90%2015%2019.741)'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",vS=Object.freeze(Object.defineProperty({__proto__:null,default:mS},Symbol.toStringTag,{value:"Module"})),_S="data:image/svg+xml,%3c?xml%20version='1.0'?%3e%3csvg%20width='30'%20height='40'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cg%20class='layer'%3e%3ctitle%20_mstHash='1'%20_mstTextHash='5637814'%3e第%201%20层%3c/title%3e%3cg%20fill='%23333333'%20id='svg_1'%20stroke='%23333333'%20stroke-width='2'%20transform='rotate(-135%2015%2019.7952)'%3e%3c!--%20第一个箭头%20--%3e%3cpolygon%20id='svg_2'%20points='7.75571882724762,9.741044044494629%2016.73842203617096,19.741044998168945%207.75571882724762,29.741044998168945%2013.369908332824707,29.741044998168945%2022.352611541748047,19.741044998168945%2013.369908332824707,9.741044044494629%20'%20transform='rotate(90%2015%2019.741)'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",yS=Object.freeze(Object.defineProperty({__proto__:null,default:_S},Symbol.toStringTag,{value:"Module"})),bS="data:image/svg+xml,%3c?xml%20version='1.0'?%3e%3csvg%20width='30'%20height='40'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cg%20class='layer'%3e%3ctitle%20_mstHash='1'%20_mstTextHash='5637814'%3e第%201%20层%3c/title%3e%3cg%20fill='%23333333'%20id='svg_1'%20stroke='%23333333'%20stroke-width='2'%20transform='rotate(-45%2015%2019.7952)'%3e%3c!--%20第一个箭头%20--%3e%3cpolygon%20id='svg_2'%20points='7.75571882724762,9.741044044494629%2016.73842203617096,19.741044998168945%207.75571882724762,29.741044998168945%2013.369908332824707,29.741044998168945%2022.352611541748047,19.741044998168945%2013.369908332824707,9.741044044494629%20'%20transform='rotate(90%2015%2019.741)'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",xS=Object.freeze(Object.defineProperty({__proto__:null,default:bS},Symbol.toStringTag,{value:"Module"})),CS="data:image/svg+xml,%3c?xml%20version='1.0'?%3e%3csvg%20width='30'%20height='40'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cg%20class='layer'%3e%3ctitle%20_mstHash='1'%20_mstTextHash='5637814'%3e第%201%20层%3c/title%3e%3cg%20fill='%23333333'%20id='svg_1'%20stroke='%23333333'%20stroke-width='2'%20transform='rotate(-90%2015%2019.7952)'%3e%3c!--%20第一个箭头%20--%3e%3cpolygon%20id='svg_2'%20points='7.75571882724762,9.741044044494629%2016.73842203617096,19.741044998168945%207.75571882724762,29.741044998168945%2013.369908332824707,29.741044998168945%2022.352611541748047,19.741044998168945%2013.369908332824707,9.741044044494629%20'%20transform='rotate(90%2015%2019.741)'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",wS=Object.freeze(Object.defineProperty({__proto__:null,default:CS},Symbol.toStringTag,{value:"Module"})),SS="data:image/svg+xml,%3c?xml%20version='1.0'?%3e%3csvg%20width='30'%20height='40'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cg%20class='layer'%3e%3ctitle%20_mstHash='1'%20_mstTextHash='5637814'%3e第%201%20层%3c/title%3e%3cg%20fill='%23333333'%20id='svg_1'%20stroke='%23333333'%20stroke-width='2'%20transform='rotate(90%2015%2019.7952)'%3e%3c!--%20第一个箭头%20--%3e%3cpolygon%20id='svg_2'%20points='7.75571882724762,9.741044044494629%2016.73842203617096,19.741044998168945%207.75571882724762,29.741044998168945%2013.369908332824707,29.741044998168945%2022.352611541748047,19.741044998168945%2013.369908332824707,9.741044044494629%20'%20transform='rotate(90%2015%2019.741)'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",TS=Object.freeze(Object.defineProperty({__proto__:null,default:SS},Symbol.toStringTag,{value:"Module"})),OS="data:image/svg+xml,%3c?xml%20version='1.0'?%3e%3csvg%20width='30'%20height='40'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cg%20class='layer'%3e%3ctitle%20_mstHash='1'%20_mstTextHash='5637814'%3e第%201%20层%3c/title%3e%3cg%20fill='%23333333'%20id='svg_1'%20stroke='%23333333'%20stroke-width='2'%20transform='rotate(135%2015%2019.7952)'%3e%3c!--%20第一个箭头%20--%3e%3cpolygon%20id='svg_2'%20points='7.75571882724762,9.741044044494629%2016.73842203617096,19.741044998168945%207.75571882724762,29.741044998168945%2013.369908332824707,29.741044998168945%2022.352611541748047,19.741044998168945%2013.369908332824707,9.741044044494629%20'%20transform='rotate(90%2015%2019.741)'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",kS=Object.freeze(Object.defineProperty({__proto__:null,default:OS},Symbol.toStringTag,{value:"Module"})),MS="data:image/svg+xml,%3c?xml%20version='1.0'?%3e%3csvg%20width='30'%20height='40'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cg%20class='layer'%3e%3ctitle%20_mstHash='1'%20_mstTextHash='5637814'%3e第%201%20层%3c/title%3e%3cg%20fill='%23333333'%20id='svg_1'%20stroke='%23333333'%20stroke-width='2'%20transform='rotate(45%2015%2019.7952)'%3e%3c!--%20第一个箭头%20--%3e%3cpolygon%20id='svg_2'%20points='7.75571882724762,9.741044044494629%2016.73842203617096,19.741044998168945%207.75571882724762,29.741044998168945%2013.369908332824707,29.741044998168945%2022.352611541748047,19.741044998168945%2013.369908332824707,9.741044044494629%20'%20transform='rotate(90%2015%2019.741)'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",ES=Object.freeze(Object.defineProperty({__proto__:null,default:MS},Symbol.toStringTag,{value:"Module"})),AS={class:"insert-image-selector"},PS={class:"image-list-container"},FS={class:"image-grid"},DS=["onClick"],RS=["src","alt"],LS={class:"image-list-container"},jS={class:"image-grid"},IS=["onClick"],BS=["src","alt"],NS={key:0,class:"load-more-container"},HS={key:1,class:"loading-indicator"},YS=50,cd=1200,hd=300,zS=Ye({__name:"InsertImageSelector",props:{canvas:{},canvasManager:{},target:{},position:{}},setup(r){const t=nt([]),e=r,s=nt(null),n=nt([]),i=nt(1),o=nt(!1),a=()=>{s.value&&s.value.click()},l=d=>{const p=d.target;if(p.files&&p.files[0]){const g=p.files[0],m=URL.createObjectURL(g);console.log("文件选择器选择的内容为：",e.canvasManager,m),e.canvasManager.getControlsManager().addImage(m),p.value=""}},c=async()=>{try{const d=Object.assign({"/public/svg/上.svg":pS,"/public/svg/下.svg":vS,"/public/svg/东北.svg":yS,"/public/svg/东南.svg":xS,"/public/svg/右.svg":wS,"/public/svg/左.svg":TS,"/public/svg/西北.svg":kS,"/public/svg/西南.svg":ES});console.log("svgContext",d);const p=Object.entries(d).map(([g,m])=>({url:m.default}));console.log("svgContext images",p),t.value=p}catch(d){console.error("加载系统资源失败:",d)}},h=async()=>{if(!o.value){o.value=!0;try{const d=await fetch(`https://picsum.photos/v2/list?page=${i.value}&limit=${YS}`);if(!d.ok)throw new Error(`HTTP error! status: ${d.status}`);const g=(await d.json()).map(m=>{const v=m.id,_=`https://picsum.photos/id/${v}/${cd}/${cd}`,y=`https://picsum.photos/id/${v}/${hd}/${hd}`;return{url:_,thumbnail:y,author:m.author||"未知作者"}});n.value=[...n.value,...g],i.value++}catch(d){console.error("加载图片失败:",d)}finally{o.value=!1}}},u=()=>{h()},f=d=>{e.canvasManager&&e.canvasManager.getControlsManager().addImage(d)};return es(()=>{c(),h()}),(d,p)=>(ot(),ut("div",AS,[p[3]||(p[3]=P("div",{class:"info-text"},[P("p",null,"请选择图片插入到画布中"),P("p",{class:"hint"},"支持 JPG、PNG、SVG 等常见图片格式")],-1)),P("button",{class:"select-button",onClick:a}," 选择本地图片 "),P("input",{type:"file",ref_key:"fileInput",ref:s,accept:"image/*",style:{display:"none"},onChange:l},null,544),P("div",PS,[p[0]||(p[0]=P("h3",{class:"section-title"},"系统资源",-1)),P("div",FS,[(ot(!0),ut(Ht,null,Qe(t.value,(g,m)=>(ot(),ut("div",{key:m,class:"image-item",onClick:v=>f(g.url)},[P("img",{src:g.url,alt:`系统图片 ${m+1}`,class:"thumbnail"},null,8,RS)],8,DS))),128))])]),P("div",LS,[p[2]||(p[2]=P("h3",{class:"section-title"},"在线图片",-1)),P("div",jS,[(ot(!0),ut(Ht,null,Qe(n.value,(g,m)=>(ot(),ut("div",{key:m,class:"image-item",onClick:v=>f(g.url)},[P("img",{src:g.thumbnail,alt:`图片 ${m+1}`,class:"thumbnail"},null,8,BS)],8,IS))),128))]),o.value?pe("",!0):(ot(),ut("div",NS,[P("button",{class:"load-more-button",onClick:u},"加载更多")])),o.value?(ot(),ut("div",HS,p[1]||(p[1]=[P("span",null,"加载中...",-1)]))):pe("",!0)])]))}}),XS=vs(zS,[["__scopeId","data-v-815a3638"]]),VS={class:"panel-content"},WS={class:"panel-header"},US={class:"panel-body"},GS=Ye({__name:"ControlPanel",props:{collapsed:{type:Boolean},panelData:{}},emits:["update:collapsed"],setup(r,{emit:t}){const e=r,s=t,n=gh(null),i=nt(""),o=nt({canvas:null,target:null,position:null});ds(()=>e.panelData,c=>{c&&(i.value=c.type,o.value={canvas:c.canvas,target:c.target,position:c.position,canvasManager:c.canvasManager},c.type===ft.PANEL_TYPE.BACKGROUND_IMAGE?n.value=iS:c.type===ft.PANEL_TYPE.BACKGROUND_COLOR?n.value=dS:c.type===ft.PANEL_TYPE.INSERT_IMAGE&&(n.value=XS))},{immediate:!0});const a=()=>{s("update:collapsed",!0)},l=te(()=>{switch(i.value){case"background-image":return"更换背景图片";case"background-color":return"更换背景颜色";case"insert-image":return"插入图片";default:return"扩展面板"}});return(c,h)=>(ot(),ut("div",{class:$e(["control-panel",{"panel-collapsed":c.collapsed}])},[P("div",VS,[P("div",WS,[P("h3",null,Cs(l.value),1),P("button",{class:"close-button",onClick:a},h[0]||(h[0]=[P("span",{class:"close-icon"},"×",-1)]))]),P("div",US,[n.value?(ot(),hn(Jd(n.value),{key:0,canvas:o.value.canvas,target:o.value.target,position:o.value.position,canvasManager:o.value.canvasManager},null,8,["canvas","target","position","canvasManager"])):pe("",!0)])])],2))}}),$S=vs(GS,[["__scopeId","data-v-197aff76"]]),qS={"Microsoft YaHei":"微软雅黑","Microsoft YaHei UI":"微软雅黑 UI",SimSun:"宋体",SimHei:"黑体",KaiTi:"楷体",FangSong:"仿宋",STXihei:"华文细黑",STKaiti:"华文楷体",STSong:"华文宋体",STFangsong:"华文仿宋",STZhongsong:"华文中宋",STHupo:"华文琥珀",STXinwei:"华文新魏",STLiti:"华文隶书",FZShuTi:"方正舒体",FZYaoti:"方正姚体",YouYuan:"幼圆",LiSu:"隶书",NSimSun:"新宋体","DFKai-SB":"标楷体","Source Han Sans CN":"思源黑体","Source Han Serif CN":"思源宋体","Noto Sans SC":"Noto Sans 简体中文","Noto Serif SC":"Noto Serif 简体中文","PingFang SC":"苹方-简","Hiragino Sans GB":"冬青黑体","WenQuanYi Micro Hei":"文泉驿微米黑","WenQuanYi Zen Hei":"文泉驿正黑",HYQiHei:"汉仪旗黑",HYKaiti:"汉仪楷体",HYZhuoKai:"汉仪卓楷",HYLeMiao:"汉仪乐喵体",HYXiaoMaiTi:"汉仪小麦体",HYCuYuan:"汉仪粗圆",HYDaSongJ:"汉仪大宋简",HYShangWeiShouShuW:"汉仪尚巍手书W",MingLiU:"细明体",PMingLiU:"新细明体","MingLiU-ExtB":"细明体-ExtB","PMingLiU-ExtB":"新细明体-ExtB",MingLiU_HKSCS:"细明体_HKSCS","MingLiU_HKSCS-ExtB":"细明体_HKSCS-ExtB","SimSun-ExtB":"宋体-ExtB",FangSong_GB2312:"仿宋_GB2312",KaiTi_GB2312:"楷体_GB2312",Dengxian:"等线","Dengxian Light":"等线 Light","Founder Type":"方正字体","Founder Clear Song":"方正清刻本悦宋简体","Founder Black Body":"方正黑体","Founder Thin":"方正细黑","Founder Compact":"方正综艺简体","Founder Cute":"方正卡通","Founder Handwriting":"方正行楷","Founder Elegant":"方正隶变简体","Founder Super":"方正超粗黑","Founder Shao":"方正少儿","Founder Simplified":"方正简体","Founder Imitation Song":"方正仿宋","Founder Regular Script":"方正楷体","Founder Small":"方正小标宋简体","Founder Xin":"方正新书宋简体","Founder Yan":"方正颜宋简体","Founder Fang":"方正仿宋简体","Founder Song":"方正书宋简体","Founder Old":"方正老宋简体",Arial:"Arial 标准","Arial Black":"Arial 黑体","Comic Sans MS":"Comic Sans 手写体","Courier New":"Courier New 等宽字体",Georgia:"Georgia 衬线体",Impact:"Impact 粗体","Times New Roman":"Times New Roman 衬线体","Trebuchet MS":"Trebuchet MS 无衬线体",Verdana:"Verdana 无衬线体",Webdings:"Webdings 符号",Wingdings:"Wingdings 符号",Calibri:"Calibri 无衬线体",Cambria:"Cambria 衬线体",Consolas:"Consolas 等宽字体","Segoe UI":"Segoe UI 界面字体",Tahoma:"Tahoma 无衬线体",Helvetica:"Helvetica 无衬线体","Helvetica Neue":"Helvetica Neue 现代无衬线体","Lucida Sans":"Lucida Sans 无衬线体","Lucida Console":"Lucida Console 等宽字体",Monaco:"Monaco 等宽字体","Palatino Linotype":"Palatino Linotype 衬线体","Book Antiqua":"Book Antiqua 古典衬线体",Garamond:"Garamond 优雅衬线体","Century Gothic":"Century Gothic 几何无衬线体","Franklin Gothic":"Franklin Gothic 无衬线体",Copperplate:"Copperplate 铜板体",Papyrus:"Papyrus 手写体","Brush Script MT":"Brush Script MT 笔刷体"};async function KS(){try{if("queryLocalFonts"in window){const t=(await window.queryLocalFonts()).map(n=>({label:qS[n.family]||n.family,value:n.family})),e=[],s=new Map;for(const n of t)s.has(n.value.toLowerCase())||(s.set(n.value.toLowerCase(),!0),e.push(n));return e}else return console.warn("浏览器不支持queryLocalFonts API"),[]}catch(r){return console.error("获取系统字体失败:",r),[]}}const JS=[{label:"微软雅黑",value:"Microsoft YaHei"},{label:"宋体",value:"SimSun"},{label:"黑体",value:"SimHei"},{label:"楷体",value:"KaiTi"},{label:"仿宋",value:"FangSong"},{label:"Arial 标准",value:"Arial"},{label:"Times New Roman 衬线体",value:"Times New Roman"},{label:"Courier New 等宽字体",value:"Courier New"}],ZS={class:"color-picker-panel"},QS={class:"color-category"},t2={class:"color-options"},e2=["onClick"],s2={class:"color-category"},n2={class:"color-options"},r2=["onClick"],i2={class:"color-category"},o2={class:"color-options"},a2=["onClick"],l2={class:"color-category"},c2={class:"color-options"},h2={class:"color-category"},u2={class:"custom-color-picker"},f2={class:"color-input-group"},d2=["value"],g2=Ye({__name:"ColorPicker",props:{color:{}},emits:["update:color","select"],setup(r,{emit:t}){const e=r,s=t,n=nt(e.color),i=nt(e.color==="transparent"?"":e.color),o=nt(null);es(()=>{o.value&&n.value!=="transparent"&&(o.value.value=n.value)}),ds(()=>e.color,f=>{n.value=f,i.value=f==="transparent"?"":f});const a=f=>{n.value=f,i.value=f==="transparent"?"":f,s("update:color",f),s("select",f)},l=f=>{const d=f.target;i.value=d.value,n.value=d.value,s("update:color",d.value)},c=f=>{const d=f.target;/^#[0-9A-F]{6}$/i.test(d.value)&&o.value&&(o.value.value=d.value)},h=()=>{(!i.value||!/^#[0-9A-F]{6}$/i.test(i.value))&&(i.value=n.value==="transparent"?"#000000":n.value)},u=()=>{/^#[0-9A-F]{6}$/i.test(i.value)&&a(i.value)};return(f,d)=>(ot(),ut("div",ZS,[P("div",QS,[d[4]||(d[4]=P("div",{class:"category-title"},"渐变柔和风",-1)),P("div",t2,[(ot(!0),ut(Ht,null,Qe(Ze(Xi).GRADIENT_COLORS,p=>(ot(),ut("div",{key:p,class:"color-option",style:hs({backgroundColor:p}),onClick:g=>a(p)},null,12,e2))),128))])]),P("div",s2,[d[5]||(d[5]=P("div",{class:"category-title"},"扁平UI色",-1)),P("div",n2,[(ot(!0),ut(Ht,null,Qe(Ze(Xi).FLAT_UI_COLORS.slice(0,10),p=>(ot(),ut("div",{key:p,class:"color-option",style:hs({backgroundColor:p}),onClick:g=>a(p)},null,12,r2))),128))])]),P("div",i2,[d[6]||(d[6]=P("div",{class:"category-title"},"中国传统色",-1)),P("div",o2,[(ot(!0),ut(Ht,null,Qe(Ze(Xi).TRADITIONAL_CHINESE_COLORS.slice(0,10),p=>(ot(),ut("div",{key:p,class:"color-option",style:hs({backgroundColor:p}),onClick:g=>a(p)},null,12,a2))),128))])]),P("div",l2,[d[7]||(d[7]=P("div",{class:"category-title"},"基础色",-1)),P("div",c2,[P("div",{class:"color-option",style:{"background-color":"#000000"},onClick:d[0]||(d[0]=p=>a("#000000"))}),P("div",{class:"color-option",style:{"background-color":"#FFFFFF"},onClick:d[1]||(d[1]=p=>a("#FFFFFF"))}),P("div",{class:"color-option transparent",onClick:d[2]||(d[2]=p=>a("transparent"))})])]),P("div",h2,[d[8]||(d[8]=P("div",{class:"category-title"},"自定义颜色",-1)),P("div",u2,[P("div",f2,[P("input",{type:"color",ref_key:"colorPickerInput",ref:o,value:n.value==="transparent"?"#000000":n.value,onInput:l,class:"color-input"},null,40,d2),mr(P("input",{type:"text","onUpdate:modelValue":d[3]||(d[3]=p=>i.value=p),onInput:c,onBlur:h,class:"color-text-input",placeholder:"#RRGGBB"},null,544),[[xc,i.value]])]),P("button",{class:"apply-color-btn",onClick:u},"应用")])])]))}}),ac=vs(g2,[["__scopeId","data-v-65a1d3cb"]]),p2={class:"toolbar-buttons"},m2={class:"text-style-control"},v2=["value"],_2={class:"font-family-control"},y2=["value"],b2={class:"font-size-control"},x2={class:"color-selector"},C2={class:"color-selector"},w2={class:"color-selector"},S2=Ye({__name:"TextSettingToolbar",props:{canvasManager:{},panelData:{}},setup(r){const t=r,e=nt(!1),s=nt(null),n=nt({top:0,left:0}),i=nt(!1),o=nt(!1),a=nt(!1),l=nt(!1),c=nt(!1),h=nt(!1),u=nt(16),f=nt("#000000"),d=nt("transparent"),p=nt("transparent"),g=nt("left"),m=nt("Arial"),v=nt("normal"),_=[{label:"普通",value:"normal"},{label:"标题1",value:"heading1"},{label:"标题2",value:"heading2"},{label:"标题3",value:"heading3"},{label:"标题4",value:"heading4"},{label:"引用",value:"quote"},{label:"代码",value:"code"}],y=nt([...JS]),b=async()=>{KS().then(B=>{y.value=B}).catch(B=>{console.error("获取系统字体失败:",B),alert("获取系统字体失败，可能是因为页面不可见或缺少用户交互。请尝试点击页面后再操作。")})},w=B=>{ct(B),i.value=!1},A=B=>{et(B),o.value=!1},O=B=>{J(B),a.value=!1},E=te(()=>({top:`${n.value.top}px`,left:`${n.value.left}px`})),D=()=>{if(!s.value)return;const B=s.value;l.value=B.fontWeight==="bold",c.value=B.fontStyle==="italic",h.value=B.underline===!0,u.value=B.fontSize||16,f.value=B.fill||"#000000",d.value=B.textBackgroundColor||"transparent",p.value=B.backgroundColor||"transparent",g.value=B.textAlign||"left",m.value=B.fontFamily||"Arial",B.fontSize>=40?v.value="heading1":B.fontSize>=32?v.value="heading2":B.fontSize>=24?v.value="heading3":B.fontSize>=18?v.value="heading4":v.value="normal"},Y=()=>{var W;if(!s.value)return;const B=s.value,N=B.fontWeight==="bold"?"normal":"bold";B.set("fontWeight",N),l.value=N==="bold",(W=t.canvasManager)==null||W.canvas.renderAll()},K=()=>{var W;if(!s.value)return;const B=s.value,N=B.fontStyle==="italic"?"normal":"italic";B.set("fontStyle",N),c.value=N==="italic",(W=t.canvasManager)==null||W.canvas.renderAll()},st=()=>{var W;if(!s.value)return;const B=s.value,N=!B.underline;B.set("underline",N),h.value=N,(W=t.canvasManager)==null||W.canvas.renderAll()},G=()=>{if(!s.value)return;const B=s.value,N=Math.min((B.fontSize||16)+1,1e3);B.setFontSize(N,!0),u.value=N},rt=()=>{if(!s.value)return;const B=s.value,N=Math.min((B.fontSize||16)-1,1e3);B.setFontSize(N,!0),u.value=N},ct=B=>{var W;if(!s.value)return;s.value.set("fill",B),f.value=B,i.value=!1,(W=t.canvasManager)==null||W.canvas.renderAll()},et=B=>{var W;if(!s.value)return;s.value.set("textBackgroundColor",B),d.value=B,o.value=!1,(W=t.canvasManager)==null||W.canvas.renderAll()},J=B=>{var W;if(!s.value)return;s.value.set("backgroundColor",B),p.value=B,a.value=!1,(W=t.canvasManager)==null||W.canvas.renderAll()},V=B=>{var W;if(!s.value)return;s.value.set("textAlign",B),g.value=B,(W=t.canvasManager)==null||W.canvas.renderAll()},pt=()=>{var N;if(!s.value)return;s.value.set("fontFamily",m.value),(N=t.canvasManager)==null||N.canvas.renderAll()},Tt=()=>{var N;if(!s.value)return;const B=s.value;switch(v.value){case"heading1":B.applyTextStyle({fontSize:40,fontWeight:"bold"}),u.value=40,l.value=!0;break;case"heading2":B.applyTextStyle({fontSize:32,fontWeight:"bold"}),u.value=32,l.value=!0;break;case"heading3":B.applyTextStyle({fontSize:24,fontWeight:"bold"}),u.value=24,l.value=!0;break;case"heading4":B.applyTextStyle({fontSize:18,fontWeight:"bold"}),u.value=18,l.value=!0;break;case"quote":B.applyTextStyle({fontStyle:"italic",textBackgroundColor:"#f0f0f0"}),c.value=!0,d.value="#f0f0f0";break;case"code":B.applyTextStyle({fontFamily:"Courier New",textBackgroundColor:"#f5f5f5"}),m.value="Courier New",d.value="#f5f5f5";break;case"normal":default:B.applyTextStyle({fontSize:16,fontWeight:"normal",fontStyle:"normal",textBackgroundColor:"transparent"}),u.value=16,l.value=!1,c.value=!1,d.value="transparent";break}(N=t.canvasManager)==null||N.canvas.renderAll()},At=()=>{var I;if(!s.value||!((I=t.canvasManager)!=null&&I.canvas))return;const B=t.canvasManager.canvas,W=s.value.getBoundingRect(),Xt=B.getZoom(),Rt=B.viewportTransform;if(!Rt)return;const R=W.left*Xt+Rt[4],Z=W.top*Xt+Rt[5];W.width*Xt,W.height*Xt;const z=document.querySelector(".text-format-toolbar"),Q=z?z.offsetWidth:300,bt=z?z.offsetHeight:50,x=window.innerWidth,C=window.innerHeight;let k=R-Q/2,L=Z-bt-15;k=Math.max(10,Math.min(k,x-Q-10)),L=Math.max(10,Math.min(L,C-bt-10)),n.value={left:k,top:L}};return es(()=>{b(),document.addEventListener("click",B=>{(i.value||o.value)&&!B.composedPath().some(N=>{var W;return(W=N.classList)==null?void 0:W.contains("color-selector")})&&(i.value=!1,o.value=!1,a.value=!1)})}),mn(()=>{document.removeEventListener("click",()=>{})}),ds(()=>t.panelData,B=>{B&&B.target&&(s.value=B.target,e.value=!0,D(),At())},{immediate:!0}),(B,N)=>e.value?(ot(),ut("div",{key:0,class:"text-format-toolbar",style:hs(E.value)},[P("div",p2,[P("div",m2,[mr(P("select",{"onUpdate:modelValue":N[0]||(N[0]=W=>v.value=W),onChange:Tt},[(ot(),ut(Ht,null,Qe(_,W=>P("option",{key:W.value,value:W.value},Cs(W.label),9,v2)),64))],544),[[Nu,v.value]])]),N[19]||(N[19]=P("div",{class:"divider"},null,-1)),P("button",{onClick:Y,class:$e({active:l.value}),title:"粗体"},N[11]||(N[11]=[P("i",{class:"fas fa-bold"},null,-1)]),2),P("button",{onClick:K,class:$e({active:c.value}),title:"斜体"},N[12]||(N[12]=[P("i",{class:"fas fa-italic"},null,-1)]),2),P("button",{onClick:st,class:$e({active:h.value}),title:"下划线"},N[13]||(N[13]=[P("i",{class:"fas fa-underline"},null,-1)]),2),N[20]||(N[20]=P("div",{class:"divider"},null,-1)),P("div",_2,[mr(P("select",{"onUpdate:modelValue":N[1]||(N[1]=W=>m.value=W),onChange:pt},[(ot(!0),ut(Ht,null,Qe(y.value,W=>(ot(),ut("option",{key:W.value,value:W.value},Cs(W.label),9,y2))),128))],544),[[Nu,m.value]])]),N[21]||(N[21]=P("div",{class:"divider"},null,-1)),P("div",b2,[P("button",{onClick:rt,title:"减小字号"},N[14]||(N[14]=[P("i",{class:"fas fa-minus"},null,-1)])),P("span",null,Cs(u.value),1),P("button",{onClick:G,title:"增大字号"},N[15]||(N[15]=[P("i",{class:"fas fa-plus"},null,-1)]))]),N[22]||(N[22]=P("div",{class:"divider"},null,-1)),P("button",{onClick:N[2]||(N[2]=W=>V("left")),class:$e({active:g.value==="left"}),title:"左对齐"},N[16]||(N[16]=[P("i",{class:"fas fa-align-left"},null,-1)]),2),P("button",{onClick:N[3]||(N[3]=W=>V("center")),class:$e({active:g.value==="center"}),title:"居中对齐"},N[17]||(N[17]=[P("i",{class:"fas fa-align-center"},null,-1)]),2),P("button",{onClick:N[4]||(N[4]=W=>V("right")),class:$e({active:g.value==="right"}),title:"右对齐"},N[18]||(N[18]=[P("i",{class:"fas fa-align-right"},null,-1)]),2),N[23]||(N[23]=P("div",{class:"divider"},null,-1)),P("div",x2,[P("button",{onClick:N[5]||(N[5]=W=>i.value=!i.value),title:"文本颜色"},[P("div",{class:"color-preview",style:hs({backgroundColor:f.value})},null,4)]),i.value?(ot(),hn(ac,{key:0,color:f.value,"onUpdate:color":N[6]||(N[6]=W=>f.value=W),onSelect:w},null,8,["color"])):pe("",!0)]),P("div",C2,[P("button",{onClick:N[7]||(N[7]=W=>o.value=!o.value),title:"文本背景颜色"},[P("div",{class:"color-preview bg-color-preview",style:hs({backgroundColor:d.value})},null,4)]),o.value?(ot(),hn(ac,{key:0,color:d.value,"onUpdate:color":N[8]||(N[8]=W=>d.value=W),onSelect:A},null,8,["color"])):pe("",!0)]),P("div",w2,[P("button",{onClick:N[9]||(N[9]=W=>a.value=!a.value),title:"文本框背景颜色"},[P("div",{class:"color-preview box-bg-color-preview",style:hs({backgroundColor:p.value})},null,4)]),a.value?(ot(),hn(ac,{key:0,color:p.value,"onUpdate:color":N[10]||(N[10]=W=>p.value=W),onSelect:O},null,8,["color"])):pe("",!0)])])],4)):pe("",!0)}}),T2=vs(S2,[["__scopeId","data-v-b9653055"]]);function O2(r){const t=nt(!1),e=nt(null),s=nt(null),n=o=>{console.log("useSettingToolsHandle 收到显示文本设置工具栏事件",o),e.value=o,t.value=!0,s.value&&(s.value.getTextSettingToolbarData().value=o,s.value.getTextSettingToolbarVisible().value=!0)},i=()=>{t.value=!1,e.value=null,s.value&&(s.value.getTextSettingToolbarVisible().value=!1,s.value.getTextSettingToolbarData().value=null)};return es(()=>{yt.on(ft.CONTROL_PANEL.SHOW_TEXT_SETTING_TOOLBAR,n),yt.on(ft.CONTROL_PANEL.HIDE_TEXT_SETTING_TOOLBAR,i)}),mn(()=>{yt.off(ft.CONTROL_PANEL.SHOW_TEXT_SETTING_TOOLBAR,n),yt.off(ft.CONTROL_PANEL.HIDE_TEXT_SETTING_TOOLBAR,i),s.value&&(s.value.destroy(),s.value=null)}),{settingToolsHandle:s,textSettingToolbarVisible:t,textSettingToolbarData:e}}const k2={class:"editor"},M2={key:0,class:"editor-toolbar"},E2={class:"editor-main"},A2={class:"editor-workspace"},P2={key:0,class:"floating-panels"},F2=Ye({__name:"NextEditorVue",emits:["update:controlPanelCollapsed"],setup(r,{emit:t}){const e=t,s=nt(!1),n=nt(null),i=nt(!1),o=nt(!1),a=nt(!1),l=nt(null),c=gh(null),h=te(()=>{var y;return(y=n.value)==null?void 0:y.selectedFrame}),u=te(()=>{var y;return(y=n.value)==null?void 0:y.selectedPage}),f=te(()=>{var y,b;return s.value?(c.value||(c.value=(y=n.value)==null?void 0:y.canvasManager,console.log("NextEditor computed canvasManager:",{manager:c.value,hasCanvas:((b=c.value)==null?void 0:b.canvas)!=null})),c.value):(console.log("Canvas 尚未准备就绪，canvasManager 不可用"),null)}),{textSettingToolbarVisible:d,textSettingToolbarData:p}=O2(),g=y=>{o.value=y,e("update:controlPanelCollapsed",y)};ds(f,y=>{console.log("NextEditor canvasManager 初始化完成！",y),y&&y.canvas&&pr(()=>{s.value=!0})},{immediate:!0});const m=async()=>{console.log("Canvas 已发出就绪事件"),await pr(),n.value&&n.value.canvasManager?(c.value=n.value.canvasManager,s.value=!0,console.log("Canvas 已准备就绪，canvasManager 已缓存")):(console.warn("Canvas 已发出就绪事件，但 canvasManager 尚未可用"),setTimeout(v,100))},v=()=>{n.value&&n.value.canvasManager?(c.value=n.value.canvasManager,s.value=!0,console.log("延迟检查：Canvas 已准备就绪，canvasManager 已缓存")):console.warn("延迟检查：canvasManager 仍未初始化")},_=y=>{l.value=y,a.value=!0,setTimeout(()=>{o.value=!1},0)};return es(async()=>{console.log("NextEditor 组件已挂载，等待 Canvas 准备就绪")}),es(()=>{yt.on(ft.CONTROL_PANEL.OPEN,_)}),mn(()=>{yt.off(ft.CONTROL_PANEL.OPEN,_)}),ds(o,y=>{y===!0&&setTimeout(()=>{a.value=!1},300)}),(y,b)=>(ot(),ut("div",k2,[s.value?(ot(),ut("div",M2,[ae(ib,{"canvas-manager":f.value},null,8,["canvas-manager"])])):pe("",!0),P("div",E2,[P("div",A2,[ae(Gw,{ref_key:"canvasRef",ref:n,onCanvasReady:m},null,512)]),s.value?(ot(),ut("div",P2,[ae(Vw,{collapsed:i.value,"onUpdate:collapsed":b[0]||(b[0]=w=>i.value=w),"canvas-manager":f.value,"selected-frame":h.value,"selected-page":u.value},null,8,["collapsed","canvas-manager","selected-frame","selected-page"]),a.value?(ot(),hn($S,{key:0,collapsed:o.value,"onUpdate:collapsed":[b[1]||(b[1]=w=>o.value=w),g],"panel-data":l.value},null,8,["collapsed","panel-data"])):pe("",!0),Ze(d)?(ot(),hn(T2,{key:1,"canvas-manager":f.value,"panel-data":Ze(p)},null,8,["canvas-manager","panel-data"])):pe("",!0)])):pe("",!0)])]))}}),D2=vs(F2,[["__scopeId","data-v-b9c65be2"]]);class O0 extends bs{constructor(e,s){const n={...s,backgroundColor:"red",textBackgroundColor:"blue",padding:10,textAlign:"left",width:800,height:300,originY:"top",splitByGrapheme:!0,lockScalingFlip:!0,minHeight:100,fixedHeight:!0,maxWidth:800,fontSize:40};super(e,{...n});F(this,"preventDistortion",!0);F(this,"_originalWidth",0);F(this,"_originalHeight",0);F(this,"_skipDimension",!1);F(this,"_minFontSize",11);F(this,"_originalFontSize",40);F(this,"_isMoving",!1);this._originalWidth=this.width,this._originalHeight=this.height,this._originalFontSize=this.fontSize||40,this._minFontSize=n._minFontSize||11,this.on("scaling",this.handleScaling.bind(this)),this.on("moving",this.handleMoving.bind(this)),this.on("mouseup",this.handleMoveEnd.bind(this)),this.on("deselected",this.handleMoveEnd.bind(this))}handleMoving(){this._isMoving=!0,console.log("控件开始移动")}handleMoveEnd(){this._isMoving=!1,console.log("控件移动结束")}isObjMoving(){return this._isMoving}initDimensions(){if(console.log("initDimensions"),this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),!this._skipDimension){if(this._splitText(),this._clearCache(),console.log("initDimensions this.path",this.path,new Date().getTime()),this.path)this.width=this.path.width,this.height=this.path.height;else{const e=this.width,s=this.calcTextWidth();console.log("initDimensions originalWidth",e,"  fontWidth",s,new Date().getTime()),s>e?this.width=s:this.width=e,console.log("this.height",this.height,this.calcTextHeight());const n=this.calcTextHeight();this.isEditing&&n>this.height&&(this.height=n)}this.textAlign&&this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),console.log("--------------------------------------------------------------------"),this.dirty=!0,this.canvas&&this.canvas.requestRenderAll()}}adjustTextSize(e,s,n){if(!this.canvas)return;const i=this.calcTextWidth(),o=this.calcTextHeight(),a=this.width,l=this.height;console.log("字体宽度:"+i,"字体高度:"+o,"容器宽度："+a,"容器高度："+l,new Date().getTime());const c=a/i,h=l/o;if(console.log("容器宽度比例:",c,"容器高度比例:",h,new Date().getTime()),c<1||h<1){const u=Math.min(c,h),f=Math.max(Number((this.fontSize*u).toFixed(3)),this._minFontSize);console.log("文本超出容器，缩小字体到:",f),this.set("fontSize",f),this.syncTextStyles()}else if(e&&s&&n){const u=e.width?e.width/s:1,f=e.height?e.height/n:1,d=Math.max(u,f);if(console.log("缩放因子:",d,"当前字号:",this.fontSize),d>1&&c>1&&h>1){const p=Math.min(Number((this.fontSize*d).toFixed(3)),this._originalFontSize);console.log("放大字体到:",p),this.set("fontSize",p),this.syncTextStyles()}else if(d<1&&(c<1||h<1)){const p=Math.max(Number((this.fontSize*d).toFixed(3)),this._minFontSize);console.log("缩小字体到:",p),this.set("fontSize",p),this.syncTextStyles()}}}syncTextStyles(){if(!this.styles)return;const e=this.fontSize||40;for(const s in this.styles)for(const n in this.styles[s])this.styles[s][n]&&(this.styles[s][n].fontSize=e);console.log("已同步所有文本样式的字体大小:",e)}handleScaling(){if(!this.preventDistortion||!this.canvas)return;let e=!1;const s={},n=this.width,i=this.height;if(console.log("缩放事件 当前文本组件宽高:",this.width,this.height),console.log("缩放事件 X:",this.scaleX,s.scaleX,"缩放事件 Y:",this.scaleY,s.scaleY),this.scaleX!==1&&(s.scaleX=1,s.width=this.width*this.scaleX,e=!0),this.scaleY!==1){s.scaleY=1;const o=this.calcTextHeight()*(this._minFontSize/this.fontSize);s.height=Math.max(this.height*this.scaleY,o),e=!0}e&&(this.set(s),this.setCoords(),this.adjustTextSize(s,n,i))}}F(O0,"type","preventDistortionTextbox");const ud={CENTER:"center"};function R2(r){return r.originX===ud.CENTER&&r.originY===ud.CENTER}function L2(r,t,e,s,n,i){const o=t.target,a=Wr.getLocalPoint(t,t.originX,t.originY,e,s),l=o.strokeWidth/(o.strokeUniform?o.scaleX:1),c=R2(t)?2:1,h=o.width,u=Math.abs(a.x*c/o.scaleX)-l,f=Math.abs(a.y*c/o.scaleY)-l;return o.set("width",Math.max(u,0)),o.set("height",Math.max(f,0)),h!==u}const $i=class $i extends Hs{constructor(e,s){super(e,{...{textAlign:"left",width:500,height:200,originY:"top",splitByGrapheme:!0,lockUniScaling:!0,lockScalingFlip:!0,minHeight:100,fixedHeight:!0},...s});F(this,"preventDistortion",!0);F(this,"lockFontScaling",!0);F(this,"originalWidth",0);F(this,"originalHeight",0);F(this,"_lastFontSize",0);F(this,"_originalFontSize",0);this.originalWidth=this.width,this.originalHeight=this.height,this._originalFontSize=this.fontSize||16,this._lastFontSize=this._originalFontSize,this.on("scaling",this.handleScaling.bind(this)),this.on("modified",this.adjustTextSize.bind(this))}static initialize(){const e=new $i(""),s=Wr.wrapWithFireEvent("resizing",Wr.wrapWithFixedAnchor(L2));e.controls.br=new Ce({x:.5,y:.5,cursorStyleHandler:Wr.scaleSkewCursorStyleHandler,actionHandler:s}),$i.prototype.controls=e.controls;const n=Hs.prototype.calcTextHeight;Hs.prototype.calcTextHeight=function(){const i=n.call(this);return Math.max(this.height||0,i)}}_renderText(e){if(this.isEmptyStyles(0)){e.save(),this._renderTextFill(e),this._renderTextStroke(e),e.restore();return}const s=e.getTransform();(this.scaleX!==1||this.scaleY!==1)&&e.scale(1/this.scaleX,1/this.scaleY),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderTextFill(e),this._renderTextStroke(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough"),e.setTransform(s)}handleScaling(){if(!this.preventDistortion||!this.canvas)return;let e=!1;const s={};this.scaleX!==1&&(s.scaleX=1,s.width=this.width*this.scaleX,e=!0),this.scaleY!==1&&(s.scaleY=1,s.height=this.height*this.scaleY,e=!0),e&&(this.canvas.fire("object:modified"),this.set(s),this.setCoords(),this.adjustTextSize(),this.canvas.requestRenderAll())}adjustTextSize(){if(!this.canvas)return;const e=this.width,s=this.height,n=this.calcTextWidth(),i=this.calcTextHeight(),o=e/n,a=s/i,l=Math.min(o,a);if(l<1){const c=Math.max(Math.floor(this.fontSize*l),8);this.set("fontSize",c),this._lastFontSize=c,this.canvas.requestRenderAll()}else if(l>1&&this.fontSize<this._originalFontSize){const c=Math.min(Math.floor(this.fontSize*l),this._originalFontSize);this.set("fontSize",c),this._lastFontSize=c,this.canvas.requestRenderAll()}}};F($i,"type","preventDistortionTextbox");let Ya=$i;Ya.initialize();const j2={class:"test-page"},I2=Ye({__name:"TestPage",setup(r){Ky();const t=nt(null);let e=null,s=null;const n=()=>{if(!t.value)return;e=new io(t.value,{width:window.innerWidth,height:window.innerHeight,backgroundColor:"#f0f0f0"}),s=new O0("在这里输入文本"),s.set("initialFontSize",s.fontSize),e.on("selection:created",function(c){console.log("selection:created 事件触发",c.target)}),e.on("selection:updated",function(c){var h,u;console.log("selection:updated 事件触发",((u=(h=c.selected)==null?void 0:h[0])==null?void 0:u.fontSize)||s.fontSize)}),e.add(s);const l=new Ya("Hello World",{left:10,top:10,fontFamily:"Roboto-Regular",angle:0,fontSize:37,splitByGrapheme:!0});e.add(l),ri.fromURL("https://fastly.picsum.photos/id/3/300/300.jpg?hmac=RT2JK6MzdIgNIWoIj61uPcz8aOSOi3lu2vhnwOxs7lY").then(c=>{c.set({left:100,top:100,width:100,height:100,selectable:!0,hasControls:!0,hasBorders:!0}),e==null||e.add(c),e==null||e.setActiveObject(c)}),e.setActiveObject(s),e.renderAll()},i=()=>{!e||!s||(e.setActiveObject(s),e.renderAll(),console.log("手动触发选择事件"))},o=()=>{e&&console.log("Canvas 事件列表:",e.__eventListeners)},a=()=>{e&&(e.setWidth(window.innerWidth),e.setHeight(window.innerHeight),e.renderAll())};return es(()=>{n(),window.addEventListener("resize",a)}),mn(()=>{window.removeEventListener("resize",a),e&&(e.dispose(),e=null)}),(l,c)=>(ot(),ut("div",j2,[P("canvas",{ref_key:"canvasRef",ref:t,class:"full-canvas"},null,512),P("div",{class:"debug-panel"},[P("button",{onClick:i,class:"debug-btn"},"触发选择事件"),P("button",{onClick:o,class:"debug-btn"},"打印事件列表")])]))}}),B2=vs(I2,[["__scopeId","data-v-9a9e3292"]]),N2=[{path:"/",name:"Editor",component:D2},{path:"/test-page",name:"TestPage",component:B2}],H2=$y({history:wy(),routes:N2}),k0=H_(W_);k0.use(H2);k0.mount("#app");
